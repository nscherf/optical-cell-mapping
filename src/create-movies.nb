(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    521415,      13228]
NotebookOptionsPosition[    490436,      12607]
NotebookOutlinePosition[    490792,      12623]
CellTagsIndexPosition[    490749,      12620]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["select data set", "Subsection",
 CellChangeTimes->{{3.6616988112429657`*^9, 
  3.6616988137700567`*^9}},ExpressionUUID->"253f1c94-683e-45f9-a990-\
d2050a508c4b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dataset", " ", "=", " ", "10"}], ";"}]], "Input",
 CellChangeTimes->{{3.6616988049646997`*^9, 3.661698805331214*^9}, {
   3.661699570047418*^9, 3.6616995702067003`*^9}, {3.661699685846887*^9, 
   3.661699685942478*^9}, {3.661699877141048*^9, 3.6616998772590837`*^9}, {
   3.661700038393881*^9, 3.661700038652042*^9}, {3.661700334737482*^9, 
   3.661700334855748*^9}, {3.661700605938519*^9, 3.661700606231571*^9}, 
   3.6619510546485367`*^9, {3.6619511802396307`*^9, 3.661951180413286*^9}, {
   3.661951331335569*^9, 3.661951331636476*^9}, {3.661951466820656*^9, 
   3.661951467548032*^9}, {3.662017798157402*^9, 3.662017798392653*^9}, 
   3.662294981013357*^9, {3.662295567511388*^9, 3.662295567637494*^9}, {
   3.662295755753685*^9, 3.662295756270338*^9}, {3.6622962877254333`*^9, 
   3.6622962879874353`*^9}, 3.662299466893277*^9, {3.667719223646413*^9, 
   3.667719223899783*^9}, {3.668839781746401*^9, 3.668839782050395*^9}, {
   3.66883989569734*^9, 3.668839895879416*^9}, {3.668839926511546*^9, 
   3.668839926734028*^9}, {3.668839978261392*^9, 3.668839978517087*^9}, {
   3.668840023660438*^9, 3.668840024156015*^9}, {3.668841525230241*^9, 
   3.6688415253632174`*^9}, 3.669356367489142*^9, {3.66935876991918*^9, 
   3.669358770061015*^9}, 3.669358897906798*^9, {3.669435010597662*^9, 
   3.669435012732415*^9}, 3.6694360073190947`*^9, {3.669437184435788*^9, 
   3.669437184617661*^9}, {3.669437338830986*^9, 3.6694373390053043`*^9}, {
   3.6694602405174417`*^9, 3.669460240594811*^9}, 3.669963041105193*^9, {
   3.669963135421245*^9, 3.669963135524159*^9}, {3.669963174354681*^9, 
   3.669963174506352*^9}, {3.669996428949101*^9, 
   3.6699964293213778`*^9}},ExpressionUUID->"fd8fcc77-2fa7-4cd8-b692-\
a97eaaa48292"],

Cell[BoxData[
 RowBox[{
  RowBox[{"overview", " ", "=", " ", 
   RowBox[{
    RowBox[{
    "Import", "[", 
     "\"\</Users/scherf/Documents/heart_new/data/spim_data.xlsx\>\"", "]"}], 
    "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.655478850907806*^9, 3.6554788624077682`*^9}, {
  3.655478908663498*^9, 
  3.655478938193561*^9}},ExpressionUUID->"cdc0b164-a6d4-4a71-88a3-\
0bce04efe8b6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["function definitions", "Subsection",
 CellChangeTimes->{{3.655477656265525*^9, 3.655477684664707*^9}, {
  3.670829954270688*^9, 
  3.6708299550289927`*^9}},ExpressionUUID->"098abeac-76b6-44ee-8cfa-\
4eff7110d5b4"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "transformToStandardView", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"transformToStandardView", "[", 
   RowBox[{"pt_", ",", 
    RowBox[{"angle_:", "45"}], ",", 
    RowBox[{"axis_:", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"RotationTransform", "[", 
    RowBox[{
     RowBox[{"angle", " ", "Degree"}], ",", "axis"}], "]"}], "[", "pt", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.658055068448379*^9, 3.658055125046105*^9}, {
  3.658055171229183*^9, 3.658055209528452*^9}, {3.658129474770509*^9, 
  3.65812950587053*^9}},ExpressionUUID->"06893693-f5d0-41a9-b9b0-\
dc826ded4264"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "transformToStandardView", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"transformToStandardView", "[", "pt_", "]"}], ":=", 
  RowBox[{"stdTransform", "[", "pt", "]"}]}]}], "Input",
 CellChangeTimes->{{3.658658373607829*^9, 
  3.658658416835149*^9}},ExpressionUUID->"99cdf467-8c8b-48af-9a3f-\
3a75d35c5514"],

Cell[BoxData[
 RowBox[{
  RowBox[{"brewerDiv", "=", 
   RowBox[{
    RowBox[{"Blend", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"RGBColor", "[", 
         RowBox[{"#", "/", "255."}], "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"178", ",", "24", ",", "43"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"214", ",", "96", ",", "77"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"244", ",", "165", ",", "130"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"253", ",", "219", ",", "199"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"247", ",", "247", ",", "247"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"209", ",", "229", ",", "240"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"146", ",", "197", ",", "222"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"67", ",", "147", ",", "195"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"33", ",", "102", ",", "172"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"1", "-", "#"}]}], "]"}], "&"}]}], ";"}]], "Input",ExpressionUUI\
D->"3ef0d7a8-5a30-4911-afaa-956ce4d35897"],

Cell[BoxData[
 RowBox[{"brewerQ1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"RGBColor", "[", 
     RowBox[{"Sequence", "@@", 
      RowBox[{"(", 
       RowBox[{"#", "/", "255."}], ")"}]}], "]"}], "&"}], "/@", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"166", ",", "206", ",", "227"}], "}"}], ",", 
     RowBox[{"{", "\n", 
      RowBox[{"31", ",", "120", ",", "180"}], "}"}], ",", 
     RowBox[{"{", "\n", 
      RowBox[{"178", ",", "223", ",", "138"}], "}"}], ",", 
     RowBox[{"{", "\n", 
      RowBox[{"51", ",", "160", ",", "44"}], "}"}], ",", "\n", 
     RowBox[{"{", 
      RowBox[{"251", ",", "154", ",", "153"}], "}"}], ",", "\n", 
     RowBox[{"{", 
      RowBox[{"227", ",", "26", ",", "28"}], "}"}], ",", "\n", 
     RowBox[{"{", 
      RowBox[{"253", ",", "191", ",", "111"}], "}"}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.662225460035103*^9, 
  3.66222551476305*^9}},ExpressionUUID->"78ec1234-6131-4128-b0d2-\
d10508d1625d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"brewerDiv2", "=", 
   RowBox[{
    RowBox[{"Blend", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"RGBColor", "[", 
         RowBox[{"#", "/", "255."}], "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"208", ",", "28", ",", "139"}], "}"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{"241", ",", "182", ",", "218"}], "}"}], ",", "\n", 
         RowBox[{"{", 
          RowBox[{"247", ",", "247", ",", "247"}], "}"}], ",", "\n", 
         RowBox[{"{", 
          RowBox[{"184", ",", "225", ",", "134"}], "}"}], ",", "\n", 
         RowBox[{"{", 
          RowBox[{"77", ",", "172", ",", "38"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"1", "-", "#"}]}], "]"}], "&"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.661700892766808*^9, 3.661700897847474*^9}, {
   3.661700933495496*^9, 3.661700935757738*^9}, 3.661701332441759*^9, {
   3.66170138624759*^9, 3.6617013991363993`*^9}, 3.6617014933560123`*^9, {
   3.661701559129677*^9, 
   3.661701559206581*^9}},ExpressionUUID->"9011ce98-89ae-4a70-8ade-\
7b1c706c5853"],

Cell[BoxData[
 RowBox[{
  RowBox[{"brewerDiv3", "=", 
   RowBox[{
    RowBox[{"Blend", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"RGBColor", "[", 
         RowBox[{"#", "/", "255."}], "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"215", ",", "25", ",", "28"}], "}"}], ",", "\n", 
         RowBox[{"{", 
          RowBox[{"253", ",", "174", ",", "97"}], "}"}], ",", "\n", 
         RowBox[{"{", 
          RowBox[{"255", ",", "255", ",", "191"}], "}"}], ",", "\n", 
         RowBox[{"{", 
          RowBox[{"166", ",", "217", ",", "106"}], "}"}], ",", "\n", 
         RowBox[{"{", 
          RowBox[{"26", ",", "150", ",", "65"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"1", "-", "#"}]}], "]"}], "&"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.661701416056884*^9, 3.661701454028306*^9}, {
  3.661701624129731*^9, 
  3.661701638858038*^9}},ExpressionUUID->"dbc4552f-bba9-4f35-b797-\
d220d600b5ed"],

Cell[BoxData[
 RowBox[{
  RowBox[{"brewerGray", "=", 
   RowBox[{
    RowBox[{"Blend", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"RGBColor", "[", 
         RowBox[{"#", "/", "255."}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"240", ",", "240", ",", "240"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"189", ",", "189", ",", "189"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"99", ",", "99", ",", "99"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"1", "-", "#"}]}], "]"}], "&"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6677196451076517`*^9, 
  3.667719695649692*^9}},ExpressionUUID->"492df008-12bc-45ae-b6c3-\
1dd92afd5ddf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"compute", " ", 
    RowBox[{"\[CapitalDelta]F", "/", "F_"}], "0"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Clear", "[", "preproc", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"preproc", "[", "series_", "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"series", "-", 
       RowBox[{"Min", "[", "series", "]"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"Min", "[", "series", "]"}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "this", " ", "is", " ", "more", " ", "reasonable", " ", "in", " ", "our",
       " ", "case"}], ",", " ", 
     RowBox[{
     "as", " ", "the", " ", "dynamic", " ", "range", " ", "of", " ", "the", 
      " ", "signal", " ", "depends", " ", "on", " ", "the", " ", "imaging", 
      " ", 
      RowBox[{"(", 
       RowBox[{"light", " ", "sheet", " ", "thickness", " ", 
        RowBox[{"etc", "."}]}], ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Clear", "[", "preproc", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"preproc", "[", "series_", "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"series", "-", 
       RowBox[{"Min", "[", "series", "]"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Max", "[", "series", "]"}], "-", 
       RowBox[{"Min", "[", "series", "]"}]}], ")"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.621414495345984*^9, 3.621414654193721*^9}, {
  3.62148862039193*^9, 3.6214886581647587`*^9}, {3.621489768697427*^9, 
  3.621489779861582*^9}, {3.621491359055036*^9, 3.621491379776462*^9}, {
  3.62150300486784*^9, 3.621503078699246*^9}, {3.6215031145596733`*^9, 
  3.621503114918274*^9}, {3.622281338117691*^9, 3.622281338333582*^9}, {
  3.622282460171179*^9, 3.6222824633812523`*^9}, {3.6482799764752703`*^9, 
  3.648279997278907*^9}, {3.648379208241482*^9, 3.648379239341011*^9}, {
  3.648379301782318*^9, 3.648379323729392*^9}, {3.6483793580730343`*^9, 
  3.648379365632245*^9}, {3.648379693572092*^9, 
  3.648379733068969*^9}},ExpressionUUID->"a5946511-7c8d-41e9-ba8b-\
c66d3281ee5c"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "smoothSeries", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"smoothSeries", "[", 
   RowBox[{"series_", ",", 
    RowBox[{"omega_:", "freqCut"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "dat", ",", " ", "lpdat", ",", "ip", ",", " ", "tmin", ",", " ", "tmax", 
      ",", " ", "tminS", ",", " ", "tmaxS", ",", " ", "t0"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dat", "=", " ", 
      RowBox[{"preproc", "[", "series", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"lpdat", " ", "=", " ", 
      RowBox[{"LowpassFilter", "[", 
       RowBox[{"dat", ",", "omega", ",", 
        RowBox[{"Padding", "\[Rule]", "\"\<Periodic\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"lpdat", " ", "=", " ", 
      RowBox[{"preproc", "[", "lpdat", "]"}]}], ";", "\[IndentingNewLine]", 
     "lpdat"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.621603610156046*^9, 3.621603640439749*^9}, {
   3.661145583639009*^9, 3.6611455893669*^9}, {3.6616893983586483`*^9, 
   3.661689399045126*^9}, 
   3.661689459237159*^9},ExpressionUUID->"207a400b-ca4c-4f45-95d0-\
06c198cae3c7"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "extractProperties", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"extractProperties", "[", 
   RowBox[{"series_", ",", 
    RowBox[{"omega_:", "freqCut"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "dat", ",", " ", "lpdat", ",", "ip", ",", " ", "tmin", ",", " ", "tmax", 
      ",", " ", "tminS", ",", " ", "tmaxS", ",", " ", "t0"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dat", "=", " ", 
      RowBox[{"preproc", "[", "series", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"lpdat", " ", "=", " ", 
      RowBox[{"LowpassFilter", "[", 
       RowBox[{"dat", ",", "omega", ",", 
        RowBox[{"Padding", "\[Rule]", "\"\<Periodic\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"lpdat", " ", "=", " ", 
      RowBox[{"preproc", "[", "lpdat", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ip", " ", "=", " ", 
      RowBox[{"Interpolation", "[", 
       RowBox[{"lpdat", ",", " ", 
        RowBox[{"Method", "\[Rule]", "\"\<Spline\>\""}], ",", " ", 
        RowBox[{"InterpolationOrder", "\[Rule]", "3"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmin", " ", "=", " ", 
      RowBox[{"Ordering", "[", 
       RowBox[{"lpdat", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tmax", " ", "=", " ", 
      RowBox[{"Ordering", "[", 
       RowBox[{"lpdat", ",", " ", 
        RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tminS", " ", "=", " ", 
      RowBox[{"z", "/.", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ip", "'"}], "[", "z", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"z", ",", 
           RowBox[{"tmin", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmaxS", " ", "=", " ", 
      RowBox[{"z", "/.", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ip", "'"}], "[", "z", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"z", ",", 
           RowBox[{"tmax", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"t0", " ", "=", 
      RowBox[{"z", "/.", " ", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ip", "[", "z", "]"}], "-", "0.05"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"z", ",", " ", 
           RowBox[{"tmin", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
           RowBox[{"tmax", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"t0", ",", 
       RowBox[{"Abs", "[", 
        RowBox[{"tmaxS", "-", "tminS"}], "]"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.621511150674205*^9, 3.621511162073666*^9}, {
  3.621603572095186*^9, 3.6216035782239227`*^9}, {3.621603657445952*^9, 
  3.621603676055779*^9}, {3.66114560736907*^9, 3.661145608016409*^9}, {
  3.661689420124222*^9, 
  3.6616894500665827`*^9}},ExpressionUUID->"c522aa00-6387-42e2-b9e0-\
bc7e76717b21"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "myGrad", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myGrad", "[", "lst_", "]"}], ":=", 
  RowBox[{"Most", "[", 
   RowBox[{
    RowBox[{"RotateLeft", "[", "lst", "]"}], "-", "lst"}], "]"}]}]}], "Input",\
ExpressionUUID->"29a17488-dbb8-493f-9c8c-cdba6d2dc497"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "shift2min", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"shift2min", "[", 
   RowBox[{"series_", ",", 
    RowBox[{"omega_:", "freqCut"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "dat", ",", " ", "lpdat", ",", "ip", ",", " ", "tmin", ",", " ", "tmax", 
      ",", " ", "tminS", ",", " ", "tmaxS", ",", " ", "t0"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dat", "=", " ", 
      RowBox[{"preproc", "[", "series", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"lpdat", " ", "=", " ", 
      RowBox[{"LowpassFilter", "[", 
       RowBox[{"dat", ",", "omega", ",", 
        RowBox[{"Padding", "\[Rule]", "\"\<Periodic\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"lpdat", " ", "=", " ", 
        RowBox[{"preproc", "[", "lpdat", "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"tmin", " ", "=", " ", 
      RowBox[{"Ordering", "[", 
       RowBox[{"lpdat", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tmax", " ", "=", " ", 
      RowBox[{"Ordering", "[", 
       RowBox[{"lpdat", ",", " ", 
        RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"RotateLeft", "[", 
      RowBox[{"lpdat", ",", "tmin"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.62184828896596*^9, 3.621848346601688*^9}, {
   3.621848529714538*^9, 3.621848530244442*^9}, {3.621848601534739*^9, 
   3.621848608503471*^9}, {3.6218488008026648`*^9, 3.62184881182285*^9}, 
   3.661149397848797*^9, 
   3.661689462468594*^9},ExpressionUUID->"b833ac0c-4edd-43e5-aa5e-\
18b1d49eb15f"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "simpleOnset", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"simpleOnset", "[", 
   RowBox[{"signal_", ",", 
    RowBox[{"\[Omega]_:", "freqCut"}], ",", " ", 
    RowBox[{"thresh_:", "0.1"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"smooth", ",", "aboveT", ",", "minT"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"smooth", " ", "=", " ", 
      RowBox[{"preproc", "@", 
       RowBox[{"LowpassFilter", "[", 
        RowBox[{"signal", ",", " ", "\[Omega]", ",", 
         RowBox[{"Padding", "\[Rule]", "\"\<Periodic\>\""}]}], "]"}]}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"aboveT", "=", 
      RowBox[{"Position", "[", 
       RowBox[{"smooth", ",", " ", 
        RowBox[{"x_", "/;", 
         RowBox[{"x", ">", "0.05"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"minT", "=", 
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{"smooth", ",", "0."}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"First", "[", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"smooth", "[", 
           RowBox[{"[", 
            RowBox[{"minT", ";;", 
             RowBox[{"Length", "[", "signal", "]"}]}], "]"}], "]"}], ",", 
          RowBox[{"x_", "/;", 
           RowBox[{"x", ">", "thresh"}]}]}], "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "+", "minT", "+", "1"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "argMaxDerivative", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"argMaxDerivative", "[", 
    RowBox[{"series_", ",", 
     RowBox[{"order_:", "1"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "dF", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dF", " ", "=", " ", 
       RowBox[{"DerivativeFilter", "[", 
        RowBox[{"series", ",", 
         RowBox[{"{", "order", "}"}], ",", 
         RowBox[{"Padding", "\[Rule]", "\"\<Periodic\>\""}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{"dF", ",", 
         RowBox[{"Max", "[", "dF", "]"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "getActivationTime", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getActivationTime", "[", 
    RowBox[{"series_", ",", 
     RowBox[{"\[Omega]_:", "freqCut"}]}], "]"}], ":=", 
   RowBox[{"argMaxDerivative", "[", 
    RowBox[{"LowpassFilter", "[", 
     RowBox[{
      RowBox[{"preproc", "[", "series", "]"}], ",", "\[Omega]", ",", 
      RowBox[{"Padding", "\[Rule]", "\"\<Periodic\>\""}]}], "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "getRiseTime", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getRiseTime", "[", 
    RowBox[{"series_", ",", 
     RowBox[{"\[Omega]_:", "freqCut"}], ",", 
     RowBox[{"Fmin_:", "0.2"}], ",", 
     RowBox[{"Fmax_:", "0.8"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "shifted", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"shifted", "=", 
       RowBox[{"preproc", "[", 
        RowBox[{"shift2min", "[", 
         RowBox[{"series", ",", "\[Omega]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"shifted", ",", 
            RowBox[{"x_", "/;", 
             RowBox[{"x", ">", "Fmin"}]}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"shifted", ",", 
           RowBox[{"x_", "/;", 
            RowBox[{"x", ">", "Fmax"}]}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "getAPD", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getAPD", "[", 
   RowBox[{"series_", ",", 
    RowBox[{"level_:", "0.25"}], ",", 
    RowBox[{"\[Omega]_:", "freqCut"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "shifted", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"shifted", "=", 
      RowBox[{"preproc", "[", 
       RowBox[{"shift2min", "[", 
        RowBox[{"series", ",", "\[Omega]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"argMaxDerivative", "[", 
        RowBox[{"shifted", ",", "1"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"Last", "[", 
        RowBox[{"Position", "[", 
         RowBox[{"shifted", ",", 
          RowBox[{"x_", "/;", 
           RowBox[{"x", ">", "level"}]}]}], "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "getAPD", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getAPD", "[", 
    RowBox[{"series_", ",", 
     RowBox[{"level_:", "0.25"}], ",", 
     RowBox[{"\[Omega]_:", "freqCut"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "shifted", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"shifted", "=", 
       RowBox[{"preproc", "[", 
        RowBox[{"shift2min", "[", 
         RowBox[{"series", ",", "\[Omega]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         RowBox[{"First", "[", 
          RowBox[{"Position", "[", 
           RowBox[{"shifted", ",", 
            RowBox[{"x_", "/;", 
             RowBox[{"x", ">", "0.1"}]}]}], "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Last", "[", 
         RowBox[{"Position", "[", 
          RowBox[{"shifted", ",", 
           RowBox[{"x_", "/;", 
            RowBox[{"x", ">", "level"}]}]}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "getRepolarization", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getRepolarization", "[", 
    RowBox[{"series_", ",", 
     RowBox[{"level_:", "0.1"}], ",", 
     RowBox[{"\[Omega]_:", "freqCut"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "shifted", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"shifted", "=", 
       RowBox[{"preproc", "[", 
        RowBox[{"shift2min", "[", 
         RowBox[{"series", ",", "\[Omega]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Last", "[", 
        RowBox[{"Position", "[", 
         RowBox[{"shifted", ",", 
          RowBox[{"x_", "/;", 
           RowBox[{"x", ">", "level"}]}]}], "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "extractFeatures", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"extractFeatures", "[", 
   RowBox[{"series_", ",", " ", 
    RowBox[{"\[Omega]_:", "freqCut"}], ",", 
    RowBox[{"Fm_:", "0.1"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "s", ",", "ss", ",", "gs", ",", "runs", ",", "hit", ",", "range", ",", 
      "t", ",", "raw", ",", "smooth", ",", "sloperaw", ",", "slopesmooth", 
      ",", "lmraw", ",", "lmsmooth", ",", "onset", ",", "onsetOld", ",", 
      "estimatedSlope", ",", "SNR", ",", "onset2"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"s", " ", "=", " ", 
      RowBox[{"preproc", "[", "series", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ss", " ", "=", " ", 
      RowBox[{"LowpassFilter", "[", 
       RowBox[{"s", ",", " ", "\[Omega]", ",", 
        RowBox[{"Padding", "\[Rule]", "\"\<Periodic\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"gs", " ", "=", " ", 
      RowBox[{"DerivativeFilter", "[", 
       RowBox[{"ss", ",", " ", 
        RowBox[{"{", "1", "}"}], ",", 
        RowBox[{"Padding", "\[Rule]", "\"\<Periodic\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"runs", " ", "=", " ", 
      RowBox[{"Split", "[", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"#", ">", "0"}], ",", "1", ",", "0"}], "]"}], "&"}], "/@", 
        "gs"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"hit", "=", 
      RowBox[{
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{"runs", ",", 
           RowBox[{"x_", "/;", 
            RowBox[{
             RowBox[{"Total", "[", "x", "]"}], "\[Equal]", "0"}]}]}], "]"}], 
         ",", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Length", "[", "#", "]"}]}], "&"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"range", "=", 
      RowBox[{
       RowBox[{"SequencePosition", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", "runs", "]"}], ",", "hit"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t", ",", "raw", ",", "smooth"}], " ", "}"}], "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"t", "-", 
            RowBox[{"range", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"s", "[", 
            RowBox[{"[", "t", "]"}], "]"}], ",", 
           RowBox[{"ss", "[", 
            RowBox[{"[", "t", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", 
           RowBox[{"range", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"range", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sloperaw", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"t", ",", "raw"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"slopesmooth", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"t", ",", "smooth"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"lmraw", "=", " ", 
      RowBox[{"LinearModelFit", "[", 
       RowBox[{"sloperaw", ",", "x", ",", "x"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"estimatedSlope", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Normal", "[", "lmraw", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SNR", "=", 
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{"Abs", "[", 
         RowBox[{"ss", "-", "s"}], "]"}], "]"}], "/", 
       RowBox[{"Length", "[", "ss", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SNR", " ", "=", " ", 
      RowBox[{"StandardDeviation", "[", 
       RowBox[{"s", "-", "ss"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"onset", " ", "=", " ", 
      RowBox[{"simpleOnset", "[", 
       RowBox[{"series", ",", "\[Omega]", ",", "Fm"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"onset", ",", " ", "estimatedSlope", ",", "SNR"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.648290426385738*^9, 3.648290500579914*^9}, {
   3.648290546740262*^9, 3.6482906066894608`*^9}, {3.648290639424357*^9, 
   3.648290642542295*^9}, {3.6482906917981577`*^9, 3.6482907358431177`*^9}, {
   3.648290765868389*^9, 3.648290823151842*^9}, {3.648290893294001*^9, 
   3.648290911052747*^9}, {3.6482909479005213`*^9, 3.648291269111842*^9}, {
   3.648291312927846*^9, 3.648291343238446*^9}, {3.648291393790494*^9, 
   3.648291427153854*^9}, {3.648292098797996*^9, 3.6482921286190443`*^9}, 
   3.648292167819491*^9, {3.648292312876318*^9, 3.648292405009597*^9}, {
   3.6482924712586184`*^9, 3.648292473559451*^9}, {3.6482926400433702`*^9, 
   3.648292640336864*^9}, {3.648292988745466*^9, 3.648292998844994*^9}, {
   3.6482930661775017`*^9, 3.648293068481189*^9}, {3.648295455890953*^9, 
   3.648295456014831*^9}, {3.6482957084335117`*^9, 3.6482957479154997`*^9}, {
   3.648295819435931*^9, 3.648295909774489*^9}, {3.6483781144423113`*^9, 
   3.6483781190779877`*^9}, {3.648382381036914*^9, 3.648382413442865*^9}, {
   3.648804471818643*^9, 3.64880453924159*^9}, {3.6488047329570227`*^9, 
   3.6488047332601433`*^9}, {3.6520699731964903`*^9, 3.652069975291255*^9}, {
   3.654864187424755*^9, 3.654864223543949*^9}, {3.6548715211093807`*^9, 
   3.654871525803388*^9}, {3.6548719329643*^9, 3.6548720547756233`*^9}, {
   3.661145554972522*^9, 3.66114556787405*^9}, {3.661145659631966*^9, 
   3.6611456763190613`*^9}, {3.6611461235078173`*^9, 3.661146126425735*^9}, {
   3.6611468317812138`*^9, 3.661146837756259*^9}, {3.661147073459908*^9, 
   3.6611471591467667`*^9}, {3.661149367683796*^9, 3.661149459654894*^9}, 
   3.66114952725494*^9, {3.6611523791584377`*^9, 3.661152382860093*^9}, {
   3.661152845396974*^9, 3.661152846499792*^9}, {3.661153376043866*^9, 
   3.661153377547793*^9}, {3.661155898982575*^9, 3.6611559014601603`*^9}, {
   3.661689464719151*^9, 3.6616894826132603`*^9}, {3.6620213209055653`*^9, 
   3.6620213391854067`*^9}},ExpressionUUID->"4a43a0fd-b938-4037-b1fd-\
b6e0f55f2b9b"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "extractFeatures", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"extractFeatures", "[", 
   RowBox[{"series_", ",", " ", 
    RowBox[{"\[Omega]_:", "freqCut"}], ",", 
    RowBox[{"Fm_:", "0.1"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "s", ",", "ss", ",", "gs", ",", "runs", ",", "hit", ",", "range", ",", 
      "t", ",", "raw", ",", "smooth", ",", "sloperaw", ",", "slopesmooth", 
      ",", "lmraw", ",", "lmsmooth", ",", "onset", ",", "onsetOld", ",", 
      "estimatedSlope", ",", "SNR", ",", "onset2"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"s", " ", "=", " ", 
      RowBox[{"preproc", "[", "series", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ss", " ", "=", " ", 
      RowBox[{"LowpassFilter", "[", 
       RowBox[{"s", ",", " ", "\[Omega]", ",", 
        RowBox[{"Padding", "\[Rule]", "\"\<Periodic\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"gs", " ", "=", " ", 
      RowBox[{"DerivativeFilter", "[", 
       RowBox[{"ss", ",", " ", 
        RowBox[{"{", "1", "}"}], ",", 
        RowBox[{"Padding", "\[Rule]", "\"\<Periodic\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"runs", " ", "=", " ", 
      RowBox[{"Split", "[", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"#", ">", "0"}], ",", "1", ",", "0"}], "]"}], "&"}], "/@", 
        "gs"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"hit", "=", 
      RowBox[{
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{"runs", ",", 
           RowBox[{"x_", "/;", 
            RowBox[{
             RowBox[{"Total", "[", "x", "]"}], "\[Equal]", "0"}]}]}], "]"}], 
         ",", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Length", "[", "#", "]"}]}], "&"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"range", "=", 
      RowBox[{
       RowBox[{"SequencePosition", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", "runs", "]"}], ",", "hit"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t", ",", "raw", ",", "smooth"}], " ", "}"}], "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"t", "-", 
            RowBox[{"range", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"s", "[", 
            RowBox[{"[", "t", "]"}], "]"}], ",", 
           RowBox[{"ss", "[", 
            RowBox[{"[", "t", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", 
           RowBox[{"range", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"range", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sloperaw", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"t", ",", "raw"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"slopesmooth", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"t", ",", "smooth"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"lmraw", "=", " ", 
      RowBox[{"LinearModelFit", "[", 
       RowBox[{"sloperaw", ",", "x", ",", "x"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"estimatedSlope", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Normal", "[", "lmraw", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SNR", "=", 
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{"Abs", "[", 
         RowBox[{"ss", "-", "s"}], "]"}], "]"}], "/", 
       RowBox[{"Length", "[", "ss", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SNR", " ", "=", " ", 
      RowBox[{"StandardDeviation", "[", 
       RowBox[{"s", "-", "ss"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"onset", " ", "=", " ", 
      RowBox[{"simpleOnset", "[", 
       RowBox[{"series", ",", "\[Omega]", ",", "Fm"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"onset", ",", " ", "estimatedSlope", ",", "SNR"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{3.661146833915065*^9, 
  3.6616894853888483`*^9},ExpressionUUID->"3566dcb6-42ca-4436-8fa5-\
6ab17256fbe9"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "localTopology", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"localTopology", "[", 
   RowBox[{"pt_", ",", "ptLst_", ",", "nearestFunction_", ",", " ", 
    RowBox[{"nCandidates_:", "10"}], ",", " ", 
    RowBox[{"maxDistance_:", "100"}], ",", " ", 
    RowBox[{"maxDistanceToPlane_:", "2.5"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "candidates", ",", "localID2globalID", ",", "Y", ",", "U", ",", "S", ",",
       "V", ",", " ", "projectedPts", ",", " ", "dm", ",", " ", "edges", ",", 
      "outliers", ",", "projectedPtsClean", ",", "idMap"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"candidates", "  ", "=", " ", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"nearestFunction", "[", 
         RowBox[{"pt", ",", " ", "nCandidates"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"EuclideanDistance", "[", 
           RowBox[{"pt", ",", " ", "#"}], "]"}], "\[LessEqual]", 
          "maxDistance"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"localID2globalID", " ", "=", " ", 
      RowBox[{"MapIndexed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#2", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", " ", 
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{"ptLst", ",", " ", "#1"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "&"}], ",", 
        "candidates"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Y", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "-", 
           RowBox[{"Mean", "/@", "#"}]}], "&"}], "[", 
         RowBox[{"candidates", "\[Transpose]"}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "This", " ", "is", " ", "an", " ", "adapted", " ", "version", " ", 
        "of", " ", 
        RowBox[{"SVD", ".", " ", "Instead"}], " ", "of", " ", "subtracting", 
        " ", "mean"}], ",", " ", 
       RowBox[{
       "we", " ", "want", " ", "our", " ", "original", " ", "point", " ", 
        "to", " ", "be", " ", "at", " ", "the", " ", 
        RowBox[{"plane", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Y", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "-", 
           RowBox[{"First", "[", "candidates", "]"}]}], "&"}], "@", 
         RowBox[{"Transpose", "[", "candidates", "]"}]}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Y", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "-", 
         RowBox[{"Mean", "/@", "#"}]}], "&"}], "[", 
       RowBox[{"candidates", "\[Transpose]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"U", ",", "S", ",", "V"}], "}"}], "=", 
      RowBox[{"SingularValueDecomposition", "[", "Y", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"projectedPts", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"V", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"V", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"outliers", " ", "=", " ", 
      RowBox[{"Position", "[", 
       RowBox[{
        RowBox[{"V", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
        RowBox[{"x_", "/;", 
         RowBox[{
          RowBox[{"Abs", "[", "x", "]"}], ">", "maxDistanceToPlane"}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"projectedPtsClean", " ", "=", " ", 
      RowBox[{"Delete", "[", 
       RowBox[{"projectedPts", ",", "outliers"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"idMap", " ", "=", " ", 
      RowBox[{"MapIndexed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#2", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", " ", 
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{"projectedPts", ",", "#1"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "&"}], ",", 
        "projectedPtsClean"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"dm", "=", 
      RowBox[{"DelaunayMesh", "[", 
       RowBox[{"(", "projectedPtsClean", ")"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"edges", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"UndirectedEdge", "[", 
         RowBox[{"Sequence", "@@", "#"}], "]"}], "&"}], "/@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MeshCells", "[", 
            RowBox[{"dm", ",", "1"}], "]"}], "/.", "idMap"}], ")"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Line", "[", 
             RowBox[{"x_", "/;", 
              RowBox[{"MemberQ", "[", 
               RowBox[{"x", ",", 
                RowBox[{"1", "/.", "idMap"}]}], "]"}]}], "]"}], "\[Rule]", 
            "x"}], ",", 
           RowBox[{
            RowBox[{"Line", "[", "_", "]"}], "\[Rule]", 
            RowBox[{"Nothing", "[", "]"}]}]}], "}"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"edges", "/.", "localID2globalID"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.653721911879781*^9, 3.653722110779483*^9}, {
   3.653722271238433*^9, 3.6537223419371777`*^9}, {3.6537223936276608`*^9, 
   3.6537224622880697`*^9}, {3.6537225480068073`*^9, 3.6537226894098454`*^9}, 
   3.653722726424877*^9, {3.653722873000099*^9, 3.6537228746371107`*^9}, {
   3.65372535237012*^9, 3.6537253540532703`*^9}, {3.653730022769689*^9, 
   3.653730280660316*^9}, {3.6537303234804564`*^9, 3.653730324860836*^9}, {
   3.653730392056385*^9, 3.653730392156045*^9}, {3.653730479783046*^9, 
   3.653730480235344*^9}, {3.6538171276476517`*^9, 3.653817129020533*^9}, {
   3.653817361397971*^9, 
   3.6538173787157784`*^9}},ExpressionUUID->"297b5a13-adbb-415d-b0a2-\
25ff5d8e4db7"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "transform2phase", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"transform2phase", "[", 
   RowBox[{"series_", ",", 
    RowBox[{"tau_:", 
     RowBox[{"\[Tau]", "/", "2"}]}]}], "]"}], ":=", 
  RowBox[{"Transpose", "[", 
   RowBox[{"{", 
    RowBox[{"series", ",", " ", 
     RowBox[{"RotateLeft", "[", 
      RowBox[{"series", ",", "tau"}], "]"}]}], "}"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.655528865550589*^9, 3.655528883412578*^9}, {
  3.655528941873798*^9, 
  3.655528945703611*^9}},ExpressionUUID->"8e2a3297-4869-4dc3-8392-\
a31ad6483484"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "estimateDiscreteWaveSpeedAtCell", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"estimateDiscreteWaveSpeedAtCell", "[", 
   RowBox[{"cellID_", ",", " ", 
    RowBox[{"dmax_:", "2"}], ",", 
    RowBox[{"dtMin_:", "2"}], ",", 
    RowBox[{"activationTime_:", "onsetAP"}], ",", 
    RowBox[{"graphDistanceFunction_:", "spfun"}], ",", 
    RowBox[{"graphDistanceMatrix_:", "gdistMat"}], ",", 
    RowBox[{"vertexList_:", "cells"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"candidates", ",", "dtlst", ",", "dslst", ",", "vlst"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"candidates", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"gdistMat", "[", 
          RowBox[{"[", "cellID", "]"}], "]"}], ",", 
         RowBox[{"x_", "/;", 
          RowBox[{"0", "<", "x", "\[LessEqual]", "dmax"}]}]}], "]"}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"dtlst", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"activationTime", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "-", 
           RowBox[{"activationTime", "[", 
            RowBox[{"[", "cellID", "]"}], "]"}]}], ")"}], "]"}], "&"}], "/@", 
       "candidates"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"candidates", ",", "dtlst"}], "}"}], "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"#2", "\[LessEqual]", "dtMin"}], ",", "Nothing", ",", 
            RowBox[{"{", 
             RowBox[{"#1", ",", "#2"}], "}"}]}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"candidates", ",", "dtlst"}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dslst", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"spfun", "[", 
          RowBox[{
           RowBox[{"cells", "[", 
            RowBox[{"[", "cellID", "]"}], "]"}], ",", 
           RowBox[{"cells", "[", 
            RowBox[{"[", "#", "]"}], "]"}]}], "]"}], "]"}], "&"}], "/@", 
       "candidates"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vlst", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "/", "#2"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{"dslst", ",", "dtlst"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"HarmonicMean", "[", "vlst", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.6579601211373453`*^9, 3.6579601284944553`*^9}, {
  3.6579789543359528`*^9, 3.6579789548479233`*^9}, {3.658641582041491*^9, 
  3.6586415855449657`*^9}, {3.661148186952147*^9, 
  3.661148213060793*^9}},ExpressionUUID->"2d248f0b-542d-49a6-b258-\
4e87e470bfd5"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "estimateLocalDistanceAtCell", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"estimateLocalDistanceAtCell", "[", 
   RowBox[{"cellID_", ",", " ", 
    RowBox[{"dmax_:", "2"}], ",", 
    RowBox[{"dtMin_:", "2"}], ",", 
    RowBox[{"activationTime_:", "onsetAP"}], ",", 
    RowBox[{"graphDistanceFunction_:", "spfun"}], ",", 
    RowBox[{"graphDistanceMatrix_:", "gdistMat"}], ",", 
    RowBox[{"vertexList_:", "cells"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "candidates", ",", "dtlst", ",", "dslst", ",", "vlst", ",", 
      "timingDifferences", ",", "upstream", ",", "downstream", ",", 
      "neighbors"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"candidates", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"gdistMat", "[", 
          RowBox[{"[", "cellID", "]"}], "]"}], ",", 
         RowBox[{"x_", "/;", 
          RowBox[{"0", "<", "x", "\[LessEqual]", "dmax"}]}]}], "]"}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"timingDifferences", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"onsetAP", "[", 
          RowBox[{"[", "cellID", "]"}], "]"}], "-", 
         RowBox[{"onsetAP", "[", 
          RowBox[{"[", "#", "]"}], "]"}]}], "&"}], "/@", "candidates"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"upstream", "=", 
      RowBox[{"candidates", "[", 
       RowBox[{"[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{"timingDifferences", ",", 
           RowBox[{"x_", "/;", 
            RowBox[{"x", ">", "0"}]}]}], "]"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"downstream", "=", 
      RowBox[{"candidates", "[", 
       RowBox[{"[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{"timingDifferences", ",", 
           RowBox[{"x_", "/;", 
            RowBox[{"x", "<", "0"}]}]}], "]"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"upstream", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[Rule]", 
         RowBox[{"timingDifferences", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"candidates", ",", "#"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], "&"}], "/@",
        "upstream"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"downstream", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[Rule]", 
         RowBox[{"-", 
          RowBox[{"timingDifferences", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"candidates", ",", "#"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}]}], "&"}], 
       "/@", "downstream"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"neighbors", "=", 
      RowBox[{"First", "/@", 
       RowBox[{"(", 
        RowBox[{"First", "/@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"SortBy", "[", 
            RowBox[{"upstream", ",", "Last"}], "]"}], ",", 
           RowBox[{"SortBy", "[", 
            RowBox[{"downstream", ",", "Last"}], "]"}]}], "}"}]}], ")"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FreeQ", "[", 
        RowBox[{"neighbors", ",", 
         RowBox[{"{", "}"}]}], "]"}], ",", 
       RowBox[{"Mean", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"EuclideanDistance", "[", 
           RowBox[{
            RowBox[{"cells", "[", 
             RowBox[{"[", "cellID", "]"}], "]"}], ",", 
            RowBox[{"cells", "[", 
             RowBox[{"[", "#", "]"}], "]"}]}], "]"}], "&"}], "/@", 
         "neighbors"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"EuclideanDistance", "[", 
            RowBox[{
             RowBox[{"cells", "[", 
              RowBox[{"[", "cellID", "]"}], "]"}], ",", 
             RowBox[{"cells", "[", 
              RowBox[{"[", "#", "]"}], "]"}]}], "]"}], "&"}], "/@", 
          RowBox[{"Flatten", "[", "neighbors", "]"}]}], ")"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.667720223152158*^9, 3.667720233678191*^9}, {
  3.6677203059254217`*^9, 3.6677207511972933`*^9}, {3.667720909126408*^9, 
  3.667720983717971*^9}, {3.667721145983016*^9, 
  3.667721149453416*^9}},ExpressionUUID->"7b296263-0997-4fd8-a5d2-\
119dabb76d19"],

Cell[BoxData[
 RowBox[{
  RowBox[{"phaseDistance", "[", 
   RowBox[{"trajectory1_", ",", "trajectory2_"}], "]"}], ":=", 
  RowBox[{"Min", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Total", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"EuclideanDistance", "[", 
         RowBox[{"Sequence", "@@", "#"}], "]"}], "&"}], "/@", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"RotateLeft", "[", 
           RowBox[{"trajectory1", ",", "dt"}], "]"}], ",", "trajectory2"}], 
         "}"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"dt", ",", "0", ",", 
       RowBox[{
        RowBox[{"Length", "[", "trajectory1", "]"}], "-", "1"}]}], "}"}]}], 
    "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.655529495131178*^9, 
  3.6555296824944067`*^9}},ExpressionUUID->"b1274aa9-d270-4758-bf3b-\
0b0fed50dc04"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Clear", "[", "frontView", "]"}], "\[IndentingNewLine]", 
     RowBox[{"frontView", "[", 
      RowBox[{
      "cells_", ",", "feature_", ",", "min_", ",", "max_", ",", "color_", ",",
        " ", 
       RowBox[{"opacity_:", "True"}], ",", 
       RowBox[{"showEdges_:", "True"}]}], "]"}]}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"maxZ", ",", "minZ", ",", "edges"}], "}"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"maxZ", ",", " ", "minZ"}], "}"}], " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", "cells"}], "]"}],
             ",", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", "cells"}], 
             "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"edges", "=", 
          RowBox[{"If", "[", 
           RowBox[{"showEdges", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"GrayLevel", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"maxZ", "-", "minZ"}], ")"}]}], "]"}], ",", 
                RowBox[{"AbsoluteThickness", "[", "1", "]"}], ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]}], "}"}], 
              "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"myEdges", "/.", 
               RowBox[{"MapIndexed", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"#2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", "#1"}], "&"}], 
                 ",", "cells"}], "]"}]}], ")"}]}], ",", 
            RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"edges", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"AbsolutePointSize", "[", "10", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"StringQ", "[", "color", "]"}], ",", 
                   RowBox[{"ColorData", "[", 
                    RowBox[{"color", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"feature", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "-", "min"}], ")"}], "/", 
                    
                    RowBox[{"(", 
                    RowBox[{"max", "-", "min"}], ")"}]}]}], "]"}], ",", 
                   RowBox[{"color", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"feature", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "-", "min"}], ")"}], "/", 
                    
                    RowBox[{"(", 
                    RowBox[{"max", "-", "min"}], ")"}]}], "]"}]}], "]"}], ",",
                  "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{"opacity", ",", " ", 
                   RowBox[{"Opacity", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cells", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"maxZ", "-", "minZ"}], ")"}]}]}], "]"}], ",", 
                   RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Specularity", "[", "0", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Sphere", "[", 
                  RowBox[{
                   RowBox[{"cells", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", "4"}], "]"}]}], 
                "}"}], "&"}], "/@", 
              RowBox[{"Range", "[", 
               RowBox[{"1", ",", 
                RowBox[{"Length", "[", "cells", "]"}]}], "]"}]}]}], "}"}], 
           ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "imsize"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"ViewPoint", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"-", "Infinity"}], ",", "0"}], "}"}]}], ",", 
           RowBox[{"Lighting", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", "White"}], "}"}], "}"}]}]}], 
          "]"}]}]}], "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Clear", "[", "topView", "]"}], "\[IndentingNewLine]", 
      RowBox[{"topView", "[", 
       RowBox[{
       "cells_", ",", "feature_", ",", "min_", ",", "max_", ",", "color_", 
        ",", " ", 
        RowBox[{"opacity_:", "True"}], ",", 
        RowBox[{"showEdges_:", "True"}]}], "]"}]}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"maxZ", ",", "minZ", ",", "edges"}], "}"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"maxZ", ",", " ", "minZ"}], "}"}], " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "cells"}], 
              "]"}], ",", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "cells"}], 
              "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"edges", "=", 
           RowBox[{"If", "[", 
            RowBox[{"showEdges", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"GrayLevel", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "maxZ"}], ")"}], "/", 
                   RowBox[{"(", 
                    RowBox[{"minZ", "-", "maxZ"}], ")"}]}], "]"}], ",", 
                 RowBox[{"AbsoluteThickness", "[", "1", "]"}], ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]}], "}"}], 
               "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{"myEdges", "/.", 
                RowBox[{"MapIndexed", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", "#1"}], "&"}], 
                  ",", "cells"}], "]"}]}], ")"}]}], ",", 
             RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"Graphics3D", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"edges", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"AbsolutePointSize", "[", "10", "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"StringQ", "[", "color", "]"}], ",", 
                    RowBox[{"ColorData", "[", 
                    RowBox[{"color", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"feature", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "-", "min"}], ")"}], "/", 
                    
                    RowBox[{"(", 
                    RowBox[{"max", "-", "min"}], ")"}]}]}], "]"}], ",", 
                    RowBox[{"color", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"feature", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "-", "min"}], ")"}], "/", 
                    
                    RowBox[{"(", 
                    RowBox[{"max", "-", "min"}], ")"}]}], "]"}]}], "]"}], ",",
                   "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{"opacity", ",", " ", 
                    RowBox[{"Opacity", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cells", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "maxZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"minZ", "-", "maxZ"}], ")"}]}]}], "]"}], ",", 
                    RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Specularity", "[", "0", "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{
                    RowBox[{"cells", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", "4"}], "]"}]}], 
                 "}"}], "&"}], "/@", 
               RowBox[{"Range", "[", 
                RowBox[{"1", ",", 
                 RowBox[{"Length", "[", "cells", "]"}]}], "]"}]}]}], "}"}], 
            ",", 
            RowBox[{"Boxed", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
            RowBox[{"ImageSize", "\[Rule]", "imsize"}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"ViewPoint", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "Infinity"}], "}"}]}], ",", 
            RowBox[{"Lighting", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"\"\<Ambient\>\"", ",", "White"}], "}"}], "}"}]}]}], 
           "]"}]}]}], "]"}], "\[IndentingNewLine]", 
       RowBox[{"Clear", "[", "viewHeart", "]"}], "\[IndentingNewLine]", 
       RowBox[{"viewHeart", "[", 
        RowBox[{
        "cells_", ",", "feature_", ",", "min_", ",", "max_", ",", "color_", 
         ",", 
         RowBox[{"opacity_:", "True"}], ",", 
         RowBox[{"showEdges_:", "True"}]}], "]"}]}], ":=", 
      RowBox[{"Rasterize", "[", 
       RowBox[{
        RowBox[{"Row", "[", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"frontView", "[", 
            RowBox[{
            "cells", ",", " ", "feature", ",", " ", "min", ",", "max", ",", 
             "color", ",", "opacity", ",", "showEdges"}], "]"}], ",", 
           RowBox[{"topView", "[", 
            RowBox[{
            "cells", ",", " ", "feature", ",", "min", ",", "max", ",", 
             "color", ",", "opacity", ",", "showEdges"}], "]"}]}], "}"}], 
         "]"}], ",", 
        RowBox[{"RasterSize", "\[Rule]", 
         RowBox[{"2", "imsize"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "imsize"}]}], "]"}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Clear", "[", "frontViewDiscrete", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"frontViewDiscrete", "[", 
     RowBox[{
     "cells_", ",", "feature_", ",", "color_", ",", " ", "opacity_", ",", 
      "opacityEdges_", ",", "scaleCells_", ",", "cellSize_", ",", 
      "showPacemakers_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"cells2", ",", "maxZ", ",", "minZ", ",", "edges"}], "}"}], ",",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cells2", " ", "=", " ", 
        RowBox[{"transformToStandardView", "/@", "cells"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"maxZ", ",", " ", "minZ"}], "}"}], " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "cells2"}], "]"}], 
          ",", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "cells2"}], 
           "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"minZ", " ", "=", " ", "minZ"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"edges", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"opacityEdges", ">", "0"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Gray", ",", 
              RowBox[{"Opacity", "[", 
               RowBox[{"1", "-", 
                RowBox[{"opacityEdges", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"maxZ", "-", "minZ"}], ")"}]}]}]}], "]"}], ",", 
              RowBox[{"AbsoluteThickness", "[", "1", "]"}], ",", 
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]}], "}"}], 
            "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{"myEdges", "/.", 
             RowBox[{"MapIndexed", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"#2", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", "#1"}], "&"}], 
               ",", "cells2"}], "]"}]}], ")"}]}], ",", 
          RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Graphics3D", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"edges", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"AbsolutePointSize", "[", "8", "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"feature", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "\[Equal]", "0"}], ",", 
                 "White", ",", 
                 RowBox[{"ColorData", "[", 
                  RowBox[{"color", ",", 
                   RowBox[{"feature", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"opacity", ">", "0"}], ",", " ", 
                 RowBox[{"Opacity", "[", 
                  RowBox[{"1", "-", 
                   RowBox[{"opacity", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cells2", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"maxZ", "-", "minZ"}], ")"}]}]}]}], "]"}], ",", 
                 RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Specularity", "[", "0", "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Sphere", "[", 
                RowBox[{
                 RowBox[{"cells2", "[", 
                  RowBox[{"[", "#", "]"}], "]"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{"scaleCells", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cells2", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"maxZ", "-", "minZ"}], ")"}]}], ")"}], "]"}], "+",
                     "1"}], ")"}], "*", "0.5", "cellSize"}], ",", 
                   "cellSize"}], "]"}]}], "]"}]}], "}"}], "&"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"1", ",", 
              RowBox[{"Length", "[", "cells2", "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"showPacemakers", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Black", ",", "\[IndentingNewLine]", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{
                    RowBox[{"cells2", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", 
                    RowBox[{"0.25", "cellSize"}]}], "]"}]}], "}"}], "&"}], "/@",
                "pacemakers"}], "}"}], ",", 
             RowBox[{"{", "}"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "imsize"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"ViewPoint", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "Infinity"}], "}"}]}], ",", 
         RowBox[{"Lighting", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"\"\<Ambient\>\"", ",", "White"}], "}"}], "}"}]}]}], 
        "]"}]}]}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Clear", "[", "viewHeart", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"viewHeartDiscrete", "[", 
     RowBox[{"cells_", ",", "feature_", ",", "color_", ",", 
      RowBox[{"opacity_:", "0.5"}], ",", 
      RowBox[{"opacityEdges_:", "0"}], ",", 
      RowBox[{"scaleCells_:", "False"}], ",", 
      RowBox[{"cellSize_:", "4"}], ",", 
      RowBox[{"showPacemakers_:", "True"}]}], "]"}], ":=", 
    RowBox[{"Rasterize", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"frontViewDiscrete", "[", 
       RowBox[{
       "cells", ",", " ", "feature", ",", " ", "color", ",", "opacity", ",", 
        "opacityEdges", ",", "scaleCells", ",", "cellSize", ",", 
        "showPacemakers"}], "]"}], ",", 
      RowBox[{"RasterSize", "\[Rule]", 
       RowBox[{"2", "imsize"}]}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "imsize"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Clear", "[", "frontView", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"frontView", "[", 
     RowBox[{
     "cells_", ",", "feature_", ",", "min_", ",", "max_", ",", "color_", ",", 
      " ", "opacity_", ",", "opacityEdges_", ",", "scaleCells_", ",", 
      "cellSize_", ",", "showPacemakers_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"cells2", ",", "maxZ", ",", "minZ", ",", "edges"}], "}"}], ",",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cells2", " ", "=", " ", 
        RowBox[{"transformToStandardView", "/@", "cells"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"maxZ", ",", " ", "minZ"}], "}"}], " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "cells2"}], "]"}], 
          ",", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "cells2"}], 
           "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"minZ", " ", "=", " ", "minZ"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"edges", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"opacityEdges", ">", "0"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Gray", ",", 
              RowBox[{"Opacity", "[", 
               RowBox[{"1", "-", 
                RowBox[{"opacityEdges", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"maxZ", "-", "minZ"}], ")"}]}]}]}], "]"}], ",", 
              RowBox[{"AbsoluteThickness", "[", "1", "]"}], ",", 
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]}], "}"}], 
            "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{"myEdges", "/.", 
             RowBox[{"MapIndexed", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"#2", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", "#1"}], "&"}], 
               ",", "cells2"}], "]"}]}], ")"}]}], ",", 
          RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Graphics3D", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"edges", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"AbsolutePointSize", "[", "8", "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"StringQ", "[", "color", "]"}], ",", 
                 RowBox[{"ColorData", "[", 
                  RowBox[{"color", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"feature", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "-", "min"}], ")"}], "/", 
                    
                    RowBox[{"(", 
                    RowBox[{"max", "-", "min"}], ")"}]}]}], "]"}], ",", 
                 RowBox[{"color", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"feature", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "-", "min"}], ")"}], "/", 
                   
                   RowBox[{"(", 
                    RowBox[{"max", "-", "min"}], ")"}]}], "]"}]}], "]"}], ",",
                "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"opacity", ">", "0"}], ",", " ", 
                 RowBox[{"Opacity", "[", 
                  RowBox[{"1", "-", 
                   RowBox[{"opacity", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cells2", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"maxZ", "-", "minZ"}], ")"}]}]}]}], "]"}], ",", 
                 RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Specularity", "[", "0", "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Sphere", "[", 
                RowBox[{
                 RowBox[{"cells2", "[", 
                  RowBox[{"[", "#", "]"}], "]"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{"scaleCells", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cells2", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"maxZ", "-", "minZ"}], ")"}]}], ")"}], "]"}], "+",
                     "1"}], ")"}], "*", "0.5", "cellSize"}], ",", 
                   "cellSize"}], "]"}]}], "]"}]}], "}"}], "&"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"1", ",", 
              RowBox[{"Length", "[", "cells2", "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"showPacemakers", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Black", ",", "\[IndentingNewLine]", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{
                    RowBox[{"cells2", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", 
                    RowBox[{"0.25", "cellSize"}]}], "]"}]}], "}"}], "&"}], "/@",
                "pacemakers"}], "}"}], ",", 
             RowBox[{"{", "}"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "imsize"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"ViewPoint", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "Infinity"}], "}"}]}], ",", 
         RowBox[{"Lighting", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"\"\<Ambient\>\"", ",", "White"}], "}"}], "}"}]}]}], 
        "]"}]}]}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Clear", "[", "viewHeart", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"viewHeart", "[", 
     RowBox[{
     "cells_", ",", "feature_", ",", "min_", ",", "max_", ",", "color_", ",", 
      
      RowBox[{"opacity_:", "0.5"}], ",", 
      RowBox[{"opacityEdges_:", "0"}], ",", 
      RowBox[{"scaleCells_:", "False"}], ",", 
      RowBox[{"cellSize_:", "4"}], ",", 
      RowBox[{"showPacemakers_:", "True"}]}], "]"}], ":=", 
    RowBox[{"Rasterize", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"frontView", "[", 
       RowBox[{
       "cells", ",", " ", "feature", ",", " ", "min", ",", "max", ",", 
        "color", ",", "opacity", ",", "opacityEdges", ",", "scaleCells", ",", 
        "cellSize", ",", "showPacemakers"}], "]"}], ",", 
      RowBox[{"RasterSize", "\[Rule]", 
       RowBox[{"2", "imsize"}]}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "imsize"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Clear", "[", "averageDistanceAtCell", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"averageDistanceAtCell", "[", 
     RowBox[{"cellID_", ",", 
      RowBox[{"graphDistanceFunction_:", "spfun"}], ",", 
      RowBox[{"graphDistanceMatrix_:", "gdistMat"}], ",", 
      RowBox[{"vertexList_:", "cells"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"candidates", ",", "dtlst", ",", "dslst", ",", "vlst"}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"candidates", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"gdistMat", "[", 
            RowBox[{"[", "cellID", "]"}], "]"}], ",", "1"}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dslst", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"spfun", "[", 
           RowBox[{
            RowBox[{"cells", "[", 
             RowBox[{"[", "cellID", "]"}], "]"}], ",", 
            RowBox[{"cells", "[", 
             RowBox[{"[", "#", "]"}], "]"}]}], "]"}], "&"}], "/@", 
         "candidates"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dslst", "=", 
        RowBox[{"Total", "/@", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{"Function", "[", 
            RowBox[{"pair", ",", 
             RowBox[{"EuclideanDistance", "[", 
              RowBox[{"Sequence", "@@", "pair"}], "]"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Partition", "[", 
              RowBox[{"#", ",", "2", ",", "1"}], "]"}], "&"}], "/@", 
            "dslst"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Mean", "[", "dslst", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.655525532695098*^9, 3.655525703922175*^9}, {
   3.6555257386370792`*^9, 3.655525886858335*^9}, {3.655525953018468*^9, 
   3.655525999976742*^9}, {3.65552603121227*^9, 3.6555260398037443`*^9}, {
   3.655526086660386*^9, 3.655526387261182*^9}, {3.655526434213662*^9, 
   3.655526446021069*^9}, {3.655526477063621*^9, 3.655526477338978*^9}, {
   3.6555265120853577`*^9, 3.655526537294764*^9}, {3.655526567849098*^9, 
   3.655526570436154*^9}, {3.6555266182487392`*^9, 3.6555266610068808`*^9}, {
   3.655526850047536*^9, 3.655526898574197*^9}, {3.6555269497922564`*^9, 
   3.65552701226225*^9}, {3.65552706172156*^9, 3.6555270771289577`*^9}, {
   3.65640248241838*^9, 3.65640248279626*^9}, {3.6579780371665897`*^9, 
   3.657978037552692*^9}, {3.658131243989954*^9, 3.658131350361908*^9}, 
   3.658131394570963*^9, {3.6581315102875757`*^9, 3.658131612212879*^9}, {
   3.658131734787282*^9, 3.658131737713756*^9}, {3.658131777761726*^9, 
   3.65813179750963*^9}, 3.658141635241521*^9, {3.658142729377187*^9, 
   3.658142746261853*^9}, {3.658142800462512*^9, 3.658142832018531*^9}, {
   3.658142884610537*^9, 3.658142884809819*^9}, {3.658142919627174*^9, 
   3.658142939280282*^9}, {3.658143004832664*^9, 3.658143035925083*^9}, {
   3.658143066646826*^9, 3.658143080563128*^9}, {3.6581431379319553`*^9, 
   3.658143145234441*^9}, {3.658143267624374*^9, 3.6581432986141653`*^9}, {
   3.6581433544209747`*^9, 3.658143367403153*^9}, {3.6581435041786633`*^9, 
   3.6581435228159313`*^9}, {3.658143722740677*^9, 3.658143724330488*^9}, {
   3.6581438060080957`*^9, 3.658143968419434*^9}, {3.658144136701977*^9, 
   3.658144190061193*^9}, {3.658144222398534*^9, 3.658144238100236*^9}, {
   3.6581455523432703`*^9, 3.6581455829728413`*^9}, 3.658145826736429*^9, {
   3.658481310954514*^9, 3.658481333368236*^9}, {3.658481368583383*^9, 
   3.6584813891354218`*^9}, {3.65848143350106*^9, 3.658481606729467*^9}, {
   3.658481651873005*^9, 3.658481659471383*^9}, {3.658481696230794*^9, 
   3.658481729984714*^9}, {3.659076454705007*^9, 3.659076524831559*^9}, {
   3.659076649748624*^9, 3.659076673737692*^9}, {3.662280153435367*^9, 
   3.6622801664286118`*^9}},ExpressionUUID->"fbb513eb-f4a1-480d-9128-\
e2cf36933ced"]
}, Closed]],

Cell[CellGroupData[{

Cell["import settings", "Subsection",
 CellChangeTimes->{{3.6554776678244247`*^9, 
  3.655477674305852*^9}},ExpressionUUID->"6d27116c-1008-4318-82fd-\
a89651980e6f"],

Cell[BoxData[{
 RowBox[{"fname", " ", "=", " ", 
  RowBox[{"overview", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"dataset", "+", "1"}], ",", "1"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"age", " ", "=", " ", 
  RowBox[{"overview", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"dataset", "+", "1"}], ",", "7"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"sampling", " ", "=", " ", 
  RowBox[{"overview", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"dataset", "+", "1"}], ",", "11"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"dx", " ", "=", " ", 
  RowBox[{"overview", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"dataset", "+", "1"}], ",", "12"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"maxRes", "=", "600"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"imsize", "=", " ", "600"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"imres", " ", "=", " ", "300"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"maxDelay", " ", "=", " ", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"maxSlope", " ", "=", " ", "0.03"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"maxSlopeCluster", "=", "0.06"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"startPoint", "=", "140"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"snrThresh", "=", "0.06"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"samplingCorrectionFactor", " ", "=", " ", 
   RowBox[{"400", "/", "sampling"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
  "prefix", " ", "=", " ", 
   "\"\</Users/scherf/Documents/heart_new/segmentation/\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"in", " ", "=", 
   RowBox[{"prefix", "<>", "fname", "<>", "\"\<-curated-signal.h5\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"map", " ", "=", " ", 
   RowBox[{"prefix", "<>", "fname", "<>", "\"\<-curated-labels.tif\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mline", " ", "=", " ", 
    RowBox[{"prefix", "<>", "fname", "<>", "\"\<-midline.m\>\""}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"just", " ", "for", " ", "testing"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minDelay", "=", "0.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"maxDelay", " ", "=", " ", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"speedThresh", "=", "0.2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"outprefix", " ", "=", " ", 
  RowBox[{
  "\"\</Users/scherf/Documents/heart_new/results/ccs-plots/\>\"", "<>", 
   "fname", "<>", "\"\</\>\""}]}], "\[IndentingNewLine]", 
 RowBox[{"freqCut", "=", "0.06"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.655479021511404*^9, 3.655479133277341*^9}, 
   3.655479168135984*^9, {3.655487371971097*^9, 3.655487372234848*^9}, 
   3.655489483208609*^9, 3.655490299425108*^9, {3.655490644672233*^9, 
   3.655490644774046*^9}, {3.655533232865612*^9, 3.655533244600911*^9}, {
   3.655533519790916*^9, 3.6555335198944483`*^9}, {3.655533906040166*^9, 
   3.655533906133751*^9}, 3.655534024866321*^9, {3.655534159555071*^9, 
   3.6555341596589003`*^9}, {3.655535031717915*^9, 3.655535032235477*^9}, {
   3.655535862268572*^9, 3.655535862426869*^9}, {3.655535942509951*^9, 
   3.655535942644422*^9}, {3.655536065345306*^9, 3.6555360655276937`*^9}, {
   3.6555361482341633`*^9, 3.6555361483368587`*^9}, {3.655536269765544*^9, 
   3.655536270075507*^9}, {3.6555415495606613`*^9, 3.655541549640798*^9}, {
   3.655546248986149*^9, 3.655546249255982*^9}, {3.655546528727294*^9, 
   3.655546528990411*^9}, 3.655547057565041*^9, {3.655547266361803*^9, 
   3.655547266479578*^9}, {3.655547885678088*^9, 3.655547885805414*^9}, {
   3.6557198439299793`*^9, 3.655719844087031*^9}, 3.6564044086060553`*^9, {
   3.656686420679265*^9, 3.6566864207797823`*^9}, {3.657345184367741*^9, 
   3.6573451845996*^9}, {3.657348396415759*^9, 3.6573483965119677`*^9}, {
   3.657541782503058*^9, 3.6575417826103077`*^9}, {3.657542616905013*^9, 
   3.6575426170398703`*^9}, {3.6575429891181993`*^9, 3.657542989225912*^9}, {
   3.6578692973927727`*^9, 3.657869299550892*^9}, {3.657869901031538*^9, 
   3.657869901149851*^9}, {3.657870185950344*^9, 3.6578701870062017`*^9}, {
   3.657870596827506*^9, 3.6578705969307547`*^9}, 3.65787202419201*^9, {
   3.657880200309387*^9, 3.657880201402659*^9}, {3.657961274646967*^9, 
   3.657961274764965*^9}, 3.6579616775648937`*^9, {3.657963748537416*^9, 
   3.657963748800256*^9}, {3.6579640548584023`*^9, 3.6579640550397377`*^9}, 
   3.6579643966343813`*^9, {3.657964787982163*^9, 3.657964788219819*^9}, {
   3.657979061944572*^9, 3.657979062094222*^9}, 3.657979162259286*^9, {
   3.658147338047896*^9, 3.6581473383659687`*^9}, {3.658147493417946*^9, 
   3.658147493560783*^9}, 3.658147638759336*^9, {3.6581478330411663`*^9, 
   3.6581478331988783`*^9}, {3.65821538082722*^9, 3.6582153931599827`*^9}, 
   3.6582192307680483`*^9, {3.658220365191001*^9, 3.658220365332737*^9}, {
   3.6582210079488087`*^9, 3.658221008348791*^9}, {3.658221655028468*^9, 
   3.658221655189927*^9}, {3.6582232741247177`*^9, 3.658223274442339*^9}, {
   3.65822964285907*^9, 3.658229643000409*^9}, {3.658230129188501*^9, 
   3.6582301293063307`*^9}, 3.658230303590469*^9, {3.658232817686871*^9, 
   3.658232817892416*^9}, 3.6584768211696243`*^9, {3.658478158331215*^9, 
   3.658478158443344*^9}, {3.658478301113508*^9, 3.658478301271511*^9}, {
   3.658478619567287*^9, 3.658478634334279*^9}, 3.658478678334684*^9, 
   3.658480635788706*^9, {3.6584833229658003`*^9, 3.658483323290544*^9}, 
   3.658487522364092*^9, {3.65848758445532*^9, 3.658487584598105*^9}, {
   3.6584884171436453`*^9, 3.65848841727075*^9}, {3.6584884778234158`*^9, 
   3.6584884779652967`*^9}, {3.658489370996216*^9, 3.65848937113943*^9}, {
   3.658489595695405*^9, 3.658489597764439*^9}, {3.658489696338751*^9, 
   3.658489696617964*^9}, {3.658492009634116*^9, 3.6584920096793003`*^9}, {
   3.6585846660710297`*^9, 3.658584666459688*^9}, {3.658585292452421*^9, 
   3.6585852925298557`*^9}, {3.658641070359269*^9, 3.658641076886517*^9}, {
   3.65864165133532*^9, 3.658641653470298*^9}, {3.658642007326476*^9, 
   3.658642007459906*^9}, {3.6586449508479767`*^9, 3.658644951699139*^9}, {
   3.658645465735037*^9, 3.658645465860588*^9}, {3.658645807779954*^9, 
   3.658645808242608*^9}, {3.6586461054593973`*^9, 3.658646105602231*^9}, {
   3.658646252248713*^9, 3.658646252398234*^9}, {3.6586464277626553`*^9, 
   3.658646438984563*^9}, {3.658646475842163*^9, 3.6586464760399303`*^9}, {
   3.658647174512472*^9, 3.6586471746871433`*^9}, {3.658648216620336*^9, 
   3.658648217242033*^9}, {3.6586482863783407`*^9, 3.658648286447935*^9}, 
   3.658648320671286*^9, {3.658648376543421*^9, 3.658648377325749*^9}, {
   3.65864855434483*^9, 3.658648554512006*^9}, 3.658653751876148*^9, {
   3.658653899701229*^9, 3.6586538998589697`*^9}, {3.6586540747667093`*^9, 
   3.65865407487011*^9}, {3.658658204802387*^9, 3.658658205272847*^9}, {
   3.658659165924616*^9, 3.658659166540614*^9}, {3.658660253437405*^9, 
   3.658660253675522*^9}, {3.658660368441811*^9, 3.6586603685352793`*^9}, {
   3.658660440119746*^9, 3.658660444189699*^9}, {3.6586605337874117`*^9, 
   3.6586605339068832`*^9}, {3.6586609079532824`*^9, 3.658660984781398*^9}, {
   3.658661222709853*^9, 3.658661223071912*^9}, {3.659076139006364*^9, 
   3.6590761408454857`*^9}, {3.660997322314293*^9, 3.660997333792224*^9}, {
   3.661000426499291*^9, 3.661000426583947*^9}, {3.661083041977661*^9, 
   3.6610830426181097`*^9}, {3.661148823202075*^9, 3.661148823328382*^9}, 
   3.6611561390514297`*^9, {3.661156350058941*^9, 3.6611563501925793`*^9}, {
   3.661156635184662*^9, 3.661156635334544*^9}, {3.66115690177173*^9, 
   3.661156902306993*^9}, {3.661157229700251*^9, 3.661157229762034*^9}, {
   3.661686252124406*^9, 3.6616862523611393`*^9}, {3.6616895007618303`*^9, 
   3.661689507670538*^9}, 3.6616899414082108`*^9, {3.661691585493167*^9, 
   3.661691585986661*^9}, {3.6616980800173807`*^9, 3.661698081343108*^9}, {
   3.661698611497982*^9, 3.6616986209107933`*^9}, {3.661698653631297*^9, 
   3.661698653956615*^9}, {3.661698783858286*^9, 3.661698786101461*^9}, {
   3.669996447857662*^9, 
   3.669996451417823*^9}},ExpressionUUID->"a7f1dfd8-2ebf-49f8-879c-\
542627d12e3e"],

Cell[CellGroupData[{

Cell["import stuff", "Subsubsection",
 CellChangeTimes->{{3.655479687337126*^9, 3.65547968906374*^9}, {
  3.655719849064539*^9, 
  3.655719849894643*^9}},ExpressionUUID->"74692aa9-3024-4f71-b5fd-\
3fa1af172e3e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mip", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
    "\"\</Users/scherf/Documents/heart_new/data/overview/\>\"", "<>", "fname",
      "<>", "\"\<.tif\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"names", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"in", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<HDF5\>\"", ",", "\"\<Datasets\>\""}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ns", " ", "=", " ", 
   RowBox[{"Length", "[", "names", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"series", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{"in", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<HDF5\>\"", ",", "\"\<Datasets\>\"", ",", "n"}], "}"}]}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", " ", "1", ",", " ", "ns", ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"heart", "=", 
   RowBox[{"Import", "[", "map", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"img", "=", 
   RowBox[{"Image3D", "[", 
    RowBox[{"heart", ",", "\"\<Bit16\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lab", " ", "=", " ", 
   RowBox[{"ComponentMeasurements", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ImageData", "[", 
        RowBox[{"img", ",", "\"\<Bit16\>\""}], "]"}], ",", "img"}], "}"}], 
     ",", 
     RowBox[{"{", "\"\<Label\>\"", "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cnts", " ", "=", " ", 
   RowBox[{"ComponentMeasurements", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ImageData", "[", 
        RowBox[{"img", ",", "\"\<Bit16\>\""}], "]"}], ",", "img"}], "}"}], 
     ",", 
     RowBox[{"{", "\"\<Centroid\>\"", "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sizes", " ", "=", " ", 
   RowBox[{"ComponentMeasurements", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ImageData", "[", 
        RowBox[{"img", ",", "\"\<Bit16\>\""}], "]"}], ",", "img"}], "}"}], 
     ",", 
     RowBox[{"{", "\"\<Count\>\"", "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pts", "=", 
   RowBox[{"Join", "@@", 
    RowBox[{"(", 
     RowBox[{"Last", "/@", "cnts"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pts2", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "*", 
      RowBox[{"{", 
       RowBox[{"dx", ",", "dx", ",", "1"}], "}"}]}], "&"}], "/@", "pts"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"series", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"RotateLeft", "[", 
      RowBox[{"#", ",", "startPoint"}], "]"}], "&"}], "/@", "series"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ids", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ToExpression", "[", 
      RowBox[{"StringDrop", "[", 
       RowBox[{"#", ",", "3"}], "]"}], "]"}], "&"}], "/@", "names"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"series", "=", 
    RowBox[{"Last", "/@", 
     RowBox[{"SortBy", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"ids", ",", "series"}], "}"}], "]"}], ",", "First"}], 
      "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"sizes2", " ", "=", " ", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Last", "/@", "sizes"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"cutoff", "=", 
     RowBox[{"Floor", "[", 
      RowBox[{
       RowBox[{"1.5", 
        RowBox[{"InterquartileRange", "[", "sizes2", "]"}]}], "+", 
       RowBox[{"Quantile", "[", 
        RowBox[{"sizes2", ",", "0.75"}], "]"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"todelete", "=", 
     RowBox[{"First", "/@", 
      RowBox[{"Select", "[", 
       RowBox[{"sizes", ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Last", "[", "#", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ">", "cutoff"}], "&"}]}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"series", "=", 
     RowBox[{"Delete", "[", 
      RowBox[{"series", ",", 
       RowBox[{"List", "/@", "todelete"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"ids", " ", "=", " ", 
     RowBox[{"Delete", "[", 
      RowBox[{"ids", ",", " ", 
       RowBox[{"List", "/@", "todelete"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"pts2", " ", "=", " ", 
       RowBox[{"Delete", "[", 
        RowBox[{"pts2", ",", " ", 
         RowBox[{"List", "/@", "todelete"}]}], "]"}]}], ";"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"onsetAP", ",", "slopes", ",", "SNR"}], "}"}], "=", 
     RowBox[{"Transpose", "[", 
      RowBox[{"extractFeatures", "/@", "series"}], "]"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stdTransform", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
    "outprefix", "<>", "fname", "<>", "\"\<-standardTransform.m\>\""}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "@", "pts2"}]}], "Input",
 CellChangeTimes->{{3.6554777135070953`*^9, 3.6554777232097397`*^9}, {
   3.655479245674204*^9, 3.6554792615614*^9}, 3.655487398780986*^9, {
   3.658478329966675*^9, 3.658478401381905*^9}, {3.6586609640409737`*^9, 
   3.658660968031726*^9}, {3.658661231493938*^9, 3.6586612318714027`*^9}, {
   3.661000523684219*^9, 3.661000523889441*^9}, 3.661000583676567*^9, 
   3.661000733243688*^9, {3.66115553423967*^9, 3.661155553104319*^9}, {
   3.6688373204136677`*^9, 
   3.6688373263768167`*^9}},ExpressionUUID->"8161e742-d853-401b-8fd7-\
bb2aa67005a6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["process series", "Subsubsection",
 CellChangeTimes->{{3.655479697881426*^9, 
  3.655479703456184*^9}},ExpressionUUID->"76e8c672-9425-4f79-9a20-\
7ec44cb93ff8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"res", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"smoothSeries", "[", "#", "]"}], "&"}], "/@", "series"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"shifted", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"shift2min", "[", 
      RowBox[{"smoothSeries", "[", "#", "]"}], "]"}], "&"}], "/@", 
    "series"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"onsetAP", ",", "slopes", ",", "SNR"}], "}"}], "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"extractFeatures", "/@", "series"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cutoffSNR", " ", "=", " ", 
   RowBox[{
    RowBox[{"1.5", " ", 
     RowBox[{"InterquartileRange", "[", "SNR", "]"}]}], "+", 
    RowBox[{"Quantile", "[", 
     RowBox[{"SNR", ",", " ", "0.75"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"del", "=", 
   RowBox[{"Position", "[", 
    RowBox[{"SNR", ",", " ", 
     RowBox[{"z_", "/;", 
      RowBox[{"z", ">", "cutoffSNR"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"series", "=", 
   RowBox[{"Delete", "[", 
    RowBox[{"series", ",", "del"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pts2", " ", "=", " ", 
   RowBox[{"Delete", "[", 
    RowBox[{"pts2", ",", "del"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.655477883181121*^9, 3.655477883358304*^9}, {
   3.6554805792274847`*^9, 3.65548058950598*^9}, {3.658478416699357*^9, 
   3.658478416931917*^9}, {3.65848353750935*^9, 3.658483569458721*^9}, 
   3.661000720898465*^9, {3.661155561804105*^9, 3.6611556339479637`*^9}, 
   3.6616982626787357`*^9, {3.661698564099627*^9, 
   3.661698566337749*^9}},ExpressionUUID->"bb2d18e3-3e7e-4857-a961-\
43ada6ac7645"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"onsetAP", ",", "slopes", ",", "SNR"}], "}"}], "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"extractFeatures", "/@", "series"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"res", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"smoothSeries", "[", "#", "]"}], "&"}], "/@", "series"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"shifted", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"shift2min", "[", 
      RowBox[{"smoothSeries", "[", "#", "]"}], "]"}], "&"}], "/@", 
    "series"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tAct", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"getActivationTime", "[", "#", "]"}], "&"}], "/@", "series"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"riseTime", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"getRiseTime", "[", "#", "]"}], "&"}], "/@", "series"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"apd", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"getAPD", "[", "#", "]"}], "&"}], "/@", "series"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"repo", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"getRepolarization", "[", "#", "]"}], "&"}], "/@", "series"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.6584772583005753`*^9, {3.658585303004656*^9, 3.658585303178588*^9}, {
   3.6611473197247267`*^9, 3.6611473372011623`*^9}, {3.661149469773375*^9, 
   3.661149480171771*^9}, {3.661152390038178*^9, 3.661152398993067*^9}, {
   3.661153381793466*^9, 3.661153388391382*^9}, {3.6611555564304857`*^9, 
   3.661155567142055*^9}},ExpressionUUID->"93730627-572a-4bd4-8dab-\
ca2a5d93676c"],

Cell[BoxData[{
 RowBox[{"rawCaDataDir", "=", 
  RowBox[{
  "\"\</Users/scherf/Documents/heart_new/data/\>\"", "<>", "fname", "<>", 
   "\"\</tp00000_ch1_VSilent/\>\""}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rawCaImageFiles", "=", 
   RowBox[{"FileNames", "[", 
    RowBox[{"\"\<*.tif\>\"", ",", "rawCaDataDir"}], "]"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.66999645416679*^9, 3.669996485871612*^9}, {
  3.669996546727735*^9, 3.6699965723753033`*^9}, {3.66999662324568*^9, 
  3.669996625499753*^9}, {3.669996659916112*^9, 
  3.669996673708066*^9}},ExpressionUUID->"cbb929de-9480-4872-9380-\
957eb8e558b0"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.66999657553506*^9, 3.669996630523695*^9}, {
  3.669996666458521*^9, 
  3.669996671677846*^9}},ExpressionUUID->"bc8d97a8-51a8-4abb-bca1-\
f0dcecb107a4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"timg", "=", 
   RowBox[{"Image3D", "[", 
    RowBox[{"Import", "[", 
     RowBox[{"rawCaImageFiles", "[", 
      RowBox[{"[", "20", "]"}], "]"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.669996764951151*^9, 
  3.669996793319707*^9}},ExpressionUUID->"2c2274ac-de92-4749-8297-\
252a8c791199"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mydat", "=", 
   RowBox[{"ImageData", "[", "timg", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"nz", ",", "ny", ",", "nx"}], "}"}], " ", "=", " ", 
   RowBox[{"Dimensions", "[", "mydat", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mymax", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{"mydat", "[", 
       RowBox[{"[", 
        RowBox[{";;", ",", "i", ",", "j"}], "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "ny"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "nx"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"viewMIP", "=", 
  RowBox[{"ImageAdjust", "[", 
   RowBox[{"ColorNegate", "[", 
    RowBox[{"ColorConvert", "[", 
     RowBox[{
      RowBox[{"Image", "[", "mymax", "]"}], ",", "\"\<Grayscale\>\""}], "]"}],
     "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"viewMIP", ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Point", "[", 
       RowBox[{
        RowBox[{"Most", "[", 
         RowBox[{"transformToStandardView", "[", "#", "]"}], "]"}], "+", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "xmin"}], "+", "6"}], ",", 
          RowBox[{
           RowBox[{"-", "ymin"}], "-", "3"}]}], "}"}]}], "]"}], "&"}], "/@", 
     "pts2"}], "]"}]}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.669996755905018*^9, 
  3.669996759567584*^9}},ExpressionUUID->"aeaf70c0-8056-422c-8805-\
73c973008e86"],

Cell[BoxData[
 RowBox[{"nmax", "=", 
  RowBox[{"Length", "[", "rawCaImageFiles", "]"}]}]], "Input",
 CellChangeTimes->{{3.6699982340947857`*^9, 
  3.669998243777323*^9}},ExpressionUUID->"f63385ea-92af-431c-b179-\
2ebe7909282e"]
}, Open  ]]
}, Open  ]],

Cell["Video S1", "Subsection",
 CellChangeTimes->{{3.6701269401512547`*^9, 
  3.6701269414695997`*^9}},ExpressionUUID->"a3135e01-8d55-44b2-821e-\
6fc40d40e7af"],

Cell[CellGroupData[{

Cell["Video S2", "Subsection",
 CellChangeTimes->{{3.670126887185161*^9, 
  3.670126913887526*^9}},ExpressionUUID->"a7dcc7d2-4185-4863-a675-\
dcae708f5955"],

Cell[CellGroupData[{

Cell["part 0", "Subsubsection",
 CellChangeTimes->{{3.6702261707780447`*^9, 
  3.670226172460988*^9}},ExpressionUUID->"99a975b9-cd3b-4c76-bf25-\
21cdeea12369"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showRawWaveFromSlices", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showRawWaveFromSlices", "[", "\[IndentingNewLine]", 
   RowBox[{
   "t_", ",", "\[IndentingNewLine]", "sliceRadius_", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"transferFunction_:", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Blend", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "0.05635", ",", " ", "0.081", ",", " ", "0.07687", ",", " ", 
               "0."}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0.284433", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "0.496561", ",", " ", "0.177689", ",", " ", "0.0361663", ",", 
               " ", "0."}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0.394387", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "1.", ",", " ", "0.6036", ",", " ", "0.", ",", " ", 
               "0.0116194"}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0.649016", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "1.", ",", " ", "0.9658", ",", " ", "0.4926", ",", " ", 
               "0.681842"}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"1.", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "1.", ",", " ", "0.6436", ",", " ", "0.03622", ",", " ", "1."}],
               "]"}]}], "}"}]}], "}"}], ",", " ", "#1"}], "]"}], " ", "&"}], 
      " ", ")"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"imgFileList_:", "rawCaImageFiles"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{"t0_:", "startPoint"}], ",", "\[IndentingNewLine]", 
    RowBox[{"nSlices_:", "152"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "img", ",", "inverseTransform", ",", "transformedImg", ",", " ", 
      "newDimensions", ",", " ", "xmin", ",", "ymin", ",", "zmin", ",", "n", 
      ",", "finalProjection", ",", "centreSlice"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "imgFileList", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"centreSlice", "=", 
      RowBox[{"Floor", "[", 
       RowBox[{"nSlices", "/", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"img", " ", "=", 
      RowBox[{"ImageAdjust", "[", 
       RowBox[{
        RowBox[{"Image3D", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Import", "[", 
            RowBox[{"imgFileList", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"t0", "+", "t"}], ",", "n"}], "]"}], "+", "1"}], 
              "]"}], "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"centreSlice", "-", "sliceRadius"}], ";;", 
             RowBox[{"centreSlice", "+", "sliceRadius"}]}], "]"}], "]"}], ",", 
          RowBox[{"ColorFunction", "\[Rule]", " ", "transferFunction"}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0.006"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"img", "=", 
      RowBox[{"ImageResize", "[", 
       RowBox[{"img", ",", 
        RowBox[{"Round", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.41", ",", "0.41", ",", "1"}], "}"}], "*", 
          RowBox[{"ImageDimensions", "[", "img", "]"}]}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", "img", "}"}], ",", 
           RowBox[{"Lighting", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"Ticks", "\[Rule]", "None"}], ",", 
           RowBox[{"AxesOrigin", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
             "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"12", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
             "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Automatic", ",", "Automatic", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"sliceRadius", "-", "centreSlice"}], ",", 
                RowBox[{"sliceRadius", "+", "centreSlice"}]}], "}"}]}], 
             "}"}]}], ",", " ", 
           RowBox[{"PlotRangePadding", "->", "None"}], ",", 
           RowBox[{"ImagePadding", "->", "None"}]}], "]"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "600"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"finalProjection", ",", 
         RowBox[{"Graphics", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Inset", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Graphics", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"ColorData", "[", 
                   RowBox[{"97", ",", "1"}], "]"}], ",", 
                  RowBox[{"Annulus", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.8", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"2", "Pi", " ", 
                    RowBox[{"t", "/", "207"}]}], ")"}], "+", "0.00001"}]}], 
                    "}"}]}], "]"}], ",", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"PaddedForm", "[", 
                    RowBox[{
                    RowBox[{"2.5", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "-", "1"}], ")"}], ",", "0"}], "]"}]}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"3", ",", "1"}], "}"}], ",", 
                    RowBox[{"NumberPadding", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\>\"", ",", "\"\<0\>\""}], "}"}]}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "0.1"}]}], "}"}]}], "]"}], ",", "12", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
                   "]"}]}], "}"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}]}], "}"}]}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "80"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"120", ",", "120"}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Inset", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Graphics", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"ColorData", "[", 
                   RowBox[{"97", ",", "1"}], "]"}], ",", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"\"\<n: \>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{
                    RowBox[{"sliceRadius", "*", "2"}], "+", "1"}], "]"}]}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "0.1"}]}], "}"}]}], "]"}], ",", "12", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
                   "]"}]}], "}"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}]}], "}"}]}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "80"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"40", ",", "120"}], "}"}]}], "]"}]}], "}"}], "]"}]}], 
        "}"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "20"}], ",", "853"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "500"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.670150794259326*^9, 3.670150839136697*^9}, {
   3.670150873302929*^9, 3.670150915182271*^9}, {3.670150946823495*^9, 
   3.670151111567506*^9}, {3.6701511690559597`*^9, 3.6701511691579943`*^9}, {
   3.670151201902421*^9, 3.670151202668602*^9}, {3.670151270026206*^9, 
   3.670151276794367*^9}, {3.670151341250643*^9, 3.6701513414565687`*^9}, {
   3.670151374626356*^9, 3.670151395670908*^9}, {3.6701514422555237`*^9, 
   3.670151450109721*^9}, {3.6701515531485863`*^9, 3.670151573552025*^9}, {
   3.6701516041941633`*^9, 3.6701516326163*^9}, 3.6701516815453987`*^9, {
   3.670154348177397*^9, 3.67015435623208*^9}, {3.670154728503667*^9, 
   3.6701547349483852`*^9}},ExpressionUUID->"ebb723c4-dcf4-4522-823b-\
eb3169707776"],

Cell[BoxData[
 RowBox[{
  RowBox[{"img", " ", "=", 
   RowBox[{"ImageAdjust", "[", 
    RowBox[{
     RowBox[{"Image3D", "[", 
      RowBox[{
       RowBox[{"Import", "[", 
        RowBox[{"rawCaImageFiles", "[", 
         RowBox[{"[", "130", "]"}], "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"75", "-", "30"}], ";;", 
         RowBox[{"75", "+", "30"}]}], "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0.006"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.670218224644598*^9, 
  3.6702182576820717`*^9}},ExpressionUUID->"9b37bb1c-c2c4-4d44-943b-\
155fe0ccd72f"],

Cell[BoxData[
 RowBox[{"showRawWaveFromSlices", "[", 
  RowBox[{"130", ",", "75", ",", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Blend", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.", ",", " ", 
           RowBox[{"RGBColor", "[", 
            RowBox[{
            "0.05635", ",", " ", "0.081", ",", " ", "0.07687", ",", " ", 
             "0."}], "]"}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"0.113715", ",", " ", 
           RowBox[{"RGBColor", "[", 
            RowBox[{
            "0.895401", ",", " ", "0.286916", ",", " ", "0.", ",", " ", 
             "0."}], "]"}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"0.345197", ",", " ", 
           RowBox[{"RGBColor", "[", 
            RowBox[{
            "1.", ",", " ", "0.61705", ",", " ", "0.018292", ",", " ", "0."}],
             "]"}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"0.66", ",", " ", 
           RowBox[{"RGBColor", "[", 
            RowBox[{
            "1.", ",", " ", "0.9658", ",", " ", "0.4926", ",", " ", 
             "0.660941"}], "]"}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"1.", ",", " ", 
           RowBox[{"RGBColor", "[", 
            RowBox[{
            "1.", ",", " ", "0.6436", ",", " ", "0.03622", ",", " ", "1."}], 
            "]"}]}], "}"}]}], "}"}], ",", " ", "#1"}], "]"}], " ", "&"}], " ",
     ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.670218316818544*^9, 3.670218324827609*^9}, 
   3.670218374132721*^9},ExpressionUUID->"0ac479a8-abd5-4a06-8159-\
23da2bc416c2"],

Cell[BoxData[
 RowBox[{"showRawWaveFromSlices", "[", 
  RowBox[{"130", ",", "75"}], "]"}]], "Input",
 CellChangeTimes->{{3.670151356596898*^9, 3.670151366069076*^9}, {
  3.670155277329777*^9, 
  3.6701552883034286`*^9}},ExpressionUUID->"9195b29e-96df-4923-9ac7-\
6a361772cef0"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{
   "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/part-\
0/\>\"", "<>", 
    RowBox[{"IntegerString", "[", 
     RowBox[{"66", ",", "10", ",", "3"}], "]"}], "<>", "\"\<.png\>\""}], ",", 
   
   RowBox[{"showRawWaveFromSlices", "[", 
    RowBox[{"66", ",", "0"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.670152159819991*^9, 3.6701521671481047`*^9}, 
   3.670229485552413*^9},ExpressionUUID->"038c865a-4c13-4bcd-948b-\
b204dcdf68f6"],

Cell[BoxData["\"\</Users/scherf/Documents/heart_new/results/supplementary-\
video-2/part-0/066.png\>\""], "Input",
 CellChangeTimes->{{3.670229486536648*^9, 
  3.670229486545321*^9}},ExpressionUUID->"b6b30306-0b40-4348-b8f2-\
663f2952586b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-0/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"t", ",", "10", ",", "3"}], "]"}], "<>", "\"\<.png\>\""}], 
      ",", 
      RowBox[{"showRawWaveFromSlices", "[", 
       RowBox[{"t", ",", "0"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "207", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6701517515536013`*^9, 3.670151751833097*^9}, {
   3.670151820163102*^9, 3.670151841093849*^9}, 
   3.670229488623662*^9},ExpressionUUID->"41a2886b-7bbf-4b8c-af81-\
d56d74db3622"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-0/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{
         RowBox[{"t", "+", "207"}], ",", "10", ",", "3"}], "]"}], "<>", 
       "\"\<.png\>\""}], ",", 
      RowBox[{"Import", "[", 
       RowBox[{
       "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-0/\>\"", "<>", 
        RowBox[{"IntegerString", "[", 
         RowBox[{"t", ",", "10", ",", "3"}], "]"}], "<>", "\"\<.png\>\""}], 
       "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "207", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670151964107444*^9, 3.670151966509115*^9}, {
  3.670229489307633*^9, 
  3.6702294897163467`*^9}},ExpressionUUID->"9e34e312-cc20-44af-b09c-\
f1ffe0e02b19"],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{
     "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-0/\>\"", "<>", 
      RowBox[{"IntegerString", "[", 
       RowBox[{
        RowBox[{"t", "+", "414"}], ",", "10", ",", "3"}], "]"}], "<>", 
      "\"\<.png\>\""}], ",", 
     RowBox[{"showRawWaveFromSlices", "[", 
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{"t", ",", "207"}], "]"}], ",", 
       RowBox[{"Quotient", "[", 
        RowBox[{"t", ",", "10"}], "]"}]}], "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "1", ",", "750", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.670152454175634*^9, 3.670152530312244*^9}, {
   3.670152581759602*^9, 3.670152587974036*^9}, 
   3.67022949079521*^9},ExpressionUUID->"878b47c5-bda1-40e4-894c-\
995db48a0801"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-0-1/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"t", ",", "10", ",", "4"}], "]"}], "<>", "\"\<.png\>\""}], 
      ",", 
      RowBox[{"Import", "[", 
       RowBox[{
       "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-0/\>\"", "<>", 
        RowBox[{"IntegerString", "[", 
         RowBox[{"t", ",", "10", ",", "3"}], "]"}], "<>", "\"\<.png\>\""}], 
       "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "998", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670153950875745*^9, 3.6701540213680477`*^9}, {
  3.670229491515339*^9, 
  3.6702294920036507`*^9}},ExpressionUUID->"c89d554d-04d8-4994-90db-\
7180d9244915"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-0-1/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{
         RowBox[{"t", "+", "414"}], ",", "10", ",", "4"}], "]"}], "<>", 
       "\"\<.png\>\""}], ",", 
      RowBox[{"showRawWaveFromSlices", "[", 
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"t", ",", "207"}], "]"}], ",", 
        RowBox[{"Quotient", "[", 
         RowBox[{"t", ",", "10"}], "]"}]}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "584", ",", "750", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670154185074945*^9, 3.670154195994451*^9}, 
   3.6701547734013968`*^9, 
   3.6702294927611732`*^9},ExpressionUUID->"b61b1f49-c345-4348-b95b-\
f9af96934f1f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{
     "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-0-1/\>\"", "<>", 
      RowBox[{"IntegerString", "[", 
       RowBox[{
        RowBox[{"#", "+", "414"}], ",", "10", ",", "4"}], "]"}], "<>", 
      "\"\<.png\>\""}], ",", 
     RowBox[{"showRawWaveFromSlices", "[", 
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{"#", ",", "207"}], "]"}], ",", 
       RowBox[{"Quotient", "[", 
        RowBox[{"#", ",", "10"}], "]"}]}], "]"}]}], "]"}], "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{"207", ",", "414", ",", "621"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.670154806120123*^9, 3.670154852541103*^9}, 
   3.670229493615349*^9},ExpressionUUID->"8c1b2c8f-f750-49cf-aa24-\
e0b8c3760c62"],

Cell[BoxData[
 RowBox[{"ImageDimensions", "[", "img", "]"}]], "Input",
 CellChangeTimes->{{3.670214921530797*^9, 
  3.670214925939073*^9}},ExpressionUUID->"3cf28517-733c-4ba3-b2ad-\
08406c109ac2"],

Cell[BoxData[
 RowBox[{"Show", "[", "img", "]"}]], "Input",
 CellChangeTimes->{{3.670215118617198*^9, 
  3.670215120885132*^9}},ExpressionUUID->"2c3c9cae-f099-467c-b6b6-\
62e825991620"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showRawWaveFromSlicesMoveCameraSmooth", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showRawWaveFromSlicesMoveCameraSmooth", "[", "\[IndentingNewLine]", 
   RowBox[{
   "t_", ",", "\[IndentingNewLine]", "sliceRadius_", ",", 
    "\[IndentingNewLine]", "alpha_", ",", "\[IndentingNewLine]", 
    RowBox[{"transferFunction_:", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Blend", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "0.05635", ",", " ", "0.081", ",", " ", "0.07687", ",", " ", 
               "0."}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0.284433", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "0.496561", ",", " ", "0.177689", ",", " ", "0.0361663", ",", 
               " ", "0."}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0.394387", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "1.", ",", " ", "0.6036", ",", " ", "0.", ",", " ", 
               "0.0116194"}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0.649016", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "1.", ",", " ", "0.9658", ",", " ", "0.4926", ",", " ", 
               "0.681842"}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"1.", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "1.", ",", " ", "0.6436", ",", " ", "0.03622", ",", " ", "1."}],
               "]"}]}], "}"}]}], "}"}], ",", " ", "#1"}], "]"}], " ", "&"}], 
      " ", ")"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"imgFileList_:", "rawCaImageFiles"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{"t0_:", "startPoint"}], ",", "\[IndentingNewLine]", 
    RowBox[{"nSlices_:", "152"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "img", ",", "inverseTransform", ",", "transformedImg", ",", " ", 
      "newDimensions", ",", " ", "xmin", ",", "ymin", ",", "zmin", ",", "n", 
      ",", "finalProjection", ",", "centreSlice"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "imgFileList", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"centreSlice", "=", 
      RowBox[{"Floor", "[", 
       RowBox[{"nSlices", "/", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"img", " ", "=", 
      RowBox[{"ImageAdjust", "[", 
       RowBox[{
        RowBox[{"Image3D", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Import", "[", 
            RowBox[{"imgFileList", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"t0", "+", "t"}], ",", "n"}], "]"}], "+", "1"}], 
              "]"}], "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"centreSlice", "-", "sliceRadius"}], ";;", 
             RowBox[{"centreSlice", "+", "sliceRadius"}]}], "]"}], "]"}], ",", 
          RowBox[{"ColorFunction", "\[Rule]", " ", "transferFunction"}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0.006"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"img", "=", 
      RowBox[{"ImageResize", "[", 
       RowBox[{"img", ",", 
        RowBox[{"Round", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.41", ",", "0.41", ",", "1"}], "}"}], "*", 
          RowBox[{"ImageDimensions", "[", "img", "]"}]}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", "img", "}"}], ",", 
           RowBox[{"Lighting", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"ViewPoint", "->", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "alpha"}], ")"}], "1.3"}], ",", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  RowBox[{"alpha", "^", "5"}]}], ")"}]}], "2.4"}], ",", 
              RowBox[{"2", "+", 
               RowBox[{"alpha", " ", "2"}]}]}], "}"}]}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"Ticks", "\[Rule]", "None"}], ",", 
           RowBox[{"AxesOrigin", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
             "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"12", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
             "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Automatic", ",", "Automatic", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"sliceRadius", "-", "centreSlice"}], ",", 
                RowBox[{"sliceRadius", "+", "centreSlice"}]}], "}"}]}], 
             "}"}]}], ",", " ", 
           RowBox[{"PlotRangePadding", "->", "None"}], ",", 
           RowBox[{"ImagePadding", "->", "None"}]}], "]"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "600"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"finalProjection", ",", 
         RowBox[{"Graphics", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Inset", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Graphics", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"ColorData", "[", 
                   RowBox[{"97", ",", "1"}], "]"}], ",", 
                  RowBox[{"Annulus", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.8", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"2", "Pi", " ", 
                    RowBox[{"t", "/", "207"}]}], ")"}], "+", "0.00001"}]}], 
                    "}"}]}], "]"}], ",", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"PaddedForm", "[", 
                    RowBox[{
                    RowBox[{"2.5", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "-", "1"}], ")"}], ",", "0"}], "]"}]}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"3", ",", "1"}], "}"}], ",", 
                    RowBox[{"NumberPadding", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\>\"", ",", "\"\<0\>\""}], "}"}]}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "0.1"}]}], "}"}]}], "]"}], ",", "12", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
                   "]"}]}], "}"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}]}], "}"}]}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "80"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"120", ",", "120"}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Inset", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Graphics", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"ColorData", "[", 
                   RowBox[{"97", ",", "1"}], "]"}], ",", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"\"\<n: \>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{
                    RowBox[{"sliceRadius", "*", "2"}], "+", "1"}], "]"}]}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "0.1"}]}], "}"}]}], "]"}], ",", "12", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
                   "]"}]}], "}"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}]}], "}"}]}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "80"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"40", ",", "120"}], "}"}]}], "]"}]}], "}"}], "]"}]}], 
        "}"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "20"}], ",", "853"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "500"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.670216035395815*^9, 3.670216039113564*^9}, {
  3.6702163121312037`*^9, 
  3.670216332463067*^9}},ExpressionUUID->"ff38959d-39d1-4989-9bc3-\
cdc4375ed355"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showRawWaveFromSlicesMoveCameraOnAxes", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showRawWaveFromSlicesMoveCameraOnAxes", "[", "\[IndentingNewLine]", 
   RowBox[{
   "t_", ",", "\[IndentingNewLine]", "sliceRadius_", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"camx_", ",", "camy_", ",", "camz_"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"transferFunction_:", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Blend", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "0.05635", ",", " ", "0.081", ",", " ", "0.07687", ",", " ", 
               "0."}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0.284433", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "0.496561", ",", " ", "0.177689", ",", " ", "0.0361663", ",", 
               " ", "0."}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0.394387", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "1.", ",", " ", "0.6036", ",", " ", "0.", ",", " ", 
               "0.0116194"}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0.649016", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "1.", ",", " ", "0.9658", ",", " ", "0.4926", ",", " ", 
               "0.681842"}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"1.", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "1.", ",", " ", "0.6436", ",", " ", "0.03622", ",", " ", "1."}],
               "]"}]}], "}"}]}], "}"}], ",", " ", "#1"}], "]"}], " ", "&"}], 
      " ", ")"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"imgFileList_:", "rawCaImageFiles"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{"t0_:", "startPoint"}], ",", "\[IndentingNewLine]", 
    RowBox[{"nSlices_:", "152"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "img", ",", "inverseTransform", ",", "transformedImg", ",", " ", 
      "newDimensions", ",", " ", "xmin", ",", "ymin", ",", "zmin", ",", "n", 
      ",", "finalProjection", ",", "centreSlice"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "imgFileList", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"centreSlice", "=", 
      RowBox[{"Floor", "[", 
       RowBox[{"nSlices", "/", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"img", " ", "=", 
      RowBox[{"ImageAdjust", "[", 
       RowBox[{
        RowBox[{"Image3D", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Import", "[", 
            RowBox[{"imgFileList", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"t0", "+", "t"}], ",", "n"}], "]"}], "+", "1"}], 
              "]"}], "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"centreSlice", "-", "sliceRadius"}], ";;", 
             RowBox[{"centreSlice", "+", "sliceRadius"}]}], "]"}], "]"}], ",", 
          RowBox[{"ColorFunction", "\[Rule]", " ", "transferFunction"}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0.006"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"img", "=", 
      RowBox[{"ImageResize", "[", 
       RowBox[{"img", ",", 
        RowBox[{"Round", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.41", ",", "0.41", ",", "1"}], "}"}], "*", 
          RowBox[{"ImageDimensions", "[", "img", "]"}]}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", "img", "}"}], ",", 
           RowBox[{"Lighting", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"ViewPoint", "->", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"camx", " ", "0.0123"}], ",", 
              RowBox[{
               RowBox[{"-", "0.112"}], " ", "camy"}], ",", 
              RowBox[{"camz", " ", "+", "3.981"}]}], "}"}]}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"Ticks", "\[Rule]", "None"}], ",", 
           RowBox[{"AxesOrigin", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
             "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"12", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
             "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Automatic", ",", "Automatic", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"sliceRadius", "-", "centreSlice"}], ",", 
                RowBox[{"sliceRadius", "+", "centreSlice"}]}], "}"}]}], 
             "}"}]}], ",", " ", 
           RowBox[{"PlotRangePadding", "->", "None"}], ",", 
           RowBox[{"ImagePadding", "->", "None"}]}], "]"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "600"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"finalProjection", ",", 
         RowBox[{"Graphics", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Inset", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Graphics", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"ColorData", "[", 
                   RowBox[{"97", ",", "1"}], "]"}], ",", 
                  RowBox[{"Annulus", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.8", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"2", "Pi", " ", 
                    RowBox[{"t", "/", "207"}]}], ")"}], "+", "0.00001"}]}], 
                    "}"}]}], "]"}], ",", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"PaddedForm", "[", 
                    RowBox[{
                    RowBox[{"2.5", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "-", "1"}], ")"}], ",", "0"}], "]"}]}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"3", ",", "1"}], "}"}], ",", 
                    RowBox[{"NumberPadding", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\>\"", ",", "\"\<0\>\""}], "}"}]}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "0.1"}]}], "}"}]}], "]"}], ",", "12", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
                   "]"}]}], "}"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}]}], "}"}]}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "80"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"120", ",", "120"}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Inset", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Graphics", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"ColorData", "[", 
                   RowBox[{"97", ",", "1"}], "]"}], ",", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"\"\<n: \>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{
                    RowBox[{"sliceRadius", "*", "2"}], "+", "1"}], "]"}]}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "0.1"}]}], "}"}]}], "]"}], ",", "12", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
                   "]"}]}], "}"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}]}], "}"}]}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "80"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"40", ",", "120"}], "}"}]}], "]"}]}], "}"}], "]"}]}], 
        "}"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "20"}], ",", "853"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "500"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.67015490832708*^9, 3.670154915612465*^9}, {
   3.670154950382378*^9, 3.670154951853094*^9}, 3.670154997562523*^9, {
   3.670155324451495*^9, 3.670155346256315*^9}, 3.6701554684955397`*^9, {
   3.670155502807678*^9, 3.6701555029391413`*^9}, 3.670156058620348*^9, {
   3.670156105188703*^9, 3.670156118415628*^9}, {3.6701563576902847`*^9, 
   3.670156393549827*^9}, {3.670157099866993*^9, 3.670157126535866*^9}, 
   3.670158151952784*^9, {3.6702163357882967`*^9, 3.670216340032666*^9}, {
   3.670216841379468*^9, 
   3.6702168645998077`*^9}},ExpressionUUID->"1a1a342b-8edc-4b08-8ec5-\
0cffd39def21"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"camx", ",", "camy", ",", "camz"}], "}"}], "=", 
  RowBox[{"BSplineFunction", "/@", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1.3", ",", 
        RowBox[{"-", "2.4"}], ",", "2"}], "}"}], " ", ",", 
      RowBox[{"{", 
       RowBox[{"0.8", ",", 
        RowBox[{"-", "1.2"}], ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.4", ",", 
        RowBox[{"-", "0.6"}], ",", "20"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "100"}], "}"}]}], "}"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.670156171005878*^9, 3.670156326834383*^9}, {
  3.6701564418930387`*^9, 
  3.670156466642137*^9}},ExpressionUUID->"7b06adbf-bbbc-4627-ae90-\
1c68b32889c4"],

Cell[BoxData[
 RowBox[{"camz", "[", "1.", "]"}]], "Input",
 CellChangeTimes->{{3.670156307795312*^9, 
  3.670156346773584*^9}},ExpressionUUID->"f7c57276-2dba-4227-8098-\
6a61f7239dd5"],

Cell[BoxData[
 RowBox[{"camx", "[", "0.99", "]"}]], "Input",
 CellChangeTimes->{{3.670156483759007*^9, 
  3.670156508352584*^9}},ExpressionUUID->"4c3c851d-b1aa-4917-a2ce-\
6adfcdb8b00f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"t", "=", "0.9905"}], ";", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "t"}], ")"}], "1.3"}], ",", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"t", "^", "5"}]}], ")"}]}], "2.4"}], ",", 
    RowBox[{"2", "+", 
     RowBox[{"t", " ", "2"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.670216719378067*^9, 3.6702167309694*^9}, {
  3.670216764504322*^9, 
  3.670216764775858*^9}},ExpressionUUID->"e0876319-4862-4942-b29b-\
fabb670e2781"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-0-1/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{
         RowBox[{"t", "+", "414"}], ",", "10", ",", "4"}], "]"}], "<>", 
       "\"\<.png\>\""}], ",", 
      RowBox[{"showRawWaveFromSlicesMoveCameraSmooth", "[", 
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"751", ",", "207"}], "]"}], ",", "75", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"t", "-", "751"}], ")"}], "/", "201"}], ")"}]}], "]"}]}], 
     "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "751", ",", "950", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670155076911737*^9, 3.670155099057929*^9}, 
   3.670155261725588*^9, {3.670155303272252*^9, 3.670155317263098*^9}, {
   3.670155351301917*^9, 3.670155367013006*^9}, {3.670157244806089*^9, 
   3.6701572795357313`*^9}, {3.6701573818061543`*^9, 3.670157381932803*^9}, {
   3.670216375140749*^9, 3.670216397620373*^9}, {3.670216434260254*^9, 
   3.670216445978609*^9}, {3.670216599816742*^9, 3.67021660018089*^9}, {
   3.670216644581575*^9, 3.67021664469247*^9}, 
   3.670229498197875*^9},ExpressionUUID->"c5289fd4-71db-42dd-b25b-\
d8479e673242"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{
       "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-0-1/\>\"", "<>", 
        RowBox[{"IntegerString", "[", 
         RowBox[{
          RowBox[{"t", "+", "414"}], ",", "10", ",", "4"}], "]"}], "<>", 
        "\"\<.png\>\""}], ",", 
       RowBox[{"showRawWaveFromSlicesMoveCamera", "[", 
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{"751", ",", "207"}], "]"}], ",", "75", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"1", "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"t", "-", "851"}], ")"}], "/", "100"}], ")"}]}], ",", 
           "1"}], "}"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "851", ",", "951", ",", "1"}], "}"}]}], "]"}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.67015730918128*^9, 3.670157332982009*^9}, {
   3.670157383781117*^9, 3.670157383909112*^9}, 3.6702164590180063`*^9, 
   3.670229499213188*^9},ExpressionUUID->"aec38008-ad8d-4dc5-9cf0-\
b190a41c75ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-0-1/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{
         RowBox[{"t", "+", "414"}], ",", "10", ",", "4"}], "]"}], "<>", 
       "\"\<.png\>\""}], ",", 
      RowBox[{"showRawWaveFromSlicesMoveCameraOnAxes", "[", 
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"751", ",", "207"}], "]"}], ",", "75", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"t", "-", "951"}], ")"}], "/", "29"}], ")"}]}], ",", 
          "1", ",", "1"}], "}"}]}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "951", ",", "980", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670157344727709*^9, 3.670157387772789*^9}, {
   3.670157982276367*^9, 3.67015798260185*^9}, {3.67021666282432*^9, 
   3.670216663787505*^9}, {3.670216893564416*^9, 3.670216925643031*^9}, {
   3.67021701346474*^9, 3.67021701353752*^9}, {3.6702210065875883`*^9, 
   3.670221007431633*^9}, 
   3.6702294997426243`*^9},ExpressionUUID->"14c0c3b5-e444-4c40-84f3-\
22a8712a38dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-0-1/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{
         RowBox[{"t", "+", "414"}], ",", "10", ",", "4"}], "]"}], "<>", 
       "\"\<.png\>\""}], ",", 
      RowBox[{"showRawWaveFromSlicesMoveCameraOnAxes", "[", 
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"751", ",", "207"}], "]"}], ",", "75", ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"t", "-", "981"}], ")"}], "/", "29"}], ")"}]}], ",", 
          "1"}], "}"}]}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "981", ",", "1010", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6702169456106586`*^9, 3.670216980888936*^9}, {
   3.6702170156807404`*^9, 3.6702170157447023`*^9}, {3.670221009739417*^9, 
   3.6702210103759623`*^9}, 
   3.670229500154573*^9},ExpressionUUID->"a13acd17-3f72-4252-a956-\
6fcad0b0d8f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-0-1/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{
         RowBox[{"t", "+", "414"}], ",", "10", ",", "4"}], "]"}], "<>", 
       "\"\<.png\>\""}], ",", 
      RowBox[{"showRawWaveFromSlicesMoveCameraOnAxes", "[", 
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"751", ",", "207"}], "]"}], ",", "75", ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"100", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"t", "-", "1011"}], ")"}], "/", "29"}], ")"}]}]}], 
         "}"}]}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1011", ",", "1040", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670217022928218*^9, 3.670217082966008*^9}, {
   3.670221012716235*^9, 3.670221013151753*^9}, 
   3.670229500601403*^9},ExpressionUUID->"a9e0ad2c-c7b2-4699-bc87-\
702260875858"]
}, Open  ]],

Cell[CellGroupData[{

Cell["part I", "Subsubsection",
 CellChangeTimes->{{3.670077920915923*^9, 
  3.670077921843992*^9}},ExpressionUUID->"5b3983be-403c-45a9-a266-\
ed97b9bafa5d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"myimg", " ", "=", 
   RowBox[{"ImageAdjust", "[", 
    RowBox[{"Image3D", "[", 
     RowBox[{"Import", "[", 
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/data/reference-nuclei/\>\"", "<>",
        "fname", "<>", "\"\<.tif\>\""}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myimg", "=", 
   RowBox[{"ImageResize", "[", 
    RowBox[{"myimg", ",", 
     RowBox[{"Round", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.41", ",", "0.41", ",", "1"}], "}"}], "*", 
       RowBox[{"ImageDimensions", "[", "myimg", "]"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",ExpressionUUID->"4170a41f-6ce6-4afc-9288-656de4b7594e"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showNuclei", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showNuclei", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"centroids_:", "pts2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"transferFunction_:", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Blend", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "0.917794", ",", " ", "0.920966", ",", " ", "0.881936", ",", 
               " ", "0."}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0.0500579", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "0.876709", ",", " ", "0.880126", ",", " ", "0.845903", ",", 
               " ", "0."}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0.105035", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "0.831587", ",", " ", "0.835272", ",", " ", "0.806328", ",", 
               " ", "0.140508"}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0.327836", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "0.601702", ",", " ", "0.619402", ",", " ", "0.616518", ",", 
               " ", "0.63673"}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"1.", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "0.1", ",", " ", "0.1", ",", " ", "0.1", ",", " ", "0.86873"}], 
              "]"}]}], "}"}]}], "}"}], ",", " ", "#1"}], "]"}], " ", "&"}], 
      " ", ")"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "img", ",", "inverseTransform", ",", "transformedImg", ",", " ", 
      "newDimensions", ",", " ", "xmin", ",", "ymin", ",", "zmin", ",", "n", 
      ",", "finalProjection"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"img", " ", "=", 
      RowBox[{"ImageAdjust", "[", 
       RowBox[{"Image3D", "[", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{
          "\"\</Users/scherf/Documents/heart_new/data/reference-nuclei/\>\"", 
           "<>", "fname", "<>", "\"\<.tif\>\""}], "]"}], ",", 
         RowBox[{"ColorFunction", "\[Rule]", " ", "transferFunction"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", "img", "}"}], ",", 
           RowBox[{"ViewPoint", "\[Rule]", "Top"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}]}], "]"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "300"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"finalProjection", ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics", "[", 
          RowBox[{"{", 
           RowBox[{"Black", ",", 
            RowBox[{"Opacity", "[", "0.3", "]"}], ",", 
            RowBox[{"AbsolutePointSize", "[", "4", "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Point", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Most", "[", "#", "]"}], "*", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"1", "/", "dx"}], ",", 
                   RowBox[{"1", "/", "dx"}]}], "}"}]}], "+", 
                RowBox[{"{", 
                 RowBox[{"20", ",", "30"}], "}"}]}], "]"}], "&"}], "/@", 
             "centroids"}]}], "}"}], "]"}]}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "800"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "500"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"800", ",", "600"}], "}"}]}], ",", 
       RowBox[{"PlotRangePadding", "->", "None"}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.6700785946916027`*^9, 3.670078717748446*^9}, {
  3.670078768627328*^9, 3.6700787849696302`*^9}, {3.67007885136158*^9, 
  3.6700788536232977`*^9}},ExpressionUUID->"6ca77127-b6f2-4c3a-a332-\
6bd8f3a460c1"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showNuclei", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showNuclei", "[", "\[IndentingNewLine]", 
   RowBox[{
   "alpha_", ",", "\[IndentingNewLine]", "referenceCells_List", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"centroids_:", "pts2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"imgFileList_:", "rawCaImageFiles"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{"t0_:", "startPoint"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "img", ",", "inverseTransform", ",", "transformedImg", ",", " ", 
      "newDimensions", ",", " ", "xmin", ",", "ymin", ",", "zmin", ",", "n", 
      ",", "finalProjection", ",", "transferFunction"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "imgFileList", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SeedRandom", "[", "\"\<1234\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"transferFunction", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Blend", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0.", ",", " ", 
              RowBox[{"RGBColor", "[", 
               RowBox[{
               "0.917794", ",", " ", "0.920966", ",", " ", "0.881936", ",", 
                " ", "0."}], "]"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"0.0500579", ",", " ", 
              RowBox[{"RGBColor", "[", 
               RowBox[{
               "0.876709", ",", " ", "0.880126", ",", " ", "0.845903", ",", 
                " ", "0."}], "]"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"0.105035", ",", " ", 
              RowBox[{"RGBColor", "[", 
               RowBox[{
               "0.831587", ",", " ", "0.835272", ",", " ", "0.806328", ",", 
                " ", 
                RowBox[{"0.140508", "*", "alpha"}]}], "]"}]}], "}"}], ",", 
            " ", 
            RowBox[{"{", 
             RowBox[{"0.327836", ",", " ", 
              RowBox[{"RGBColor", "[", 
               RowBox[{
               "0.601702", ",", " ", "0.619402", ",", " ", "0.616518", ",", 
                " ", 
                RowBox[{"0.63673", "*", "alpha"}]}], "]"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"1.", ",", " ", 
              RowBox[{"RGBColor", "[", 
               RowBox[{"0.1", ",", " ", "0.1", ",", " ", "0.1", ",", " ", 
                RowBox[{"0.86873", "*", "alpha"}]}], "]"}]}], "}"}]}], "}"}], 
          ",", " ", "#1"}], "]"}], " ", "&"}], " ", ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"img", " ", "=", 
      RowBox[{"ImageAdjust", "[", 
       RowBox[{"Image3D", "[", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{
          "\"\</Users/scherf/Documents/heart_new/data/reference-nuclei/\>\"", 
           "<>", "fname", "<>", "\"\<.tif\>\""}], "]"}], ",", 
         RowBox[{"ColorFunction", "\[Rule]", " ", "transferFunction"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"img", "=", 
      RowBox[{"ImageResize", "[", 
       RowBox[{"img", ",", 
        RowBox[{"Round", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.41", ",", "0.41", ",", "1"}], "}"}], "*", 
          RowBox[{"ImageDimensions", "[", "img", "]"}]}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"img", ",", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"ColorData", "[", 
                   RowBox[{"96", ",", 
                    RowBox[{"RandomInteger", "[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "20"}], "}"}], "]"}]}], "]"}], ",", 
                  RowBox[{"Specularity", "[", "0.", "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{"#", ",", "1.4"}], "]"}]}], "}"}], "&"}], "/@", 
               "centroids"}], "]"}]}], "}"}], ",", 
           RowBox[{"Lighting", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"ViewPoint", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "Infinity"}], "}"}]}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRangePadding", "->", "None"}], ",", 
           RowBox[{"ImagePadding", "->", "None"}]}], "]"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "600"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", "finalProjection", "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "20"}], ",", "853"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "500"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.6700874767171097`*^9, 3.6700875003106403`*^9}, 
   3.670087532182136*^9, 3.6700875887398787`*^9, {3.67008764411082*^9, 
   3.6700877778812227`*^9}, {3.670087820697379*^9, 3.67008783076757*^9}, {
   3.670088250977563*^9, 
   3.6700882586578074`*^9}},ExpressionUUID->"29dd84a5-6822-4091-88fc-\
b2855a33689e"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showNucleiGray", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showNucleiGray", "[", "\[IndentingNewLine]", 
   RowBox[{
   "alpha_", ",", "\[IndentingNewLine]", "referenceCells_List", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"centroids_:", "pts2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"imgFileList_:", "rawCaImageFiles"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{"t0_:", "startPoint"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "img", ",", "inverseTransform", ",", "transformedImg", ",", " ", 
      "newDimensions", ",", " ", "xmin", ",", "ymin", ",", "zmin", ",", "n", 
      ",", "finalProjection", ",", "transferFunction"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "imgFileList", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SeedRandom", "[", "\"\<1234\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"transferFunction", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Blend", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0.", ",", " ", 
              RowBox[{"RGBColor", "[", 
               RowBox[{
               "0.917794", ",", " ", "0.920966", ",", " ", "0.881936", ",", 
                " ", "0."}], "]"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"0.0500579", ",", " ", 
              RowBox[{"RGBColor", "[", 
               RowBox[{
               "0.876709", ",", " ", "0.880126", ",", " ", "0.845903", ",", 
                " ", "0."}], "]"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"0.105035", ",", " ", 
              RowBox[{"RGBColor", "[", 
               RowBox[{
               "0.831587", ",", " ", "0.835272", ",", " ", "0.806328", ",", 
                " ", 
                RowBox[{"0.140508", "*", "alpha"}]}], "]"}]}], "}"}], ",", 
            " ", 
            RowBox[{"{", 
             RowBox[{"0.327836", ",", " ", 
              RowBox[{"RGBColor", "[", 
               RowBox[{
               "0.601702", ",", " ", "0.619402", ",", " ", "0.616518", ",", 
                " ", 
                RowBox[{"0.63673", "*", "alpha"}]}], "]"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"1.", ",", " ", 
              RowBox[{"RGBColor", "[", 
               RowBox[{"0.1", ",", " ", "0.1", ",", " ", "0.1", ",", " ", 
                RowBox[{"0.86873", "*", "alpha"}]}], "]"}]}], "}"}]}], "}"}], 
          ",", " ", "#1"}], "]"}], " ", "&"}], " ", ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"img", " ", "=", 
      RowBox[{"ImageAdjust", "[", 
       RowBox[{"Image3D", "[", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{
          "\"\</Users/scherf/Documents/heart_new/data/reference-nuclei/\>\"", 
           "<>", "fname", "<>", "\"\<.tif\>\""}], "]"}], ",", 
         RowBox[{"ColorFunction", "\[Rule]", " ", "transferFunction"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"img", "=", 
      RowBox[{"ImageResize", "[", 
       RowBox[{"img", ",", 
        RowBox[{"Round", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.41", ",", "0.41", ",", "1"}], "}"}], "*", 
          RowBox[{"ImageDimensions", "[", "img", "]"}]}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"img", ",", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Gray", ",", 
                  RowBox[{"Specularity", "[", "0.", "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{"#", ",", "1.4"}], "]"}]}], "}"}], "&"}], "/@", 
               "centroids"}], "]"}]}], "}"}], ",", 
           RowBox[{"Lighting", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"ViewPoint", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "Infinity"}], "}"}]}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRangePadding", "->", "None"}], ",", 
           RowBox[{"ImagePadding", "->", "None"}]}], "]"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "600"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", "finalProjection", "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "20"}], ",", "853"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "500"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.670088445820189*^9, 
  3.670088493859745*^9}},ExpressionUUID->"2566b15d-414e-41a8-b9e9-\
863a31cd8388"],

Cell[BoxData[
 RowBox[{"frame1", "=", 
  RowBox[{"showNuclei", "[", 
   RowBox[{"0.001", ",", 
    RowBox[{"{", 
     RowBox[{"120", ",", "200"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.670078726351602*^9, 3.670078731375277*^9}, {
  3.6700875106000853`*^9, 3.670087513191864*^9}, {3.670087781567267*^9, 
  3.670087794935062*^9}, {3.670087851374748*^9, 3.670087852044722*^9}, {
  3.670087901382079*^9, 3.670087902443198*^9}, {3.670088475985675*^9, 
  3.670088479177782*^9}},ExpressionUUID->"98099e1a-001d-4df3-8c81-\
b6c4f5b768ae"],

Cell[BoxData[
 RowBox[{"frame2", "=", 
  RowBox[{"showNucleiGray", "[", 
   RowBox[{"0.00", ",", 
    RowBox[{"{", 
     RowBox[{"120", ",", "200"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.67008850248237*^9, 
  3.670088514464284*^9}},ExpressionUUID->"5abbb3d4-7894-494d-ac44-\
c3beb1ebadb3"],

Cell[BoxData[
 RowBox[{"Blend", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"frame1", ",", "frame2"}], "}"}], ",", "0.4"}], "]"}]], "Input",
 CellChangeTimes->{{3.670088522500749*^9, 3.6700885539855947`*^9}, {
  3.670088584024227*^9, 3.67008860051*^9}, {3.670088808241542*^9, 
  3.670088818648643*^9}},ExpressionUUID->"92d1a52e-78d6-48a6-8099-\
a53d9befce6b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-1/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{
         RowBox[{"t", "+", "20"}], ",", "10", ",", "3"}], "]"}], "<>", 
       "\"\<.png\>\""}], ",", 
      RowBox[{"Blend", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"frame1", ",", "frame2"}], "}"}], ",", 
        RowBox[{"0.1", " ", "t"}]}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "10"}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.6700880617189407`*^9, 3.670088118380741*^9}, {
   3.670088159181883*^9, 3.670088188395228*^9}, {3.670088286431903*^9, 
   3.6700882866233683`*^9}, {3.6700886297114887`*^9, 3.670088656508431*^9}, {
   3.670088720468835*^9, 3.670088759139432*^9}, {3.6700888248333817`*^9, 
   3.670088827038785*^9}, 
   3.670229501543788*^9},ExpressionUUID->"0498459a-0d3d-402c-b093-\
731f4e572d4d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-1/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"t", ",", "10", ",", "3"}], "]"}], "<>", "\"\<.png\>\""}], 
      ",", 
      RowBox[{"showNuclei", "[", 
       RowBox[{
        RowBox[{"1", "-", 
         RowBox[{"t", "/", "20"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"225", ",", "20"}], "}"}], ",", "pts2"}], "]"}]}], "]"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "20"}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{
  3.670229502192215*^9},ExpressionUUID->"4ec13f09-faee-4750-8ef0-\
eb8b3c331c74"],

Cell[BoxData[
 RowBox[{"test", "=", "\[IndentingNewLine]", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Image3D", "[", 
       RowBox[{"myimg", ",", 
        RowBox[{"ColorFunction", "->", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Blend", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0.", ",", " ", 
                 RowBox[{"RGBColor", "[", 
                  RowBox[{
                  "0.917794", ",", " ", "0.920966", ",", " ", "0.881936", ",",
                    " ", "0."}], "]"}]}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"0.0500579", ",", " ", 
                 RowBox[{"RGBColor", "[", 
                  RowBox[{
                  "0.876709", ",", " ", "0.880126", ",", " ", "0.845903", ",",
                    " ", "0."}], "]"}]}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"0.105035", ",", " ", 
                 RowBox[{"RGBColor", "[", 
                  RowBox[{
                  "0.831587", ",", " ", "0.835272", ",", " ", "0.806328", ",",
                    " ", "0.140508"}], "]"}]}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"0.327836", ",", " ", 
                 RowBox[{"RGBColor", "[", 
                  RowBox[{
                  "0.601702", ",", " ", "0.619402", ",", " ", "0.616518", ",",
                    " ", "0.63673"}], "]"}]}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"1.", ",", " ", 
                 RowBox[{"RGBColor", "[", 
                  RowBox[{
                  "0.1", ",", " ", "0.1", ",", " ", "0.1", ",", " ", 
                   "0.86873"}], "]"}]}], "}"}]}], "}"}], ",", " ", "#1"}], 
            "]"}], " ", "&"}], " ", ")"}]}]}], "]"}], ",", 
      RowBox[{"Graphics3D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ColorData", "[", 
            RowBox[{"96", ",", 
             RowBox[{"RandomInteger", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", "20"}], "}"}], "]"}]}], "]"}], ",", 
           RowBox[{"Specularity", "[", "0", "]"}], ",", 
           RowBox[{"Sphere", "[", 
            RowBox[{"#", ",", "1.5"}], "]"}]}], "}"}], "&"}], "/@", "pts2"}], 
       "]"}]}], "}"}], ",", 
    RowBox[{"ViewPoint", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "Infinity"}], "}"}]}], ",", 
    RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
    RowBox[{"Lighting", "->", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.670078889102418*^9, 3.6700789179417057`*^9}, {
  3.6700789826277323`*^9, 3.6700791159929457`*^9}, {3.670079739836691*^9, 
  3.6700797738967447`*^9}, {3.670087335710326*^9, 
  3.6700873377261953`*^9}},ExpressionUUID->"046fe678-f2a9-4ab6-a893-\
e49738d11d22"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"nuclearChannel", "=", 
   RowBox[{"Image", "[", 
    RowBox[{"Rasterize", "[", 
     RowBox[{
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"Image3D", "[", 
         RowBox[{"myimg", ",", 
          RowBox[{"ColorFunction", "->", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Blend", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0.", ",", " ", 
                   RowBox[{"RGBColor", "[", 
                    RowBox[{
                    "0.917794", ",", " ", "0.920966", ",", " ", "0.881936", 
                    ",", " ", "0."}], "]"}]}], "}"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"0.0500579", ",", " ", 
                   RowBox[{"RGBColor", "[", 
                    RowBox[{
                    "0.876709", ",", " ", "0.880126", ",", " ", "0.845903", 
                    ",", " ", "0."}], "]"}]}], "}"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"0.105035", ",", " ", 
                   RowBox[{"RGBColor", "[", 
                    RowBox[{
                    "0.831587", ",", " ", "0.835272", ",", " ", "0.806328", 
                    ",", " ", "0.140508"}], "]"}]}], "}"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"0.327836", ",", " ", 
                   RowBox[{"RGBColor", "[", 
                    RowBox[{
                    "0.601702", ",", " ", "0.619402", ",", " ", "0.616518", 
                    ",", " ", "0.63673"}], "]"}]}], "}"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"1.", ",", " ", 
                   RowBox[{"RGBColor", "[", 
                    RowBox[{
                    "0.1", ",", " ", "0.1", ",", " ", "0.1", ",", " ", 
                    "0.86873"}], "]"}]}], "}"}]}], "}"}], ",", " ", "#1"}], 
              "]"}], " ", "&"}], " ", ")"}]}]}], "]"}], ",", 
        RowBox[{"ViewPoint", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "Infinity"}], "}"}]}], ",", 
        RowBox[{"Boxed", "\[Rule]", "False"}]}], "]"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
      RowBox[{"ImageResolution", "\[Rule]", "300"}]}], "]"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.670077927577117*^9, 3.670077930051448*^9}, {
   3.670078037481964*^9, 3.6700780682833652`*^9}, 3.6700782067038*^9, {
   3.6700782392845697`*^9, 3.6700782775529346`*^9}, {3.670078416255992*^9, 
   3.670078478475244*^9}, {3.670080450014278*^9, 
   3.6700804542446823`*^9}},ExpressionUUID->"d06cce66-acd2-40df-86d5-\
a8b7c22607ca"],

Cell[BoxData[
 RowBox[{"dim1", "=", 
  RowBox[{"ImageDimensions", "[", "test", "]"}]}]], "Input",
 CellChangeTimes->{{3.6700809393076982`*^9, 
  3.6700809618043747`*^9}},ExpressionUUID->"e6563fe0-7563-4e63-9500-\
0c42326dc186"],

Cell[BoxData[
 RowBox[{"dim2", "=", 
  RowBox[{"ImageDimensions", "[", 
   RowBox[{"Image", "[", 
    RowBox[{"Graphics", "[", 
     RowBox[{"{", 
      RowBox[{"Black", ",", 
       RowBox[{"Opacity", "[", "1", "]"}], ",", 
       RowBox[{"AbsolutePointSize", "[", "4", "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"Most", "[", "#", "]"}], "]"}], "&"}], "/@", "pts2"}]}], 
      "}"}], "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.67008083421819*^9, 3.670080885311164*^9}, {
  3.670080946263579*^9, 
  3.670080963717704*^9}},ExpressionUUID->"934dc430-217b-4671-91eb-\
a4cd959959d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"N", "@", "dim1"}], "/", "dim2"}]], "Input",
 CellChangeTimes->{{3.67008096500319*^9, 
  3.670080972403977*^9}},ExpressionUUID->"190f59e4-0554-4f2e-985b-\
16c2ceaa631f"],

Cell[BoxData[
 RowBox[{"ImageDimensions", "[", "test", "]"}]], "Input",
 CellChangeTimes->{{3.670080793297289*^9, 
  3.67008080965726*^9}},ExpressionUUID->"7c26f3be-208d-475f-83ca-\
b1ad9da0dca9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["part II", "Subsubsection",
 CellChangeTimes->{{3.670077911932323*^9, 
  3.6700779181000357`*^9}},ExpressionUUID->"74f25efc-d7ab-4263-8a42-\
41f28f985369"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"img", " ", "=", 
   RowBox[{"ImageAdjust", "[", 
    RowBox[{
     RowBox[{"Image3D", "[", 
      RowBox[{
       RowBox[{"Import", "[", 
        RowBox[{"rawCaImageFiles", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{"startPoint", "-", "10"}], ",", "207"}], "]"}], "+", 
           "1"}], "]"}], "]"}], "]"}], ",", 
       RowBox[{"ColorFunction", "\[Rule]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Blend", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0.", ",", " ", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{
                 "0.05635", ",", " ", "0.081", ",", " ", "0.07687", ",", " ", 
                  "0."}], "]"}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0.284433", ",", " ", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{
                 "0.496561", ",", " ", "0.177689", ",", " ", "0.0361663", ",",
                   " ", "0."}], "]"}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0.394387", ",", " ", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{
                 "1.", ",", " ", "0.6036", ",", " ", "0.", ",", " ", 
                  "0.0116194"}], "]"}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0.649016", ",", " ", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{
                 "1.", ",", " ", "0.9658", ",", " ", "0.4926", ",", " ", 
                  "0.01"}], "]"}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"1.", ",", " ", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{
                 "1.", ",", " ", "0.6436", ",", " ", "0.03622", ",", " ", 
                  "0.01"}], "]"}]}], "}"}]}], "}"}], ",", " ", "#1"}], "]"}], 
          " ", "&"}], " ", ")"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0.006"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"img", "=", 
   RowBox[{"ImageResize", "[", 
    RowBox[{"img", ",", 
     RowBox[{"Round", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.41", ",", "0.41", ",", "1"}], "}"}], "*", 
       RowBox[{"ImageDimensions", "[", "img", "]"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.670082914696488*^9, 3.6700829624081697`*^9}, {
  3.6700829987259407`*^9, 
  3.67008302506879*^9}},ExpressionUUID->"be3f6105-d9f4-48b4-b8ff-\
e9cdccb8bf1e"],

Cell[BoxData[
 RowBox[{"canvasCoords", "=", 
  RowBox[{"Sort", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Last", "/@", 
      RowBox[{"ComponentMeasurements", "[", 
       RowBox[{
        RowBox[{"MorphologicalComponents", "[", 
         RowBox[{"Binarize", "[", 
          RowBox[{
           RowBox[{"ColorNegate", "@", 
            RowBox[{"Image", "[", 
             RowBox[{"Rasterize", "[", 
              RowBox[{
               RowBox[{"Show", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"img", ",", 
                   RowBox[{"Graphics3D", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Black", ",", 
                    RowBox[{"Specularity", "[", "0.", "]"}], ",", 
                    RowBox[{"Sphere", "[", 
                    RowBox[{"#", ",", "0.5"}], "]"}]}], "}"}], "&"}], "/@", 
                    "pts2"}], "]"}]}], "}"}], ",", 
                 RowBox[{"Lighting", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], 
                   "}"}]}], ",", 
                 RowBox[{"ViewPoint", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "Infinity"}], "}"}]}], ",", 
                 RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                 RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
                 RowBox[{"PlotRangePadding", "->", "None"}], ",", 
                 RowBox[{"ImagePadding", "->", "None"}]}], "]"}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
               RowBox[{"ImageResolution", "\[Rule]", "300"}]}], "]"}], 
             "]"}]}], ",", "0.82"}], "]"}], "]"}], ",", 
        RowBox[{"{", "\"\<Centroid\>\"", "}"}]}], "]"}]}], ",", "1"}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6700829004741898`*^9, 3.670082901136447*^9}, {
  3.670082974014327*^9, 3.670082981912943*^9}, {3.670083034622427*^9, 
  3.67008318804735*^9}, {3.67008321992031*^9, 
  3.6700832251422663`*^9}},ExpressionUUID->"5ca03408-681c-4d2b-9ba8-\
660190a00829"],

Cell[BoxData[
 RowBox[{"floatingCoords", "=", 
  RowBox[{"Sort", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Most", "[", "#", "]"}], "&"}], "/@", "pts2"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.670083192441585*^9, 
  3.670083232823052*^9}},ExpressionUUID->"d9b62a76-bc1b-4150-a09d-\
8e32cbb596ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"error", ",", "tfun"}], "}"}], "=", 
  RowBox[{"FindGeometricTransform", "[", 
   RowBox[{"canvasCoords", ",", 
    RowBox[{"Take", "[", 
     RowBox[{"floatingCoords", ",", 
      RowBox[{"Length", "[", "canvasCoords", "]"}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.670083236701099*^9, 3.670083279908334*^9}, {
  3.6700835359416924`*^9, 3.670083541914006*^9}, {3.6700836208096647`*^9, 
  3.67008362850517*^9}},ExpressionUUID->"a8372053-6880-40ab-ba07-\
6f761562017c"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showRawWave", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showRawWave", "[", "\[IndentingNewLine]", 
   RowBox[{"t_", ",", "\[IndentingNewLine]", 
    RowBox[{"centroids_:", "pts2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"transferFunction_:", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Blend", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "0.05635", ",", " ", "0.081", ",", " ", "0.07687", ",", " ", 
               "0."}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0.284433", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "0.496561", ",", " ", "0.177689", ",", " ", "0.0361663", ",", 
               " ", "0."}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0.394387", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "1.", ",", " ", "0.6036", ",", " ", "0.", ",", " ", 
               "0.0116194"}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0.649016", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "1.", ",", " ", "0.9658", ",", " ", "0.4926", ",", " ", 
               "0.681842"}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"1.", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "1.", ",", " ", "0.6436", ",", " ", "0.03622", ",", " ", "1."}],
               "]"}]}], "}"}]}], "}"}], ",", " ", "#1"}], "]"}], " ", "&"}], 
      " ", ")"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"imgFileList_:", "rawCaImageFiles"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{"t0_:", "startPoint"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "img", ",", "inverseTransform", ",", "transformedImg", ",", " ", 
      "newDimensions", ",", " ", "xmin", ",", "ymin", ",", "zmin", ",", "n", 
      ",", "finalProjection"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "imgFileList", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"img", " ", "=", 
      RowBox[{"ImageAdjust", "[", 
       RowBox[{
        RowBox[{"Image3D", "[", 
         RowBox[{
          RowBox[{"Import", "[", 
           RowBox[{"imgFileList", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"t0", "+", "t"}], ",", "n"}], "]"}], "+", "1"}], 
             "]"}], "]"}], "]"}], ",", 
          RowBox[{"ColorFunction", "\[Rule]", " ", "transferFunction"}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0.006"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"img", "=", 
      RowBox[{"ImageResize", "[", 
       RowBox[{"img", ",", 
        RowBox[{"Round", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.41", ",", "0.41", ",", "1"}], "}"}], "*", 
          RowBox[{"ImageDimensions", "[", "img", "]"}]}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"img", ",", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Gray", ",", 
                  RowBox[{"Specularity", "[", "0.", "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{"#", ",", "1."}], "]"}]}], "}"}], "&"}], "/@", 
               "centroids"}], "]"}]}], "}"}], ",", 
           RowBox[{"Lighting", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"ViewPoint", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "Infinity"}], "}"}]}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRangePadding", "->", "None"}], ",", 
           RowBox[{"ImagePadding", "->", "None"}]}], "]"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "600"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"finalProjection", ",", 
         RowBox[{"Graphics", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Graphics", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"ColorData", "[", 
                  RowBox[{"97", ",", "1"}], "]"}], ",", 
                 RowBox[{"Annulus", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0.8", ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"2", "Pi", " ", 
                    RowBox[{"t", "/", "207"}]}]}], "}"}]}], "]"}], ",", 
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"PaddedForm", "[", 
                    RowBox[{
                    RowBox[{"2.5", 
                    RowBox[{"(", 
                    RowBox[{"t", "-", "1"}], ")"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "1"}], "}"}], ",", 
                    RowBox[{"NumberPadding", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\>\"", ",", "\"\<0\>\""}], "}"}]}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "0.1"}]}], "}"}]}], "]"}], ",", "12", ",", 
                   RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
                  "]"}]}], "}"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}]}], "}"}]}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "80"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"120", ",", "120"}], "}"}]}], "]"}], "}"}], "]"}]}], 
        "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "20"}], ",", "853"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "500"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.6701168347735558`*^9, 3.670116863666915*^9}, {
  3.670116897354669*^9, 
  3.670116899537343*^9}},ExpressionUUID->"9090a5d7-1c8a-4b8c-a89b-\
f0a8c354334f"],

Cell[BoxData[
 RowBox[{"test", "=", 
  RowBox[{"showRawWave", "[", 
   RowBox[{"100", ",", "pts2", ",", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Blend", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.", ",", " ", 
            RowBox[{"RGBColor", "[", 
             RowBox[{
             "0.05635", ",", " ", "0.081", ",", " ", "0.07687", ",", " ", 
              "0."}], "]"}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0.278646", ",", " ", 
            RowBox[{"RGBColor", "[", 
             RowBox[{
             "0.496561", ",", " ", "0.177689", ",", " ", "0.0361663", ",", 
              " ", "0."}], "]"}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0.33941", ",", " ", 
            RowBox[{"RGBColor", "[", 
             RowBox[{
             "1.", ",", " ", "0.6036", ",", " ", "0.", ",", " ", 
              "0.0245082"}], "]"}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0.539062", ",", " ", 
            RowBox[{"RGBColor", "[", 
             RowBox[{
             "1.", ",", " ", "0.9658", ",", " ", "0.4926", ",", " ", 
              "0.314508"}], "]"}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"1.", ",", " ", 
            RowBox[{"RGBColor", "[", 
             RowBox[{
             "1.", ",", " ", "0.6436", ",", " ", "0.03622", ",", " ", "1."}], 
             "]"}]}], "}"}]}], "}"}], ",", " ", "#1"}], "]"}], " ", "&"}], 
     " ", ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.670116851818881*^9, 3.6701168590809917`*^9}, {
  3.6701169104009333`*^9, 
  3.6701169114872017`*^9}},ExpressionUUID->"5b92d0ed-7290-49af-b939-\
b91c2853cde8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-2/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"t", ",", "10", ",", "3"}], "]"}], "<>", "\"\<.png\>\""}], 
      ",", 
      RowBox[{"showRawWave", "[", 
       RowBox[{"t", ",", "pts2", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Blend", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0.", ",", " ", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{
                 "0.05635", ",", " ", "0.081", ",", " ", "0.07687", ",", " ", 
                  "0."}], "]"}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0.278646", ",", " ", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{
                 "0.496561", ",", " ", "0.177689", ",", " ", "0.0361663", ",",
                   " ", "0."}], "]"}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0.33941", ",", " ", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{
                 "1.", ",", " ", "0.6036", ",", " ", "0.", ",", " ", 
                  "0.0245082"}], "]"}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0.539062", ",", " ", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{
                 "1.", ",", " ", "0.9658", ",", " ", "0.4926", ",", " ", 
                  "0.314508"}], "]"}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"1.", ",", " ", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{
                 "1.", ",", " ", "0.6436", ",", " ", "0.03622", ",", " ", 
                  "1."}], "]"}]}], "}"}]}], "}"}], ",", " ", "#1"}], "]"}], 
          " ", "&"}], " ", ")"}]}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "207", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670117037197627*^9, 3.6701170443152943`*^9}, 
   3.670229502905579*^9},ExpressionUUID->"7e5d518f-e400-45ba-a27b-\
100e7e721927"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-2/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{
         RowBox[{"t", "+", "207"}], ",", "10", ",", "3"}], "]"}], "<>", 
       "\"\<.png\>\""}], ",", 
      RowBox[{"Import", "[", 
       RowBox[{
       "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-2/\>\"", "<>", 
        RowBox[{"IntegerString", "[", 
         RowBox[{"t", ",", "10", ",", "3"}], "]"}], "<>", "\"\<.png\>\""}], 
       "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "207", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6701299793656597`*^9, 3.670130082249773*^9}, {
  3.670229503545743*^9, 
  3.67022950405376*^9}},ExpressionUUID->"897aad39-aa53-4ccf-97b1-\
8c31b54092c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-2/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{
         RowBox[{"t", "+", "414"}], ",", "10", ",", "3"}], "]"}], "<>", 
       "\"\<.png\>\""}], ",", 
      RowBox[{"Import", "[", 
       RowBox[{
       "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-2/\>\"", "<>", 
        RowBox[{"IntegerString", "[", 
         RowBox[{"t", ",", "10", ",", "3"}], "]"}], "<>", "\"\<.png\>\""}], 
       "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "414", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6701301343510513`*^9, 3.670130137350281*^9}, 
   3.670229474212179*^9, 
   3.670229505149098*^9},ExpressionUUID->"e75e27bd-89d0-4a9c-8f3e-\
e11095e487f1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["part III", "Subsubsection",
 CellChangeTimes->{{3.670116965629211*^9, 
  3.670116966997136*^9}},ExpressionUUID->"ac1085ad-e89a-43c3-98e1-\
2ec20e7b8df9"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showAnnotatedWave", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showAnnotatedWave", "[", "\[IndentingNewLine]", 
   RowBox[{
   "t_", ",", "\[IndentingNewLine]", "referenceCells_List", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"centroids_:", "pts2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"transferFunction_:", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Blend", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "0.05635", ",", " ", "0.081", ",", " ", "0.07687", ",", " ", 
               "0."}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0.284433", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "0.496561", ",", " ", "0.177689", ",", " ", "0.0361663", ",", 
               " ", "0."}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0.394387", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "1.", ",", " ", "0.6036", ",", " ", "0.", ",", " ", 
               "0.0116194"}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0.649016", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "1.", ",", " ", "0.9658", ",", " ", "0.4926", ",", " ", 
               "0.681842"}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"1.", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "1.", ",", " ", "0.6436", ",", " ", "0.03622", ",", " ", "1."}],
               "]"}]}], "}"}]}], "}"}], ",", " ", "#1"}], "]"}], " ", "&"}], 
      " ", ")"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"imgFileList_:", "rawCaImageFiles"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{"t0_:", "startPoint"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "img", ",", "inverseTransform", ",", "transformedImg", ",", " ", 
      "newDimensions", ",", " ", "xmin", ",", "ymin", ",", "zmin", ",", "n", 
      ",", "finalProjection"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "imgFileList", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"img", " ", "=", 
      RowBox[{"ImageAdjust", "[", 
       RowBox[{
        RowBox[{"Image3D", "[", 
         RowBox[{
          RowBox[{"Import", "[", 
           RowBox[{"imgFileList", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"t0", "+", "t"}], ",", "n"}], "]"}], "+", "1"}], 
             "]"}], "]"}], "]"}], ",", 
          RowBox[{"ColorFunction", "\[Rule]", " ", "transferFunction"}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0.006"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"img", "=", 
      RowBox[{"ImageResize", "[", 
       RowBox[{"img", ",", 
        RowBox[{"Round", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.41", ",", "0.41", ",", "1"}], "}"}], "*", 
          RowBox[{"ImageDimensions", "[", "img", "]"}]}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"img", ",", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Gray", ",", 
                  RowBox[{"Specularity", "[", "0.", "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{"#", ",", "1."}], "]"}]}], "}"}], "&"}], "/@", 
               "centroids"}], "]"}]}], "}"}], ",", 
           RowBox[{"Lighting", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"ViewPoint", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "Infinity"}], "}"}]}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRangePadding", "->", "None"}], ",", 
           RowBox[{"ImagePadding", "->", "None"}]}], "]"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "600"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"finalProjection", ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
              RowBox[{"Darker", "@", "Gray"}], ",", 
              RowBox[{"Circle", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Most", "@", 
                    RowBox[{"centroids", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], ")"}], "*", "2.728"}], 
                 "+", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ",", "16"}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Darker", "@", "Gray"}], ",", 
              RowBox[{"AbsoluteThickness", "[", "1", "]"}], ",", 
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"Most", "@", 
                    RowBox[{"centroids", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], ")"}], "*", "2.728"}], 
                  "+", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"600", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"centroids", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "*", "2.728"}], "+", 
                    "1"}]}], "}"}]}], "}"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Inset", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"ListLinePlot", "[", 
                 RowBox[{
                  RowBox[{"Drop", "[", 
                   RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"series", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", 
                    RowBox[{"series", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", 
                    RowBox[{"series", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"t", "+", "207", "+", "103"}]}], "]"}], ",", 
                    RowBox[{"103", "+", "t"}]}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Epilog", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"AbsolutePointSize", "[", "7", "]"}], ",", 
                    RowBox[{"Darker", "@", 
                    RowBox[{"ColorData", "[", 
                    RowBox[{"97", ",", "1"}], "]"}]}], ",", 
                    RowBox[{"Point", "[", 
                    RowBox[{"{", 
                    RowBox[{"103", ",", 
                    RowBox[{
                    RowBox[{"series", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "[", 
                    RowBox[{"[", "t", "]"}], "]"}]}], "}"}], "]"}]}], "}"}]}],
                   ",", "\[IndentingNewLine]", 
                  RowBox[{"PlotRange", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"series", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Min", "[", 
                    RowBox[{"series", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Max", "[", 
                    RowBox[{"series", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "]"}]}], "}"}]}], "}"}]}],
                   ",", 
                  RowBox[{"Ticks", "\[Rule]", "None"}], ",", 
                  RowBox[{"AxesOrigin", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"103", ",", "Automatic"}], "}"}]}], ",", 
                  RowBox[{"AxesLabel", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<t\>\"", ",", 
                    "\"\<\!\(\*SuperscriptBox[\(Ca\), \
\(\(2\)\(+\)\)]\)\>\""}], "}"}]}], ",", 
                  RowBox[{"AxesStyle", "\[Rule]", 
                   RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"AbsoluteThickness", "[", "1", "]"}], ",", 
                    RowBox[{"Darker", "@", "Gray"}]}], "]"}]}], ",", 
                  RowBox[{"LabelStyle", "\[Rule]", 
                   RowBox[{"Directive", "[", 
                    RowBox[{"12", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
                    "]"}]}], ",", 
                  RowBox[{"ImageSize", "\[Rule]", "180"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"700", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"centroids", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/", "dx"}], "+", 
                   "30"}]}], "}"}]}], "]"}]}], "}"}], "&"}], "/@", 
           "referenceCells"}], "]"}], ",", 
         RowBox[{"Graphics", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Graphics", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"ColorData", "[", 
                  RowBox[{"97", ",", "1"}], "]"}], ",", 
                 RowBox[{"Annulus", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0.8", ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"2", "Pi", " ", 
                    RowBox[{"t", "/", "207"}]}]}], "}"}]}], "]"}], ",", 
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"PaddedForm", "[", 
                    RowBox[{
                    RowBox[{"2.5", 
                    RowBox[{"(", 
                    RowBox[{"t", "-", "1"}], ")"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "1"}], "}"}], ",", 
                    RowBox[{"NumberPadding", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\>\"", ",", "\"\<0\>\""}], "}"}]}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "0.1"}]}], "}"}]}], "]"}], ",", "12", ",", 
                   RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
                  "]"}]}], "}"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}]}], "}"}]}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "80"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"120", ",", "120"}], "}"}]}], "]"}], "}"}], "]"}]}], 
        "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "20"}], ",", "853"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "500"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.670057903071376*^9, 3.670057911071385*^9}, {
   3.670057963374995*^9, 3.6700579712773867`*^9}, {3.6700582536768827`*^9, 
   3.67005825702*^9}, {3.670058336883436*^9, 3.6700583449705772`*^9}, {
   3.670058380296713*^9, 3.670058409160487*^9}, {3.670058454135605*^9, 
   3.670058454494956*^9}, {3.670058500454132*^9, 3.670058534356063*^9}, {
   3.6700585773818398`*^9, 3.67005857875786*^9}, {3.670058622027166*^9, 
   3.670058642908824*^9}, {3.670058713208865*^9, 3.6700587377433357`*^9}, {
   3.670058814998385*^9, 3.670058906465366*^9}, {3.670058958359602*^9, 
   3.6700589928706512`*^9}, {3.6700590317987432`*^9, 3.670059032566143*^9}, {
   3.670059074158242*^9, 3.6700591058517637`*^9}, {3.670059152549259*^9, 
   3.670059152648828*^9}, {3.670059245745757*^9, 3.670059275806356*^9}, {
   3.6700593451468782`*^9, 3.670059371181117*^9}, {3.670059414979084*^9, 
   3.670059444067402*^9}, {3.670059516869369*^9, 3.6700595260288963`*^9}, {
   3.670059564624566*^9, 3.670059663330315*^9}, {3.670067637111182*^9, 
   3.6700676372360067`*^9}, {3.670075812796523*^9, 3.670075813250984*^9}, {
   3.670075853980027*^9, 3.6700758542003603`*^9}, {3.670076429649761*^9, 
   3.670076434398636*^9}, {3.670076610235682*^9, 3.670076610712755*^9}, {
   3.670079827347691*^9, 3.670079832473482*^9}, {3.670079896057816*^9, 
   3.670079912071719*^9}, {3.670079945994007*^9, 3.670079984415719*^9}, {
   3.6700800668626204`*^9, 3.670080149585837*^9}, {3.670080205795228*^9, 
   3.670080278573999*^9}, {3.670080316317648*^9, 3.670080344308157*^9}, {
   3.670080379633957*^9, 3.670080381986149*^9}, {3.670082082952228*^9, 
   3.67008211945892*^9}, {3.670082298699785*^9, 3.670082302327158*^9}, {
   3.670082334269651*^9, 3.670082411513792*^9}, {3.670082573751011*^9, 
   3.670082789264279*^9}, {3.670084228084301*^9, 3.6700844394593477`*^9}, {
   3.670084493331437*^9, 3.670084528552898*^9}, {3.670084688708909*^9, 
   3.670084799319314*^9}, {3.670084843512848*^9, 3.670085044623982*^9}, {
   3.67008510473496*^9, 3.670085159997501*^9}, {3.670085204324115*^9, 
   3.670085209283094*^9}, {3.670085270707155*^9, 3.670085317720256*^9}, {
   3.6700853522968903`*^9, 3.670085439171743*^9}, {3.670085722915914*^9, 
   3.67008576064083*^9}, {3.6700858007379103`*^9, 3.670085800856196*^9}, {
   3.670085859321311*^9, 3.670085872926487*^9}, {3.670085933526428*^9, 
   3.670085933764886*^9}, {3.670086057139759*^9, 3.670086246499321*^9}, {
   3.670086319234215*^9, 3.670086319800359*^9}, {3.6700869214052896`*^9, 
   3.670086922157887*^9}, {3.670086970540852*^9, 3.670087122241911*^9}, {
   3.670087164144413*^9, 3.670087196359371*^9}, {3.6700879510547953`*^9, 
   3.670087986987369*^9}, {3.670088915771068*^9, 3.670088948141985*^9}, {
   3.670089036772299*^9, 3.670089036883877*^9}, 3.670089080738925*^9, {
   3.670089299235347*^9, 
   3.670089300987401*^9}},ExpressionUUID->"23f95310-606f-4545-ad15-\
ba331f83e748"],

Cell[BoxData["108"], "Input",
 CellChangeTimes->{{3.670085528181142*^9, 
  3.670085528469571*^9}},ExpressionUUID->"fa9b04f6-250a-4239-b6cc-\
369d78f3de5f"],

Cell[BoxData[
 RowBox[{"Mod", "[", 
  RowBox[{
   RowBox[{"startPoint", "+", "10"}], ",", "207"}], "]"}]], "Input",
 CellChangeTimes->{{3.670086882291113*^9, 
  3.670086911780707*^9}},ExpressionUUID->"87587b8b-7099-4049-8f11-\
38c0a3704592"],

Cell[BoxData["startPoint"], "Input",
 CellChangeTimes->{{3.670086914603519*^9, 
  3.67008691556491*^9}},ExpressionUUID->"55460152-7b01-4a38-a537-\
19c260306645"],

Cell[BoxData[
 RowBox[{"test", "=", 
  RowBox[{"showAnnotatedWave", "[", 
   RowBox[{"1", ",", 
    RowBox[{"{", 
     RowBox[{"225", ",", "20"}], "}"}], ",", "pts2", ",", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Blend", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.", ",", " ", 
            RowBox[{"RGBColor", "[", 
             RowBox[{
             "0.05635", ",", " ", "0.081", ",", " ", "0.07687", ",", " ", 
              "0."}], "]"}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0.278646", ",", " ", 
            RowBox[{"RGBColor", "[", 
             RowBox[{
             "0.496561", ",", " ", "0.177689", ",", " ", "0.0361663", ",", 
              " ", "0."}], "]"}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0.33941", ",", " ", 
            RowBox[{"RGBColor", "[", 
             RowBox[{
             "1.", ",", " ", "0.6036", ",", " ", "0.", ",", " ", 
              "0.0245082"}], "]"}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0.539062", ",", " ", 
            RowBox[{"RGBColor", "[", 
             RowBox[{
             "1.", ",", " ", "0.9658", ",", " ", "0.4926", ",", " ", 
              "0.314508"}], "]"}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"1.", ",", " ", 
            RowBox[{"RGBColor", "[", 
             RowBox[{
             "1.", ",", " ", "0.6436", ",", " ", "0.03622", ",", " ", "1."}], 
             "]"}]}], "}"}]}], "}"}], ",", " ", "#1"}], "]"}], " ", "&"}], 
     " ", ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.670058606321575*^9, 3.670058606583727*^9}, {
   3.6700590047097282`*^9, 3.670059005091017*^9}, {3.670059186889099*^9, 
   3.6700591890615263`*^9}, {3.6700594520697412`*^9, 
   3.6700594527572327`*^9}, {3.670084546702035*^9, 3.67008463503399*^9}, {
   3.670085002654913*^9, 3.6700850034547997`*^9}, {3.670085472906477*^9, 
   3.670085555297866*^9}, {3.670085587901754*^9, 3.67008568432942*^9}, {
   3.670086936212569*^9, 3.670086952169417*^9}, 3.6700892668197737`*^9, {
   3.670089309858926*^9, 
   3.670089313151868*^9}},ExpressionUUID->"4c5b5fd5-6224-446c-b973-\
8126eb256d5b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-3/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"t", ",", "10", ",", "3"}], "]"}], "<>", "\"\<.png\>\""}], 
      ",", 
      RowBox[{"showAnnotatedWave", "[", 
       RowBox[{"t", ",", 
        RowBox[{"{", 
         RowBox[{"225", ",", "20"}], "}"}], ",", "pts2", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Blend", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0.", ",", " ", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{
                 "0.05635", ",", " ", "0.081", ",", " ", "0.07687", ",", " ", 
                  "0."}], "]"}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0.278646", ",", " ", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{
                 "0.496561", ",", " ", "0.177689", ",", " ", "0.0361663", ",",
                   " ", "0."}], "]"}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0.33941", ",", " ", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{
                 "1.", ",", " ", "0.6036", ",", " ", "0.", ",", " ", 
                  "0.0245082"}], "]"}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0.539062", ",", " ", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{
                 "1.", ",", " ", "0.9658", ",", " ", "0.4926", ",", " ", 
                  "0.314508"}], "]"}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"1.", ",", " ", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{
                 "1.", ",", " ", "0.6436", ",", " ", "0.03622", ",", " ", 
                  "1."}], "]"}]}], "}"}]}], "}"}], ",", " ", "#1"}], "]"}], 
          " ", "&"}], " ", ")"}]}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "207", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670050041515707*^9, 3.670050069595236*^9}, {
   3.670050199167712*^9, 3.67005025143883*^9}, {3.6700763378841877`*^9, 
   3.670076367549861*^9}, 3.670077854498332*^9, {3.670085998545019*^9, 
   3.6700859999359093`*^9}, {3.670089122367725*^9, 3.6700891247494297`*^9}, {
   3.670116953040066*^9, 3.670116953206319*^9}, 
   3.670229476601289*^9},ExpressionUUID->"604c4624-52f9-421a-8567-\
a993439a3d99"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-3/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{
         RowBox[{"t", "+", "207"}], ",", "10", ",", "3"}], "]"}], "<>", 
       "\"\<.png\>\""}], ",", 
      RowBox[{"Import", "[", 
       RowBox[{
       "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-3/\>\"", "<>", 
        RowBox[{"IntegerString", "[", 
         RowBox[{"t", ",", "10", ",", "3"}], "]"}], "<>", "\"\<.png\>\""}], 
       "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "207", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670132316226865*^9, 3.6701323176734343`*^9}, {
  3.670229477856039*^9, 
  3.6702294787492523`*^9}},ExpressionUUID->"1218ce1d-5bda-4021-8873-\
4a74c8b504a3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-3/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{
         RowBox[{"t", "+", "414"}], ",", "10", ",", "3"}], "]"}], "<>", 
       "\"\<.png\>\""}], ",", 
      RowBox[{"Import", "[", 
       RowBox[{
       "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-3/\>\"", "<>", 
        RowBox[{"IntegerString", "[", 
         RowBox[{"t", ",", "10", ",", "3"}], "]"}], "<>", "\"\<.png\>\""}], 
       "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "414", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670132320250915*^9, 3.670132322001602*^9}, {
  3.670229479534808*^9, 
  3.670229480972004*^9}},ExpressionUUID->"c11b3f1d-a52e-433f-8f51-\
545bb5d2a95f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"myimg", " ", "=", 
   RowBox[{"ImageAdjust", "[", 
    RowBox[{"Image3D", "[", 
     RowBox[{"Import", "[", 
      RowBox[{"rawCaImageFiles", "[", 
       RowBox[{"[", "60", "]"}], "]"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myimg", "=", 
   RowBox[{"ImageResize", "[", 
    RowBox[{"myimg", ",", 
     RowBox[{"Round", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.41", ",", "0.41", ",", "1"}], "}"}], "*", 
       RowBox[{"ImageDimensions", "[", "myimg", "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"invT", "=", 
   RowBox[{"InverseFunction", "[", "stdTransform", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.658662245985496*^9, 3.65866224723695*^9}, {
  3.6586623040222692`*^9, 3.658662350299596*^9}, {3.658663373879035*^9, 
  3.6586633982443733`*^9}, {3.6610883855703497`*^9, 3.661088385807625*^9}, {
  3.669996869701923*^9, 3.669996873092071*^9}, {3.669997643621047*^9, 
  3.669997644108048*^9}, {3.669997674444769*^9, 3.669997695731678*^9}, {
  3.669997741194888*^9, 3.669997781024274*^9}, {3.6699978741934137`*^9, 
  3.669997882620698*^9}, {3.6699979160281153`*^9, 3.669997999848838*^9}, {
  3.6699980521914253`*^9, 
  3.669998075398568*^9}},ExpressionUUID->"1d5793ec-6c91-4bcc-9e5d-\
21238c78023d"],

Cell[BoxData[
 RowBox[{"cfun2", "=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Blend", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.", ",", " ", 
          RowBox[{"RGBColor", "[", 
           RowBox[{
           "0.05635", ",", " ", "0.081", ",", " ", "0.07687", ",", " ", 
            "0."}], "]"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0.284433", ",", " ", 
          RowBox[{"RGBColor", "[", 
           RowBox[{
           "0.496561", ",", " ", "0.177689", ",", " ", "0.0361663", ",", " ", 
            "0."}], "]"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0.330729", ",", " ", 
          RowBox[{"RGBColor", "[", 
           RowBox[{
           "1.", ",", " ", "0.6036", ",", " ", "0.", ",", " ", "0.00517491"}],
            "]"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0.423322", ",", " ", 
          RowBox[{"RGBColor", "[", 
           RowBox[{
           "1.", ",", " ", "0.9658", ",", " ", "0.4926", ",", " ", "1."}], 
           "]"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"1.", ",", " ", 
          RowBox[{"RGBColor", "[", 
           RowBox[{
           "1.", ",", " ", "0.6436", ",", " ", "0.03622", ",", " ", "1."}], 
           "]"}]}], "}"}]}], "}"}], ",", " ", "#1"}], "]"}], " ", "&"}], " ", 
   ")"}]}]], "Input",
 CellChangeTimes->{{3.669997533936854*^9, 3.669997540038754*^9}, 
   3.669997617617292*^9},ExpressionUUID->"4bd879ba-7948-4668-a068-\
391250cfe06c"],

Cell[BoxData[
 RowBox[{"cfun2", "=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Blend", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.", ",", " ", 
          RowBox[{"RGBColor", "[", 
           RowBox[{
           "0.05635", ",", " ", "0.081", ",", " ", "0.07687", ",", " ", 
            "0."}], "]"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0.284433", ",", " ", 
          RowBox[{"RGBColor", "[", 
           RowBox[{
           "0.496561", ",", " ", "0.177689", ",", " ", "0.0361663", ",", " ", 
            "0."}], "]"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0.434896", ",", " ", 
          RowBox[{"RGBColor", "[", 
           RowBox[{"1.", ",", " ", "0.6036", ",", " ", "0.", ",", " ", "0."}],
            "]"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0.649016", ",", " ", 
          RowBox[{"RGBColor", "[", 
           RowBox[{
           "1.", ",", " ", "0.9658", ",", " ", "0.4926", ",", " ", 
            "0.681842"}], "]"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"1.", ",", " ", 
          RowBox[{"RGBColor", "[", 
           RowBox[{
           "1.", ",", " ", "0.6436", ",", " ", "0.03622", ",", " ", "1."}], 
           "]"}]}], "}"}]}], "}"}], ",", " ", "#1"}], "]"}], " ", "&"}], " ", 
   ")"}]}]], "Input",
 CellChangeTimes->{{3.66999804651812*^9, 
  3.669998048274829*^9}},ExpressionUUID->"6556f07d-fa34-46a1-ae84-\
690573a816a9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"timg", "=", 
   RowBox[{"Image3D", "[", 
    RowBox[{
     RowBox[{"ImageTransformation", "[", 
      RowBox[{"myimg", ",", "invT", ",", " ", 
       RowBox[{"DataRange", "\[Rule]", "Full"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
     RowBox[{"ColorFunction", "->", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Blend", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0.", ",", " ", 
              RowBox[{"RGBColor", "[", 
               RowBox[{
               "0.05635", ",", " ", "0.081", ",", " ", "0.07687", ",", " ", 
                "0."}], "]"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"0.0529514", ",", " ", 
              RowBox[{"RGBColor", "[", 
               RowBox[{
               "0.496561", ",", " ", "0.177689", ",", " ", "0.0361663", ",", 
                " ", "0."}], "]"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"0.3", ",", " ", 
              RowBox[{"RGBColor", "[", 
               RowBox[{
               "1.", ",", " ", "0.6036", ",", " ", "0.", ",", " ", 
                "0.301431"}], "]"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"0.66", ",", " ", 
              RowBox[{"RGBColor", "[", 
               RowBox[{
               "1.", ",", " ", "0.9658", ",", " ", "0.4926", ",", " ", 
                "0.660695"}], "]"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"1.", ",", " ", 
              RowBox[{"RGBColor", "[", 
               RowBox[{
               "1.", ",", " ", "0.6436", ",", " ", "0.03622", ",", " ", 
                "1."}], "]"}]}], "}"}]}], "}"}], ",", " ", "#1"}], "]"}], " ",
         "&"}], " ", ")"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"newdims", "=", 
   RowBox[{
    RowBox[{"Round", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", "#", "]"}], "-", 
        RowBox[{"Min", "[", "#", "]"}]}], "&"}], "/@", 
      RowBox[{"Transpose", "[", 
       RowBox[{"transformToStandardView", "/@", "pts2"}], "]"}]}], "]"}], "+",
     "10"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"xmin", ",", "ymin", ",", "zmin"}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Min", "[", "#", "]"}], "&"}], "/@", 
    RowBox[{"Transpose", "[", 
     RowBox[{"transformToStandardView", "/@", "pts2"}], "]"}]}]}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{"timg", "=", 
   RowBox[{"ImageCrop", "[", 
    RowBox[{
     RowBox[{"Image3D", "[", 
      RowBox[{"timg", ",", 
       RowBox[{"ColorFunction", "\[Rule]", "cfun2"}]}], "]"}], ",", 
     "newdims"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.669997074343728*^9, 3.6699970749010363`*^9}, 
   3.6699974673294563`*^9, {3.6699975285800457`*^9, 
   3.669997551199277*^9}},ExpressionUUID->"f333682b-2733-4da0-a73b-\
5e165b82c8b5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["frame rate calculation", "Subsubsection",
 CellChangeTimes->{{3.6701272439992647`*^9, 
  3.67012724977728*^9}},ExpressionUUID->"00fd6f3e-6ed3-4c20-99ff-\
b22445cbfabd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"2.5", " ", "/", " ", "1000"}], ")"}], "*", "207"}]], "Input",
 CellChangeTimes->{{3.670127258537372*^9, 
  3.670127275632824*^9}},ExpressionUUID->"bce0c93a-ae45-4ad1-b3cd-\
876f5c8023b0"],

Cell[BoxData[
 RowBox[{"1", "/", 
  RowBox[{"(", 
   RowBox[{"2.5", " ", "/", " ", "1000"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.67012735568633*^9, 
  3.67012735582161*^9}},ExpressionUUID->"189f443e-0b5e-4bd8-926f-\
fe84b6381e08"],

Cell[BoxData[
 RowBox[{"N", "[", 
  RowBox[{"207", "/", "400"}], "]"}]], "Input",
 CellChangeTimes->{{3.670127365511354*^9, 
  3.670127379229003*^9}},ExpressionUUID->"8f1679d0-506c-492e-b629-\
fd2b3f76bc6a"],

Cell[BoxData[
 RowBox[{"0.5175", " ", "*", " ", "4"}]], "Input",
 CellChangeTimes->{{3.6701298921509123`*^9, 
  3.67012991848485*^9}},ExpressionUUID->"5cbb7955-ea5e-4cf0-b96a-\
4d78cf9da570"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.670127327698716*^9, 
  3.670127333070944*^9}},ExpressionUUID->"235ddde4-1b78-42c6-ae41-\
4fbd46ea53c0"],

Cell[BoxData[
 RowBox[{"1", "/", "0.5175"}]], "Input",
 CellChangeTimes->{{3.670127288792818*^9, 
  3.670127293264018*^9}},ExpressionUUID->"9c7d4152-fa43-41e7-acb1-\
e2e875d53d61"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Video S3", "Subsection",
 CellChangeTimes->{{3.670126964565254*^9, 3.6701269670452757`*^9}, {
  3.670241808625021*^9, 
  3.670241811998432*^9}},ExpressionUUID->"e31cb52a-5450-4ff5-a463-\
cca16d536dfc"],

Cell[CellGroupData[{

Cell["part 1", "Subsubsection",
 CellChangeTimes->{{3.655479721777885*^9, 3.655479723344633*^9}, {
  3.66943602834438*^9, 3.66943602898307*^9}, {3.670241817007113*^9, 
  3.6702418216064568`*^9}},ExpressionUUID->"8e7a63ae-e181-42af-9b6d-\
0eb8b98bd5fd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nnfun", " ", "=", " ", 
   RowBox[{"Nearest", "[", "pts2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myEdges", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"localTopology", "[", 
       RowBox[{"#", ",", "pts2", ",", "nnfun"}], "]"}], "&"}], "/@", "pts2"}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vertexIDs", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"Length", "[", "pts2", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"edgeDelays", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"onsetAP", "[", 
         RowBox[{"[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "-", 
        RowBox[{"onsetAP", "[", 
         RowBox[{"[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "]"}], "&"}], "/@",
      "myEdges"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"edgeOutlierThresh", "=", 
     RowBox[{
      RowBox[{"1.5", 
       RowBox[{"InterquartileRange", "[", "edgeDelays", "]"}]}], "+", 
      RowBox[{"Quantile", "[", 
       RowBox[{"edgeDelays", ",", "0.75"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"edgeOutliers", "=", 
     RowBox[{"Position", "[", 
      RowBox[{"edgeDelays", ",", 
       RowBox[{"x_", "/;", 
        RowBox[{"x", "\[GreaterEqual]", "edgeOutlierThresh"}]}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"myEdges", "=", 
     RowBox[{"Delete", "[", 
      RowBox[{"myEdges", ",", "edgeOutliers"}], "]"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myGraph", "=", 
   RowBox[{"Graph", "[", 
    RowBox[{"vertexIDs", ",", " ", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"Sort", "/@", "myEdges"}], "]"}], ",", " ", 
     RowBox[{"VertexCoordinates", "\[Rule]", 
      RowBox[{"MapIndexed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#2", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", "#1"}], "&"}], ",", 
        "pts2"}], "]"}]}], ",", 
     RowBox[{"EdgeStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{
        RowBox[{"AbsoluteThickness", "[", "1", "]"}], ",", "LightGray"}], 
       "]"}]}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.655478038313387*^9, 3.655478052570207*^9}, {
   3.658640810280506*^9, 3.658640810537683*^9}, 
   3.6586462072401876`*^9},ExpressionUUID->"c9fcb7d2-3698-472d-880d-\
6ed6013f1de6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"maxZ", ",", " ", "minZ"}], "}"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", "pts2"}], "]"}], ",", 
     RowBox[{"Min", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", "pts2"}], "]"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"edges", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"GrayLevel", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", "#", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"maxZ", "-", "minZ"}], ")"}]}], "]"}], ",", 
       RowBox[{"AbsoluteThickness", "[", "1", "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]}], "}"}], "&"}], "/@", 
    RowBox[{"(", 
     RowBox[{"myEdges", "/.", 
      RowBox[{"MapIndexed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#2", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", "#1"}], "&"}], ",", 
        "pts2"}], "]"}]}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.655482883642618*^9, 3.655483086125012*^9}, {
  3.655483123033209*^9, 3.655483142891944*^9}, {3.65548319577076*^9, 
  3.655483239928317*^9}},ExpressionUUID->"0c11094d-40a7-48fd-8b11-\
26744c795e79"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cells", " ", "=", " ", "pts2"}], ";"}]], "Input",
 CellChangeTimes->{{3.655488142715345*^9, 
  3.655488145226264*^9}},ExpressionUUID->"735416ad-8c58-4a0b-bdb3-\
fcee85fa8cd7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"spfun", "=", 
   RowBox[{"FindShortestPath", "[", 
    RowBox[{"myGraph", ",", "All", ",", "All"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gdistMat", " ", "=", " ", 
   RowBox[{"GraphDistanceMatrix", "[", "myGraph", "]"}]}], ";"}]}], "Input",Ex\
pressionUUID->"6fef87d7-b91c-4be9-b91e-fd563a616176"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showNodes", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showNodes", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"centroids_:", "pts2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "maxZ", ",", "minZ", ",", "stdCentroids", ",", "n", ",", 
      "finalProjection", ",", "transferFunction"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "\"\<1234\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"stdCentroids", " ", "=", " ", 
      RowBox[{"dataTransform", "/@", "centroids"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"maxZ", ",", " ", "minZ"}], "}"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"Graphics3D", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Gray", ",", 
                 RowBox[{"Specularity", "[", "0.", "]"}], ",", 
                 RowBox[{"GrayLevel", "[", 
                  RowBox[{"0.5", "+", 
                   RowBox[{"0.2", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"maxZ", "-", "minZ"}], ")"}]}], ")"}]}], 
                    ")"}]}]}], "]"}], ",", 
                 RowBox[{"Sphere", "[", 
                  RowBox[{"#", ",", "2"}], "]"}]}], "}"}], "&"}], "/@", 
              RowBox[{"(", "stdCentroids", ")"}]}], "]"}], "}"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"Lighting", "->", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"ViewPoint", "\[Rule]", "Top"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "None"}]}], "]"}], ",", 
         RowBox[{"RasterSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", "finalProjection", "}"}], ",", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "200"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "50"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.67022634267782*^9, 3.670226474047686*^9}, {
  3.6702265048019333`*^9, 3.670226541181279*^9}, {3.670226615121361*^9, 
  3.670226702632674*^9}, {3.670226792139421*^9, 3.670227037149662*^9}, {
  3.670227084163362*^9, 3.670227344531225*^9}, {3.670227383838891*^9, 
  3.670227393626245*^9}, {3.670227437686014*^9, 3.670227450136833*^9}, {
  3.67022751014697*^9, 3.670227558792839*^9}, {3.670227697093686*^9, 
  3.670227697538872*^9}, {3.670227734244042*^9, 3.67022788134704*^9}, {
  3.670227925700842*^9, 3.670228035814036*^9}, {3.670228261972925*^9, 
  3.670228329724214*^9}, {3.670228735315816*^9, 
  3.6702287354394712`*^9}},ExpressionUUID->"0df7c42f-7c6b-4997-b85d-\
057a80010d1c"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showNodes", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showNodes", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"centroids_:", "pts2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "maxZ", ",", "minZ", ",", "stdCentroids", ",", "n", ",", 
      "finalProjection", ",", "transferFunction"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "\"\<1234\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"stdCentroids", " ", "=", " ", 
      RowBox[{"dataTransform", "/@", "centroids"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"maxZ", ",", " ", "minZ"}], "}"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"Graphics3D", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"GrayLevel", "[", 
                  RowBox[{"0.5", "+", 
                   RowBox[{"0.2", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"maxZ", "-", "minZ"}], ")"}]}], ")"}]}], 
                    ")"}]}]}], "]"}], ",", 
                 RowBox[{"Sphere", "[", 
                  RowBox[{"#", ",", "1"}], "]"}]}], "}"}], "&"}], "/@", 
              RowBox[{"(", "stdCentroids", ")"}]}], "]"}], 
            "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", 
           RowBox[{"Lighting", "->", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"ViewPoint", "\[Rule]", "Top"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "85"}], ",", "134"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "38"}], ",", "118"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"101", ",", "228"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "None"}]}], "]"}], ",", 
         RowBox[{"RasterSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", "finalProjection", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "200"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "50"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.670577037602235*^9, 3.6705770820718327`*^9}, {
  3.670577172772563*^9, 
  3.670577173292027*^9}},ExpressionUUID->"c23f138c-8edb-4502-a4c9-\
415baa4556d8"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showNodesActivation", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showNodesActivation", "[", "\[IndentingNewLine]", 
   RowBox[{"t_", ",", "\[IndentingNewLine]", 
    RowBox[{"dt_:", "20"}], ",", "\[IndentingNewLine]", 
    RowBox[{"centroids_:", "pts2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "maxZ", ",", "minZ", ",", "stdCentroids", ",", "n", ",", 
      "finalProjection", ",", "transferFunction"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "\"\<1234\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"stdCentroids", " ", "=", " ", 
      RowBox[{"dataTransform", "/@", "centroids"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"maxZ", ",", " ", "minZ"}], "}"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Graphics3D", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"GrayLevel", "[", 
                   RowBox[{"0.5", "+", 
                    RowBox[{"0.2", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"maxZ", "-", "minZ"}], ")"}]}], ")"}]}], 
                    ")"}]}]}], "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{"#", ",", "1"}], "]"}]}], "}"}], "&"}], "/@", 
               RowBox[{"(", "stdCentroids", ")"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"ColorData", "[", 
                   RowBox[{"\"\<SolarColors\>\"", ",", "0.94"}], "]"}], ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"onsetAP", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "-", "t"}], "]"}], 
                    "\[LessEqual]", "dt"}], ",", 
                    RowBox[{"Opacity", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"Clip", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"res", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "[", 
                    RowBox[{"[", "t", "]"}], "]"}], "-", "0.1"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0.1"}], "}"}]}], "]"}], "/", "0.1"}]}],
                     "]"}], ",", 
                    RowBox[{"Opacity", "[", "0", "]"}]}], "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{
                    RowBox[{"stdCentroids", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", "3"}], "]"}]}], 
                 "}"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "stdCentroids", "]"}], "]"}], ")"}]}],
               "]"}]}], "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", 
           ",", 
           RowBox[{"Lighting", "->", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"ViewPoint", "\[Rule]", "Top"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "85"}], ",", "134"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "38"}], ",", "118"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"101", ",", "228"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "None"}]}], "]"}], ",", 
         RowBox[{"RasterSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"finalProjection", ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Graphics", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"ColorData", "[", 
                  RowBox[{"97", ",", "1"}], "]"}], ",", 
                 RowBox[{"Annulus", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0.8", ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"2", "Pi", " ", 
                    RowBox[{"t", "/", "207"}]}]}], "}"}]}], "]"}], ",", 
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"PaddedForm", "[", 
                    RowBox[{
                    RowBox[{"2.5", 
                    RowBox[{"(", 
                    RowBox[{"t", "-", "1"}], ")"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "1"}], "}"}], ",", 
                    RowBox[{"NumberPadding", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\>\"", ",", "\"\<0\>\""}], "}"}]}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "0.1"}]}], "}"}]}], "]"}], ",", "12", ",", 
                   RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
                  "]"}]}], "}"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}]}], "}"}]}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "80"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"120", ",", "120"}], "}"}]}], "]"}], "}"}], "]"}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "200"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "50"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.670228950569273*^9, 3.67022898640732*^9}, {
   3.670229056833683*^9, 3.670229094772396*^9}, {3.670229149136731*^9, 
   3.670229156497582*^9}, {3.670229187267654*^9, 3.67022918791304*^9}, {
   3.670229308770278*^9, 3.6702293109263906`*^9}, {3.67022934228942*^9, 
   3.670229362764471*^9}, {3.6702294011189833`*^9, 3.670229401162406*^9}, {
   3.670230165455474*^9, 3.670230316080367*^9}, {3.670230346157982*^9, 
   3.6702303619248257`*^9}, {3.670230399857809*^9, 3.670230423922172*^9}, {
   3.67023047052139*^9, 3.670230493406858*^9}, {3.670230542221409*^9, 
   3.670230579797349*^9}, {3.670230628515089*^9, 3.6702306319164457`*^9}, {
   3.6702306799897833`*^9, 3.6702306845619593`*^9}, 3.670230851301062*^9, {
   3.670230882073017*^9, 3.670230935537386*^9}, {3.670231403952125*^9, 
   3.670231469921949*^9}, {3.670231534178928*^9, 3.6702315496459227`*^9}, {
   3.6702318121695633`*^9, 3.670231814206272*^9}, {3.67023184742906*^9, 
   3.670231879609311*^9}, {3.670231918662765*^9, 3.670231924296708*^9}, 
   3.670232054366424*^9, 3.670232096314803*^9, 3.670232140585349*^9, {
   3.670307492857266*^9, 3.67030750892975*^9}, {3.67030753901551*^9, 
   3.67030754573792*^9}, {3.670307628463193*^9, 3.6703077139495068`*^9}, {
   3.6703077684097767`*^9, 3.670307814369773*^9}, {3.670308242737397*^9, 
   3.670308243099165*^9}},ExpressionUUID->"83e9e95d-27ba-4ddc-92bc-\
ee6ee36189f3"],

Cell[BoxData[
 RowBox[{"showNodesActivation", "[", "40", "]"}]], "Input",
 CellChangeTimes->{{3.67022915894302*^9, 3.670229166640956*^9}, {
  3.670229197865447*^9, 3.670229216407112*^9}, {3.670229279487547*^9, 
  3.670229279837199*^9}, {3.6702293166218367`*^9, 3.670229329451868*^9}, {
  3.6702293722349453`*^9, 3.6702293822823153`*^9}, {3.670230587461276*^9, 
  3.670230591777742*^9}, {3.670230911970964*^9, 3.6702309647512283`*^9}, {
  3.6702315073981457`*^9, 3.670231569987254*^9}, {3.670231937657378*^9, 
  3.670231949310602*^9}, {3.6702321562006683`*^9, 
  3.670232161551962*^9}},ExpressionUUID->"ec965732-1c28-4102-a3ed-\
8fbde2bf7b45"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-3/\
part-1/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"t", ",", "10", ",", "4"}], "]"}], "<>", "\"\<.png\>\""}], 
      ",", 
      RowBox[{"showNodesActivation", "[", "t", "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "207", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6702295980277367`*^9, 3.670229652304862*^9}, {
  3.67024154997503*^9, 3.6702415754301643`*^9}, {3.670258079584731*^9, 
  3.670258087845747*^9}},ExpressionUUID->"6a9c76b1-518c-4321-aae2-\
a2237d0ad4af"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-3/\
part-1/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{
         RowBox[{"t", "+", "207"}], ",", "10", ",", "4"}], "]"}], "<>", 
       "\"\<.png\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{"Import", "[", 
       RowBox[{
       "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-3/\
part-1/\>\"", "<>", 
        RowBox[{"IntegerString", "[", 
         RowBox[{"t", ",", "10", ",", "4"}], "]"}], "<>", "\"\<.png\>\""}], 
       "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "207", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6706869582976303`*^9, 
  3.6706869881035767`*^9}},ExpressionUUID->"d4fe94e7-bd00-4ea0-be23-\
ffbe10ee23cd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-3/\
part-1/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{
         RowBox[{"t", "+", "207", "+", "207"}], ",", "10", ",", "4"}], "]"}], 
       "<>", "\"\<.png\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{"Import", "[", 
       RowBox[{
       "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-3/\
part-1/\>\"", "<>", 
        RowBox[{"IntegerString", "[", 
         RowBox[{"t", ",", "10", ",", "4"}], "]"}], "<>", "\"\<.png\>\""}], 
       "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", 
      RowBox[{"207", "+", "207"}], ",", "1"}], "}"}]}], "]"}], ";"}]], "Input",\

 CellChangeTimes->{{3.67068707407672*^9, 
  3.6706870799079227`*^9}},ExpressionUUID->"4b60bf37-95e1-4ecd-9f37-\
fa9e5b553320"]
}, Open  ]],

Cell[CellGroupData[{

Cell["part 2", "Subsubsection",
 CellChangeTimes->{{3.670241828333707*^9, 
  3.670241830414549*^9}},ExpressionUUID->"19a76ecb-5163-4d9b-8ddb-\
d10e4108e4f6"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showNodesAndNEdges", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showNodesAndNEdges", "[", "\[IndentingNewLine]", 
   RowBox[{"n_", ",", "\[IndentingNewLine]", 
    RowBox[{"centroids_:", "pts2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}], ",", "\[IndentingNewLine]", 
    RowBox[{"edges_:", "myEdges"}]}], "\[IndentingNewLine]", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "maxZ", ",", "minZ", ",", "stdCentroids", ",", "finalProjection", ",", 
      "transferFunction"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "\"\<1234\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"stdCentroids", " ", "=", " ", 
      RowBox[{"dataTransform", "/@", "centroids"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"maxZ", ",", " ", "minZ"}], "}"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Graphics3D", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Gray", ",", 
                  RowBox[{"Specularity", "[", "0.", "]"}], ",", 
                  RowBox[{"GrayLevel", "[", 
                   RowBox[{"0.5", "+", 
                    RowBox[{"0.2", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"maxZ", "-", "minZ"}], ")"}]}], ")"}]}], 
                    ")"}]}]}], "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{"#", ",", "1"}], "]"}]}], "}"}], "&"}], "/@", 
               RowBox[{"(", "stdCentroids", ")"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"GrayLevel", "[", 
                   RowBox[{"0.5", "+", 
                    RowBox[{"0.2", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"stdCentroids", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"maxZ", "-", "minZ"}], ")"}]}], ")"}]}], 
                    ")"}]}]}], "]"}], ",", 
                  RowBox[{"Tube", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"stdCentroids", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"stdCentroids", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}], 
                    ",", "0.25"}], "]"}]}], "}"}], "&"}], "/@", 
               RowBox[{"Take", "[", 
                RowBox[{"edges", ",", "n"}], "]"}]}], "]"}]}], "}"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"Lighting", "->", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"ViewPoint", "\[Rule]", "Top"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "85"}], ",", "134"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "38"}], ",", "118"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"101", ",", "228"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "None"}]}], "]"}], ",", 
         RowBox[{"RasterSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", "finalProjection", "}"}], ",", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "200"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "50"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.670228077388611*^9, 3.670228132954935*^9}, {
   3.670228375745685*^9, 3.670228411915131*^9}, {3.670228445537074*^9, 
   3.670228483459071*^9}, {3.670228590697063*^9, 3.670228600085656*^9}, {
   3.6702286406310663`*^9, 3.670228652145726*^9}, {3.67022868351131*^9, 
   3.6702287234480247`*^9}, {3.670229367072443*^9, 3.670229369988366*^9}, 
   3.670307425722949*^9, {3.670307843246273*^9, 
   3.670307844311747*^9}},ExpressionUUID->"a0fad517-bd14-4727-9198-\
3870a0e924a7"],

Cell[BoxData[
 RowBox[{"showNodesAndNEdges", "[", "1200", "]"}]], "Input",
 CellChangeTimes->{{3.670228473622711*^9, 3.670228477710795*^9}, {
  3.670228606386951*^9, 
  3.670228628945737*^9}},ExpressionUUID->"595bce4f-7e75-4488-891e-\
8122df59153c"],

Cell[BoxData[
 RowBox[{"Length", "[", "myEdges", "]"}]], "Input",
 CellChangeTimes->{{3.6702416157846127`*^9, 
  3.670241621118741*^9}},ExpressionUUID->"472f848f-ad80-4e64-907a-\
3799b9b045df"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-3/\
part-2/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{
         RowBox[{"t", "+", "207"}], ",", "10", ",", "4"}], "]"}], "<>", 
       "\"\<.png\>\""}], ",", 
      RowBox[{"showNodesAndNEdges", "[", 
       RowBox[{"t", "*", "10"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "134", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670241594678389*^9, 3.6702416081611977`*^9}, {
  3.670241645957604*^9, 3.670241647004771*^9}, {3.670241762474422*^9, 
  3.670241766968235*^9}, {3.670258105542266*^9, 
  3.6702581077546167`*^9}},ExpressionUUID->"628984ae-313c-44a5-b452-\
cbc1afb13d74"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showGraphActivation", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showGraphActivation", "[", "\[IndentingNewLine]", 
   RowBox[{"t_", ",", "\[IndentingNewLine]", 
    RowBox[{"dt_:", "20"}], ",", "\[IndentingNewLine]", 
    RowBox[{"centroids_:", "pts2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}], ",", "\[IndentingNewLine]", 
    RowBox[{"edges_:", "myEdges"}]}], "\[IndentingNewLine]", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "maxZ", ",", "minZ", ",", "stdCentroids", ",", "finalProjection", ",", 
      "transferFunction"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "\"\<1234\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"stdCentroids", " ", "=", " ", 
      RowBox[{"dataTransform", "/@", "centroids"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"maxZ", ",", " ", "minZ"}], "}"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Graphics3D", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"GrayLevel", "[", 
                   RowBox[{"0.5", "+", 
                    RowBox[{"0.2", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"maxZ", "-", "minZ"}], ")"}]}], ")"}]}], 
                    ")"}]}]}], "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{"#", ",", "1"}], "]"}]}], "}"}], "&"}], "/@", 
               RowBox[{"(", "stdCentroids", ")"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"ColorData", "[", 
                   RowBox[{"\"\<SolarColors\>\"", ",", "0.94"}], "]"}], ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"onsetAP", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "-", "t"}], "]"}], 
                    "\[LessEqual]", "dt"}], ",", 
                    RowBox[{"Opacity", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"Clip", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"res", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "[", 
                    RowBox[{"[", "t", "]"}], "]"}], "-", "0.1"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0.1"}], "}"}]}], "]"}], "/", "0.1"}]}],
                     "]"}], ",", 
                    RowBox[{"Opacity", "[", "0", "]"}]}], "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{
                    RowBox[{"stdCentroids", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", "3"}], "]"}]}], 
                 "}"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "stdCentroids", "]"}], "]"}], ")"}]}],
               "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"GrayLevel", "[", 
                   RowBox[{"0.5", "+", 
                    RowBox[{"0.2", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"stdCentroids", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"maxZ", "-", "minZ"}], ")"}]}], ")"}]}], 
                    ")"}]}]}], "]"}], ",", 
                  RowBox[{"Tube", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"stdCentroids", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"stdCentroids", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}], 
                    ",", "0.25"}], "]"}]}], "}"}], "&"}], "/@", "edges"}], 
              "]"}]}], "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", 
           ",", 
           RowBox[{"Lighting", "->", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"ViewPoint", "\[Rule]", "Top"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "85"}], ",", "134"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "38"}], ",", "118"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"101", ",", "228"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "None"}]}], "]"}], ",", 
         RowBox[{"RasterSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"finalProjection", ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Graphics", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"ColorData", "[", 
                  RowBox[{"97", ",", "1"}], "]"}], ",", 
                 RowBox[{"Annulus", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0.8", ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"2", "Pi", " ", 
                    RowBox[{"t", "/", "207"}]}]}], "}"}]}], "]"}], ",", 
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"PaddedForm", "[", 
                    RowBox[{
                    RowBox[{"2.5", 
                    RowBox[{"(", 
                    RowBox[{"t", "-", "1"}], ")"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "1"}], "}"}], ",", 
                    RowBox[{"NumberPadding", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\>\"", ",", "\"\<0\>\""}], "}"}]}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "0.1"}]}], "}"}]}], "]"}], ",", "12", ",", 
                   RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
                  "]"}]}], "}"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}]}], "}"}]}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "80"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"120", ",", "120"}], "}"}]}], "]"}], "}"}], "]"}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "200"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "50"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.6702419004470673`*^9, 3.670241911940661*^9}, {
   3.6702419462806873`*^9, 3.670242011962625*^9}, {3.670242050382998*^9, 
   3.670242057585606*^9}, 3.670242093430608*^9, 3.6703073218719673`*^9, 
   3.670307446600737*^9, {3.670307861072434*^9, 3.670307879270604*^9}, {
   3.670307914469616*^9, 3.67030793448628*^9}, {3.6703082203936253`*^9, 
   3.670308230347044*^9}},ExpressionUUID->"8ab3faf6-704a-4d97-a1c4-\
b07d7659c120"],

Cell[BoxData[
 RowBox[{"showGraphActivation", "[", "102", "]"}]], "Input",
 CellChangeTimes->{{3.670242017712137*^9, 3.670242025407577*^9}, {
  3.670307902710285*^9, 
  3.670307904580365*^9}},ExpressionUUID->"bc29e71f-e8d0-4da1-afda-\
9906650bb9c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-3/\
part-2/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{
         RowBox[{"t", "+", "207", "+", "134"}], ",", "10", ",", "4"}], "]"}], 
       "<>", "\"\<.png\>\""}], ",", 
      RowBox[{"showGraphActivation", "[", "t", "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "207", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670242131886764*^9, 3.670242158427297*^9}, {
  3.670258146222557*^9, 
  3.670258148477076*^9}},ExpressionUUID->"d15122a6-35f2-404c-a741-\
f350923a0ee6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dspeeds", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"estimateDiscreteWaveSpeedAtCell", "[", 
      RowBox[{"i", ",", "2", ",", "0"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "cells", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"79d20d02-438a-4fa1-bf4b-d6ad5a1e1776"],

Cell[BoxData[{
 RowBox[{"maxSpeed", "=", 
  RowBox[{"Quantile", "[", 
   RowBox[{"dspeeds", ",", "0.95"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"minSpeed", "=", 
  RowBox[{"Quantile", "[", 
   RowBox[{"dspeeds", ",", "0.05"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6702423293660097`*^9, 
  3.67024238109302*^9}},ExpressionUUID->"bfff942f-7f46-4daf-ab45-\
432ab7d75fc3"],

Cell[BoxData[
 RowBox[{"colorscale", "=", 
  RowBox[{"Image", "[", 
   RowBox[{"MatrixPlot", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ConstantArray", "[", 
         RowBox[{"i", ",", "4"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "1", ",", "0.01"}], "}"}]}], "]"}], 
      "]"}], ",", 
     RowBox[{"ColorFunction", "\[Rule]", "brewerDiv"}], ",", 
     RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
     RowBox[{"Axes", "\[Rule]", "False"}], ",", 
     RowBox[{"Frame", "\[Rule]", "False"}], ",", 
     RowBox[{"PlotRangePadding", "\[Rule]", "None"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.670773826177229*^9, 3.670774005951931*^9}, {
  3.670774180931897*^9, 
  3.670774209537972*^9}},ExpressionUUID->"ff8c258f-0580-46d1-911f-\
c8d4fd3db3e6"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showGraphActivationSpeedMap", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showGraphActivationSpeedMap", "[", "\[IndentingNewLine]", 
   RowBox[{"t_", ",", "\[IndentingNewLine]", 
    RowBox[{"dt_:", "20"}], ",", "\[IndentingNewLine]", 
    RowBox[{"centroids_:", "pts2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}], ",", "\[IndentingNewLine]", 
    RowBox[{"edges_:", "myEdges"}]}], "\[IndentingNewLine]", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "maxZ", ",", "minZ", ",", "stdCentroids", ",", "finalProjection", ",", 
      "transferFunction"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "\"\<1234\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"stdCentroids", " ", "=", " ", 
      RowBox[{"dataTransform", "/@", "centroids"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"maxZ", ",", " ", "minZ"}], "}"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Graphics3D", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"onsetAP", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"t", "-", "5"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"brewerDiv", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"dspeeds", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "-", "minDelay"}], ")"}], 
                    "/", 
                    RowBox[{"(", 
                    RowBox[{"maxDelay", "-", "minDelay"}], ")"}]}], "]"}], 
                    ",", 
                    RowBox[{"Sphere", "[", 
                    RowBox[{
                    RowBox[{"stdCentroids", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", "2.9"}], "]"}]}], 
                    "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"GrayLevel", "[", 
                    RowBox[{"0.5", "+", 
                    RowBox[{"0.2", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"stdCentroids", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"maxZ", "-", "minZ"}], ")"}]}], ")"}]}], 
                    ")"}]}]}], "]"}], ",", 
                    RowBox[{"Sphere", "[", 
                    RowBox[{
                    RowBox[{"stdCentroids", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", "1"}], "]"}]}], 
                    "}"}]}], "]"}], "}"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "stdCentroids", "]"}], "]"}], ")"}]}],
               "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"ColorData", "[", 
                   RowBox[{"\"\<SolarColors\>\"", ",", "0.94"}], "]"}], ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"onsetAP", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "-", "t"}], "]"}], 
                    "\[LessEqual]", "dt"}], ",", 
                    RowBox[{"Opacity", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"Clip", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"res", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "[", 
                    RowBox[{"[", "t", "]"}], "]"}], "-", "0.1"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0.1"}], "}"}]}], "]"}], "/", "0.1"}]}],
                     "]"}], ",", 
                    RowBox[{"Opacity", "[", "0", "]"}]}], "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{
                    RowBox[{"stdCentroids", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", "3"}], "]"}]}], 
                 "}"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "stdCentroids", "]"}], "]"}], ")"}]}],
               "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"GrayLevel", "[", 
                   RowBox[{"0.5", "+", 
                    RowBox[{"0.2", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"stdCentroids", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"maxZ", "-", "minZ"}], ")"}]}], ")"}]}], 
                    ")"}]}]}], "]"}], ",", 
                  RowBox[{"Tube", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"stdCentroids", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"stdCentroids", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}], 
                    ",", "0.25"}], "]"}]}], "}"}], "&"}], "/@", "edges"}], 
              "]"}]}], "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", 
           ",", 
           RowBox[{"Lighting", "->", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"ViewPoint", "\[Rule]", "Top"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "85"}], ",", "134"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "38"}], ",", "118"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"101", ",", "228"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "None"}]}], "]"}], ",", 
         RowBox[{"RasterSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"finalProjection", ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Graphics", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"ColorData", "[", 
                  RowBox[{"97", ",", "1"}], "]"}], ",", 
                 RowBox[{"Annulus", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0.8", ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"2", "Pi", " ", 
                    RowBox[{"t", "/", "207"}]}]}], "}"}]}], "]"}], ",", 
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"PaddedForm", "[", 
                    RowBox[{
                    RowBox[{"2.5", 
                    RowBox[{"(", 
                    RowBox[{"t", "-", "1"}], ")"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "1"}], "}"}], ",", 
                    RowBox[{"NumberPadding", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\>\"", ",", "\"\<0\>\""}], "}"}]}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "0.1"}]}], "}"}]}], "]"}], ",", "12", ",", 
                   RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
                  "]"}]}], "}"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}]}], "}"}]}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "80"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"120", ",", "120"}], "}"}]}], "]"}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Graphics", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Inset", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Show", "[", 
               RowBox[{
                RowBox[{"{", "colorscale", "}"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "80"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"120", ",", "50"}], "}"}]}], "]"}], ",", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<min\>\"", ",", "10", ",", 
                RowBox[{"GrayLevel", "[", "0.3", "]"}], ",", 
                RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
               "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"80", ",", "30"}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<max\>\"", ",", "10", ",", 
                RowBox[{"GrayLevel", "[", "0.3", "]"}], ",", 
                RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
               "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"160", ",", "30"}], "}"}]}], "]"}]}], "}"}], "]"}]}], 
        "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "200"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "50"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.670242135412122*^9, 3.670242147491954*^9}, {
  3.6702421885183897`*^9, 3.670242320201766*^9}, {3.670242387030748*^9, 
  3.670242405020561*^9}, {3.67030574623412*^9, 3.6703057549281807`*^9}, {
  3.670305797520784*^9, 3.670305797617805*^9}, {3.670307987868079*^9, 
  3.670308025890815*^9}, {3.670308067442627*^9, 3.670308128311228*^9}, {
  3.6703081636519403`*^9, 3.67030820282119*^9}, {3.670308257881425*^9, 
  3.670308258090385*^9}, {3.6703083090873213`*^9, 3.6703083299449663`*^9}, {
  3.6703083623103943`*^9, 3.670308362520217*^9}, {3.67077471785614*^9, 
  3.670774721420907*^9}, {3.67077475357498*^9, 3.6707747712693233`*^9}, {
  3.670774802156836*^9, 
  3.670774812177799*^9}},ExpressionUUID->"951e2095-652f-47d3-bb09-\
8b1dc1ad809e"],

Cell[BoxData[
 RowBox[{"showGraphActivationSpeedMap", "[", "84", "]"}]], "Input",
 CellChangeTimes->{{3.6702424075074873`*^9, 3.67024244698629*^9}, {
  3.670305770657569*^9, 3.670305811454967*^9}, {3.6703083317107353`*^9, 
  3.6703083690770273`*^9}},ExpressionUUID->"343c28dd-5037-4402-978b-\
003194acb4d3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-3/\
part-2/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{
         RowBox[{"t", "+", "207", "+", "134", "+", "207"}], ",", "10", ",", 
         "4"}], "]"}], "<>", "\"\<.png\>\""}], ",", 
      RowBox[{"showGraphActivationSpeedMap", "[", "t", "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "207", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670305841912134*^9, 
  3.670305847726589*^9}},ExpressionUUID->"41fee0c2-73ed-40ec-94d1-\
2bf42cc1aa33"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.67030983083351*^9, 3.670309835389791*^9}, 
   3.670310005225306*^9},ExpressionUUID->"87daf923-a7a9-4cdb-895f-\
6ff0627d2289"]
}, Open  ]],

Cell[CellGroupData[{

Cell["part 3", "Subsubsection",
 CellChangeTimes->{{3.670241853214517*^9, 
  3.670241854868787*^9}},ExpressionUUID->"85f5befe-f91d-47a0-bc62-\
59d962285877"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xmin", ",", "xmax"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ymin", ",", "ymax"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"zmin", ",", "zmax"}], "}"}]}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Min", "[", "#", "]"}], ",", 
       RowBox[{"Max", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
    RowBox[{"Transpose", "[", "pts2", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ctrlPts", "=", 
   RowBox[{"Import", "[", "mline", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"xi", ",", "yi", ",", "zi"}], "}"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"BSplineFunction", "[", 
       RowBox[{"#", ",", 
        RowBox[{"SplineDegree", "\[Rule]", "4"}]}], "]"}], "&"}], "/@", 
     RowBox[{"Transpose", "[", "ctrlPts", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "s", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s", "[", "x_", "]"}], ":=", 
  RowBox[{"NIntegrate", "[", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xi", "'"}], "[", "t0", "]"}], ")"}], "^", "2"}], " ", "+", 
      " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"yi", "'"}], "[", "t0", "]"}], ")"}], "^", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"zi", "'"}], "[", "t0", "]"}], ")"}], "^", "2"}]}], "]"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"t0", ",", "0", ",", "x"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.657264228489072*^9, 3.657264262224662*^9}, 
   3.6584837573919783`*^9, {3.670306966055604*^9, 
   3.6703069825459642`*^9}},ExpressionUUID->"911f8448-54c5-4ac7-86e6-\
3de7ee6e3b3f"],

Cell[BoxData[
 RowBox[{"smin", "=", 
  RowBox[{"s", "[", "0", "]"}]}]], "Input",
 CellChangeTimes->{{3.657532910691523*^9, 
  3.657532913820859*^9}},ExpressionUUID->"8b1bf90c-f56a-4ce0-b95f-\
48a040f1607f"],

Cell[BoxData[
 RowBox[{"smax", " ", "=", " ", 
  RowBox[{
   RowBox[{"s", "[", "1.", "]"}], "-", "0.001"}]}]], "Input",
 CellChangeTimes->{{3.657532915647379*^9, 3.6575329184857597`*^9}, 
   3.6581423917168913`*^9, {3.658142551112506*^9, 
   3.6581425537602367`*^9}},ExpressionUUID->"b2df2be4-962b-4a36-a73e-\
527d1e470fe0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ipol", "=", 
   RowBox[{"ListInterpolation", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "t", "}"}], ",", 
        RowBox[{"s", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "0", ",", "1", ",", "0.05"}], "}"}]}], "]"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.657345818128326*^9, 3.657345841485382*^9}, {
   3.6573459420897284`*^9, 3.657345965124411*^9}, {3.657346041760828*^9, 
   3.657346060879562*^9}, 
   3.657532791982586*^9},ExpressionUUID->"e7c26c01-a89a-4f47-997a-\
d9923119bb77"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "t", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", "[", "s_", "]"}], ":=", 
  RowBox[{
   RowBox[{"InverseFunction", "[", "ipol", "]"}], "[", "s", "]"}]}]}], "Input",\

 CellChangeTimes->{{3.6573460636659203`*^9, 3.657346093806614*^9}, {
  3.6581419849927588`*^9, 
  3.65814198774489*^9}},ExpressionUUID->"6288ba70-566b-440e-9ace-\
a8887bd79b96"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "xint", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xint", "[", "s_", "]"}], ":=", 
  RowBox[{"Chop", "[", 
   RowBox[{"xi", "[", 
    RowBox[{"t", "[", 
     RowBox[{"s", "*", "smax"}], "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "yint", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yint", "[", "s_", "]"}], ":=", 
  RowBox[{"Chop", "[", 
   RowBox[{"yi", "[", 
    RowBox[{"t", "[", 
     RowBox[{"s", "*", "smax"}], "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "zint", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zint", "[", "s_", "]"}], ":=", 
  RowBox[{"Chop", "[", 
   RowBox[{"zi", "[", 
    RowBox[{"t", "[", 
     RowBox[{"s", "*", "smax"}], "]"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.657532795491921*^9, 3.657532846916621*^9}, {
  3.657532985285966*^9, 3.657532987001934*^9}, {3.657533020441791*^9, 
  3.65753303592013*^9}, {3.6575330948184137`*^9, 
  3.657533124107502*^9}},ExpressionUUID->"5e57f71b-ce4d-4a4e-9230-\
dc5d5e4b086b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"xint2", "=", 
   RowBox[{"BSplineFunction", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"xint", "[", "s", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"s", ",", "0", ",", "1", ",", "0.01"}], "}"}]}], "]"}], ",", 
     RowBox[{"SplineDegree", "\[Rule]", "4"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yint2", "=", 
   RowBox[{"BSplineFunction", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"yint", "[", "s", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"s", ",", "0", ",", "1", ",", "0.01"}], "}"}]}], "]"}], ",", 
     RowBox[{"SplineDegree", "\[Rule]", "4"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zint2", "=", 
   RowBox[{"BSplineFunction", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"zint", "[", "s", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"s", ",", "0", ",", "1", ",", "0.01"}], "}"}]}], "]"}], ",", 
     RowBox[{"SplineDegree", "\[Rule]", "4"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.657532739823515*^9, 3.657532743770092*^9}, {
  3.657533352078638*^9, 3.657533424513402*^9}, {3.657533528780498*^9, 
  3.657533595790003*^9}, {3.657534103983925*^9, 
  3.657534105958561*^9}},ExpressionUUID->"6b7a56de-7ea5-4950-b5b6-\
22e6f6c6c19c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"midline", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xint2", "[", "t", "]"}], ",", 
       RowBox[{"yint2", "[", "t", "]"}], ",", 
       RowBox[{"zint2", "[", "t", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "1", ",", "0.01"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670310021881441*^9, 
  3.6703100585097523`*^9}},ExpressionUUID->"7f9aca3b-02ff-4334-a7b9-\
e85dc2a265fd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"straightenedLine", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"First", "[", "midline", "]"}], "+", 
      RowBox[{"t", 
       RowBox[{"(", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Last", "[", "midline", "]"}], "-", 
          RowBox[{"First", "[", "midline", "]"}]}], ")"}], ")"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "1", ",", "0.01"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6703101602580357`*^9, 3.6703102488901377`*^9}, {
  3.670310300588932*^9, 3.6703103771708117`*^9}, {3.670310424888227*^9, 
  3.670310439769334*^9}},ExpressionUUID->"0c0cc2b4-7d5e-4212-b956-\
52bbe665c8e4"],

Cell[BoxData[{
 RowBox[{"meanY", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"Mean", " ", "@", 
     RowBox[{"(", 
      RowBox[{"transformToStandardView", "/@", "pts2"}], ")"}]}], ")"}], "[", 
   
   RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"meanZ", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"Mean", " ", "@", 
     RowBox[{"(", 
      RowBox[{"transformToStandardView", "/@", "pts2"}], ")"}]}], ")"}], "[", 
   
   RowBox[{"[", "3", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"minX", ",", "maxX"}], "}"}], "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Min", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"transformToStandardView", "/@", "pts2"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
    RowBox[{"Max", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"transformToStandardView", "/@", "pts2"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.670568864384687*^9, 3.6705689791244173`*^9}, {
  3.670569018469366*^9, 
  3.67056904520255*^9}},ExpressionUUID->"8492c084-ab5d-4473-93b5-\
42b15ba01ec1"],

Cell[BoxData[
 RowBox[{"invT", "=", 
  RowBox[{"Inverse", "[", 
   RowBox[{"Most", "/@", 
    RowBox[{"Most", "[", 
     RowBox[{"TransformationMatrix", "[", "stdTransform", "]"}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.670576286326392*^9, 3.6705763038802757`*^9}, {
  3.670576520865547*^9, 
  3.670576525440954*^9}},ExpressionUUID->"0bee6b30-2f18-4dcc-8232-\
2451c3fb9a3e"],

Cell[BoxData[
 RowBox[{"direction", "=", 
  RowBox[{"invT", ".", 
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"maxX", ",", "meanY", ",", "meanZ"}], "}"}], "-", 
      RowBox[{"{", 
       RowBox[{"minX", ",", "meanY", ",", "meanZ"}], "}"}]}], 
     ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6705764367076197`*^9, 3.670576491707786*^9}, {
  3.670576530647499*^9, 3.67057653903916*^9}, {3.6705768498616037`*^9, 
  3.6705768936220903`*^9}},ExpressionUUID->"f5b38709-e285-430c-b7d7-\
88b5af56f94e"],

Cell[BoxData[
 RowBox[{"start", "=", 
  RowBox[{"invT", ".", 
   RowBox[{"{", 
    RowBox[{"maxX", ",", "meanY", ",", "meanZ"}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.6705765411502438`*^9, 3.670576550729751*^9}, {
  3.670576904156537*^9, 
  3.670576905227605*^9}},ExpressionUUID->"2a13c90f-7111-47c5-98b1-\
f912f7a75d1e"],

Cell[BoxData[
 RowBox[{"Graphics3D", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Point", "/@", 
      RowBox[{"(", 
       RowBox[{"transformToStandardView", "/@", "pts2"}], ")"}]}], ",", 
     RowBox[{"Arrow", "[", 
      RowBox[{"transformToStandardView", "/@", 
       RowBox[{"{", 
        RowBox[{"start", ",", 
         RowBox[{"start", "+", "direction"}]}], "}"}]}], "]"}]}], "}"}], ",", 
   
   RowBox[{"ViewPoint", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "Infinity"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.670576340178465*^9, 3.6705764157773123`*^9}, {
  3.670576565226345*^9, 3.6705765863871527`*^9}, {3.6705768652126017`*^9, 
  3.67057686631107*^9}},ExpressionUUID->"8dc3464b-80e6-4246-9f16-\
1e419fdef1b5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"straightenedLine", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"start", "+", 
      RowBox[{"t", " ", "direction"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "1", ",", "0.01"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670568397543148*^9, 3.670568431741837*^9}, {
   3.670568754473185*^9, 3.670568769634334*^9}, {3.670569013275419*^9, 
   3.670569071602146*^9}, {3.670576602131784*^9, 3.670576624305841*^9}, 
   3.670576799509507*^9, {3.670576913064521*^9, 
   3.670576914555496*^9}},ExpressionUUID->"d7e02a02-cf13-48b7-930f-\
8b5c76e32a7c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"straightenedLine", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"First", "[", "midline", "]"}], "+", 
      RowBox[{"t", 
       RowBox[{"(", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Last", "[", "midline", "]"}], "-", 
          RowBox[{"First", "[", "midline", "]"}]}], ")"}], ")"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "1", ",", "0.01"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670683267037756*^9, 
  3.6706832872651987`*^9}},ExpressionUUID->"ec5d6abf-f6f2-49a7-b999-\
b1f6baa95e75"],

Cell[BoxData[
 RowBox[{"Length", "/@", 
  RowBox[{"{", 
   RowBox[{"midline", ",", "straightenedLine"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6703104477279167`*^9, 
  3.6703104542836523`*^9}},ExpressionUUID->"3223aee0-51a8-45ee-9d2f-\
5bb809203178"],

Cell[BoxData[
 RowBox[{
  RowBox[{"intermediateMidlines", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", "lambda", ")"}], "straightenedLine"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "lambda"}], ")"}], "midline"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"lambda", ",", "0", ",", "1", ",", "0.05"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.67031047083746*^9, 3.6703105168229733`*^9}, {
  3.670310662130438*^9, 3.6703107081448708`*^9}, {3.670310764021202*^9, 
  3.6703107839986362`*^9}, {3.6705777971510687`*^9, 
  3.670577797838842*^9}},ExpressionUUID->"d92b4079-9df7-4a70-b02b-\
fefd8c9d64c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"interpolatedMidlines", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"BSplineFunction", "[", 
      RowBox[{"#", ",", 
       RowBox[{"SplineDegree", "\[Rule]", "4"}]}], "]"}], "&"}], "/@", 
    "intermediateMidlines"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6703107865238247`*^9, 3.6703108076800528`*^9}, 
   3.670311149124642*^9},ExpressionUUID->"dbe0613d-6615-4f5c-ba45-\
4e708337eb69"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "getMovingFrame", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getMovingFrame", "[", "interpolatedLine_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "xint", ",", "yint", ",", "zint", ",", "kappa", ",", "tau", ",", "Ni", 
      ",", "Bi", ",", "Ti"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"xint", "=", 
      RowBox[{"BSplineFunction", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"interpolatedLine", "[", "s", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"s", ",", "0", ",", "1", ",", "0.01"}], "}"}]}], "]"}], 
        ",", 
        RowBox[{"SplineDegree", "\[Rule]", "4"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"yint", "=", 
      RowBox[{"BSplineFunction", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"interpolatedLine", "[", "s", "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"s", ",", "0", ",", "1", ",", "0.01"}], "}"}]}], "]"}], 
        ",", 
        RowBox[{"SplineDegree", "\[Rule]", "4"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"zint", "=", 
      RowBox[{"BSplineFunction", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"interpolatedLine", "[", "s", "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"s", ",", "0", ",", "1", ",", "0.01"}], "}"}]}], "]"}], 
        ",", 
        RowBox[{"SplineDegree", "\[Rule]", "4"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"kappa", ",", "tau"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Ti", ",", "Ni", ",", "Bi"}], "}"}]}], "}"}], " ", "=", 
      RowBox[{"FrenetSerretSystem", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"xint", "[", "t", "]"}], ",", 
          RowBox[{"yint", "[", "t", "]"}], ",", 
          RowBox[{"zint", "[", "t", "]"}]}], "}"}], ",", "t"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Ti", ",", "Ni", ",", "Bi"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"xint", ",", "yint", ",", "zint"}], "}"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.670311161869294*^9, 3.670311308574066*^9}, {
  3.6703114980775347`*^9, 3.670311502497424*^9}, {3.670567763862814*^9, 
  3.670567771235819*^9}, {3.670578349504897*^9, 
  3.6705783541663027`*^9}},ExpressionUUID->"b24834c6-0f9c-4827-bd7a-\
c3899212706d"],

Cell[BoxData[
 RowBox[{"Graphics3D", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{"transformToStandardView", "/@", "midline"}], "]"}], ",", "Red",
      ",", 
     RowBox[{"Line", "[", 
      RowBox[{"transformToStandardView", "/@", "straightenedLine"}], "]"}], 
     ",", "Green", ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Line", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", "lambda", ")"}], 
          RowBox[{"transformToStandardView", "/@", "straightenedLine"}]}], 
         "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "lambda"}], ")"}], 
          RowBox[{"transformToStandardView", "/@", "midline"}]}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"lambda", ",", "0.1", ",", "0.9", ",", "0.1"}], "}"}]}], 
      "]"}]}], "}"}], ",", 
   RowBox[{"ViewPoint", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "Infinity"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.670310060293558*^9, 3.670310121004026*^9}, {
  3.670310255824738*^9, 3.670310258099206*^9}, {3.670310389339546*^9, 
  3.6703103962992*^9}, {3.670310523520898*^9, 3.670310610340622*^9}, {
  3.67031064504414*^9, 3.670310645907138*^9}, {3.670568648577527*^9, 
  3.670568672097446*^9}, {3.670568703533202*^9, 3.670568735710125*^9}, {
  3.670576721491817*^9, 
  3.67057673402522*^9}},ExpressionUUID->"ed13947d-d360-4b87-8a59-\
a0887b07e7d1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Kappa]", ",", "\[Tau]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Ti", ",", "Ni", ",", "Bi"}], "}"}]}], "}"}], " ", "=", 
   RowBox[{"FrenetSerretSystem", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xint2", "[", "t", "]"}], ",", 
       RowBox[{"yint2", "[", "t", "]"}], ",", 
       RowBox[{"zint2", "[", "t", "]"}]}], "}"}], ",", "t"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.657533627637414*^9, 
  3.657533631436824*^9}},ExpressionUUID->"1cea2259-4ae8-4b90-bd5b-\
bd77095e8d97"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "projectPointToMidline", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"projectPointToMidline", "[", 
   RowBox[{"pt_", ",", 
    RowBox[{"xint_:", "xint2"}], ",", 
    RowBox[{"yint_:", "yint2"}], ",", 
    RowBox[{"zint_:", "zint2"}], ",", " ", 
    RowBox[{"frenetFrame_:", 
     RowBox[{"FrenetSerretSystem", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"xint2", "[", "t", "]"}], ",", 
         RowBox[{"yint2", "[", "t", "]"}], ",", 
         RowBox[{"zint2", "[", "t", "]"}]}], "}"}], ",", "t"}], "]"}]}]}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "pieces", ",", " ", "minDist", ",", " ", "minPar", ",", "minVec", ",", 
      "Ti", ",", "Ni", ",", "Bi", ",", "dv", ",", "\[Kappa]", ",", "\[Tau]", 
      ",", "vec", ",", "z", ",", "\[Rho]", ",", "\[Phi]"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"minDist", ",", " ", "minPar"}], "}"}], "=", 
      RowBox[{"NMinimize", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"EuclideanDistance", "[", 
           RowBox[{"pt", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xint", "[", "t", "]"}], ",", 
              RowBox[{"yint", "[", "t", "]"}], ",", 
              RowBox[{"zint", "[", "t", "]"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"0", "<", "t", "<", "1"}]}], "}"}], ",", "t"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"minDist", ",", "minPar"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{"minDist", ",", " ", 
        RowBox[{"t", "/.", "minPar"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"minVec", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"xint", "[", "minPar", "]"}], ",", 
        RowBox[{"yint", "[", "minPar", "]"}], ",", 
        RowBox[{"zint", "[", "minPar", "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Kappa]", ",", "\[Tau]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Ti", ",", "Ni", ",", "Bi"}], "}"}]}], "}"}], " ", "=", " ", 
      
      RowBox[{"frenetFrame", "/.", 
       RowBox[{"t", "\[Rule]", "minPar"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"vec", "=", 
      RowBox[{"pt", "-", "minVec"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Rho]", ",", "\[Phi]", ",", "z"}], "}"}], "=", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"ToPolarCoordinates", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"vec", ".", "Bi"}], ",", 
           RowBox[{"vec", ".", "Ni"}]}], "}"}], "]"}], ",", "minPar"}], 
       "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.6575325654682417`*^9, 3.657532607428583*^9}, {
  3.657532646290414*^9, 3.657532656411809*^9}, {3.657533635384447*^9, 
  3.657533648547943*^9}, {3.7179231010122747`*^9, 
  3.717923105146702*^9}},ExpressionUUID->"c38fd92d-a9e4-4b88-aa6c-\
f84c7fb8aa2d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ptsCylinder", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"projectPointToMidline", "[", 
      RowBox[{"#", ",", "xint2", ",", "yint2", ",", "zint2", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Kappa]", ",", "\[Tau]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Ti", ",", "Ni", ",", "Bi"}], "}"}]}], "}"}]}], "]"}], 
     "&"}], "/@", "pts2"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.657291360484021*^9, 3.6572913868855143`*^9}, {
  3.657291942495368*^9, 3.65729195739799*^9}, {3.6575419469868097`*^9, 
  3.6575419496444798`*^9}, {3.6610871437402153`*^9, 
  3.6610871449158382`*^9}},ExpressionUUID->"29f78d66-40b8-4125-8515-\
efdda3ffd83c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"minParameter", "=", 
   RowBox[{"Min", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Last", "[", "#", "]"}], "&"}], "/@", "ptsCylinder"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"maxParameter", "=", 
   RowBox[{"Max", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Last", "[", "#", "]"}], "&"}], "/@", "ptsCylinder"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.65848387882095*^9, 3.658483940543996*^9}, {
  3.658484394123461*^9, 3.65848443784943*^9}, {3.661087182193818*^9, 
  3.661087209472797*^9}},ExpressionUUID->"1030169f-4efc-418d-8204-\
82d1cdc5a679"],

Cell[BoxData[
 RowBox[{"smax", "=", 
  RowBox[{
   RowBox[{"s", "[", "1.0", "]"}], " ", "*", " ", 
   RowBox[{"(", 
    RowBox[{"maxParameter", "-", "minParameter"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.661087261351487*^9, 3.661087275094413*^9}, {
  3.661087347253866*^9, 
  3.661087349771925*^9}},ExpressionUUID->"432b0cf9-460e-4bbc-b0da-\
e2b456295886"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ptsCylinder", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "-", "minParameter"}], ")"}], "/", 
        
        RowBox[{"(", 
         RowBox[{"maxParameter", "-", "minParameter"}], ")"}]}]}], "}"}], 
     "&"}], "/@", "ptsCylinder"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.661087386022403*^9, 3.661087425813204*^9}, {
  3.6610874746178637`*^9, 3.661087476840064*^9}, {3.661087555102058*^9, 
  3.66108755659865*^9}},ExpressionUUID->"fb51decb-f9b9-4b6c-9b8f-\
75e204275415"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "projectBackFromMidline", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"projectBackFromMidline", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Rho]_", ",", "\[Phi]_", ",", "z_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"Ti_", ",", "Ni_", ",", "Bi_"}], "}"}], ",", 
    RowBox[{"xint_:", "xint2"}], ",", 
    RowBox[{"yint_:", "yint2"}], ",", 
    RowBox[{"zint_:", "zint2"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x0", ",", "n", ",", "b"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"x0", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"xint", "[", "z", "]"}], ",", 
        RowBox[{"yint", "[", "z", "]"}], ",", 
        RowBox[{"zint", "[", "z", "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"b", ",", "n"}], "}"}], "=", 
      RowBox[{"FromPolarCoordinates", "[", 
       RowBox[{"{", 
        RowBox[{"\[Rho]", ",", "\[Phi]"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"x0", "+", 
      RowBox[{"b", " ", 
       RowBox[{"(", 
        RowBox[{"Bi", "/.", 
         RowBox[{"t", "->", "z"}]}], ")"}]}], "+", 
      RowBox[{"n", " ", 
       RowBox[{"(", 
        RowBox[{"Ni", "/.", 
         RowBox[{"t", "->", "z"}]}], ")"}]}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.6705670417093153`*^9, 3.670567317283452*^9}, {
  3.670567426150058*^9, 3.670567437854035*^9}, {3.670567492690938*^9, 
  3.6705675030364437`*^9}, {3.670567538234458*^9, 
  3.670567565641444*^9}},ExpressionUUID->"46603b42-17ff-422c-b437-\
a6bdbbb69857"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "computeIntermediateHeartGeometry", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"computeIntermediateHeartGeometry", "[", 
   RowBox[{"midline_", ",", 
    RowBox[{"coords_:", "ptsCylinder"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "tangent", ",", "normal", ",", "binormal", ",", "xInter", ",", "yInter", 
      ",", "zInter", ",", "newPts"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"tangent", ",", "normal", ",", "binormal"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"xInter", ",", "yInter", ",", "zInter"}], "}"}]}], "}"}], 
      "=", 
      RowBox[{"getMovingFrame", "[", "midline", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"newPts", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"projectBackFromMidline", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{"tangent", ",", "normal", ",", "binormal"}], "}"}], ",", 
          "xInter", ",", "yInter", ",", "zInter"}], "]"}], "&"}], "/@", 
       "coords"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.670567930629661*^9, 
  3.670568033883307*^9}},ExpressionUUID->"bb68b33e-f88f-492b-91f4-\
d44433ba9ab3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"intermediatePts", "=", 
   RowBox[{
   "computeIntermediateHeartGeometry", "/@", "interpolatedMidlines"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6705681304323683`*^9, 
  3.6705681475521297`*^9}},ExpressionUUID->"e2900b91-d7e6-486c-9c26-\
ed424b87c4e8"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "cyl2cart", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cyl2cart", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Rho]_", ",", "\[Phi]_", ",", "z_"}], "}"}], ",", 
    RowBox[{"scale_:", "smax"}]}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "z"}], " ", "scale"}], ",", " ", 
    RowBox[{"\[Rho]", " ", 
     RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
    RowBox[{"\[Rho]", " ", 
     RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.657292352892045*^9, 3.657292413173862*^9}, {
  3.657292451179304*^9, 3.6572924842990522`*^9}, {3.6572925737699137`*^9, 
  3.657292578111039*^9}, {3.657292861435207*^9, 3.657292868167025*^9}, {
  3.6572935256862993`*^9, 3.657293550769112*^9}, {3.670584173751635*^9, 
  3.670584174336763*^9}},ExpressionUUID->"f540c9ad-fc6f-4d17-86b9-\
8716c6fd25d7"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showNodesAndMidline", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showNodesAndMidline", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tmax_:", "0"}], ",", 
    RowBox[{"centroids_:", "pts2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "maxZ", ",", "minZ", ",", "stdCentroids", ",", "n", ",", 
      "finalProjection", ",", "transferFunction", ",", "trails"}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "\"\<1234\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"stdCentroids", " ", "=", " ", 
      RowBox[{"dataTransform", "/@", "centroids"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"maxZ", ",", " ", "minZ"}], "}"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Graphics3D", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"AbsoluteThickness", "[", "5", "]"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"GrayLevel", "[", "0.3", "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"transformToStandardView", "/@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xint2", "[", "t", "]"}], ",", 
                    RowBox[{"yint2", "[", "t", "]"}], ",", 
                    RowBox[{"zint2", "[", "t", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xint2", "[", 
                    RowBox[{"t", "+", "0.01"}], "]"}], ",", 
                    RowBox[{"yint2", "[", 
                    RowBox[{"t", "+", "0.01"}], "]"}], ",", 
                    RowBox[{"zint2", "[", 
                    RowBox[{"t", "+", "0.01"}], "]"}]}], "}"}]}], "}"}]}], 
                    "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"t", ",", "minParameter", ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{"tmax", ",", 
                    RowBox[{"maxParameter", "-", "0.01"}]}], "]"}], ",", 
                    "0.01"}], "}"}]}], "]"}]}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Opacity", "[", "0.2", "]"}], ",", 
                  RowBox[{"GrayLevel", "[", 
                   RowBox[{"0.5", "+", 
                    RowBox[{"0.2", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"maxZ", "-", "minZ"}], ")"}]}], ")"}]}], 
                    ")"}]}]}], "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{"#", ",", "2.5"}], "]"}], ",", 
                  RowBox[{"Opacity", "[", "1", "]"}], ",", 
                  RowBox[{"GrayLevel", "[", "0.3", "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{"#", ",", "1"}], "]"}]}], "}"}], "&"}], "/@", 
               RowBox[{"(", "stdCentroids", ")"}]}], "]"}]}], 
            "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", 
           RowBox[{"Lighting", "->", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"ViewPoint", "\[Rule]", "Top"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "85"}], ",", "134"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "38"}], ",", "118"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"101", ",", "228"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "None"}]}], "]"}], ",", 
         RowBox[{"RasterSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", "finalProjection", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "200"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "50"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.670680102804528*^9, 3.67068012930226*^9}, 
   3.6706830191492243`*^9, {3.670683933500822*^9, 3.670683991334156*^9}, {
   3.670684027354344*^9, 3.670684044831604*^9}, {3.670685157207794*^9, 
   3.670685162685554*^9}},ExpressionUUID->"18cfdb2e-a73a-4733-8377-\
f0eca8d2fcfa"],

Cell[BoxData[
 RowBox[{"showNodesAndMidline", "[", "1", "]"}]], "Input",
 CellChangeTimes->{{3.670683866619974*^9, 3.670683874739737*^9}, {
   3.6706839272354717`*^9, 3.670683929048983*^9}, {3.670683999329176*^9, 
   3.670684013838654*^9}, 
   3.670685166243457*^9},ExpressionUUID->"50ce28fc-e3f7-4aef-823a-\
14ea53a6c1c1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-4/\
part-1/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"t", ",", "10", ",", "4"}], "]"}], "<>", "\"\<.png\>\""}], 
      ",", 
      RowBox[{"showNodesAndMidline", "[", 
       RowBox[{"t", "/", "100"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "100", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.67068513682563*^9, 3.670685184377162*^9}, {
  3.6706852160853043`*^9, 
  3.670685259159155*^9}},ExpressionUUID->"400a93eb-21df-4787-92b8-\
32c9f8a18014"],

Cell[BoxData[
 RowBox[{"myblue", "=", 
  InterpretationBox[
   ButtonBox[
    TooltipBox[
     GraphicsBox[{
       {GrayLevel[0], RectangleBox[{0, 0}]}, 
       {GrayLevel[0], RectangleBox[{1, -1}]}, 
       {RGBColor[
        0.33725490196078434`, 0.7058823529411764, 0.9137254901960784], 
        RectangleBox[{0, -1}, {2, 1}]}},
      AspectRatio->1,
      Frame->True,
      FrameStyle->RGBColor[
       0.22483660130718958`, 0.47058823529411764`, 0.6091503267973857],
      FrameTicks->None,
      ImageSize->
       Dynamic[{
        Automatic, 
         1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
          Magnification])}],
      PlotRangePadding->None],
     "RGBColor[0.33725490196078434, 0.7058823529411764, 0.9137254901960784]"],
    
    Appearance->None,
    BaseStyle->{},
    BaselinePosition->Baseline,
    ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
      If[
       Not[
        AbsoluteCurrentValue["Deployed"]], 
       SelectionMove[Typeset`box$, All, Expression]; 
       FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
       FrontEnd`Private`$ColorSelectorInitialColor = 
        RGBColor[
         0.33725490196078434`, 0.7058823529411764, 0.9137254901960784]; 
       FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
       MathLink`CallFrontEnd[
         FrontEnd`AttachCell[Typeset`box$, 
          FrontEndResource["RGBColorValueSelector"], {0, {Left, Bottom}}, {
          Left, Top}, 
          "ClosingActions" -> {
           "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
    DefaultBaseStyle->{},
    Evaluator->Automatic,
    Method->"Preemptive"],
   RGBColor[0.33725490196078434`, 0.7058823529411764, 0.9137254901960784],
   Editable->False,
   Selectable->False]}]], "Input",
 CellChangeTimes->{{3.6706846763450727`*^9, 
  3.6706846782775927`*^9}},ExpressionUUID->"686a18b0-b7c2-4c00-a66c-\
9809444695bd"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showNodesAndReference", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showNodesAndReference", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ti_:", "0"}], ",", "\[IndentingNewLine]", 
    RowBox[{"centroids_:", "pts2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "maxZ", ",", "minZ", ",", "stdCentroids", ",", "n", ",", 
      "finalProjection", ",", "transferFunction", ",", "trails"}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "\"\<1234\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"stdCentroids", " ", "=", " ", 
      RowBox[{"dataTransform", "/@", "centroids"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"maxZ", ",", " ", "minZ"}], "}"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Graphics3D", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"GrayLevel", "[", "0.3", "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"transformToStandardView", "/@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xint2", "[", "t", "]"}], ",", 
                    RowBox[{"yint2", "[", "t", "]"}], ",", 
                    RowBox[{"zint2", "[", "t", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xint2", "[", 
                    RowBox[{"t", "+", "0.01"}], "]"}], ",", 
                    RowBox[{"yint2", "[", 
                    RowBox[{"t", "+", "0.01"}], "]"}], ",", 
                    RowBox[{"zint2", "[", 
                    RowBox[{"t", "+", "0.01"}], "]"}]}], "}"}]}], "}"}]}], 
                    "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"t", ",", "minParameter", ",", 
                    RowBox[{"maxParameter", "-", "0.01"}], ",", "0.01"}], 
                   "}"}]}], "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"AbsoluteThickness", "[", "5", "]"}], ",", "Black", 
                ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"transformToStandardView", "/@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xint2", "[", "ti", "]"}], ",", 
                    RowBox[{"yint2", "[", "ti", "]"}], ",", 
                    RowBox[{"zint2", "[", "ti", "]"}]}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xint2", "[", "ti", "]"}], ",", 
                    RowBox[{"yint2", "[", "ti", "]"}], ",", 
                    RowBox[{"zint2", "[", "ti", "]"}]}], "}"}], "+", 
                    RowBox[{"15", 
                    RowBox[{"(", 
                    RowBox[{"Ti", "/.", 
                    RowBox[{"t", "\[Rule]", "ti"}]}], ")"}]}]}]}], "}"}]}], 
                 "]"}], ",", "\[IndentingNewLine]", "Gray", ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"transformToStandardView", "/@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xint2", "[", "ti", "]"}], ",", 
                    RowBox[{"yint2", "[", "ti", "]"}], ",", 
                    RowBox[{"zint2", "[", "ti", "]"}]}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xint2", "[", "ti", "]"}], ",", 
                    RowBox[{"yint2", "[", "ti", "]"}], ",", 
                    RowBox[{"zint2", "[", "ti", "]"}]}], "}"}], "+", 
                    RowBox[{"15", 
                    RowBox[{"(", 
                    RowBox[{"Ni", "/.", 
                    RowBox[{"t", "\[Rule]", "ti"}]}], ")"}]}]}]}], "}"}]}], 
                 "]"}], ",", "\[IndentingNewLine]", "myblue", ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"transformToStandardView", "/@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xint2", "[", "ti", "]"}], ",", 
                    RowBox[{"yint2", "[", "ti", "]"}], ",", 
                    RowBox[{"zint2", "[", "ti", "]"}]}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xint2", "[", "ti", "]"}], ",", 
                    RowBox[{"yint2", "[", "ti", "]"}], ",", 
                    RowBox[{"zint2", "[", "ti", "]"}]}], "}"}], "+", 
                    RowBox[{"15", 
                    RowBox[{"(", 
                    RowBox[{"Bi", "/.", 
                    RowBox[{"t", "\[Rule]", "ti"}]}], ")"}]}]}]}], "}"}]}], 
                 "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"myblue", ",", 
                    RowBox[{"Opacity", "[", "0.2", "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"transformToStandardView", "/@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xint2", "[", "t", "]"}], ",", 
                    RowBox[{"yint2", "[", "t", "]"}], ",", 
                    RowBox[{"zint2", "[", "t", "]"}]}], "}"}], "-", 
                    RowBox[{"5", 
                    RowBox[{"(", 
                    RowBox[{"Bi", "/.", 
                    RowBox[{"t", "\[Rule]", "t"}]}], ")"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xint2", "[", "t", "]"}], ",", 
                    RowBox[{"yint2", "[", "t", "]"}], ",", 
                    RowBox[{"zint2", "[", "t", "]"}]}], "}"}], "+", 
                    RowBox[{"5", 
                    RowBox[{"(", 
                    RowBox[{"Bi", "/.", 
                    RowBox[{"t", "\[Rule]", "t"}]}], ")"}]}]}]}], "}"}]}], 
                    "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"t", ",", "minParameter", ",", 
                    RowBox[{"ti", "-", "0.01"}], ",", "0.001"}], "}"}]}], 
                 "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Opacity", "[", "0.2", "]"}], ",", 
                  RowBox[{"GrayLevel", "[", 
                   RowBox[{"0.5", "+", 
                    RowBox[{"0.2", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"maxZ", "-", "minZ"}], ")"}]}], ")"}]}], 
                    ")"}]}]}], "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{"#", ",", "2.5"}], "]"}], ",", 
                  RowBox[{"Opacity", "[", "1", "]"}], ",", 
                  RowBox[{"GrayLevel", "[", "0.3", "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{"#", ",", "1"}], "]"}]}], "}"}], "&"}], "/@", 
               RowBox[{"(", "stdCentroids", ")"}]}], "]"}]}], 
            "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", 
           RowBox[{"Lighting", "->", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"ViewPoint", "\[Rule]", "Top"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "85"}], ",", "134"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "38"}], ",", "118"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"101", ",", "228"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "None"}]}], "]"}], ",", 
         RowBox[{"RasterSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", "finalProjection", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "200"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "50"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.670684072951549*^9, 3.670684120428967*^9}, {
  3.6706841745084333`*^9, 3.670684199795245*^9}, {3.670684238674363*^9, 
  3.670684248050229*^9}, {3.67068443391028*^9, 3.670684628117836*^9}, {
  3.670684685869546*^9, 3.670684726778635*^9}, {3.6706849070291853`*^9, 
  3.670684940379243*^9}, {3.6706849709017277`*^9, 3.670685118200675*^9}, {
  3.670685322896262*^9, 
  3.670685326478973*^9}},ExpressionUUID->"13105c2f-d299-407f-8de1-\
c0ba560bab35"],

Cell[BoxData[
 RowBox[{"showNodesAndReference", "[", 
  RowBox[{"pts2", ",", "0.8"}], "]"}]], "Input",
 CellChangeTimes->{{3.670684211628325*^9, 3.670684257878666*^9}, {
  3.670684736767717*^9, 
  3.670684749790978*^9}},ExpressionUUID->"8b3975fc-27b2-4560-8554-\
7f6a2e36df05"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-4/\
part-1/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{
         RowBox[{"x", "+", "100"}], ",", "10", ",", "4"}], "]"}], "<>", 
       "\"\<.png\>\""}], ",", 
      RowBox[{"showNodesAndReference", "[", 
       RowBox[{"x", "/", "100"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "1", ",", "100", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.67068513682563*^9, 3.670685184377162*^9}, {
  3.6706852160853043`*^9, 3.670685259159155*^9}, {3.6706853123755083`*^9, 
  3.6706853340601254`*^9}, {3.670686309088122*^9, 
  3.670686313516638*^9}},ExpressionUUID->"6b7e9f5b-54aa-4197-bba0-\
13220c1d5274"],

Cell[BoxData[
 RowBox[{"midline3D1", "=", 
  RowBox[{"Graphics3D", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Opacity", "[", "0.2", "]"}], ",", "Black", ",", 
      RowBox[{"AbsoluteThickness", "[", ".1", "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"pts2", "[", 
            RowBox[{"[", 
             RowBox[{"First", "@", "#"}], "]"}], "]"}], ",", 
           RowBox[{"pts2", "[", 
            RowBox[{"[", 
             RowBox[{"Last", "@", "#"}], "]"}], "]"}]}], "}"}], "]"}], "&"}], 
       "/@", "myEdges"}], ",", 
      RowBox[{"Opacity", "[", "1", "]"}], ",", "Gray", ",", 
      RowBox[{"AbsolutePointSize", "[", "4", "]"}], ",", 
      RowBox[{"Point", "/@", "pts2"}], ",", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Line", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"xint", "[", "t", "]"}], ",", 
             RowBox[{"yint", "[", "t", "]"}], ",", 
             RowBox[{"zint", "[", "t", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "25"}]}], "}"}]}], "]"}], "]"}], ","}], "*)"}],
       ",", 
      RowBox[{"AbsoluteThickness", "[", "10", "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"brewerDiv", "[", "t", "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"transformToStandardView", "/@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xint2", "[", "t", "]"}], ",", 
                RowBox[{"yint2", "[", "t", "]"}], ",", 
                RowBox[{"zint2", "[", "t", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xint2", "[", 
                 RowBox[{"t", "+", "0.01"}], "]"}], ",", 
                RowBox[{"yint2", "[", 
                 RowBox[{"t", "+", "0.01"}], "]"}], ",", 
                RowBox[{"zint2", "[", 
                 RowBox[{"t", "+", "0.01"}], "]"}]}], "}"}]}], "}"}]}], 
           "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "minParameter", ",", 
          RowBox[{"maxParameter", "-", "0.01"}], ",", "0.01"}], "}"}]}], 
       "]"}]}], "}"}], ",", 
    RowBox[{"ViewPoint", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "Infinity"}], "}"}]}], ",", " ", 
    RowBox[{"Boxed", "\[Rule]", "False"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.657984783975045*^9, 3.657984836355968*^9}, {
   3.6579848938347187`*^9, 3.657984901243081*^9}, {3.6579849325088167`*^9, 
   3.657985104263637*^9}, {3.6579851848621883`*^9, 3.657985240083713*^9}, {
   3.657985270363158*^9, 3.657985270575674*^9}, {3.657985374071765*^9, 
   3.657985379878828*^9}, {3.6579855816872683`*^9, 3.657985643790964*^9}, {
   3.657985674222041*^9, 3.65798581777089*^9}, {3.6580351580489902`*^9, 
   3.6580352123148003`*^9}, {3.658035283593392*^9, 3.658035327406106*^9}, {
   3.65803543250918*^9, 3.6580354821549683`*^9}, {3.6582341639082623`*^9, 
   3.658234166209003*^9}, {3.658234303230865*^9, 3.658234306447753*^9}, {
   3.658235047185814*^9, 3.658235070014612*^9}, {3.658235233051486*^9, 
   3.658235235897299*^9}, 3.658589020224845*^9, 3.658658668562426*^9, {
   3.662104192035379*^9, 3.662104236090082*^9}, {3.662112949769024*^9, 
   3.66211302024553*^9}, {3.662217712312717*^9, 3.662217721644907*^9}, {
   3.662280464149666*^9, 3.662280469381529*^9}, {3.662280502308629*^9, 
   3.662280502980617*^9}, {3.670307155853096*^9, 
   3.6703071754923058`*^9}},ExpressionUUID->"d980575b-47fb-4dd8-b5ab-\
831a2bf3f511"],

Cell[BoxData[
 RowBox[{"midline3D", "=", 
  RowBox[{"Graphics3D", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Opacity", "[", "0.2", "]"}], ",", "Black", ",", 
      RowBox[{"AbsoluteThickness", "[", ".5", "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"pts2", "[", 
            RowBox[{"[", 
             RowBox[{"First", "@", "#"}], "]"}], "]"}], ",", 
           RowBox[{"pts2", "[", 
            RowBox[{"[", 
             RowBox[{"Last", "@", "#"}], "]"}], "]"}]}], "}"}], "]"}], "&"}], 
       "/@", "myEdges"}], ",", 
      RowBox[{"Opacity", "[", "1", "]"}], ",", "Gray", ",", 
      RowBox[{"AbsolutePointSize", "[", "3", "]"}], ",", 
      RowBox[{"MapIndexed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"minAngle", "<=", 
              RowBox[{
               RowBox[{"ptsCylinder", "[", 
                RowBox[{"[", 
                 RowBox[{"#2", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", "maxAngle"}], 
             ",", 
             RowBox[{"Directive", "[", 
              RowBox[{
               RowBox[{"AbsolutePointSize", "[", "7", "]"}], ",", "Gray"}], 
              "]"}], ",", 
             RowBox[{"Directive", "[", 
              RowBox[{
               RowBox[{"Opacity", "[", "0.2", "]"}], ",", "Black"}], "]"}]}], 
            "]"}], ",", 
           RowBox[{"Point", "[", "#1", "]"}]}], "}"}], "&"}], ",", "pts2"}], 
       "]"}], ",", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Line", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"xint", "[", "t", "]"}], ",", 
             RowBox[{"yint", "[", "t", "]"}], ",", 
             RowBox[{"zint", "[", "t", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "25"}]}], "}"}]}], "]"}], "]"}], ","}], "*)"}],
       ",", 
      RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", "Black", ",", 
      RowBox[{"Line", "[", 
       RowBox[{"transformToStandardView", "/@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"xint2", "[", "t", "]"}], ",", 
            RowBox[{"yint2", "[", "t", "]"}], ",", 
            RowBox[{"zint2", "[", "t", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "t", ",", "minParameter", ",", "maxParameter", ",", "0.01"}], 
           "}"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"(*", 
          RowBox[{"Black", ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xint2", "[", "t", "]"}], ",", 
                RowBox[{"yint2", "[", "t", "]"}], ",", 
                RowBox[{"zint2", "[", "t", "]"}]}], "}"}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xint2", "[", "t", "]"}], ",", 
                 RowBox[{"yint2", "[", "t", "]"}], ",", 
                 RowBox[{"zint2", "[", "t", "]"}]}], "}"}], "+", 
               RowBox[{"10", 
                RowBox[{"(", 
                 RowBox[{"Ti", "/.", 
                  RowBox[{"t", "\[Rule]", "t"}]}], ")"}]}]}]}], "}"}], "]"}], 
           ","}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AbsoluteThickness", "[", "3", "]"}], ",", "Gray", ",", 
          RowBox[{"Line", "[", 
           RowBox[{"transformToStandardView", "/@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xint2", "[", "t", "]"}], ",", 
                RowBox[{"yint2", "[", "t", "]"}], ",", 
                RowBox[{"zint2", "[", "t", "]"}]}], "}"}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xint2", "[", "t", "]"}], ",", 
                 RowBox[{"yint2", "[", "t", "]"}], ",", 
                 RowBox[{"zint2", "[", "t", "]"}]}], "}"}], "+", 
               RowBox[{"10", 
                RowBox[{"(", 
                 RowBox[{"Ni", "/.", 
                  RowBox[{"t", "\[Rule]", "t"}]}], ")"}]}]}]}], "}"}]}], 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"cols", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "3", "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"transformToStandardView", "/@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xint2", "[", "t", "]"}], ",", 
                RowBox[{"yint2", "[", "t", "]"}], ",", 
                RowBox[{"zint2", "[", "t", "]"}]}], "}"}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xint2", "[", "t", "]"}], ",", 
                 RowBox[{"yint2", "[", "t", "]"}], ",", 
                 RowBox[{"zint2", "[", "t", "]"}]}], "}"}], "+", 
               RowBox[{"10", 
                RowBox[{"(", 
                 RowBox[{"Bi", "/.", 
                  RowBox[{"t", "\[Rule]", "t"}]}], ")"}]}]}]}], "}"}]}], 
           "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "minParameter", ",", "maxParameter", ",", "0.03"}],
          "}"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"ViewPoint", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "Infinity"}], "}"}]}], ",", 
    RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.65798595040504*^9, 3.657985992340199*^9}, {
   3.657986033164126*^9, 3.65798608729807*^9}, {3.65798613029888*^9, 
   3.657986218374427*^9}, {3.657986260805554*^9, 3.657986283684362*^9}, {
   3.657986351163575*^9, 3.657986464216404*^9}, {3.6579865240388527`*^9, 
   3.657986542469304*^9}, {3.6579865964142227`*^9, 3.65798671596922*^9}, {
   3.657988305564435*^9, 3.657988308886791*^9}, {3.658234356295573*^9, 
   3.658234383718233*^9}, {3.658234518082582*^9, 3.658234518779248*^9}, {
   3.658235077305356*^9, 3.658235092863056*^9}, 3.658589025232708*^9, 
   3.6586586792992773`*^9, {3.662104260082375*^9, 3.662104301431559*^9}, {
   3.662104398252344*^9, 3.6621044031869097`*^9}, {3.6622805448921967`*^9, 
   3.66228058487367*^9}},ExpressionUUID->"978cd85f-0844-418a-8167-\
eef6ae535535"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "findLocalRotation", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"findLocalRotation", "[", 
   RowBox[{"t0_", ",", "dt_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"T0", ",", "N0", ",", "B0", ",", "T1", ",", "B1", ",", "N1"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"T0", ",", "N0", ",", "B0"}], "}"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Ti", ",", "Ni", ",", "Bi"}], "}"}], "/.", 
       RowBox[{"t", "\[Rule]", "t0"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"T1", ",", "N1", ",", "B1"}], "}"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Ti", ",", "Ni", ",", "Bi"}], "}"}], "/.", 
       RowBox[{"t", "\[Rule]", 
        RowBox[{"t0", "+", "dt"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Theta]", "/.", 
      RowBox[{"Last", "[", 
       RowBox[{"NMinimize", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"EuclideanDistance", "[", 
           RowBox[{"N1", ",", 
            RowBox[{
             RowBox[{"RotationMatrix", "[", 
              RowBox[{"\[Theta]", ",", "T0"}], "]"}], ".", "N0"}]}], "]"}], 
          "+", 
          RowBox[{"EuclideanDistance", "[", 
           RowBox[{"B1", ",", 
            RowBox[{
             RowBox[{"RotationMatrix", "[", 
              RowBox[{"\[Theta]", ",", "T0"}], "]"}], ".", "B0"}]}], "]"}]}], 
         ",", "\[Theta]"}], "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.670652667738594*^9, 3.670652842552628*^9}, {
  3.6706528883533087`*^9, 3.670652963603217*^9}, {3.670653037952166*^9, 
  3.6706530495219927`*^9}, {3.67065308325386*^9, 3.670653096359571*^9}, {
  3.670653327126549*^9, 3.670653337471537*^9}, {3.670653371692881*^9, 
  3.670653376774559*^9}},ExpressionUUID->"12c2032b-58d1-42fc-b95f-\
bdfc5d21ef22"],

Cell[BoxData[
 RowBox[{
  RowBox[{"localRotations", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"findLocalRotation", "[", 
      RowBox[{"x", ",", "0.01"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", 
       RowBox[{"1", "-", "0.01"}], ",", "0.01"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670652966335971*^9, 3.670652997688999*^9}, {
  3.670653062143635*^9, 3.670653062863909*^9}, {3.6706531015513277`*^9, 
  3.6706531198221684`*^9}, {3.6706531627579203`*^9, 
  3.6706532278186693`*^9}},ExpressionUUID->"59d4201e-6641-4cba-a006-\
9367348caf60"],

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", 
  RowBox[{"localRotations", ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.670653232127906*^9, 
  3.670653256957162*^9}},ExpressionUUID->"b42133ec-05f0-4879-bf2f-\
d21c31efe3f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"accumulatedRotations", "=", 
   RowBox[{"Accumulate", "[", "localRotations", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.670653390502137*^9, 
  3.670653445836005*^9}},ExpressionUUID->"18726508-94de-4245-bc0a-\
d46a08456e7e"],

Cell[BoxData[
 RowBox[{"intRotations", "=", 
  RowBox[{"ListInterpolation", "[", 
   RowBox[{"accumulatedRotations", ",", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.670653447305667*^9, 
  3.670653486498242*^9}},ExpressionUUID->"fafb117b-7cad-4c98-bdb2-\
1966940e2512"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "untwistCurve", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"untwistCurve", "[", 
   RowBox[{"alpha_", ",", 
    RowBox[{"{", 
     RowBox[{"\[Rho]_", ",", "\[Phi]_", ",", "z_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"Ti_", ",", "Ni_", ",", "Bi_"}], "}"}], ",", 
    RowBox[{"xint_:", "xint2"}], ",", 
    RowBox[{"yint_:", "yint2"}], ",", 
    RowBox[{"zint_:", "zint2"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x0", ",", "n", ",", "b", ",", "rot"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"x0", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"xint", "[", "z", "]"}], ",", 
        RowBox[{"yint", "[", "z", "]"}], ",", 
        RowBox[{"zint", "[", "z", "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"b", ",", "n"}], "}"}], "=", 
      RowBox[{"FromPolarCoordinates", "[", 
       RowBox[{"{", 
        RowBox[{"\[Rho]", ",", "\[Phi]"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"x0", "+", 
       RowBox[{"b", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"RotationMatrix", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"intRotations", "[", "z", "]"}]}], "alpha"}], ",", 
            "Ti"}], "]"}], ".", 
          RowBox[{"(", 
           RowBox[{"Bi", "/.", 
            RowBox[{"t", "->", "z"}]}], ")"}]}], ")"}]}], "+", 
       RowBox[{"n", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"RotationMatrix", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"intRotations", "[", "z", "]"}]}], "alpha"}], ",", 
            "Ti"}], "]"}], 
          RowBox[{"(", 
           RowBox[{"Ni", "/.", 
            RowBox[{"t", "->", "z"}]}], ")"}]}], ")"}]}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"rot", "=", 
      RowBox[{"RotationMatrix", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "alpha"}], " ", 
         RowBox[{"intRotations", "[", "z", "]"}]}], ",", 
        RowBox[{"(", 
         RowBox[{"Ti", "/.", 
          RowBox[{"t", "\[Rule]", "z"}]}], ")"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"x0", "+", 
      RowBox[{"b", 
       RowBox[{"(", 
        RowBox[{"rot", ".", 
         RowBox[{"(", 
          RowBox[{"Bi", "/.", 
           RowBox[{"t", "\[Rule]", "z"}]}], ")"}]}], ")"}]}], "+", 
      RowBox[{"n", 
       RowBox[{"(", 
        RowBox[{"rot", ".", 
         RowBox[{"(", 
          RowBox[{"Ni", "/.", 
           RowBox[{"t", "\[Rule]", "z"}]}], ")"}]}], ")"}]}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.670653668406418*^9, 3.670653676844726*^9}, {
  3.670653708780542*^9, 3.670653806088893*^9}, {3.670653910548849*^9, 
  3.670654118383088*^9}},ExpressionUUID->"08964da3-b17b-48c9-a933-\
2f25ca3bc494"],

Cell[BoxData[
 RowBox[{"Graphics3D", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Line", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"untwistCurve", "[", 
        RowBox[{"alpha", ",", "#", ",", 
         RowBox[{"{", 
          RowBox[{"Ti", ",", "Ni", ",", "Bi"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"alpha", ",", "0", ",", "1", ",", "0.1"}], "}"}]}], "]"}], 
     "]"}], "&"}], "/@", "ptsCylinder"}], "]"}]], "Input",
 CellChangeTimes->{{3.670654167445711*^9, 3.6706541798922567`*^9}, {
  3.670654248315516*^9, 
  3.670654269122683*^9}},ExpressionUUID->"be34459a-46dc-41d6-9573-\
20ce9cae02bf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"untwistingSequence", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"untwistCurve", "[", 
        RowBox[{"alpha", ",", "#", ",", 
         RowBox[{"{", 
          RowBox[{"Ti", ",", "Ni", ",", "Bi"}], "}"}]}], "]"}], "&"}], "/@", 
      "ptsCylinder"}], ",", 
     RowBox[{"{", 
      RowBox[{"alpha", ",", "0", ",", "1", ",", "0.01"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6706596377165403`*^9, 
  3.6706596885558453`*^9}},ExpressionUUID->"368e1cc5-4e93-473b-a61b-\
c658a3b3cbaf"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showNodesTrail", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showNodesTrail", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"centroidLst_:", "pts2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "maxZ", ",", "minZ", ",", "stdCentroids", ",", "n", ",", 
      "finalProjection", ",", "transferFunction", ",", "centroids", ",", 
      "trails"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "\"\<1234\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"centroids", "=", 
      RowBox[{"Last", "[", "centroidLst", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"trails", "=", 
      RowBox[{"dataTransform", "/@", 
       RowBox[{"Transpose", "[", "centroidLst", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"stdCentroids", " ", "=", " ", 
      RowBox[{"dataTransform", "/@", "centroids"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"maxZ", ",", " ", "minZ"}], "}"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Graphics3D", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Opacity", "[", "0.2", "]"}], ",", 
                  RowBox[{"GrayLevel", "[", 
                   RowBox[{"0.5", "+", 
                    RowBox[{"0.2", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"maxZ", "-", "minZ"}], ")"}]}], ")"}]}], 
                    ")"}]}]}], "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{"#", ",", "2.5"}], "]"}], ",", 
                  RowBox[{"Opacity", "[", "1", "]"}], ",", 
                  RowBox[{"GrayLevel", "[", "0.3", "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{"#", ",", "1"}], "]"}]}], "}"}], "&"}], "/@", 
               RowBox[{"(", "stdCentroids", ")"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"AbsoluteThickness", "[", "1.5", "]"}], ",", 
                RowBox[{"GrayLevel", "[", "0.3", "]"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Line", "[", "#", "]"}], "&"}], "/@", "trails"}]}], 
               "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"Lighting", "->", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"ViewPoint", "\[Rule]", "Top"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "85"}], ",", "134"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "38"}], ",", "118"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"101", ",", "228"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "None"}]}], "]"}], ",", 
         RowBox[{"RasterSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", "finalProjection", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "200"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "50"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.670679566295768*^9, 3.670679576485353*^9}, {
  3.670679616213417*^9, 3.6706796922585497`*^9}, {3.670679735498166*^9, 
  3.670679754888548*^9}, {3.6706798129051723`*^9, 3.670679937651681*^9}, {
  3.670679973979554*^9, 3.670680000704935*^9}, {3.670680038544817*^9, 
  3.670680047831208*^9}},ExpressionUUID->"f3c432fa-9d2e-49dd-91f3-\
6a91be11eae6"],

Cell[BoxData[
 RowBox[{"showNodesTrail", "[", 
  RowBox[{"Take", "[", 
   RowBox[{"untwistingSequence", ",", "90"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.670679699288466*^9, 3.670679722896117*^9}, {
  3.6706797616249123`*^9, 3.6706797897101173`*^9}, {3.6706799493070297`*^9, 
  3.670679949704588*^9}, {3.67068000748109*^9, 
  3.670680008375182*^9}},ExpressionUUID->"40fa19c9-20b2-4e26-8565-\
4d80cfffe16b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-4/\
part-2-a/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"t", ",", "10", ",", "4"}], "]"}], "<>", "\"\<.png\>\""}], 
      ",", 
      RowBox[{"showNodesTrail", "[", 
       RowBox[{"Take", "[", 
        RowBox[{"untwistingSequence", ",", "t"}], "]"}], "]"}]}], "]"}], ",", 
    
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "100", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670680253096822*^9, 
  3.6706802766632147`*^9}},ExpressionUUID->"599b4470-20cb-4631-b9cb-\
ac809989e8e3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"Ti", ",", "Ni", ",", "Bi"}], "}"}], "/.", 
  RowBox[{"t", "\[Rule]", "0"}]}]], "Input",
 CellChangeTimes->{{3.67068352413937*^9, 
  3.670683538773431*^9}},ExpressionUUID->"ac1c159a-0441-4b27-aa5e-\
5c68ef1ccb5d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"startPositions", "=", 
   RowBox[{"Last", "[", "untwistingSequence", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"finalPositions", "=", 
   RowBox[{"computeIntermediateHeartGeometry", "[", 
    RowBox[{"Last", "[", "interpolatedMidlines", "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.670577531030735*^9, 3.670577557246562*^9}, {
  3.6705957900603323`*^9, 3.67059579071119*^9}, {3.670659717636059*^9, 
  3.6706597662787867`*^9}},ExpressionUUID->"f937c5f3-b82e-485d-b47a-\
c5e8047ba0a6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"displacements", "=", 
   RowBox[{"finalPositions", "-", "startPositions"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.670577561960559*^9, 3.670577613413162*^9}, {
  3.6705777160227118`*^9, 
  3.670577717050075*^9}},ExpressionUUID->"672316da-85c6-43a4-8503-\
2cf0ccd9654f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"straighteningSequence", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"startPositions", "+", 
      RowBox[{"alpha", " ", "displacements"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"alpha", ",", "0", ",", "1", ",", "0.01"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670659768981691*^9, 
  3.6706597985843*^9}},ExpressionUUID->"9479de5d-3f77-4528-bd9e-cd4e94617b95"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showNodes", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showNodes", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"centroids_:", "pts2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "maxZ", ",", "minZ", ",", "stdCentroids", ",", "n", ",", 
      "finalProjection", ",", "transferFunction", ",", "trails"}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "\"\<1234\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"stdCentroids", " ", "=", " ", 
      RowBox[{"dataTransform", "/@", "centroids"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"maxZ", ",", " ", "minZ"}], "}"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"Graphics3D", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Opacity", "[", "0.2", "]"}], ",", 
                  RowBox[{"GrayLevel", "[", 
                   RowBox[{"0.9", "+", 
                    RowBox[{"0.1", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"maxZ", "-", "minZ"}], ")"}]}], ")"}]}], 
                    ")"}]}]}], "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{"#", ",", "2.5"}], "]"}], ",", 
                  RowBox[{"Opacity", "[", "1", "]"}], ",", 
                  RowBox[{"GrayLevel", "[", "0.3", "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{"#", ",", "1"}], "]"}]}], "}"}], "&"}], "/@", 
               RowBox[{"(", "stdCentroids", ")"}]}], ",", 
              RowBox[{"Background", "\[Rule]", "LightGray"}]}], "]"}], 
            "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", 
           RowBox[{"Lighting", "->", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"ViewPoint", "\[Rule]", "Top"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "85"}], ",", "134"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "38"}], ",", "118"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"101", ",", "228"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "None"}]}], "]"}], ",", 
         RowBox[{"RasterSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", "finalProjection", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "200"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "50"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.670683033791862*^9, 3.670683068558463*^9}, {
  3.6706831092475643`*^9, 
  3.6706831283109827`*^9}},ExpressionUUID->"f20dd9c9-8ee0-46fe-bdd8-\
b74ea92d262f"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showNodes", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showNodes", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"centroids_:", "pts2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "maxZ", ",", "minZ", ",", "stdCentroids", ",", "n", ",", 
      "finalProjection", ",", "transferFunction", ",", "trails"}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "\"\<1234\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"stdCentroids", " ", "=", " ", 
      RowBox[{"dataTransform", "/@", "centroids"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"maxZ", ",", " ", "minZ"}], "}"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"Graphics3D", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Opacity", "[", "0.2", "]"}], ",", 
                 RowBox[{"GrayLevel", "[", 
                  RowBox[{"0.5", "+", 
                   RowBox[{"0.2", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"maxZ", "-", "minZ"}], ")"}]}], ")"}]}], 
                    ")"}]}]}], "]"}], ",", 
                 RowBox[{"Sphere", "[", 
                  RowBox[{"#", ",", "2.5"}], "]"}], ",", 
                 RowBox[{"Opacity", "[", "1", "]"}], ",", 
                 RowBox[{"GrayLevel", "[", "0.3", "]"}], ",", 
                 RowBox[{"Sphere", "[", 
                  RowBox[{"#", ",", "1"}], "]"}]}], "}"}], "&"}], "/@", 
              RowBox[{"(", "stdCentroids", ")"}]}], "]"}], 
            "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", 
           RowBox[{"Lighting", "->", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"ViewPoint", "\[Rule]", "Top"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "85"}], ",", "134"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "38"}], ",", "118"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"101", ",", "228"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "None"}]}], "]"}], ",", 
         RowBox[{"RasterSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", "finalProjection", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "200"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "50"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.670680102804528*^9, 3.67068012930226*^9}, 
   3.6706830191492243`*^9},ExpressionUUID->"35a778ab-7d7c-42a6-9f86-\
14db83a931cd"],

Cell[BoxData[
 RowBox[{"showNodes", "[", 
  RowBox[{"straighteningSequence", "[", 
   RowBox[{"[", "90", "]"}], "]"}], "]"}]], "Input",ExpressionUUID->"9993e9d4-\
bcfa-4d44-bfb5-4ceb5fc3f87e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-4/\
part-2-b/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"t", ",", "10", ",", "4"}], "]"}], "<>", "\"\<.png\>\""}], 
      ",", 
      RowBox[{"showNodes", "[", 
       RowBox[{"straighteningSequence", "[", 
        RowBox[{"[", "t", "]"}], "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "100", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670680312147273*^9, 
  3.670680326012377*^9}},ExpressionUUID->"ed5aa493-40e7-49c9-946f-\
c23f289356f0"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Graphics3D", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Point", "[", 
         RowBox[{"transformToStandardView", "[", "#", "]"}], "]"}], "&"}], "/@", 
       RowBox[{"(", 
        RowBox[{"untwistingSequence", "[", 
         RowBox[{"[", "t", "]"}], "]"}], ")"}]}], "}"}], ",", 
     RowBox[{"ViewPoint", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "Infinity"}], "}"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "1", ",", 
     RowBox[{"Length", "[", "untwistingSequence", "]"}], ",", "1"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6705776219474077`*^9, 3.670577670299862*^9}, {
  3.670584406145727*^9, 3.6705844218521338`*^9}, {3.670659812040189*^9, 
  3.670659829687619*^9}, {3.670660579976738*^9, 
  3.670660588023383*^9}},ExpressionUUID->"cd39c720-e8c2-4620-8c19-\
4dd50982ac68"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Graphics3D", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Point", "[", 
        RowBox[{"transformToStandardView", "[", "#", "]"}], "]"}], "&"}], "/@", 
      RowBox[{"straighteningSequence", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{"ViewPoint", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "Infinity"}], "}"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "straighteningSequence", "]"}], ",", "1"}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.670577820161676*^9, 3.6705778447014427`*^9}, {
  3.670578474860207*^9, 3.670578495722582*^9}, {3.6705793419659367`*^9, 
  3.6705793798681927`*^9}, {3.6705894806336317`*^9, 3.670589480841942*^9}, {
  3.6706598533449907`*^9, 
  3.670659854744608*^9}},ExpressionUUID->"923f831b-0278-4e58-904e-\
7c6e8f2caea6"],

Cell[BoxData[
 RowBox[{"Mean", "[", 
  RowBox[{"First", "/@", "ptsCylinder"}], "]"}]], "Input",
 CellChangeTimes->{{3.6706606579266453`*^9, 
  3.670660663980104*^9}},ExpressionUUID->"10fb9958-3712-4526-8118-\
48e5abec2008"],

Cell[BoxData[
 RowBox[{
  RowBox[{"finalCylinder", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"35", ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}], "/@", 
    "ptsCylinder"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6706606206017933`*^9, 
  3.6706606713085403`*^9}},ExpressionUUID->"ce7c2e79-dd7e-44a8-9049-\
ae4d3845ecde"],

Cell[BoxData[
 RowBox[{
  RowBox[{"finalPositionsBlowUp", "=", 
   RowBox[{"computeIntermediateHeartGeometry", "[", 
    RowBox[{
     RowBox[{"Last", "[", "interpolatedMidlines", "]"}], ",", 
     "finalCylinder"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.670660612543305*^9, 3.670660614550268*^9}, {
  3.6706606750523043`*^9, 
  3.670660677533257*^9}},ExpressionUUID->"a0015525-11f3-4aa6-b6d0-\
e42d5f5423d2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"startPositions2", "=", 
   RowBox[{"Last", "[", "straighteningSequence", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"finalPositions2", "=", "finalPositionsBlowUp"}], ";"}]}], "Input",
 CellChangeTimes->{{3.670577531030735*^9, 3.670577557246562*^9}, {
  3.6705957900603323`*^9, 3.67059579071119*^9}, {3.670659717636059*^9, 
  3.6706597662787867`*^9}, {3.670660706284568*^9, 
  3.670660719434865*^9}},ExpressionUUID->"49944e64-47d4-46e5-adf0-\
ef8ecaa592ae"],

Cell[BoxData[
 RowBox[{
  RowBox[{"displacements2", "=", 
   RowBox[{"finalPositions2", "-", "startPositions2"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.670577561960559*^9, 3.670577613413162*^9}, {
  3.6705777160227118`*^9, 3.670577717050075*^9}, {3.670660720963282*^9, 
  3.6706607236667624`*^9}},ExpressionUUID->"a614ba8c-03fa-483a-b666-\
533e97651a51"],

Cell[BoxData[
 RowBox[{
  RowBox[{"blowUpSequence", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"startPositions2", "+", 
      RowBox[{"alpha", " ", "displacements2"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"alpha", ",", "0", ",", "1", ",", "0.01"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670659768981691*^9, 3.6706597985843*^9}, {
  3.670660726802848*^9, 
  3.670660733938422*^9}},ExpressionUUID->"dd849383-cfc8-453a-98a0-\
d90547df0f6c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-4/\
part-2-b/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{
         RowBox[{"t", "+", "100"}], ",", "10", ",", "4"}], "]"}], "<>", 
       "\"\<.png\>\""}], ",", 
      RowBox[{"showNodes", "[", 
       RowBox[{"blowUpSequence", "[", 
        RowBox[{"[", "t", "]"}], "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "100", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670680312147273*^9, 3.670680326012377*^9}, {
  3.670680356214452*^9, 
  3.67068036761917*^9}},ExpressionUUID->"6b3e880b-4a08-4f26-a3d0-\
1293ce742c7a"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Graphics3D", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Point", "[", 
        RowBox[{"transformToStandardView", "[", "#", "]"}], "]"}], "&"}], "/@", 
      RowBox[{"blowUpSequence", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{"ViewPoint", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "Infinity"}], "}"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "blowUpSequence", "]"}], ",", "1"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.670577820161676*^9, 3.6705778447014427`*^9}, {
  3.670578474860207*^9, 3.670578495722582*^9}, {3.6705793419659367`*^9, 
  3.6705793798681927`*^9}, {3.6705894806336317`*^9, 3.670589480841942*^9}, {
  3.6706598533449907`*^9, 3.670659854744608*^9}, {3.670660750091552*^9, 
  3.6706607532563047`*^9}},ExpressionUUID->"d0dff843-b422-465c-8e63-\
3d1eadc222d3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Min", "[", "#", "]"}], ",", 
     RowBox[{"Max", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
  RowBox[{"Transpose", "[", "finalPositionsBlowUp", "]"}]}]], "Input",
 CellChangeTimes->{{3.670677304761421*^9, 
  3.670677326878892*^9}},ExpressionUUID->"01a167f2-79f0-4169-af00-\
82ecf24ff464"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-3/\
part-4-alt/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"t", ",", "10", ",", "4"}], "]"}], "<>", "\"\<.png\>\""}], 
      ",", 
      RowBox[{"showNodes", "[", "t", "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "207", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670659604799827*^9, 
  3.670659627598448*^9}},ExpressionUUID->"95fc3974-1319-4ac3-b362-\
9fb74a8ee576"],

Cell[BoxData[
 RowBox[{
  RowBox[{"testCylPts", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "+", "\[Pi]"}], ",", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "*", 
        RowBox[{"-", "5"}]}]}], "}"}], "&"}], "/@", "ptsCylinder"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670676385379427*^9, 3.6706764379144487`*^9}, {
   3.6706767279147587`*^9, 3.670676728024674*^9}, 3.670676804782564*^9, 
   3.670676890219676*^9, 3.6706769218027277`*^9, {3.670677388808144*^9, 
   3.6706773892353077`*^9}, {3.670677435498369*^9, 3.670677435665737*^9}, {
   3.6706774667291603`*^9, 
   3.670677472577305*^9}},ExpressionUUID->"05a0db4d-624d-4e8a-9d5c-\
100a63206440"],

Cell[BoxData[
 RowBox[{
  RowBox[{"unroll", "[", 
   RowBox[{"\[Phi]_", ",", 
    RowBox[{"{", 
     RowBox[{"r_", ",", "\[Theta]_", ",", "z_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Piecewise", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"z", ",", 
         RowBox[{
          RowBox[{"2", " ", "\[Pi]"}], "-", "\[Phi]", "-", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]", "-", "\[Phi]"}], "]"}]}], ",", 
         RowBox[{"-", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]", "-", "\[Phi]"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"\[Phi]", "\[LessEqual]", "\[Theta]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"z", ",", 
         RowBox[{
          RowBox[{"2", " ", "\[Pi]"}], "-", "\[Theta]"}], ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"\[Phi]", ">", "\[Theta]"}]}], "}"}]}], "}"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6706761560762463`*^9, 
  3.670676230656538*^9}},ExpressionUUID->"bbe4a241-09a5-4956-84f3-\
67c91ba2793e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"unrollingSequence", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"unroll", "[", 
        RowBox[{
         RowBox[{"2", "\[Pi]", " ", "t"}], ",", "#"}], "]"}], "&"}], "/@", 
      "testCylPts"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "1", ",", "0.01"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670677602364678*^9, 
  3.670677660034585*^9}},ExpressionUUID->"750edfd7-b446-41a6-96cd-\
808962466b14"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showNodesUnrolling", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showNodesUnrolling", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"centroids_:", "pts2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "maxZ", ",", "minZ", ",", "stdCentroids", ",", "n", ",", 
      "finalProjection", ",", "transferFunction"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "\"\<1234\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"stdCentroids", " ", "=", " ", "centroids"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"maxZ", ",", " ", "minZ"}], "}"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Graphics3D", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Opacity", "[", "0.2", "]"}], ",", 
                  RowBox[{"GrayLevel", "[", 
                   RowBox[{"0.5", "+", 
                    RowBox[{"0.2", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"maxZ", "-", "minZ"}], ")"}]}], ")"}]}], 
                    ")"}]}]}], "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{"#", ",", "0.07"}], "]"}], ",", 
                  RowBox[{"Opacity", "[", "1", "]"}], ",", 
                  RowBox[{"GrayLevel", "[", "0.3", "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{"#", ",", "0.03"}], "]"}]}], "}"}], "&"}], "/@", 
               RowBox[{"(", "stdCentroids", ")"}]}], "]"}], ",", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "\[Pi]", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "5.2"}], ",", "\[Pi]", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], "]"}], ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"2", "\[Pi]"}], ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], "]"}]}], "}"}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<\[Phi]\>\"", ",", "Bold", ",", "32", ",", 
                  RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
                 "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0.2", ",", 
                  RowBox[{"2", "\[Pi]"}], ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}], ",", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<\[Tau]\>\"", ",", "Bold", ",", "32", ",", 
                  RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
                 "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "5.4"}], ",", "\[Pi]", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], 
            "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", 
           RowBox[{"Lighting", "->", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "5.2"}], ",", "0.2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "0.2"}], ",", "8.2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1.2"}], ",", "1.2"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "None"}]}], "]"}], ",", 
         RowBox[{"RasterSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", "finalProjection", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "200"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "50"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.67067773300272*^9, 3.670677861756619*^9}, {
  3.670677906998221*^9, 3.670677910059761*^9}, {3.670677943172559*^9, 
  3.6706779659699574`*^9}, {3.6706780201531067`*^9, 3.670678046577499*^9}, {
  3.6706781288523693`*^9, 3.6706781800424337`*^9}, {3.670678210756214*^9, 
  3.67067824833885*^9}, {3.670679017337426*^9, 3.6706790175625563`*^9}, {
  3.6707760340509357`*^9, 3.6707761811541567`*^9}, {3.670776254330929*^9, 
  3.670776256551668*^9}, {3.6707763236332397`*^9, 
  3.6707763247896852`*^9}},ExpressionUUID->"d8b8e039-7083-4907-8a68-\
09213c0d981b"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showNodesUnrollingFinal", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showNodesUnrollingFinal", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"centroids_:", "pts2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "maxZ", ",", "minZ", ",", "stdCentroids", ",", "n", ",", 
      "finalProjection", ",", "transferFunction"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "\"\<1234\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"stdCentroids", " ", "=", " ", "centroids"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"maxZ", ",", " ", "minZ"}], "}"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Graphics3D", "[", 
              RowBox[{"MapIndexed", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"brewerDiv", "[", 
                    RowBox[{
                    RowBox[{"dspeeds", "[", 
                    RowBox[{"[", 
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "/", 
                    "maxDelay"}], "]"}], ",", 
                   RowBox[{"Sphere", "[", 
                    RowBox[{"#1", ",", ".07"}], "]"}]}], "}"}], "&"}], ",", 
                RowBox[{"(", "stdCentroids", ")"}]}], "]"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "\[Pi]", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "5.2"}], ",", "\[Pi]", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], "]"}], ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"2", "\[Pi]"}], ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], "]"}]}], "}"}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<\[Phi]\>\"", ",", "Bold", ",", "32", ",", 
                  RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
                 "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0.2", ",", 
                  RowBox[{"2", "\[Pi]"}], ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}], ",", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<\[Tau]\>\"", ",", "Bold", ",", "32", ",", 
                  RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
                 "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "5.4"}], ",", "\[Pi]", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], 
            "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", 
           RowBox[{"Lighting", "->", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "5.2"}], ",", "0.2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "0.2"}], ",", "8.2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1.2"}], ",", "1.2"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "None"}]}], "]"}], ",", 
         RowBox[{"RasterSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"finalProjection", ",", 
         RowBox[{"Graphics", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Inset", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Show", "[", 
               RowBox[{
                RowBox[{"{", "colorscale", "}"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "80"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"120", ",", "50"}], "}"}]}], "]"}], ",", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<min\>\"", ",", "10", ",", 
                RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
               "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"70", ",", "30"}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<max\>\"", ",", "10", ",", 
                RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
               "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"170", ",", "30"}], "}"}]}], "]"}]}], "}"}], "]"}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "200"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "50"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.6706782773372107`*^9, 3.6706783370585003`*^9}, {
  3.670678391117787*^9, 3.670678431795196*^9}, {3.670678462622322*^9, 
  3.670678469995364*^9}, {3.67067853760069*^9, 3.670678563808647*^9}, {
  3.6706786050634527`*^9, 3.670678612189555*^9}, {3.670678654443651*^9, 
  3.670678675763212*^9}, {3.670678718818304*^9, 3.67067878783911*^9}, {
  3.670678825048061*^9, 3.670678960050521*^9}, {3.6707735900955343`*^9, 
  3.670773593757457*^9}, {3.670773648720449*^9, 3.670773703154313*^9}, {
  3.670773737844263*^9, 3.670773748849936*^9}, {3.670774018628251*^9, 
  3.670774103502471*^9}, {3.6707741984784184`*^9, 3.6707742232508287`*^9}, {
  3.6707742671306963`*^9, 3.6707744147495127`*^9}, {3.670776269914693*^9, 
  3.67077627189544*^9}, {3.670776312641651*^9, 
  3.6707763139024982`*^9}},ExpressionUUID->"90cbbb53-bcbf-41fc-8a66-\
c34a3acf7348"],

Cell[BoxData[
 RowBox[{"colorscale", "=", 
  RowBox[{"Image", "[", 
   RowBox[{"MatrixPlot", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ConstantArray", "[", 
         RowBox[{"i", ",", "4"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "1", ",", "0.01"}], "}"}]}], "]"}], 
      "]"}], ",", 
     RowBox[{"ColorFunction", "\[Rule]", "brewerDiv"}], ",", 
     RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
     RowBox[{"Axes", "\[Rule]", "False"}], ",", 
     RowBox[{"Frame", "\[Rule]", "False"}], ",", 
     RowBox[{"PlotRangePadding", "\[Rule]", "None"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.670773826177229*^9, 3.670774005951931*^9}, {
  3.670774180931897*^9, 
  3.670774209537972*^9}},ExpressionUUID->"3fed961e-9dbd-47db-9211-\
2ba29640a573"],

Cell[BoxData[
 RowBox[{
  RowBox[{"N", "@", "2"}], "\[Pi]"}]], "Input",
 CellChangeTimes->{{3.670677924784705*^9, 
  3.670677928714056*^9}},ExpressionUUID->"66d18686-eaa1-4871-bbe6-\
030d547a3b5d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Min", "[", "#", "]"}], ",", 
     RowBox[{"Max", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
  RowBox[{"Transpose", "[", 
   RowBox[{"Join", "@@", "unrollingSequence"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.670677986278201*^9, 
  3.6706780128714733`*^9}},ExpressionUUID->"119ffc6d-cd78-4136-b992-\
05dbe823e266"],

Cell[BoxData[
 RowBox[{"showNodesUnrolling", "[", 
  RowBox[{"unrollingSequence", "[", 
   RowBox[{"[", "20", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.670775971902285*^9, 
  3.670775972366226*^9}},ExpressionUUID->"e21ade1e-e3c7-4294-a444-\
14ceeb313537"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-4/\
part-3/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"t", ",", "10", ",", "4"}], "]"}], "<>", "\"\<.png\>\""}], 
      ",", 
      RowBox[{"showNodesUnrolling", "[", 
       RowBox[{"unrollingSequence", "[", 
        RowBox[{"[", "t", "]"}], "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "100", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670679085334559*^9, 
  3.67067913394716*^9}},ExpressionUUID->"deffc191-43ec-4e94-8526-\
c62a3f47e48f"],

Cell[BoxData[
 RowBox[{"showNodesUnrollingFinal", "[", 
  RowBox[{"unrollingSequence", "[", 
   RowBox[{"[", "100", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6706783490444813`*^9, 3.670678360709469*^9}, {
   3.670678582711277*^9, 3.670678595244526*^9}, 3.670678627253779*^9, 
   3.670678692378819*^9, {3.670678971995027*^9, 3.670678972136321*^9}, {
   3.670679027199538*^9, 
   3.670679028038682*^9}},ExpressionUUID->"e317cb97-1034-4b62-876c-\
54e3d7090bec"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{
   "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-4/part-\
3-color/\>\"", "<>", 
    RowBox[{"IntegerString", "[", 
     RowBox[{"100", ",", "10", ",", "4"}], "]"}], "<>", "\"\<.png\>\""}], ",", 
   RowBox[{"showNodesUnrollingFinal", "[", 
    RowBox[{"unrollingSequence", "[", 
     RowBox[{"[", "100", "]"}], "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.67077444919633*^9, 
  3.670774451907034*^9}},ExpressionUUID->"55ffdee6-311e-433f-ace7-\
649dde0a7766"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-4/\
part-3-color/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"t", ",", "10", ",", "4"}], "]"}], "<>", "\"\<.png\>\""}], 
      ",", 
      RowBox[{"showNodesUnrollingFinal", "[", 
       RowBox[{"unrollingSequence", "[", 
        RowBox[{"[", "t", "]"}], "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "100", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670679168490752*^9, 
  3.670679176793675*^9}},ExpressionUUID->"4fc172b3-9679-4586-8004-\
7d38470071b7"],

Cell[BoxData[
 RowBox[{"Graphics3D", "[", 
  RowBox[{"MapIndexed", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"AbsolutePointSize", "[", "4", "]"}], ",", 
       RowBox[{"brewerDiv", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"dspeeds", "[", 
           RowBox[{"[", 
            RowBox[{"#2", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ")"}], "/", 
         RowBox[{"(", "maxDelay", ")"}]}], "]"}], ",", 
       RowBox[{"Point", "[", 
        RowBox[{"unroll", "[", 
         RowBox[{
          RowBox[{"1.3", "\[Pi]"}], ",", "#1"}], "]"}], "]"}]}], "}"}], "&"}],
     ",", "testCylPts"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.670676760425209*^9, 
  3.6706767889827557`*^9}},ExpressionUUID->"a3aa9c22-fef1-46eb-a8a7-\
805326aaed36"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Graphics3D", "[", 
    RowBox[{"MapIndexed", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"AbsolutePointSize", "[", "4", "]"}], ",", 
         RowBox[{"brewerDiv", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"dspeeds", "[", 
             RowBox[{"[", 
              RowBox[{"#2", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ")"}], "/", 
           RowBox[{"(", "maxDelay", ")"}]}], "]"}], ",", 
         RowBox[{"Point", "[", 
          RowBox[{"unroll", "[", 
           RowBox[{"\[Phi]", ",", "#1"}], "]"}], "]"}]}], "}"}], "&"}], ",", 
      "testCylPts"}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Phi]", ",", "0", ",", 
     RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.670676234656116*^9, 3.6706763214863167`*^9}, {
  3.670676483042409*^9, 3.670676578013033*^9}, {3.670676625718337*^9, 
  3.670676628004204*^9}, {3.670676743312656*^9, 
  3.6706767487757263`*^9}},ExpressionUUID->"e3ab23d5-8e3b-490c-b32c-\
8f8de31dd83a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["solving the Frenet-Serret equations", "Subsubsection",
 CellChangeTimes->{{3.670725684202384*^9, 
  3.6707257013338003`*^9}},ExpressionUUID->"7b035c10-7391-4d4a-af26-\
1e0358717fd2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xmin", ",", "xmax"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ymin", ",", "ymax"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"zmin", ",", "zmax"}], "}"}]}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Min", "[", "#", "]"}], ",", 
       RowBox[{"Max", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
    RowBox[{"Transpose", "[", "pts2", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ctrlPts", "=", 
   RowBox[{"Import", "[", "mline", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"xi", ",", "yi", ",", "zi"}], "}"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"BSplineFunction", "[", 
       RowBox[{"#", ",", 
        RowBox[{"SplineDegree", "\[Rule]", "4"}]}], "]"}], "&"}], "/@", 
     RowBox[{"Transpose", "[", "ctrlPts", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "s", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s", "[", "x_", "]"}], ":=", 
  RowBox[{"NIntegrate", "[", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xi", "'"}], "[", "t0", "]"}], ")"}], "^", "2"}], " ", "+", 
      " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"yi", "'"}], "[", "t0", "]"}], ")"}], "^", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"zi", "'"}], "[", "t0", "]"}], ")"}], "^", "2"}]}], "]"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"t0", ",", "0", ",", "x"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.657264228489072*^9, 3.657264262224662*^9}, 
   3.6584837573919783`*^9, {3.670306966055604*^9, 
   3.6703069825459642`*^9}},ExpressionUUID->"baaaa090-f468-44bd-bb50-\
e24906120a18"],

Cell[BoxData[
 RowBox[{"smin", "=", 
  RowBox[{"s", "[", "0", "]"}]}]], "Input",
 CellChangeTimes->{{3.657532910691523*^9, 
  3.657532913820859*^9}},ExpressionUUID->"ffddcc35-9431-41f6-be16-\
7348ce5d678e"],

Cell[BoxData[
 RowBox[{"smax", " ", "=", " ", 
  RowBox[{
   RowBox[{"s", "[", "1.", "]"}], "-", "0.001"}]}]], "Input",
 CellChangeTimes->{{3.657532915647379*^9, 3.6575329184857597`*^9}, 
   3.6581423917168913`*^9, {3.658142551112506*^9, 
   3.6581425537602367`*^9}},ExpressionUUID->"045cabe3-fc53-45c9-97ff-\
73ef4aafc25f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ipol", "=", 
   RowBox[{"ListInterpolation", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "t", "}"}], ",", 
        RowBox[{"s", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "0", ",", "1", ",", "0.05"}], "}"}]}], "]"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.657345818128326*^9, 3.657345841485382*^9}, {
   3.6573459420897284`*^9, 3.657345965124411*^9}, {3.657346041760828*^9, 
   3.657346060879562*^9}, 
   3.657532791982586*^9},ExpressionUUID->"0f17acb2-5084-473e-bc49-\
ebffd555895a"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "tp", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tp", "[", "s_", "]"}], ":=", 
  RowBox[{
   RowBox[{"InverseFunction", "[", "ipol", "]"}], "[", "s", "]"}]}]}], "Input",\

 CellChangeTimes->{{3.6573460636659203`*^9, 3.657346093806614*^9}, {
  3.6581419849927588`*^9, 3.65814198774489*^9}, {3.670726349379245*^9, 
  3.670726353081375*^9}},ExpressionUUID->"d07389b9-f2e7-4a51-ab8b-\
637f8fc263ba"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "xint", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xint", "[", "s_", "]"}], ":=", 
  RowBox[{"Chop", "[", 
   RowBox[{"xi", "[", 
    RowBox[{"tp", "[", "s", "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "yint", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yint", "[", "s_", "]"}], ":=", 
  RowBox[{"Chop", "[", 
   RowBox[{"yi", "[", 
    RowBox[{"tp", "[", "s", "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "zint", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zint", "[", "s_", "]"}], ":=", 
  RowBox[{"Chop", "[", 
   RowBox[{"zi", "[", 
    RowBox[{"tp", "[", "s", "]"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.657532795491921*^9, 3.657532846916621*^9}, {
  3.657532985285966*^9, 3.657532987001934*^9}, {3.657533020441791*^9, 
  3.65753303592013*^9}, {3.6575330948184137`*^9, 3.657533124107502*^9}, {
  3.670726356474152*^9, 3.670726362112317*^9}, {3.6707268910411987`*^9, 
  3.670726895119443*^9}},ExpressionUUID->"8e1e3be9-31b5-4bad-aea5-\
594c1141768d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Kappa]0", ",", "\[Tau]0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Ti0", ",", "Ni0", ",", "Bi0"}], "}"}]}], "}"}], " ", "=", 
   RowBox[{"FrenetSerretSystem", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xint", "[", "t", "]"}], ",", 
       RowBox[{"yint", "[", "t", "]"}], ",", 
       RowBox[{"zint", "[", "t", "]"}]}], "}"}], ",", "t"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670726141489395*^9, 
  3.670726160359025*^9}},ExpressionUUID->"ac95dc7d-d0b2-475e-ac7f-\
8e36d3cb31ee"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "r", ",", "s", ",", "t", ",", "n", ",", "b", ",", "\[Kappa]", ",", 
    "\[Tau]", ",", "r0", ",", "t0", ",", "n0", ",", "b0"}], "]"}], 
  ";"}]], "Input",ExpressionUUID->"f8465502-4f16-4b3a-b10e-43617342d4d8"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"\[Kappa]", ",", "\[Tau]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Kappa]", "[", "s_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{"\[Kappa]0", "/.", 
     RowBox[{"(", 
      RowBox[{"t", "\[Rule]", "s"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Tau]", "[", "s_", "]"}], ":=", 
   RowBox[{"\[Tau]0", "/.", 
    RowBox[{"(", 
     RowBox[{"t", "\[Rule]", "s"}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.67072617197198*^9, 3.670726185999049*^9}, {
   3.670726216545053*^9, 3.670726232911861*^9}, {3.6707262942611856`*^9, 
   3.670726320090952*^9}, {3.670726421080755*^9, 3.670726432177107*^9}, {
   3.6707298115822763`*^9, 3.6707298141711483`*^9}, {3.6707330684128723`*^9, 
   3.670733076669704*^9}, 
   3.6707331415704203`*^9},ExpressionUUID->"2b0db82f-09a7-4e17-b8c5-\
7d6226c4ac42"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"t0", ",", "n0", ",", "b0"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"t0", ",", "n0", ",", "b0"}], "}"}], "=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Ti", ",", "Ni", ",", "Bi"}], "}"}], "/.", 
   RowBox[{"t", "\[Rule]", "0"}]}]}]}], "Input",
 CellChangeTimes->{{3.6707269723627787`*^9, 3.670727002685224*^9}, {
  3.670731739811378*^9, 3.670731742027259*^9}, {3.670733078523773*^9, 
  3.670733085075445*^9}},ExpressionUUID->"427358e1-73dc-4f55-9fce-\
e179a4505f44"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "r0", "]"}], "\[IndentingNewLine]", 
 RowBox[{"r0", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"xint", "[", "0", "]"}], ",", 
    RowBox[{"yint", "[", "0", "]"}], ",", 
    RowBox[{"zint", "[", "0", "]"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.6707270137803392`*^9, 3.670727029851408*^9}, {
  3.670733097475074*^9, 
  3.670733097988418*^9}},ExpressionUUID->"ba15268f-d2ae-4e6e-8272-\
92fe8d4a430e"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "t", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"eqns", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"t", "'"}], "[", "s", "]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"\[Kappa]", "[", "s", "]"}], " ", 
        RowBox[{"n", "[", "s", "]"}]}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"n", "'"}], "[", "s", "]"}], "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"\[Kappa]", "[", "s", "]"}]}], " ", 
         RowBox[{"t", "[", "s", "]"}]}], "+", 
        RowBox[{
         RowBox[{"\[Tau]", "[", "s", "]"}], " ", 
         RowBox[{"b", "[", "s", "]"}]}]}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"b", "'"}], "[", "s", "]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[Tau]", "[", "s", "]"}]}], " ", 
        RowBox[{"n", "[", "s", "]"}]}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"r", "'"}], "[", "s", "]"}], "\[Equal]", 
       RowBox[{"t", "[", "s", "]"}]}], ",", 
      RowBox[{
       RowBox[{"t", "[", "0", "]"}], "\[Equal]", "t0"}], ",", 
      RowBox[{
       RowBox[{"n", "[", "0", "]"}], "\[Equal]", "n0"}], ",", 
      RowBox[{
       RowBox[{"b", "[", "0", "]"}], "\[Equal]", "b0"}], ",", 
      RowBox[{
       RowBox[{"r", "[", "0", "]"}], "\[Equal]", "r0"}]}], "}"}]}], ";"}], 
  "\n", "\n"}], "\n", 
 RowBox[{
  RowBox[{"sol", "=", 
   RowBox[{"First", "@", 
    RowBox[{"NDSolve", "[", 
     RowBox[{"eqns", ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", "t", ",", "n", ",", "b"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"s", ",", "0", ",", "249"}], "}"}]}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.670725702532131*^9, 3.6707257025725718`*^9}, {
   3.6707264097493258`*^9, 3.670726439622849*^9}, 3.6707265167903023`*^9, {
   3.670726936352687*^9, 3.670726937486918*^9}, 3.6707270112060013`*^9, {
   3.670727098413224*^9, 3.6707271003222857`*^9}, {3.6707271691866503`*^9, 
   3.67072718333039*^9}, {3.670733120925274*^9, 
   3.670733124931184*^9}},ExpressionUUID->"2d81595e-bdf2-4ee8-9722-\
3fe679de0e18"],

Cell[BoxData[
 RowBox[{"Graphics3D", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"r", "/.", "sol"}], ")"}], "[", "x", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", "smax", ",", "0.1"}], "}"}]}], "]"}], 
      "]"}], ",", "Red", ",", 
     RowBox[{"Line", "[", "midline", "]"}]}], "}"}], ",", 
   RowBox[{"Boxed", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.670725711901298*^9, 3.67072571214231*^9}, {
  3.670726537995584*^9, 3.670726603860136*^9}, {3.67072665567185*^9, 
  3.6707266584311867`*^9}, {3.670727200942355*^9, 3.670727216256673*^9}, {
  3.6707293521879883`*^9, 3.670729363681699*^9}, {3.6707294827113743`*^9, 
  3.670729497933557*^9}, {3.670729602890107*^9, 3.670729607218041*^9}, {
  3.6707296512725687`*^9, 3.670729651400323*^9}, {3.670729795493265*^9, 
  3.670729799235561*^9}, {3.670733170177573*^9, 
  3.6707331716251373`*^9}},ExpressionUUID->"af600083-1322-4162-bfce-\
466ef1587c73"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "removeTorsion", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"removeTorsion", "[", "alpha_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Kappa]", ",", "\[Tau]", ",", "t0", ",", "n0", ",", "b0", ",", "r0", 
      ",", "eqns", ",", "sol"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Kappa]", "[", "s_", "]"}], ":=", 
      RowBox[{"(", 
       RowBox[{"\[Kappa]0", "/.", 
        RowBox[{"(", 
         RowBox[{"t", "\[Rule]", "s"}], ")"}]}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Tau]", "[", "s_", "]"}], ":=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "alpha"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"\[Tau]0", "/.", 
         RowBox[{"(", 
          RowBox[{"t", "\[Rule]", "s"}], ")"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t0", ",", "n0", ",", "b0"}], "}"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Ti", ",", "Ni", ",", "Bi"}], "}"}], "/.", 
       RowBox[{"t", "\[Rule]", "0"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r0", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"xint", "[", "0", "]"}], ",", 
        RowBox[{"yint", "[", "0", "]"}], ",", 
        RowBox[{"zint", "[", "0", "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"eqns", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"t", "'"}], "[", "s", "]"}], "\[Equal]", 
         RowBox[{
          RowBox[{"\[Kappa]", "[", "s", "]"}], " ", 
          RowBox[{"n", "[", "s", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"n", "'"}], "[", "s", "]"}], "\[Equal]", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"\[Kappa]", "[", "s", "]"}]}], " ", 
           RowBox[{"t", "[", "s", "]"}]}], "+", 
          RowBox[{
           RowBox[{"\[Tau]", "[", "s", "]"}], " ", 
           RowBox[{"b", "[", "s", "]"}]}]}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"b", "'"}], "[", "s", "]"}], "\[Equal]", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"\[Tau]", "[", "s", "]"}]}], " ", 
          RowBox[{"n", "[", "s", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"r", "'"}], "[", "s", "]"}], "\[Equal]", 
         RowBox[{"t", "[", "s", "]"}]}], ",", 
        RowBox[{
         RowBox[{"t", "[", "0", "]"}], "\[Equal]", "t0"}], ",", 
        RowBox[{
         RowBox[{"n", "[", "0", "]"}], "\[Equal]", "n0"}], ",", 
        RowBox[{
         RowBox[{"b", "[", "0", "]"}], "\[Equal]", "b0"}], ",", 
        RowBox[{
         RowBox[{"r", "[", "0", "]"}], "\[Equal]", "r0"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sol", "=", 
      RowBox[{"First", "@", 
       RowBox[{"NDSolve", "[", 
        RowBox[{"eqns", ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "t", ",", "n", ",", "b"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "0", ",", "249"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"r", "/.", "sol"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6707332254716473`*^9, 3.670733372732245*^9}, {
  3.670733615134295*^9, 
  3.67073362012488*^9}},ExpressionUUID->"fe13896f-25f4-4a2c-abef-\
34a4aa0a41fc"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "removeCurvature", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"removeCurvature", "[", "alpha_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Kappa]", ",", "\[Tau]", ",", "t0", ",", "n0", ",", "b0", ",", "r0", 
      ",", "eqns", ",", "sol"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Kappa]", "[", "s_", "]"}], ":=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "alpha"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"\[Kappa]0", "/.", 
         RowBox[{"(", 
          RowBox[{"t", "\[Rule]", "s"}], ")"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Tau]", "[", "s_", "]"}], ":=", 
      RowBox[{
       RowBox[{"(", "0.05", ")"}], 
       RowBox[{"(", 
        RowBox[{"\[Tau]0", "/.", 
         RowBox[{"(", 
          RowBox[{"t", "\[Rule]", "s"}], ")"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t0", ",", "n0", ",", "b0"}], "}"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Ti", ",", "Ni", ",", "Bi"}], "}"}], "/.", 
       RowBox[{"t", "\[Rule]", "0"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r0", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"xint", "[", "0", "]"}], ",", 
        RowBox[{"yint", "[", "0", "]"}], ",", 
        RowBox[{"zint", "[", "0", "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"eqns", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"t", "'"}], "[", "s", "]"}], "\[Equal]", 
         RowBox[{
          RowBox[{"\[Kappa]", "[", "s", "]"}], " ", 
          RowBox[{"n", "[", "s", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"n", "'"}], "[", "s", "]"}], "\[Equal]", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"\[Kappa]", "[", "s", "]"}]}], " ", 
           RowBox[{"t", "[", "s", "]"}]}], "+", 
          RowBox[{
           RowBox[{"\[Tau]", "[", "s", "]"}], " ", 
           RowBox[{"b", "[", "s", "]"}]}]}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"b", "'"}], "[", "s", "]"}], "\[Equal]", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"\[Tau]", "[", "s", "]"}]}], " ", 
          RowBox[{"n", "[", "s", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"r", "'"}], "[", "s", "]"}], "\[Equal]", 
         RowBox[{"t", "[", "s", "]"}]}], ",", 
        RowBox[{
         RowBox[{"t", "[", "0", "]"}], "\[Equal]", "t0"}], ",", 
        RowBox[{
         RowBox[{"n", "[", "0", "]"}], "\[Equal]", "n0"}], ",", 
        RowBox[{
         RowBox[{"b", "[", "0", "]"}], "\[Equal]", "b0"}], ",", 
        RowBox[{
         RowBox[{"r", "[", "0", "]"}], "\[Equal]", "r0"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sol", "=", 
      RowBox[{"First", "@", 
       RowBox[{"NDSolve", "[", 
        RowBox[{"eqns", ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "t", ",", "n", ",", "b"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "0", ",", "249"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"r", "/.", "sol"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",\

 CellChangeTimes->{{3.670734050006229*^9, 
  3.670734077605364*^9}},ExpressionUUID->"c6d5410d-787e-47e8-90c8-\
121d9a2faef0"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "removeCurvatureTurn", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"removeCurvatureTurn", "[", 
   RowBox[{"alpha_", ",", 
    RowBox[{"angle_:", "angle"}], ",", 
    RowBox[{"axis_:", "rotVector"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Kappa]", ",", "\[Tau]", ",", "t0", ",", "n0", ",", "b0", ",", "r0", 
      ",", "eqns", ",", "sol"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Kappa]", "[", "s_", "]"}], ":=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "alpha"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"\[Kappa]0", "/.", 
         RowBox[{"(", 
          RowBox[{"t", "\[Rule]", "s"}], ")"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Tau]", "[", "s_", "]"}], ":=", 
      RowBox[{
       RowBox[{"(", "0.05", ")"}], 
       RowBox[{"(", 
        RowBox[{"\[Tau]0", "/.", 
         RowBox[{"(", 
          RowBox[{"t", "\[Rule]", "s"}], ")"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t0", ",", "n0", ",", "b0"}], "}"}], "=", 
      RowBox[{
       RowBox[{"RotationMatrix", "[", 
        RowBox[{
         RowBox[{"alpha", " ", "angle"}], ",", "axis"}], "]"}], ".", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Ti", ",", "Ni", ",", "Bi"}], "}"}], "/.", 
         RowBox[{"t", "\[Rule]", "0"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"r0", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"xint", "[", "0", "]"}], ",", 
        RowBox[{"yint", "[", "0", "]"}], ",", 
        RowBox[{"zint", "[", "0", "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"eqns", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"t", "'"}], "[", "s", "]"}], "\[Equal]", 
         RowBox[{
          RowBox[{"\[Kappa]", "[", "s", "]"}], " ", 
          RowBox[{"n", "[", "s", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"n", "'"}], "[", "s", "]"}], "\[Equal]", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"\[Kappa]", "[", "s", "]"}]}], " ", 
           RowBox[{"t", "[", "s", "]"}]}], "+", 
          RowBox[{
           RowBox[{"\[Tau]", "[", "s", "]"}], " ", 
           RowBox[{"b", "[", "s", "]"}]}]}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"b", "'"}], "[", "s", "]"}], "\[Equal]", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"\[Tau]", "[", "s", "]"}]}], " ", 
          RowBox[{"n", "[", "s", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"r", "'"}], "[", "s", "]"}], "\[Equal]", 
         RowBox[{"t", "[", "s", "]"}]}], ",", 
        RowBox[{
         RowBox[{"t", "[", "0", "]"}], "\[Equal]", "t0"}], ",", 
        RowBox[{
         RowBox[{"n", "[", "0", "]"}], "\[Equal]", "n0"}], ",", 
        RowBox[{
         RowBox[{"b", "[", "0", "]"}], "\[Equal]", "b0"}], ",", 
        RowBox[{
         RowBox[{"r", "[", "0", "]"}], "\[Equal]", "r0"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sol", "=", 
      RowBox[{"First", "@", 
       RowBox[{"NDSolve", "[", 
        RowBox[{"eqns", ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "t", ",", "n", ",", "b"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "0", ",", "249"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"r", "/.", "sol"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",\

 CellChangeTimes->{{3.670752976425336*^9, 3.670752979223507*^9}, {
  3.670753364244713*^9, 3.670753378012005*^9}, {3.6707534172671633`*^9, 
  3.670753432164103*^9}, {3.670770390026923*^9, 3.6707704053851757`*^9}, {
  3.670770619868084*^9, 
  3.67077062065923*^9}},ExpressionUUID->"486b192f-cb35-402e-9e37-\
d24f6233103d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rotationAxis", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rotationAngle", "=", 
   RowBox[{"8", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Pi]", "/", "2"}], ")"}], "/", "9"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.670753305890916*^9, 3.6707533602615347`*^9}, {
   3.670753400420825*^9, 3.6707534026263533`*^9}, 3.6707534482192707`*^9, {
   3.670754008128722*^9, 3.6707540103204412`*^9}, {3.670754079271901*^9, 
   3.670754080750554*^9}},ExpressionUUID->"9c139a46-4a5a-4130-b094-\
d426ab6f3236"],

Cell[BoxData[
 RowBox[{"rotVector", "=", 
  RowBox[{"Cross", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"transformToStandardView", "@", "t0"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.670770071993154*^9, 3.670770090225*^9}, {
   3.6707701259200773`*^9, 3.670770154727002*^9}, 
   3.67077029014132*^9},ExpressionUUID->"0b054f95-7ea6-4f90-8052-\
d2876c40baf5"],

Cell[BoxData[
 RowBox[{"angle", "=", 
  RowBox[{"VectorAngle", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"transformToStandardView", "@", "t0"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.670770156311062*^9, 3.670770169538775*^9}, 
   3.6707702949555693`*^9},ExpressionUUID->"0b375fb2-ed57-42f1-872d-\
33c8f90d5119"],

Cell[BoxData[
 RowBox[{
  RowBox[{"test", "=", 
   RowBox[{"removeCurvatureTurn", "[", 
    RowBox[{"0.5", ",", "angle", ",", "rotVector"}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.670753459655388*^9, 3.670753491175664*^9}, {
  3.670753965186593*^9, 3.670753969745701*^9}, {3.670754034442194*^9, 
  3.670754039991611*^9}, {3.670754102328373*^9, 3.670754104269245*^9}, {
  3.670770440183793*^9, 3.670770447353423*^9}, {3.670770529462317*^9, 
  3.67077055174988*^9}, {3.670770590642864*^9, 3.670770590922184*^9}, {
  3.670770639881605*^9, 
  3.670770663176379*^9}},ExpressionUUID->"9d915d6d-b0ba-4588-853e-\
7070560c275d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"inerTest", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"BSplineFunction", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"#", "[", "s", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "0", ",", "smax", ",", "0.5"}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"SplineDegree", "\[Rule]", "4"}]}], "]"}], "&"}], "@", 
    "test"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.670753559719433*^9, 
  3.6707535682931843`*^9}},ExpressionUUID->"8cd07e19-a265-4d26-8fd5-\
d9aac4e63100"],

Cell[BoxData[
 RowBox[{"Graphics3D", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Point", "[", 
       RowBox[{"transformToStandardView", "[", "#", "]"}], "]"}], "&"}], "/@", 
     RowBox[{"computeIntermediateHeartGeometry", "[", "inerTest", "]"}]}], 
    "}"}], ",", 
   RowBox[{"ViewPoint", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "2"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.67075348585575*^9, 
  3.670753589820826*^9}},ExpressionUUID->"fe293b5c-490c-4a8f-9226-\
226a3832de89"],

Cell[BoxData[
 RowBox[{"showNodesAdaptive", "[", 
  RowBox[{"computeIntermediateHeartGeometry", "[", "inerTest", "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.670753797933069*^9, 
  3.670753820090433*^9}},ExpressionUUID->"e02a7492-903b-4d4a-8732-\
7b00c60975f7"],

Cell[BoxData[
 RowBox[{"rot1", "=", 
  RowBox[{"RotationMatrix", "[", 
   RowBox[{
    RowBox[{"-", "angle"}], ",", "rotVector"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.670768844882782*^9, 3.670768881089777*^9}, {
   3.6707689195045567`*^9, 3.670768919760661*^9}, {3.670768955968214*^9, 
   3.6707689923427887`*^9}, {3.670769352124323*^9, 3.670769360627851*^9}, {
   3.6707694556027813`*^9, 3.670769455904893*^9}, {3.6707701808888683`*^9, 
   3.67077018941813*^9}, 
   3.670770310291593*^9},ExpressionUUID->"44ff4c3c-70e1-46b2-b6c7-\
5e791a575404"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"t1", ",", "n1", ",", "b1"}], "}"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"rot1", ".", 
     RowBox[{"(", 
      RowBox[{"transformToStandardView", "[", "#", "]"}], ")"}]}], "&"}], "/@", 
   RowBox[{"{", 
    RowBox[{"t0", ",", "n0", ",", "b0"}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.67077023599582*^9, 
  3.670770266899867*^9}},ExpressionUUID->"be02e079-e193-4dbe-b271-\
9639dd5ec64a"],

Cell[BoxData[
 RowBox[{"Graphics3D", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Thick", ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"10", "t1"}]}], "}"}], "]"}], ",", "Gray", ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"10", "n1"}]}], "}"}], "]"}], ",", "Blue", ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"10", "b1"}]}], "}"}], "]"}]}], "}"}], ",", 
   RowBox[{"Axes", "\[Rule]", "True"}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\""}], "}"}]}], ",", 
   
   RowBox[{"ViewPoint", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "2"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.670752993967341*^9, 3.670753091794215*^9}, {
  3.6707532082326317`*^9, 3.670753293021209*^9}, {3.670768477135264*^9, 
  3.6707685572994747`*^9}, {3.670768607370513*^9, 3.67076865282483*^9}, {
  3.670768749368289*^9, 3.670768769800674*^9}, {3.670768888914063*^9, 
  3.6707689012897463`*^9}, {3.670768932096588*^9, 3.670768945152573*^9}, {
  3.670769038439596*^9, 3.670769111435894*^9}, {3.670769504608032*^9, 
  3.670769504687419*^9}, {3.6707702115271797`*^9, 
  3.670770222245726*^9}},ExpressionUUID->"07b39f92-2e4a-4d6e-8669-\
43ebfc1d1258"],

Cell[BoxData[
 RowBox[{
  RowBox[{"intermediateLines", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"removeTorsion", "[", "alpha", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"alpha", ",", "0", ",", "0.99", ",", "0.01"}], "}"}]}], "]"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.670733379305916*^9, 3.6707334212250967`*^9}, {
  3.67073362477914*^9, 3.670733634490131*^9}, {3.670734516612916*^9, 
  3.6707345222141523`*^9}},ExpressionUUID->"8cfceca7-a105-46fb-b9e9-\
a7ab2ccad7f8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"intermediateLines2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"removeCurvature", "[", "alpha", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"alpha", ",", "0", ",", "0.99", ",", "0.01"}], "}"}]}], "]"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.670734093540894*^9, 3.670734099393105*^9}, {
  3.670734519765397*^9, 
  3.6707345254959593`*^9}},ExpressionUUID->"1c8b548b-034b-44bd-a425-\
b2d896f8915d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"intermediateLines2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"removeCurvatureTurn", "[", 
      RowBox[{"alpha", ",", "angle", ",", "rotVector"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"alpha", ",", "0", ",", "0.99", ",", "0.01"}], "}"}]}], "]"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.6707704858213263`*^9, 
  3.670770495925254*^9}},ExpressionUUID->"c619d4db-5024-4ff4-a338-\
cfd4eb3e2622"],

Cell[BoxData[
 RowBox[{
  RowBox[{"interpolatedMidlines", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"BSplineFunction", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"#", "[", "s", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "0", ",", "smax", ",", "0.5"}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"SplineDegree", "\[Rule]", "4"}]}], "]"}], "&"}], "/@", 
    "intermediateLines"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6707335187986794`*^9, 
  3.670733547692766*^9}},ExpressionUUID->"8b5d4d3a-f2b8-4c0e-a49b-\
ca365ad89c32"],

Cell[BoxData[
 RowBox[{
  RowBox[{"interpolatedMidlines2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"BSplineFunction", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"#", "[", "s", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "0", ",", "smax", ",", "0.5"}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"SplineDegree", "\[Rule]", "4"}]}], "]"}], "&"}], "/@", 
    "intermediateLines2"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6707341090848093`*^9, 
  3.670734111277372*^9}},ExpressionUUID->"d141c875-8757-4c1a-b818-\
1cfb6b021641"],

Cell[BoxData[
 RowBox[{"Graphics3D", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Line", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"#", "[", "s", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"s", ",", "0", ",", "smax", ",", "0.5"}], "}"}]}], "]"}], 
     "]"}], "&"}], "/@", 
   RowBox[{"Join", "[", 
    RowBox[{"intermediateLines", ",", "intermediateLines2"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6707335570095*^9, 3.670733573365151*^9}, {
  3.670734133387774*^9, 
  3.670734145423471*^9}},ExpressionUUID->"3e892611-ed4e-427f-b9fb-\
92ce6d35768a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"intermediatePoints", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"computeIntermediateHeartGeometry", "[", "#", "]"}], "&"}], "/@",
     "interpolatedMidlines"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.670733782912477*^9, {3.670733849037225*^9, 
   3.6707338689876947`*^9}},ExpressionUUID->"2abae24c-0643-4f42-a398-\
735fc2387e5c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"intermediatePoints2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"computeIntermediateHeartGeometry", "[", "#", "]"}], "&"}], "/@",
     "interpolatedMidlines2"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.670734155746179*^9, 
  3.670734157513968*^9}},ExpressionUUID->"08efd64f-b9b2-4eb6-8e89-\
4125505c414f"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Graphics3D", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"AbsolutePointSize", "[", "3", "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"transformToStandardView", "[", "#", "]"}], "]"}], "&"}], "/@", 
        RowBox[{"intermediatePoints", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"ViewPoint", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "2"}], "}"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "intermediatePoints", "]"}], ",", "1"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.670733898503622*^9, 
  3.6707339690484247`*^9}},ExpressionUUID->"6041b228-d4ed-4b05-aa82-\
5fa9d100c204"],

Cell[BoxData[
 RowBox[{"axis", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Mean", "[", 
     RowBox[{"transformToStandardView", "/@", 
      RowBox[{"intermediatePoints2", "[", 
       RowBox[{"[", "100", "]"}], "]"}]}], "]"}], ",", 
    RowBox[{
     RowBox[{"Mean", "[", 
      RowBox[{"transformToStandardView", "/@", 
       RowBox[{"intermediatePoints2", "[", 
        RowBox[{"[", "100", "]"}], "]"}]}], "]"}], "+", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "10"}], "}"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6707379258867893`*^9, 3.6707379597289133`*^9}, {
  3.670737993543726*^9, 3.670738020894418*^9}, {3.670738055829603*^9, 
  3.6707380571332417`*^9}, {3.670738093196187*^9, 3.670738157385211*^9}, {
  3.6707382857172947`*^9, 3.670738287412794*^9}, {3.670738345795347*^9, 
  3.67073834843433*^9}, {3.6707384061769342`*^9, 
  3.6707384776315403`*^9}},ExpressionUUID->"d8da79e0-a7a0-4b6e-8307-\
d831e89a4467"],

Cell[BoxData[
 RowBox[{"rot", "=", 
  RowBox[{"RotationMatrix", "[", 
   RowBox[{
    RowBox[{"\[Pi]", "/", "2"}], ",", "axis"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.670738008808865*^9, 
  3.670738034301962*^9}},ExpressionUUID->"09e4e53e-a47b-44a4-be81-\
11904b559b0c"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Graphics3D", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"AbsolutePointSize", "[", "3", "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"rot", ".", 
           RowBox[{"transformToStandardView", "[", "#", "]"}]}], "]"}], "&"}],
         "/@", 
        RowBox[{"intermediatePoints2", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"ViewPoint", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "2"}], "}"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "intermediatePoints2", "]"}], ",", "1"}], "}"}]}],
   "]"}]], "Input",
 CellChangeTimes->{{3.67073416665357*^9, 3.670734168516985*^9}, {
  3.670738041424192*^9, 3.670738042157937*^9}, {3.670738081870812*^9, 
  3.670738085316327*^9}},ExpressionUUID->"5c6fc51d-35cb-447d-89a0-\
197cf5ce96ae"],

Cell[BoxData[
 RowBox[{"showNodesTrail", "[", 
  RowBox[{"Take", "[", 
   RowBox[{"intermediatePoints", ",", "100"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.670679699288466*^9, 3.670679722896117*^9}, {
  3.6706797616249123`*^9, 3.6706797897101173`*^9}, {3.6706799493070297`*^9, 
  3.670679949704588*^9}, {3.67068000748109*^9, 3.670680008375182*^9}, {
  3.670734610535202*^9, 3.670734612420465*^9}, {3.670737779785531*^9, 
  3.670737780911381*^9}},ExpressionUUID->"107dd728-80b0-47b5-b8ff-\
4a9be9e847ff"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showNodesTrailAdaptive", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showNodesTrailAdaptive", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"centroidLst_:", "pts2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "maxZ", ",", "minZ", ",", "stdCentroids", ",", "n", ",", 
      "finalProjection", ",", "transferFunction", ",", "centroids", ",", 
      "trails"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "\"\<1234\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"centroids", "=", 
      RowBox[{"Last", "[", "centroidLst", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"trails", "=", 
      RowBox[{"dataTransform", "/@", 
       RowBox[{"Transpose", "[", "centroidLst", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"stdCentroids", " ", "=", " ", 
      RowBox[{"dataTransform", "/@", "centroids"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"maxZ", ",", " ", "minZ"}], "}"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Graphics3D", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Opacity", "[", "0.2", "]"}], ",", 
                  RowBox[{"GrayLevel", "[", 
                   RowBox[{"0.5", "+", 
                    RowBox[{"0.2", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"maxZ", "-", "minZ"}], ")"}]}], ")"}]}], 
                    ")"}]}]}], "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{"#", ",", "2.5"}], "]"}], ",", 
                  RowBox[{"Opacity", "[", "1", "]"}], ",", 
                  RowBox[{"GrayLevel", "[", "0.3", "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{"#", ",", "1"}], "]"}]}], "}"}], "&"}], "/@", 
               RowBox[{"(", "stdCentroids", ")"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"AbsoluteThickness", "[", "1.5", "]"}], ",", 
                RowBox[{"GrayLevel", "[", "0.3", "]"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Line", "[", "#", "]"}], "&"}], "/@", "trails"}]}], 
               "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"Lighting", "->", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"ViewPoint", "\[Rule]", "Top"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
           RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "None"}]}], "]"}], ",", 
         RowBox[{"RasterSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", "finalProjection", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "200"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "50"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.670738550641561*^9, 
  3.6707385633788157`*^9}},ExpressionUUID->"ad5cda6b-b744-49d5-a2fe-\
59329f77d059"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showNodesAdaptive", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showNodesAdaptive", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"centroids_:", "pts2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "maxZ", ",", "minZ", ",", "stdCentroids", ",", "n", ",", 
      "finalProjection", ",", "transferFunction", ",", "trails"}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "\"\<1234\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"stdCentroids", " ", "=", " ", 
      RowBox[{"dataTransform", "/@", "centroids"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"maxZ", ",", " ", "minZ"}], "}"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"Graphics3D", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Opacity", "[", "0.2", "]"}], ",", 
                 RowBox[{"GrayLevel", "[", 
                  RowBox[{"0.5", "+", 
                   RowBox[{"0.2", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"maxZ", "-", "minZ"}], ")"}]}], ")"}]}], 
                    ")"}]}]}], "]"}], ",", 
                 RowBox[{"Sphere", "[", 
                  RowBox[{"#", ",", "2.5"}], "]"}], ",", 
                 RowBox[{"Opacity", "[", "1", "]"}], ",", 
                 RowBox[{"GrayLevel", "[", "0.3", "]"}], ",", 
                 RowBox[{"Sphere", "[", 
                  RowBox[{"#", ",", "1"}], "]"}]}], "}"}], "&"}], "/@", 
              RowBox[{"(", "stdCentroids", ")"}]}], "]"}], 
            "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", 
           RowBox[{"Lighting", "->", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"ViewPoint", "\[Rule]", "Top"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
           RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "None"}]}], "]"}], ",", 
         RowBox[{"RasterSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", "finalProjection", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "200"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "50"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.6707389609353533`*^9, 
  3.6707389804795227`*^9}},ExpressionUUID->"e9a3022e-823b-43a4-bbd2-\
0b8ab4ac6613"],

Cell[BoxData[
 RowBox[{"showNodesTrailAdaptive", "[", 
  RowBox[{"Take", "[", 
   RowBox[{"intermediatePoints2", ",", "100"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{
  3.67073782780551*^9, {3.6707385721694593`*^9, 
   3.67073858586764*^9}},ExpressionUUID->"e76feedc-a3a9-454b-871a-\
f2f405020878"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-4/\
part-2-a/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"t", ",", "10", ",", "4"}], "]"}], "<>", "\"\<.png\>\""}], 
      ",", 
      RowBox[{"showNodesTrail", "[", 
       RowBox[{"Take", "[", 
        RowBox[{"intermediatePoints", ",", "t"}], "]"}], "]"}]}], "]"}], ",", 
    
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "100", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670680253096822*^9, 3.6706802766632147`*^9}, {
  3.6707378170065117`*^9, 
  3.670737819655587*^9}},ExpressionUUID->"9958585e-67ac-4ffb-9401-\
64739569e170"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-4/\
part-2-b/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"t", ",", "10", ",", "4"}], "]"}], "<>", "\"\<.png\>\""}], 
      ",", 
      RowBox[{"showNodesTrailAdaptive", "[", 
       RowBox[{"Take", "[", 
        RowBox[{"intermediatePoints2", ",", "t"}], "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "100", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6707386114659443`*^9, 
  3.6707386243219337`*^9}},ExpressionUUID->"1fd7ce3d-0a41-4044-9ed8-\
1f2e4ff9b4e1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-4/\
part-2-b-trailless/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"t", ",", "10", ",", "4"}], "]"}], "<>", "\"\<.png\>\""}], 
      ",", 
      RowBox[{"showNodesAdaptive", "[", 
       RowBox[{"intermediatePoints2", "[", 
        RowBox[{"[", "t", "]"}], "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "100", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6707389983100653`*^9, 
  3.670739021493019*^9}},ExpressionUUID->"6112782f-af9a-4b0c-adf0-\
2fe103ba7717"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ptsCylinderFlat", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"35", ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}], "/@", 
    "ptsCylinder"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.670739259145679*^9, 
  3.670739288974854*^9}},ExpressionUUID->"08faa604-e384-4f67-bc9a-\
0a55221d51a0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"start", "=", 
   RowBox[{"Last", "[", "intermediatePoints2", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6707392422374687`*^9, 
  3.670739256054229*^9}},ExpressionUUID->"bb100f2b-a564-4991-818e-\
fcca4d698940"],

Cell[BoxData[
 RowBox[{
  RowBox[{"end", "=", 
   RowBox[{"computeIntermediateHeartGeometry", "[", 
    RowBox[{
     RowBox[{"Last", "[", "interpolatedMidlines2", "]"}], ",", 
     "ptsCylinderFlat"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6707392914609947`*^9, 
  3.670739331814378*^9}},ExpressionUUID->"c0dd47de-ba7d-4a81-b2a7-\
c144cf6014dc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"displacement", "=", 
   RowBox[{"end", "-", "start"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.670739338362875*^9, 
  3.670739349365456*^9}},ExpressionUUID->"16ce0cd9-4615-46e7-b622-\
090b880df7cd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"blowUpPoints", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"start", "+", 
      RowBox[{"a", " ", "displacement"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "0", ",", "1", ",", "0.01"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670739355110736*^9, 
  3.670739381597134*^9}},ExpressionUUID->"1d3a26bc-5806-4d10-bfba-\
6bf7e1c489f2"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showNodesBlowUp", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showNodesBlowUp", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"centroids_:", "pts2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "maxZ", ",", "minZ", ",", "stdCentroids", ",", "n", ",", 
      "finalProjection", ",", "transferFunction", ",", "trails"}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "\"\<1234\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"stdCentroids", " ", "=", " ", 
      RowBox[{"dataTransform", "/@", "centroids"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"maxZ", ",", " ", "minZ"}], "}"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"Graphics3D", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Opacity", "[", "0.2", "]"}], ",", 
                 RowBox[{"GrayLevel", "[", 
                  RowBox[{"0.5", "+", 
                   RowBox[{"0.2", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"maxZ", "-", "minZ"}], ")"}]}], ")"}]}], 
                    ")"}]}]}], "]"}], ",", 
                 RowBox[{"Sphere", "[", 
                  RowBox[{"#", ",", "2.5"}], "]"}], ",", 
                 RowBox[{"Opacity", "[", "1", "]"}], ",", 
                 RowBox[{"GrayLevel", "[", "0.3", "]"}], ",", 
                 RowBox[{"Sphere", "[", 
                  RowBox[{"#", ",", "1"}], "]"}]}], "}"}], "&"}], "/@", 
              RowBox[{"(", "stdCentroids", ")"}]}], "]"}], 
            "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", 
           RowBox[{"Lighting", "->", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"ViewPoint", "\[Rule]", "Top"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "160"}], ",", "95"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "80"}], ",", "30"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"165", ",", "255"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "None"}]}], "]"}], ",", 
         RowBox[{"RasterSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", "finalProjection", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "200"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "50"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.670772238477687*^9, 3.6707722441959476`*^9}, {
  3.67077228144306*^9, 3.670772371699368*^9}, {3.670772483717043*^9, 
  3.6707724878852043`*^9}},ExpressionUUID->"0b25fa5b-f946-4cbd-94c9-\
6c314bd67a22"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Min", "[", "#", "]"}], ",", 
     RowBox[{"Max", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
  RowBox[{"Transpose", "[", 
   RowBox[{"transformToStandardView", "/@", 
    RowBox[{"blowUpPoints", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.670772249966744*^9, 3.670772275410228*^9}, 
   3.670772474382751*^9},ExpressionUUID->"744a8074-72f2-4ec7-a526-\
a2e95e888ccf"],

Cell[BoxData[
 RowBox[{"showNodesBlowUp", "[", 
  RowBox[{"blowUpPoints", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.670739383886479*^9, 3.6707393945808983`*^9}, {
   3.67077184333689*^9, 3.670771848201825*^9}, {3.6707723206571198`*^9, 
   3.670772323690284*^9}, 
   3.670772380305187*^9},ExpressionUUID->"178efb93-c689-47da-9a71-\
7c2430796fa9"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.670752899678864*^9, 3.670752902970375*^9}, {
  3.6707529370397243`*^9, 
  3.670752938879821*^9}},ExpressionUUID->"d6607fb8-2b01-437c-a60b-\
81657242d1b5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-4/\
part-2-c/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"t", ",", "10", ",", "4"}], "]"}], "<>", "\"\<.png\>\""}], 
      ",", 
      RowBox[{"showNodesBlowUp", "[", 
       RowBox[{"blowUpPoints", "[", 
        RowBox[{"[", "t", "]"}], "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "100", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670739430516576*^9, 3.670739441885194*^9}, {
  3.670772435064447*^9, 
  3.6707724398249187`*^9}},ExpressionUUID->"6fbb9397-9729-46c8-8a75-\
90cd4e1bd110"],

Cell[BoxData[
 RowBox[{"Length", "[", "intermediatePoints", "]"}]], "Input",
 CellChangeTimes->{{3.6707343925351458`*^9, 
  3.67073439736308*^9}},ExpressionUUID->"ccaa6e27-dbcb-48af-a672-\
73fd36df822d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"testCylPts", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"2", "\[Pi]"}]}], "}"}], "]"}], ",", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], "]"}]}], "}"}], ",", 
     
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "400"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6706758875131474`*^9, 
  3.6706759594734163`*^9}},ExpressionUUID->"e60541e1-5435-4a9c-b9a9-\
b768bd8d108e"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.670675962800527*^9, 3.670675972136806*^9}, 
   3.670676029758923*^9},ExpressionUUID->"78a6f97c-8607-449b-8024-\
928f158cfc23"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Insert", "[", 
   RowBox[{
    RowBox[{"unroll", "[", 
     RowBox[{"\[Phi]", ",", "\[Theta]", ",", 
      RowBox[{"-", "1"}]}], "]"}], ",", "v", ",", "1"}], "]"}], "+", 
  RowBox[{"{", 
   RowBox[{"\[Pi]", ",", 
    RowBox[{"-", "\[Pi]"}], ",", "0"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.670661799643724*^9, 3.670661804794361*^9}, {
  3.6706618489524193`*^9, 
  3.670661873527978*^9}},ExpressionUUID->"2e10de7c-2936-48f7-93bf-\
06418c44d096"],

Cell[BoxData[
 RowBox[{"unrolledCylinder", "=", 
  RowBox[{"Graphics3D", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Dashed", ",", 
      RowBox[{"Line", "[", 
       RowBox[{"cyl2cart", "/@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"AbsolutePointSize", "[", "4", "]"}], ",", 
      RowBox[{"MapIndexed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"\[Pi]", "<=", 
              RowBox[{
               RowBox[{"ptsCylinder", "[", 
                RowBox[{"[", 
                 RowBox[{"#2", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
             RowBox[{"Directive", "[", 
              RowBox[{
               RowBox[{"AbsolutePointSize", "[", "7", "]"}], ",", "Gray"}], 
              "]"}], ",", 
             RowBox[{"Directive", "[", 
              RowBox[{
               RowBox[{"Opacity", "[", "0.4", "]"}], ",", "Black"}], "]"}]}], 
            "]"}], ",", 
           RowBox[{"Point", "[", 
            RowBox[{"cyl2cart", "[", "#1", "]"}], "]"}]}], "}"}], "&"}], ",", 
        "ptsCylinder"}], "]"}]}], "}"}], ",", 
    RowBox[{"ViewPoint", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "Infinity"}], "}"}]}], ",", 
    RowBox[{"Boxed", "\[Rule]", "False"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.657986769896801*^9, 3.657986937082038*^9}, {
  3.657986993449499*^9, 3.657987070061286*^9}, {3.6582345301370983`*^9, 
  3.658234533174749*^9}, {3.6585890298176603`*^9, 3.6585890351668167`*^9}, {
  3.662104431923518*^9, 3.662104437734913*^9}, {3.670577332175994*^9, 
  3.670577348095648*^9}},ExpressionUUID->"4d78de3c-1bfb-46b2-b870-\
ce01a52c4083"],

Cell[BoxData[
 RowBox[{"flattenedHeart", "=", 
  RowBox[{"Graphics", "[", 
   RowBox[{
    RowBox[{"MapIndexed", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"minAngle", "<=", 
            RowBox[{
             RowBox[{"ptsCylinder", "[", 
              RowBox[{"[", 
               RowBox[{"#2", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", "maxAngle"}], 
           ",", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"AbsolutePointSize", "[", "7", "]"}], ",", "Gray"}], 
            "]"}], ",", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"Opacity", "[", "0.4", "]"}], ",", "Black", ",", 
             RowBox[{"AbsolutePointSize", "[", "4", "]"}]}], "]"}]}], "]"}], 
         ",", 
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "10"}], 
             RowBox[{"#1", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ",", 
            RowBox[{"#1", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]}], "}"}], "&"}], 
      ",", "ptsCylinder"}], "]"}], ",", 
    RowBox[{"Axes", "\[Rule]", "True"}], ",", 
    RowBox[{"AxesOrigin", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], ",", 
    RowBox[{"Ticks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "10"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "5"}], ",", "0.5"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", "\[Pi]"}], ",", "\[Pi]", ",", 
         RowBox[{"\[Pi]", "/", "2"}], ",", 
         RowBox[{
          RowBox[{"-", "\[Pi]"}], "/", "2"}]}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", "11"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3.2"}], ",", "3.2"}], "}"}]}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6579871822109632`*^9, 3.657987231120967*^9}, {
  3.657987283689743*^9, 3.657987427971757*^9}, {3.658234548081234*^9, 
  3.6582345810221977`*^9}, {3.662104364756791*^9, 3.662104369020638*^9}, {
  3.662104442211701*^9, 
  3.6621044472509127`*^9}},ExpressionUUID->"12cac2ec-9419-4d79-b665-\
b659d3f79e09"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showNodesAndNEdges", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showNodesAndNEdges", "[", "\[IndentingNewLine]", 
   RowBox[{"n_", ",", "\[IndentingNewLine]", 
    RowBox[{"centroids_:", "pts2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}], ",", "\[IndentingNewLine]", 
    RowBox[{"edges_:", "myEdges"}]}], "\[IndentingNewLine]", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "maxZ", ",", "minZ", ",", "stdCentroids", ",", "finalProjection", ",", 
      "transferFunction"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "\"\<1234\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"stdCentroids", " ", "=", " ", 
      RowBox[{"dataTransform", "/@", "centroids"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"maxZ", ",", " ", "minZ"}], "}"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Graphics3D", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Gray", ",", 
                  RowBox[{"Specularity", "[", "0.", "]"}], ",", 
                  RowBox[{"GrayLevel", "[", 
                   RowBox[{"0.5", "+", 
                    RowBox[{"0.2", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"maxZ", "-", "minZ"}], ")"}]}], ")"}]}], 
                    ")"}]}]}], "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{"#", ",", "2"}], "]"}]}], "}"}], "&"}], "/@", 
               RowBox[{"(", "stdCentroids", ")"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"GrayLevel", "[", 
                   RowBox[{"0.5", "+", 
                    RowBox[{"0.2", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"stdCentroids", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"maxZ", "-", "minZ"}], ")"}]}], ")"}]}], 
                    ")"}]}]}], "]"}], ",", 
                  RowBox[{"Tube", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"stdCentroids", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"stdCentroids", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}], 
                    ",", "0.25"}], "]"}]}], "}"}], "&"}], "/@", 
               RowBox[{"Take", "[", 
                RowBox[{"edges", ",", "n"}], "]"}]}], "]"}]}], "}"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"Lighting", "->", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"ViewPoint", "\[Rule]", "Top"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "None"}]}], "]"}], ",", 
         RowBox[{"RasterSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", "finalProjection", "}"}], ",", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "200"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "50"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",ExpressionUUID->"075c15d0-db29-\
488d-af63-2a028cdf0852"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{787, 1116},
WindowMargins->{{Automatic, 470}, {Automatic, 0}},
FrontEndVersion->"11.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (April 27, \
2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 167, 3, 44, "Subsection", "ExpressionUUID" -> \
"253f1c94-683e-45f9-a990-d2050a508c4b"],
Cell[750, 27, 1759, 26, 32, "Input", "ExpressionUUID" -> \
"fd8fcc77-2fa7-4cd8-b692-a97eaaa48292"],
Cell[2512, 55, 426, 12, 32, "Input", "ExpressionUUID" -> \
"cdc0b164-a6d4-4a71-88a3-0bce04efe8b6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2975, 72, 219, 4, 44, "Subsection", "ExpressionUUID" -> \
"098abeac-76b6-44ee-8cfa-4eff7110d5b4"],
Cell[3197, 78, 698, 18, 63, "Input", "ExpressionUUID" -> \
"06893693-f5d0-41a9-b9b0-dc826ded4264"],
Cell[3898, 98, 354, 8, 46, "Input", "ExpressionUUID" -> \
"99cdf467-8c8b-48af-9a3f-3a75d35c5514"],
Cell[4255, 108, 1177, 31, 80, "Input", "ExpressionUUID" -> \
"3ef0d7a8-5a30-4911-afaa-956ce4d35897"],
Cell[5435, 141, 966, 26, 131, "Input", "ExpressionUUID" -> \
"78ec1234-6131-4128-b0d2-d10508d1625d"],
Cell[6404, 169, 1124, 28, 97, "Input", "ExpressionUUID" -> \
"9011ce98-89ae-4a70-8ade-7b1c706c5853"],
Cell[7531, 199, 973, 26, 97, "Input", "ExpressionUUID" -> \
"dbc4552f-bba9-4f35-b797-d220d600b5ed"],
Cell[8507, 227, 819, 23, 80, "Input", "ExpressionUUID" -> \
"492df008-12bc-45ae-b6c3-1dd92afd5ddf"],
Cell[9329, 252, 2128, 49, 148, "Input", "ExpressionUUID" -> \
"a5946511-7c8d-41e9-ba8b-c66d3281ee5c"],
Cell[11460, 303, 1251, 28, 148, "Input", "ExpressionUUID" -> \
"207a400b-ca4c-4f45-95d0-06c198cae3c7"],
Cell[12714, 333, 3288, 81, 267, "Input", "ExpressionUUID" -> \
"c522aa00-6387-42e2-b9e0-bc7e76717b21"],
Cell[16005, 416, 307, 7, 46, "Input", "ExpressionUUID" -> \
"29a17488-dbb8-493f-9c8c-cdba6d2dc497"],
Cell[16315, 425, 1778, 41, 199, "Input", "ExpressionUUID" -> \
"b833ac0c-4edd-43e5-aa5e-18b1d49eb15f"],
Cell[18096, 468, 13989, 341, 1168, "Input", "ExpressionUUID" -> \
"4a43a0fd-b938-4037-b1fd-b6e0f55f2b9b"],
Cell[32088, 811, 4616, 117, 369, "Input", "ExpressionUUID" -> \
"3566dcb6-42ca-4436-8fa5-6ab17256fbe9"],
Cell[36707, 930, 6375, 161, 488, "Input", "ExpressionUUID" -> \
"297b5a13-adbb-415d-b0a2-25ff5d8e4db7"],
Cell[43085, 1093, 596, 15, 46, "Input", "ExpressionUUID" -> \
"8e2a3297-4869-4dc3-8392-a31ad6483484"],
Cell[43684, 1110, 3025, 78, 233, "Input", "ExpressionUUID" -> \
"2d248f0b-542d-49a6-b258-4e87e470bfd5"],
Cell[46712, 1190, 4731, 124, 301, "Input", "ExpressionUUID" -> \
"7b296263-0997-4fd8-a5d2-119dabb76d19"],
Cell[51446, 1316, 880, 25, 97, "Input", "ExpressionUUID" -> \
"b1274aa9-d270-4758-bf3b-0b0fed50dc04"],
Cell[52329, 1343, 32910, 770, 2222, "Input", "ExpressionUUID" -> \
"fbb513eb-f4a1-480d-9128-e2cf36933ced"]
}, Closed]],
Cell[CellGroupData[{
Cell[85276, 2118, 165, 3, 36, "Subsection", "ExpressionUUID" -> \
"6d27116c-1008-4318-82fd-a89651980e6f"],
Cell[85444, 2123, 8317, 152, 516, "Input", "ExpressionUUID" -> \
"a7f1dfd8-2ebf-49f8-879c-542627d12e3e"],
Cell[CellGroupData[{
Cell[93786, 2279, 211, 4, 35, "Subsubsection", "ExpressionUUID" -> \
"74692aa9-3024-4f71-b5fd-3fa1af172e3e"],
Cell[94000, 2285, 5798, 170, 495, "Input", "ExpressionUUID" -> \
"8161e742-d853-401b-8fd7-bb2aa67005a6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[99835, 2460, 165, 3, 35, "Subsubsection", "ExpressionUUID" -> \
"76e8c672-9425-4f79-9a20-7ec44cb93ff8"],
Cell[100003, 2465, 1789, 50, 159, "Input", "ExpressionUUID" -> \
"bb2d18e3-3e7e-4857-a961-43ada6ac7645"],
Cell[101795, 2517, 1699, 51, 159, "Input", "ExpressionUUID" -> \
"93730627-572a-4bd4-8dab-ca2a5d93676c"],
Cell[103497, 2570, 621, 14, 75, "Input", "ExpressionUUID" -> \
"cbb929de-9480-4872-9380-957eb8e558b0"],
Cell[104121, 2586, 200, 4, 32, "Input", "ExpressionUUID" -> \
"bc8d97a8-51a8-4abb-bca1-f0dcecb107a4"],
Cell[104324, 2592, 339, 9, 32, "Input", "ExpressionUUID" -> \
"2c2274ac-de92-4749-8297-252a8c791199"],
Cell[104666, 2603, 1634, 48, 159, "Input", "ExpressionUUID" -> \
"aeaf70c0-8056-422c-8805-73c973008e86"],
Cell[106303, 2653, 227, 5, 32, "Input", "ExpressionUUID" -> \
"f63385ea-92af-431c-b179-2ebe7909282e"]
}, Open  ]]
}, Open  ]],
Cell[106557, 2662, 160, 3, 44, "Subsection", "ExpressionUUID" -> \
"a3135e01-8d55-44b2-821e-6fc40d40e7af"],
Cell[CellGroupData[{
Cell[106742, 2669, 156, 3, 36, "Subsection", "ExpressionUUID" -> \
"a7dcc7d2-4185-4863-a675-dcae708f5955"],
Cell[CellGroupData[{
Cell[106923, 2676, 159, 3, 35, "Subsubsection", "ExpressionUUID" -> \
"99a975b9-cd3b-4c76-bf25-21cdeea12369"],
Cell[107085, 2681, 11267, 266, 999, "Input", "ExpressionUUID" -> \
"ebb723c4-dcf4-4522-823b-eb3169707776"],
Cell[118355, 2949, 768, 22, 54, "Input", "ExpressionUUID" -> \
"9b37bb1c-c2c4-4d44-943b-155fe0ccd72f"],
Cell[119126, 2973, 1614, 42, 138, "Input", "ExpressionUUID" -> \
"0ac479a8-abd5-4a06-8159-23da2bc416c2"],
Cell[120743, 3017, 277, 6, 32, "Input", "ExpressionUUID" -> \
"9195b29e-96df-4923-9ac7-6a361772cef0"],
Cell[121023, 3025, 523, 13, 54, "Input", "ExpressionUUID" -> \
"038c865a-4c13-4bcd-948b-b204dcdf68f6"],
Cell[121549, 3040, 240, 4, 32, "Input", "ExpressionUUID" -> \
"b6b30306-0b40-4348-b8f2-663f2952586b"],
Cell[121792, 3046, 747, 20, 75, "Input", "ExpressionUUID" -> \
"41a2886b-7bbf-4b8c-af81-d56d74db3622"],
Cell[122542, 3068, 947, 26, 138, "Input", "ExpressionUUID" -> \
"9e34e312-cc20-44af-b09c-f1ffe0e02b19"],
Cell[123492, 3096, 879, 23, 96, "Input", "ExpressionUUID" -> \
"878b47c5-bda1-40e4-894c-995db48a0801"],
Cell[124374, 3121, 918, 25, 159, "Input", "ExpressionUUID" -> \
"c89d554d-04d8-4994-90db-7180d9244915"],
Cell[125295, 3148, 902, 25, 117, "Input", "ExpressionUUID" -> \
"b61b1f49-c345-4348-b95b-f9af96934f1f"],
Cell[126200, 3175, 811, 22, 96, "Input", "ExpressionUUID" -> \
"8c1b2c8f-f750-49cf-aa24-e0b8c3760c62"],
Cell[127014, 3199, 196, 4, 32, "Input", "ExpressionUUID" -> \
"3cf28517-733c-4ba3-b2ad-08406c109ac2"],
Cell[127213, 3205, 185, 4, 32, "Input", "ExpressionUUID" -> \
"2c3c9cae-f099-467c-b6b6-62e825991620"],
Cell[127401, 3211, 11261, 272, 1041, "Input", "ExpressionUUID" -> \
"ff38959d-39d1-4989-9bc3-cdc4375ed355"],
Cell[138665, 3485, 11575, 275, 1041, "Input", "ExpressionUUID" -> \
"1a1a342b-8edc-4b08-8ec5-0cffd39def21"],
Cell[150243, 3762, 796, 23, 75, "Input", "ExpressionUUID" -> \
"7b06adbf-bbbc-4627-ae90-1c68b32889c4"],
Cell[151042, 3787, 184, 4, 32, "Input", "ExpressionUUID" -> \
"f7c57276-2dba-4227-8098-6a61f7239dd5"],
Cell[151229, 3793, 186, 4, 32, "Input", "ExpressionUUID" -> \
"4c3c851d-b1aa-4917-a2ce-6adfcdb8b00f"],
Cell[151418, 3799, 560, 18, 32, "Input", "ExpressionUUID" -> \
"e0876319-4862-4942-b29b-fabb670e2781"],
Cell[151981, 3819, 1377, 33, 138, "Input", "ExpressionUUID" -> \
"c5289fd4-71db-42dd-b25b-d8479e673242"],
Cell[153361, 3854, 1194, 32, 138, "Input", "ExpressionUUID" -> \
"aec38008-ad8d-4dc5-9cf0-b190a41c75ba"],
Cell[154558, 3888, 1323, 34, 138, "Input", "ExpressionUUID" -> \
"14c0c3b5-e444-4c40-84f3-22a8712a38dd"],
Cell[155884, 3924, 1186, 32, 138, "Input", "ExpressionUUID" -> \
"a13acd17-3f72-4252-a956-6fcad0b0d8f4"],
Cell[157073, 3958, 1126, 31, 138, "Input", "ExpressionUUID" -> \
"a9e0ad2c-c7b2-4699-bc87-702260875858"]
}, Open  ]],
Cell[CellGroupData[{
Cell[158236, 3994, 157, 3, 35, "Subsubsection", "ExpressionUUID" -> \
"5b3983be-403c-45a9-a266-ed97b9bafa5d"],
Cell[158396, 3999, 708, 19, 117, "Input", "ExpressionUUID" -> \
"4170a41f-6ce6-4afc-9288-656de4b7594e"],
Cell[159107, 4020, 4878, 116, 600, "Input", "ExpressionUUID" -> \
"6ca77127-b6f2-4c3a-a332-6bd8f3a460c1"],
Cell[163988, 4138, 6166, 146, 789, "Input", "ExpressionUUID" -> \
"29dd84a5-6822-4091-88fc-b2855a33689e"],
Cell[170157, 4286, 5740, 138, 747, "Input", "ExpressionUUID" -> \
"2566b15d-414e-41a8-b9e9-863a31cd8388"],
Cell[175900, 4426, 541, 11, 32, "Input", "ExpressionUUID" -> \
"98099e1a-001d-4df3-8c81-b6c4f5b768ae"],
Cell[176444, 4439, 302, 8, 32, "Input", "ExpressionUUID" -> \
"5abbb3d4-7894-494d-ac44-c3beb1ebadb3"],
Cell[176749, 4449, 361, 8, 32, "Input", "ExpressionUUID" -> \
"92d1a52e-78d6-48a6-8099-a53d9befce6b"],
Cell[177113, 4459, 1051, 26, 75, "Input", "ExpressionUUID" -> \
"0498459a-0d3d-402c-b093-731f4e572d4d"],
Cell[178167, 4487, 763, 23, 96, "Input", "ExpressionUUID" -> \
"4ec13f09-faee-4750-8ef0-eb8b3c331c74"],
Cell[178933, 4512, 3002, 73, 285, "Input", "ExpressionUUID" -> \
"046fe678-f2a9-4ab6-a893-e49738d11d22"],
Cell[181938, 4587, 2695, 60, 264, "Input", "ExpressionUUID" -> \
"d06cce66-acd2-40df-86d5-a8b7c22607ca"],
Cell[184636, 4649, 227, 5, 32, "Input", "ExpressionUUID" -> \
"e6563fe0-7563-4e63-9500-0c42326dc186"],
Cell[184866, 4656, 644, 17, 96, "Input", "ExpressionUUID" -> \
"934dc430-217b-4671-91eb-a4cd959959d5"],
Cell[185513, 4675, 203, 5, 32, "Input", "ExpressionUUID" -> \
"190f59e4-0554-4f2e-985b-16c2ceaa631f"],
Cell[185719, 4682, 196, 4, 32, "Input", "ExpressionUUID" -> \
"7c26f3be-208d-475f-83ca-b1ad9da0dca9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[185952, 4691, 160, 3, 35, "Subsubsection", "ExpressionUUID" -> \
"74f25efc-d7ab-4263-8a42-41f28f985369"],
Cell[186115, 4696, 2778, 72, 201, "Input", "ExpressionUUID" -> \
"be3f6105-d9f4-48b4-b8ff-e9cdccb8bf1e"],
Cell[188896, 4770, 2201, 49, 243, "Input", "ExpressionUUID" -> \
"5ca03408-681c-4d2b-9ba8-660190a00829"],
Cell[191100, 4821, 303, 9, 32, "Input", "ExpressionUUID" -> \
"d9b62a76-bc1b-4150-a09d-8e32cbb596ba"],
Cell[191406, 4832, 535, 13, 54, "Input", "ExpressionUUID" -> \
"a8372053-6880-40ab-ba07-6f761562017c"],
Cell[191944, 4847, 8067, 197, 789, "Input", "ExpressionUUID" -> \
"9090a5d7-1c8a-4b8c-a89b-f0a8c354334f"],
Cell[200014, 5046, 1713, 44, 138, "Input", "ExpressionUUID" -> \
"5b92d0ed-7290-49af-b939-b91c2853cde8"],
Cell[201730, 5092, 2253, 56, 201, "Input", "ExpressionUUID" -> \
"7e5d518f-e400-45ba-a27b-100e7e721927"],
Cell[203986, 5150, 946, 26, 138, "Input", "ExpressionUUID" -> \
"897aad39-aa53-4ccf-97b1-8c31b54092c9"],
Cell[204935, 5178, 947, 26, 138, "Input", "ExpressionUUID" -> \
"e75e27bd-89d0-4a9c-8f3e-e11095e487f1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[205919, 5209, 159, 3, 35, "Subsubsection", "ExpressionUUID" -> \
"ac1085ad-e89a-43c3-98e1-2ec20e7b8df9"],
Cell[206081, 5214, 16574, 364, 1189, "Input", "ExpressionUUID" -> \
"23f95310-606f-4545-ad15-ba331f83e748"],
Cell[222658, 5580, 155, 3, 32, "Input", "ExpressionUUID" -> \
"fa9b04f6-250a-4239-b6cc-369d78f3de5f"],
Cell[222816, 5585, 241, 6, 32, "Input", "ExpressionUUID" -> \
"87587b8b-7099-4049-8f11-38c0a3704592"],
Cell[223060, 5593, 161, 3, 32, "Input", "ExpressionUUID" -> \
"55460152-7b01-4a38-a537-19c260306645"],
Cell[223224, 5598, 2201, 52, 138, "Input", "ExpressionUUID" -> \
"4c5b5fd5-6224-446c-b973-8126eb256d5b"],
Cell[225428, 5652, 2602, 62, 201, "Input", "ExpressionUUID" -> \
"604c4624-52f9-421a-8567-a993439a3d99"],
Cell[228033, 5716, 949, 26, 138, "Input", "ExpressionUUID" -> \
"1218ce1d-5bda-4021-8873-4a74c8b504a3"],
Cell[228985, 5744, 945, 26, 138, "Input", "ExpressionUUID" -> \
"c11b3f1d-a52e-433f-8f51-545bb5d2a95f"],
Cell[229933, 5772, 1339, 31, 75, "Input", "ExpressionUUID" -> \
"1d5793ec-6c91-4bcc-9e5d-21238c78023d"],
Cell[231275, 5805, 1525, 41, 138, "Input", "ExpressionUUID" -> \
"4bd879ba-7948-4668-a068-391250cfe06c"],
Cell[232803, 5848, 1488, 40, 138, "Input", "ExpressionUUID" -> \
"6556f07d-fa34-46a1-ae84-690573a816a9"],
Cell[234294, 5890, 2945, 80, 264, "Input", "ExpressionUUID" -> \
"f333682b-2733-4da0-a73b-5e165b82c8b5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[237276, 5975, 174, 3, 35, "Subsubsection", "ExpressionUUID" -> \
"00fd6f3e-6ed3-4c20-99ff-b22445cbfabd"],
Cell[237453, 5980, 239, 6, 32, "Input", "ExpressionUUID" -> \
"bce0c93a-ae45-4ad1-b3cd-876f5c8023b0"],
Cell[237695, 5988, 235, 6, 32, "Input", "ExpressionUUID" -> \
"189f443e-0b5e-4bd8-926f-fe84b6381e08"],
Cell[237933, 5996, 207, 5, 32, "Input", "ExpressionUUID" -> \
"8f1679d0-506c-492e-b629-fd2b3f76bc6a"],
Cell[238143, 6003, 191, 4, 32, "Input", "ExpressionUUID" -> \
"5cbb7955-ea5e-4cf0-b96a-4d78cf9da570"],
Cell[238337, 6009, 152, 3, 32, "Input", "ExpressionUUID" -> \
"235ddde4-1b78-42c6-ae41-4fbd46ea53c0"],
Cell[238492, 6014, 180, 4, 32, "Input", "ExpressionUUID" -> \
"9c7d4152-fa43-41e7-acb1-e2e875d53d61"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[238721, 6024, 207, 4, 44, "Subsection", "ExpressionUUID" -> \
"e31cb52a-5450-4ff5-a463-cca16d536dfc"],
Cell[CellGroupData[{
Cell[238953, 6032, 252, 4, 35, "Subsubsection", "ExpressionUUID" -> \
"8e7a63ae-e181-42af-9b6d-0eb8b98bd5fd"],
Cell[239208, 6038, 2590, 74, 222, "Input", "ExpressionUUID" -> \
"c9fcb7d2-3698-472d-880d-6ed6013f1de6"],
Cell[241801, 6114, 1757, 53, 96, "Input", "ExpressionUUID" -> \
"0c11094d-40a7-48fd-8b11-26744c795e79"],
Cell[243561, 6169, 210, 5, 32, "Input", "ExpressionUUID" -> \
"735416ad-8c58-4a0b-bdb3-fcee85fa8cd7"],
Cell[243774, 6176, 360, 9, 54, "Input", "ExpressionUUID" -> \
"6fef87d7-b91c-4be9-b91e-fd563a616176"],
Cell[244137, 6187, 4659, 109, 453, "Input", "ExpressionUUID" -> \
"0df7c42f-7c6b-4997-b85d-057a80010d1c"],
Cell[248799, 6298, 4523, 112, 474, "Input", "ExpressionUUID" -> \
"c23f138c-8edb-4502-a4c9-415baa4556d8"],
Cell[253325, 6412, 9952, 225, 726, "Input", "ExpressionUUID" -> \
"83e9e95d-27ba-4ddc-92bc-ee6ee36189f3"],
Cell[263280, 6639, 642, 10, 32, "Input", "ExpressionUUID" -> \
"ec965732-1c28-4102-a3ed-8fbde2bf7b45"],
Cell[263925, 6651, 740, 19, 75, "Input", "ExpressionUUID" -> \
"6a9c76b1-518c-4321-aae2-a2237d0ad4af"],
Cell[264668, 6672, 946, 25, 159, "Input", "ExpressionUUID" -> \
"d4fe94e7-bd00-4ea0-be23-ffbe10ee23cd"],
Cell[265617, 6699, 983, 26, 159, "Input", "ExpressionUUID" -> \
"4b60bf37-95e1-4ecd-9f37-fa9e5b553320"]
}, Open  ]],
Cell[CellGroupData[{
Cell[266637, 6730, 157, 3, 35, "Subsubsection", "ExpressionUUID" -> \
"19a76ecb-5163-4d9b-8ddb-d10e4108e4f6"],
Cell[266797, 6735, 6653, 157, 600, "Input", "ExpressionUUID" -> \
"a0fad517-bd14-4727-9198-3870a0e924a7"],
Cell[273453, 6894, 249, 5, 32, "Input", "ExpressionUUID" -> \
"595bce4f-7e75-4488-891e-8122df59153c"],
Cell[273705, 6901, 193, 4, 32, "Input", "ExpressionUUID" -> \
"472f848f-ad80-4e64-907a-3799b9b045df"],
Cell[273901, 6907, 851, 22, 75, "Input", "ExpressionUUID" -> \
"628984ae-313c-44a5-b452-cbc1afb13d74"],
Cell[274755, 6931, 10615, 249, 810, "Input", "ExpressionUUID" -> \
"8ab3faf6-704a-4d97-a1c4-b07d7659c120"],
Cell[285373, 7182, 249, 5, 32, "Input", "ExpressionUUID" -> \
"bc29e71f-e8d0-4da1-afda-9906650bb9c6"],
Cell[285625, 7189, 736, 20, 96, "Input", "ExpressionUUID" -> \
"d15122a6-35f2-404c-a741-f350923a0ee6"],
Cell[286364, 7211, 392, 10, 32, "Input", "ExpressionUUID" -> \
"79d20d02-438a-4fa1-bf4b-d6ad5a1e1776"],
Cell[286759, 7223, 378, 9, 54, "Input", "ExpressionUUID" -> \
"bfff942f-7f46-4daf-ab45-432ab7d75fc3"],
Cell[287140, 7234, 876, 22, 96, "Input", "ExpressionUUID" -> \
"ff8c258f-0580-46d1-911f-c8d4fd3db3e6"],
Cell[288019, 7258, 13678, 317, 1020, "Input", "ExpressionUUID" -> \
"951e2095-652f-47d3-bb09-8b1dc1ad809e"],
Cell[301700, 7577, 307, 5, 32, "Input", "ExpressionUUID" -> \
"343c28dd-5037-4402-978b-003194acb4d3"],
Cell[302010, 7584, 709, 19, 96, "Input", "ExpressionUUID" -> \
"41fee0c2-73ed-40ec-94d1-2bf42cc1aa33"],
Cell[302722, 7605, 174, 3, 32, "Input", "ExpressionUUID" -> \
"87daf923-a7a9-4cdb-895f-6ff0627d2289"]
}, Open  ]],
Cell[CellGroupData[{
Cell[302933, 7613, 157, 3, 35, "Subsubsection", "ExpressionUUID" -> \
"85f5befe-f91d-47a0-bc62-59d962285877"],
Cell[303093, 7618, 1914, 59, 138, "Input", "ExpressionUUID" -> \
"911f8448-54c5-4ac7-86e6-3de7ee6e3b3f"],
Cell[305010, 7679, 206, 5, 32, "Input", "ExpressionUUID" -> \
"8b1bf90c-f56a-4ce0-b95f-48a040f1607f"],
Cell[305219, 7686, 324, 7, 32, "Input", "ExpressionUUID" -> \
"b2df2be4-962b-4a36-a73e-527d1e470fe0"],
Cell[305546, 7695, 627, 17, 32, "Input", "ExpressionUUID" -> \
"e7c26c01-a89a-4f47-997a-d9923119bb77"],
Cell[306176, 7714, 394, 10, 54, "Input", "ExpressionUUID" -> \
"6288ba70-566b-440e-9ace-a8887bd79b96"],
Cell[306573, 7726, 1067, 26, 138, "Input", "ExpressionUUID" -> \
"5e57f71b-ce4d-4a4e-9230-dc5d5e4b086b"],
Cell[307643, 7754, 1360, 37, 75, "Input", "ExpressionUUID" -> \
"6b7a56de-7ea5-4950-b5b6-22e6f6c6c19c"],
Cell[309006, 7793, 512, 15, 32, "Input", "ExpressionUUID" -> \
"7f9aca3b-02ff-4334-a7b9-e85dc2a265fd"],
Cell[309521, 7810, 714, 19, 54, "Input", "ExpressionUUID" -> \
"0c0cc2b4-7d5e-4212-b956-52bbe665c8e4"],
Cell[310238, 7831, 1187, 35, 96, "Input", "ExpressionUUID" -> \
"8492c084-ab5d-4473-93b5-42b15ba01ec1"],
Cell[311428, 7868, 389, 10, 32, "Input", "ExpressionUUID" -> \
"0bee6b30-2f18-4dcc-8232-2451c3fb9a3e"],
Cell[311820, 7880, 537, 14, 32, "Input", "ExpressionUUID" -> \
"f5b38709-e285-430c-b7d7-88b5af56f94e"],
Cell[312360, 7896, 326, 8, 32, "Input", "ExpressionUUID" -> \
"2a13c90f-7111-47c5-98b1-f912f7a75d1e"],
Cell[312689, 7906, 771, 20, 75, "Input", "ExpressionUUID" -> \
"8dc3464b-80e6-4246-9f16-1e419fdef1b5"],
Cell[313463, 7928, 629, 15, 32, "Input", "ExpressionUUID" -> \
"d7e02a02-cf13-48b7-930f-8b5c76e32a7c"],
Cell[314095, 7945, 615, 18, 54, "Input", "ExpressionUUID" -> \
"ec5d6abf-f6f2-49a7-b999-b1f6baa95e75"],
Cell[314713, 7965, 253, 6, 32, "Input", "ExpressionUUID" -> \
"3223aee0-51a8-45ee-9d2f-5bb809203178"],
Cell[314969, 7973, 691, 18, 54, "Input", "ExpressionUUID" -> \
"d92b4079-9df7-4a70-b02b-fefd8c9d64c3"],
Cell[315663, 7993, 425, 11, 32, "Input", "ExpressionUUID" -> \
"dbe0613d-6615-4f5c-ba45-4e708337eb69"],
Cell[316091, 8006, 2905, 77, 285, "Input", "ExpressionUUID" -> \
"b24834c6-0f9c-4827-bd7a-c3899212706d"],
Cell[318999, 8085, 1460, 37, 117, "Input", "ExpressionUUID" -> \
"ed13947d-d360-4b87-8a59-a0887b07e7d1"],
Cell[320462, 8124, 626, 19, 32, "Input", "ExpressionUUID" -> \
"1cea2259-4ae8-4b90-bd5b-bd77095e8d97"],
Cell[321091, 8145, 3287, 85, 348, "Input", "ExpressionUUID" -> \
"c38fd92d-a9e4-4b88-aa6c-f84c7fb8aa2d"],
Cell[324381, 8232, 734, 18, 54, "Input", "ExpressionUUID" -> \
"29f78d66-40b8-4125-8515-efdda3ffd83c"],
Cell[325118, 8252, 630, 18, 54, "Input", "ExpressionUUID" -> \
"1030169f-4efc-418d-8204-82d1cdc5a679"],
Cell[325751, 8272, 362, 9, 32, "Input", "ExpressionUUID" -> \
"432b0cf9-460e-4bbc-b0da-e2b456295886"],
Cell[326116, 8283, 803, 23, 75, "Input", "ExpressionUUID" -> \
"fb51decb-f9b9-4b6c-9b8f-75e204275415"],
Cell[326922, 8308, 1695, 45, 180, "Input", "ExpressionUUID" -> \
"46603b42-17ff-422c-b437-a6bdbbb69857"],
Cell[328620, 8355, 1367, 35, 180, "Input", "ExpressionUUID" -> \
"bb68b33e-f88f-492b-91f4-d44433ba9ab3"],
Cell[329990, 8392, 293, 8, 32, "Input", "ExpressionUUID" -> \
"e2900b91-d7e6-486c-9c26-ed424b87c4e8"],
Cell[330286, 8402, 899, 21, 54, "Input", "ExpressionUUID" -> \
"f540c9ad-fc6f-4d17-86b9-8716c6fd25d7"],
Cell[331188, 8425, 6612, 154, 642, "Input", "ExpressionUUID" -> \
"18cfdb2e-a73a-4733-8377-f0eca8d2fcfa"],
Cell[337803, 8581, 323, 6, 32, "Input", "ExpressionUUID" -> \
"50ce28fc-e3f7-4aef-823a-14ea53a6c1c1"],
Cell[338129, 8589, 722, 20, 75, "Input", "ExpressionUUID" -> \
"400a93eb-21df-4787-92b8-32c9f8a18014"],
Cell[338854, 8611, 1894, 51, 32, "Input", "ExpressionUUID" -> \
"686a18b0-b7c2-4c00-a66c-9809444695bd"],
Cell[340751, 8664, 11484, 258, 978, "Input", "ExpressionUUID" -> \
"13105c2f-d299-407f-8de1-c0ba560bab35"],
Cell[352238, 8924, 277, 6, 32, "Input", "ExpressionUUID" -> \
"8b3975fc-27b2-4560-8554-7f6a2e36df05"],
Cell[352518, 8932, 856, 22, 117, "Input", "ExpressionUUID" -> \
"6b7e9f5b-54aa-4197-bba0-13220c1d5274"],
Cell[353377, 8956, 3769, 85, 264, "Input", "ExpressionUUID" -> \
"d980575b-47fb-4dd8-b5ab-831a2bf3f511"],
Cell[357149, 9043, 6754, 163, 495, "Input", "ExpressionUUID" -> \
"978cd85f-0844-418a-8167-eef6ae535535"],
Cell[363906, 9208, 1990, 49, 201, "Input", "ExpressionUUID" -> \
"12c2032b-58d1-42fc-b95f-bdfc5d21ef22"],
Cell[365899, 9259, 603, 15, 32, "Input", "ExpressionUUID" -> \
"59d4201e-6641-4cba-a006-9367348caf60"],
Cell[366505, 9276, 267, 6, 32, "Input", "ExpressionUUID" -> \
"b42133ec-05f0-4879-bf2f-d21c31efe3f3"],
Cell[366775, 9284, 263, 6, 32, "Input", "ExpressionUUID" -> \
"18726508-94de-4245-bc0a-d46a08456e7e"],
Cell[367041, 9292, 351, 9, 32, "Input", "ExpressionUUID" -> \
"fafb117b-7cad-4c98-bdb2-1966940e2512"],
Cell[367395, 9303, 3030, 86, 264, "Input", "ExpressionUUID" -> \
"08964da3-b17b-48c9-a933-2f25ca3bc494"],
Cell[370428, 9391, 638, 17, 54, "Input", "ExpressionUUID" -> \
"be34459a-46dc-41d6-9573-20ce9cae02bf"],
Cell[371069, 9410, 582, 17, 54, "Input", "ExpressionUUID" -> \
"368e1cc5-4e93-473b-a61b-c658a3b3cbaf"],
Cell[371654, 9429, 5782, 136, 558, "Input", "ExpressionUUID" -> \
"f3c432fa-9d2e-49dd-91f3-6a91be11eae6"],
Cell[377439, 9567, 415, 8, 32, "Input", "ExpressionUUID" -> \
"40fa19c9-20b2-4e26-8565-4d80cfffe16b"],
Cell[377857, 9577, 728, 21, 117, "Input", "ExpressionUUID" -> \
"599b4470-20cb-4631-b9cb-ac809989e8e3"],
Cell[378588, 9600, 264, 7, 32, "Input", "ExpressionUUID" -> \
"ac1c159a-0441-4b27-aa5e-5c68ef1ccb5d"],
Cell[378855, 9609, 554, 13, 54, "Input", "ExpressionUUID" -> \
"f937c5f3-b82e-485d-b47a-c5e8047ba0a6"],
Cell[379412, 9624, 306, 7, 32, "Input", "ExpressionUUID" -> \
"672316da-85c6-43a4-8503-2cf0ccd9654f"],
Cell[379721, 9633, 432, 11, 32, "Input", "ExpressionUUID" -> \
"9479de5d-3f77-4528-bd9e-cd4e94617b95"],
Cell[380156, 9646, 4952, 119, 516, "Input", "ExpressionUUID" -> \
"f20dd9c9-8ee0-46fe-bdd8-b74ea92d262f"],
Cell[385111, 9767, 4816, 116, 516, "Input", "ExpressionUUID" -> \
"35a778ab-7d7c-42a6-9f86-14db83a931cd"],
Cell[389930, 9885, 192, 4, 32, "Input", "ExpressionUUID" -> \
"9993e9d4-bcfa-4d44-bfb5-4ceb5fc3f87e"],
Cell[390125, 9891, 716, 20, 117, "Input", "ExpressionUUID" -> \
"ed5aa493-40e7-49c9-946f-c23f289356f0"],
Cell[390844, 9913, 941, 24, 75, "Input", "ExpressionUUID" -> \
"cd39c720-e8c2-4620-8c19-4dd50982ac68"],
Cell[391788, 9939, 942, 23, 75, "Input", "ExpressionUUID" -> \
"923f831b-0278-4e58-904e-7c6e8f2caea6"],
Cell[392733, 9964, 223, 5, 32, "Input", "ExpressionUUID" -> \
"10fb9958-3712-4526-8118-48e5abec2008"],
Cell[392959, 9971, 457, 14, 32, "Input", "ExpressionUUID" -> \
"ce7c2e79-dd7e-44a8-9049-ae4d3845ecde"],
Cell[393419, 9987, 419, 10, 54, "Input", "ExpressionUUID" -> \
"a0015525-11f3-4aa6-b6d0-e42d5f5423d2"],
Cell[393841, 9999, 512, 11, 54, "Input", "ExpressionUUID" -> \
"49944e64-47d4-46e5-adf0-ef8ecaa592ae"],
Cell[394356, 10012, 357, 7, 32, "Input", "ExpressionUUID" -> \
"a614ba8c-03fa-483a-b666-533e97651a51"],
Cell[394716, 10021, 478, 13, 32, "Input", "ExpressionUUID" -> \
"dd849383-cfc8-453a-98a0-d90547df0f6c"],
Cell[395197, 10036, 790, 22, 117, "Input", "ExpressionUUID" -> \
"6b3e880b-4a08-4f26-a3d0-1293ce742c7a"],
Cell[395990, 10060, 974, 23, 54, "Input", "ExpressionUUID" -> \
"d0dff843-b422-465c-8e63-3d1eadc222d3"],
Cell[396967, 10085, 364, 10, 32, "Input", "ExpressionUUID" -> \
"01a167f2-79f0-4169-af00-82ecf24ff464"],
Cell[397334, 10097, 636, 18, 96, "Input", "ExpressionUUID" -> \
"95fc3974-1319-4ac3-b362-9fb74a8ee576"],
Cell[397973, 10117, 838, 22, 32, "Input", "ExpressionUUID" -> \
"05a0db4d-624d-4e8a-9d5c-100a63206440"],
Cell[398814, 10141, 1098, 32, 54, "Input", "ExpressionUUID" -> \
"bbe4a241-09a5-4956-84f3-67c91ba2793e"],
Cell[399915, 10175, 517, 16, 32, "Input", "ExpressionUUID" -> \
"750edfd7-b446-41a6-96cd-808962466b14"],
Cell[400435, 10193, 7305, 169, 600, "Input", "ExpressionUUID" -> \
"d8b8e039-7083-4907-8a68-09213c0d981b"],
Cell[407743, 10364, 8364, 194, 663, "Input", "ExpressionUUID" -> \
"90cbbb53-bcbf-41fc-8a66-c34a3acf7348"],
Cell[416110, 10560, 876, 22, 96, "Input", "ExpressionUUID" -> \
"3fed961e-9dbd-47db-9211-2ba29640a573"],
Cell[416989, 10584, 197, 5, 32, "Input", "ExpressionUUID" -> \
"66d18686-eaa1-4871-bbe6-030d547a3b5d"],
Cell[417189, 10591, 391, 11, 32, "Input", "ExpressionUUID" -> \
"119ffc6d-cd78-4136-b992-05dbe823e266"],
Cell[417583, 10604, 266, 6, 32, "Input", "ExpressionUUID" -> \
"e21ade1e-e3c7-4294-a444-14ceeb313537"],
Cell[417852, 10612, 718, 20, 96, "Input", "ExpressionUUID" -> \
"deffc191-43ec-4e94-8526-c62a3f47e48f"],
Cell[418573, 10634, 469, 9, 32, "Input", "ExpressionUUID" -> \
"e317cb97-1034-4b62-876c-54e3d7090bec"],
Cell[419045, 10645, 550, 13, 96, "Input", "ExpressionUUID" -> \
"55ffdee6-311e-433f-ace7-649dde0a7766"],
Cell[419598, 10660, 730, 20, 117, "Input", "ExpressionUUID" -> \
"4fc172b3-9679-4586-8004-7d38470071b7"],
Cell[420331, 10682, 821, 23, 96, "Input", "ExpressionUUID" -> \
"a3aa9c22-fef1-46eb-a8a7-805326aaed36"],
Cell[421155, 10707, 1126, 29, 96, "Input", "ExpressionUUID" -> \
"e3ab23d5-8e3b-490c-b32c-8f8de31dd83a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[422318, 10741, 188, 3, 35, "Subsubsection", "ExpressionUUID" -> \
"7b035c10-7391-4d4a-af26-1e0358717fd2"],
Cell[422509, 10746, 1914, 59, 138, "Input", "ExpressionUUID" -> \
"baaaa090-f468-44bd-bb50-e24906120a18"],
Cell[424426, 10807, 206, 5, 32, "Input", "ExpressionUUID" -> \
"ffddcc35-9431-41f6-be16-7348ce5d678e"],
Cell[424635, 10814, 324, 7, 32, "Input", "ExpressionUUID" -> \
"045cabe3-fc53-45c9-97ff-73ef4aafc25f"],
Cell[424962, 10823, 627, 17, 32, "Input", "ExpressionUUID" -> \
"0f17acb2-5084-473e-bc49-ebffd555895a"],
Cell[425592, 10842, 442, 10, 54, "Input", "ExpressionUUID" -> \
"d07389b9-f2e7-4a51-ab8b-637f8fc263ba"],
Cell[426037, 10854, 1080, 24, 138, "Input", "ExpressionUUID" -> \
"8e1e3be9-31b5-4bad-aea5-594c1141768d"],
Cell[427120, 10880, 628, 19, 32, "Input", "ExpressionUUID" -> \
"ac95dc7d-d0b2-475e-ac7f-8e36d3cb31ee"],
Cell[427751, 10901, 273, 6, 32, "Input", "ExpressionUUID" -> \
"f8465502-4f16-4b3a-b10e-43617342d4d8"],
Cell[428027, 10909, 917, 23, 75, "Input", "ExpressionUUID" -> \
"2b0db82f-09a7-4e17-b8c5-7d6226c4ac42"],
Cell[428947, 10934, 545, 13, 54, "Input", "ExpressionUUID" -> \
"427358e1-73dc-4f55-9fce-e179a4505f44"],
Cell[429495, 10949, 445, 11, 54, "Input", "ExpressionUUID" -> \
"ba15268f-d2ae-4e6e-8272-92fe8d4a430e"],
Cell[429943, 10962, 2162, 60, 138, "Input", "ExpressionUUID" -> \
"2d81595e-bdf2-4ee8-9722-3fe679de0e18"],
Cell[432108, 11024, 1077, 24, 54, "Input", "ExpressionUUID" -> \
"af600083-1322-4162-bfce-466ef1587c73"],
Cell[433188, 11050, 3490, 96, 285, "Input", "ExpressionUUID" -> \
"fe13896f-25f4-4a2c-abef-34a4aa0a41fc"],
Cell[436681, 11148, 3476, 97, 264, "Input", "ExpressionUUID" -> \
"c6d5410d-787e-47e8-90c8-121d9a2faef0"],
Cell[440160, 11247, 3962, 109, 264, "Input", "ExpressionUUID" -> \
"486b192f-cb35-402e-9e37-d24f6233103d"],
Cell[444125, 11358, 626, 16, 54, "Input", "ExpressionUUID" -> \
"9c139a46-4a5a-4130-b094-d426ab6f3236"],
Cell[444754, 11376, 441, 11, 32, "Input", "ExpressionUUID" -> \
"0b054f95-7ea6-4f90-8052-d2876c40baf5"],
Cell[445198, 11389, 397, 10, 32, "Input", "ExpressionUUID" -> \
"0b375fb2-ed57-42f1-872d-33c8f90d5119"],
Cell[445598, 11401, 630, 13, 32, "Input", "ExpressionUUID" -> \
"9d915d6d-b0ba-4588-853e-7070560c275d"],
Cell[446231, 11416, 566, 17, 32, "Input", "ExpressionUUID" -> \
"8cd07e19-a265-4d26-8fd5-d9aac4e63100"],
Cell[446800, 11435, 546, 15, 75, "Input", "ExpressionUUID" -> \
"fe293b5c-490c-4a8f-9226-226a3832de89"],
Cell[447349, 11452, 265, 6, 32, "Input", "ExpressionUUID" -> \
"e02a7492-903b-4d4a-8732-7b00c60975f7"],
Cell[447617, 11460, 551, 11, 32, "Input", "ExpressionUUID" -> \
"44ff4c3c-70e1-46b2-b6c7-5e791a575404"],
Cell[448171, 11473, 447, 13, 32, "Input", "ExpressionUUID" -> \
"be02e079-e193-4dbe-b271-9639dd5ec64a"],
Cell[448621, 11488, 1584, 39, 75, "Input", "ExpressionUUID" -> \
"07b39f92-2e4a-4d6e-8669-43ebfc1d1258"],
Cell[450208, 11529, 498, 12, 32, "Input", "ExpressionUUID" -> \
"8cfceca7-a105-46fb-b9e9-a7ab2ccad7f8"],
Cell[450709, 11543, 454, 12, 32, "Input", "ExpressionUUID" -> \
"1c8b548b-034b-44bd-a425-b2d896f8915d"],
Cell[451166, 11557, 458, 12, 54, "Input", "ExpressionUUID" -> \
"c619d4db-5024-4ff4-a338-cfd4eb3e2622"],
Cell[451627, 11571, 592, 17, 75, "Input", "ExpressionUUID" -> \
"8b5d4d3a-f2b8-4c0e-a49b-ca365ad89c32"],
Cell[452222, 11590, 594, 17, 75, "Input", "ExpressionUUID" -> \
"d141c875-8757-4c1a-b818-1cfb6b021641"],
Cell[452819, 11609, 588, 17, 54, "Input", "ExpressionUUID" -> \
"3e892611-ed4e-427f-b9fb-92ce6d35768a"],
Cell[453410, 11628, 369, 10, 32, "Input", "ExpressionUUID" -> \
"2abae24c-0643-4f42-a398-735fc2387e5c"],
Cell[453782, 11640, 343, 9, 32, "Input", "ExpressionUUID" -> \
"08efd64f-b9b2-4eb6-8e89-4125505c414f"],
Cell[454128, 11651, 840, 23, 96, "Input", "ExpressionUUID" -> \
"6041b228-d4ed-4b05-aa82-5fa9d100c204"],
Cell[454971, 11676, 941, 21, 54, "Input", "ExpressionUUID" -> \
"d8da79e0-a7a0-4b6e-8307-d831e89a4467"],
Cell[455915, 11699, 274, 7, 32, "Input", "ExpressionUUID" -> \
"09e4e53e-a47b-44a4-be81-11904b559b0c"],
Cell[456192, 11708, 977, 26, 96, "Input", "ExpressionUUID" -> \
"5c6fc51d-35cb-447d-89a0-197cf5ce96ae"],
Cell[457172, 11736, 511, 9, 32, "Input", "ExpressionUUID" -> \
"107dd728-80b0-47b5-b8ff-4a9be9e847ff"],
Cell[457686, 11747, 5195, 123, 537, "Input", "ExpressionUUID" -> \
"ad5cda6b-b744-49d5-a2fe-59329f77d059"],
Cell[462884, 11872, 4450, 106, 495, "Input", "ExpressionUUID" -> \
"e9a3022e-823b-43a4-bbd2-0b8ab4ac6613"],
Cell[467337, 11980, 302, 7, 32, "Input", "ExpressionUUID" -> \
"e76feedc-a3a9-454b-871a-f2f405020878"],
Cell[467642, 11989, 779, 22, 117, "Input", "ExpressionUUID" -> \
"9958585e-67ac-4ffb-9401-64739569e170"],
Cell[468424, 12013, 734, 20, 117, "Input", "ExpressionUUID" -> \
"1fd7ce3d-0a41-4044-9ed8-1f2e4ff9b4e1"],
Cell[469161, 12035, 734, 20, 117, "Input", "ExpressionUUID" -> \
"6112782f-af9a-4b0c-adf0-2fe103ba7717"],
Cell[469898, 12057, 455, 14, 32, "Input", "ExpressionUUID" -> \
"08faa604-e384-4f67-bc9a-0a55221d51a0"],
Cell[470356, 12073, 249, 6, 32, "Input", "ExpressionUUID" -> \
"bb100f2b-a564-4991-818e-fcca4d698940"],
Cell[470608, 12081, 356, 9, 32, "Input", "ExpressionUUID" -> \
"c0dd47de-ba7d-4a81-b2a7-c144cf6014dc"],
Cell[470967, 12092, 234, 6, 32, "Input", "ExpressionUUID" -> \
"16ce0cd9-4615-46e7-b622-090b880df7cd"],
Cell[471204, 12100, 409, 12, 32, "Input", "ExpressionUUID" -> \
"1d3a26bc-5806-4d10-bfba-6bf7e1c489f2"],
Cell[471616, 12114, 4901, 117, 516, "Input", "ExpressionUUID" -> \
"0b25fa5b-f946-4cbd-94c9-6c314bd67a22"],
Cell[476520, 12233, 482, 13, 32, "Input", "ExpressionUUID" -> \
"744a8074-72f2-4ec7-a526-a2e95e888ccf"],
Cell[477005, 12248, 383, 8, 32, "Input", "ExpressionUUID" -> \
"178efb93-c689-47da-9a71-7c2430796fa9"],
Cell[477391, 12258, 203, 4, 32, "Input", "ExpressionUUID" -> \
"d6607fb8-2b01-437c-a60b-81657242d1b5"],
Cell[477597, 12264, 764, 21, 117, "Input", "ExpressionUUID" -> \
"6fbb9397-9729-46c8-8a75-90cd4e1bd110"],
Cell[478364, 12287, 203, 4, 32, "Input", "ExpressionUUID" -> \
"ccaa6e27-dbcb-48af-a672-73fd36df822d"],
Cell[478570, 12293, 664, 20, 32, "Input", "ExpressionUUID" -> \
"e60541e1-5435-4a9c-b9a9-b768bd8d108e"],
Cell[479237, 12315, 175, 3, 32, "Input", "ExpressionUUID" -> \
"78a6f97c-8607-449b-8024-928f158cfc23"],
Cell[479415, 12320, 483, 13, 32, "Input", "ExpressionUUID" -> \
"2e10de7c-2936-48f7-93bf-06418c44d096"],
Cell[479901, 12335, 2011, 49, 138, "Input", "ExpressionUUID" -> \
"4d78de3c-1bfb-46b2-b870-ce01a52c4083"],
Cell[481915, 12386, 2694, 76, 201, "Input", "ExpressionUUID" -> \
"12cac2ec-9419-4d79-b665-b659d3f79e09"],
Cell[484612, 12464, 5796, 139, 579, "Input", "ExpressionUUID" -> \
"075c15d0-db29-488d-af63-2a028cdf0852"]
}, Open  ]]
}, Open  ]]
}
]
*)

