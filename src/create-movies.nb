(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    409829,      10318]
NotebookOptionsPosition[    384555,       9801]
NotebookOutlinePosition[    384908,       9817]
CellTagsIndexPosition[    384865,       9814]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Cell-accurate optical mapping across the entire developing heart\
\>", "Title",
 CellChangeTimes->{{3.714798636167549*^9, 3.714798643920143*^9}, {
  3.714798712696336*^9, 3.714798738212171*^9}, {3.7151020354743443`*^9, 
  3.715102049707464*^9}},ExpressionUUID->"ae4d838c-45d8-404a-ac1d-\
2bc52147ce9b"],

Cell[CellGroupData[{

Cell["Generate animations for supplementary movies", "Chapter",
 CellChangeTimes->{{3.715102052214654*^9, 3.71510207614849*^9}, {
  3.715102991867036*^9, 3.715102997212191*^9}, {3.7180078513291883`*^9, 
  3.718007864255444*^9}},ExpressionUUID->"f70b2d53-7e59-4ecf-8842-\
aeb38c2a6260"],

Cell[BoxData[
 RowBox[{"Get", "[", 
  RowBox[{
   RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<functions.m\>\""}], 
  "]"}]], "Input",ExpressionUUID->"17f02651-4138-48b0-aa0c-3718904e1c90"],

Cell[BoxData[
 RowBox[{"root", "=", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"Most", "[", 
    RowBox[{"FileNameSplit", "[", 
     RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "]"}], "]"}]}]], "Input",\
ExpressionUUID->"f59c4b78-d69d-46aa-bec5-a10cc0677254"],

Cell[CellGroupData[{

Cell["select dataset to analyze", "Subchapter",
 CellChangeTimes->{{3.7147987676717777`*^9, 
  3.714798774375169*^9}},ExpressionUUID->"8a6f721f-d86f-4581-ba2c-\
8b0e769d9d57"],

Cell["\<\
We used the data from 5 different experiments for the analysis presented in \
the manuscript. An overview of the specific characteristics can be found in \
the datasheet: \[OpenCurlyQuote]datasets.xls\[CloseCurlyQuote].\
\>", "Text",
 CellChangeTimes->{{3.714799204745493*^9, 3.7147992066798887`*^9}, {
  3.714799676803508*^9, 
  3.714799758825612*^9}},ExpressionUUID->"9299b925-35d3-4158-a027-\
f1bb546a467e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"overview", " ", "=", " ", 
   RowBox[{
    RowBox[{"Import", "[", 
     RowBox[{"root", "<>", "\"\</data/datasets.xls\>\""}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"TableForm", "[", "overview", "]"}]}], "Input",
 CellChangeTimes->{{3.655478939679381*^9, 3.655478943841887*^9}, {
  3.6744588416113253`*^9, 3.6744588422202806`*^9}, {3.714754406080118*^9, 
  3.714754418749305*^9}, {3.714754861757915*^9, 3.7147548618474913`*^9}, {
  3.714755147550641*^9, 3.714755168941865*^9}, {3.715094139523484*^9, 
  3.7150941415661383`*^9}},ExpressionUUID->"45b84a11-4300-4e70-b063-\
5187097877f1"],

Cell["\<\
Indicate number of dataset for analysis here. For illustration purposes we \
will use dataset 4:\
\>", "Text",
 CellChangeTimes->{{3.7147997690692167`*^9, 
  3.714799804298193*^9}},ExpressionUUID->"6e6c5fac-96a6-4056-93f1-\
68fbdc2996da"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dataset", " ", "=", " ", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"overview", "[", 
   RowBox[{"[", 
    RowBox[{"dataset", "+", "1"}], "]"}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6616988049646997`*^9, 3.661698805331214*^9}, {
   3.661699570047418*^9, 3.6616995702067003`*^9}, {3.661699685846887*^9, 
   3.661699685942478*^9}, {3.661699877141048*^9, 3.6616998772590837`*^9}, {
   3.661700038393881*^9, 3.661700038652042*^9}, {3.661700334737482*^9, 
   3.661700334855748*^9}, {3.661700605938519*^9, 3.661700606231571*^9}, 
   3.6619510546485367`*^9, {3.6619511802396307`*^9, 3.661951180413286*^9}, {
   3.661951331335569*^9, 3.661951331636476*^9}, {3.661951466820656*^9, 
   3.661951467548032*^9}, {3.662017798157402*^9, 3.662017798392653*^9}, 
   3.662294981013357*^9, {3.662295567511388*^9, 3.662295567637494*^9}, {
   3.662295755753685*^9, 3.662295756270338*^9}, {3.6622962877254333`*^9, 
   3.6622962879874353`*^9}, 3.662299466893277*^9, {3.667719223646413*^9, 
   3.667719223899783*^9}, {3.668839781746401*^9, 3.668839782050395*^9}, {
   3.66883989569734*^9, 3.668839895879416*^9}, {3.668839926511546*^9, 
   3.668839926734028*^9}, {3.668839978261392*^9, 3.668839978517087*^9}, {
   3.668840023660438*^9, 3.668840024156015*^9}, {3.668841525230241*^9, 
   3.6688415253632174`*^9}, 3.669356367489142*^9, {3.66935876991918*^9, 
   3.669358770061015*^9}, 3.669358897906798*^9, {3.669435010597662*^9, 
   3.669435012732415*^9}, 3.6694360073190947`*^9, {3.669437184435788*^9, 
   3.669437184617661*^9}, {3.669437338830986*^9, 3.6694373390053043`*^9}, {
   3.6694602405174417`*^9, 3.669460240594811*^9}, 3.669963041105193*^9, {
   3.669963135421245*^9, 3.669963135524159*^9}, {3.669963174354681*^9, 
   3.669963174506352*^9}, {3.671251083346183*^9, 3.671251083586445*^9}, {
   3.674458853996708*^9, 3.674458856530954*^9}, 3.6744804031035023`*^9, {
   3.674480634219165*^9, 3.6744806344267893`*^9}, {3.6744808012621403`*^9, 
   3.674480801549555*^9}, {3.674527016704975*^9, 3.674527017024848*^9}, {
   3.674828691983982*^9, 3.674828692103085*^9}, 3.6748291933172207`*^9, {
   3.674829722144554*^9, 3.674829772996612*^9}, 3.674829818865635*^9, {
   3.674834417030634*^9, 3.6748344171492147`*^9}, {3.6748350739103813`*^9, 
   3.674835074348338*^9}, {3.6748353954284267`*^9, 3.674835395794833*^9}, {
   3.6748357058655777`*^9, 3.674835706110931*^9}, {3.67483675921109*^9, 
   3.6748367594101677`*^9}, {3.674836906042531*^9, 3.6748369061455927`*^9}, {
   3.674837015978903*^9, 3.6748370162086697`*^9}, {3.6748371149521923`*^9, 
   3.674837115511373*^9}, {3.674837675853219*^9, 3.674837676090798*^9}, {
   3.674837711393977*^9, 3.674837711513997*^9}, {3.6749005088508463`*^9, 
   3.6749005091307697`*^9}, 3.674905087058902*^9, {3.674905199933023*^9, 
   3.6749052002113132`*^9}, {3.674905275755107*^9, 3.674905277000918*^9}, {
   3.6749164728209677`*^9, 3.6749164730845346`*^9}, 
   3.714755249668799*^9},ExpressionUUID->"f0b055b9-0547-49f1-8769-\
d6711d11e0ef"],

Cell[CellGroupData[{

Cell["dataset-specific information", "Section",
 CellChangeTimes->{{3.714798816970935*^9, 
  3.71479882729669*^9}},ExpressionUUID->"46031d6a-d29b-4847-b7d2-\
ddcf9aa8ee07"],

Cell[BoxData[{
 RowBox[{"fname", " ", "=", " ", 
  RowBox[{"overview", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"dataset", "+", "1"}], ",", "1"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"age", " ", "=", " ", 
  RowBox[{"overview", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"dataset", "+", "1"}], ",", "7"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"sampling", " ", "=", " ", 
  RowBox[{"overview", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"dataset", "+", "1"}], ",", "11"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"dx", " ", "=", " ", 
  RowBox[{"overview", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"dataset", "+", "1"}], ",", "12"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"samplingCorrectionFactor", " ", "=", " ", 
   RowBox[{"400", "/", "sampling"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.655479021511404*^9, 3.655479133277341*^9}, 
   3.655479168135984*^9, {3.655487371971097*^9, 3.655487372234848*^9}, 
   3.655489483208609*^9, 3.655490299425108*^9, {3.655490644672233*^9, 
   3.655490644774046*^9}, {3.655533232865612*^9, 3.655533244600911*^9}, {
   3.655533519790916*^9, 3.6555335198944483`*^9}, {3.655533906040166*^9, 
   3.655533906133751*^9}, 3.655534024866321*^9, {3.655534159555071*^9, 
   3.6555341596589003`*^9}, {3.655535031717915*^9, 3.655535032235477*^9}, {
   3.655535862268572*^9, 3.655535862426869*^9}, {3.655535942509951*^9, 
   3.655535942644422*^9}, {3.655536065345306*^9, 3.6555360655276937`*^9}, {
   3.6555361482341633`*^9, 3.6555361483368587`*^9}, {3.655536269765544*^9, 
   3.655536270075507*^9}, {3.6555415495606613`*^9, 3.655541549640798*^9}, {
   3.655546248986149*^9, 3.655546249255982*^9}, {3.655546528727294*^9, 
   3.655546528990411*^9}, 3.655547057565041*^9, {3.655547266361803*^9, 
   3.655547266479578*^9}, {3.655547885678088*^9, 3.655547885805414*^9}, {
   3.6557198439299793`*^9, 3.655719844087031*^9}, 3.6564044086060553`*^9, {
   3.656686420679265*^9, 3.6566864207797823`*^9}, {3.657345184367741*^9, 
   3.6573451845996*^9}, {3.657348396415759*^9, 3.6573483965119677`*^9}, {
   3.657541782503058*^9, 3.6575417826103077`*^9}, {3.657542616905013*^9, 
   3.6575426170398703`*^9}, {3.6575429891181993`*^9, 3.657542989225912*^9}, {
   3.6578692973927727`*^9, 3.657869299550892*^9}, {3.657869901031538*^9, 
   3.657869901149851*^9}, {3.657870185950344*^9, 3.6578701870062017`*^9}, {
   3.657870596827506*^9, 3.6578705969307547`*^9}, 3.65787202419201*^9, {
   3.657880200309387*^9, 3.657880201402659*^9}, {3.657961274646967*^9, 
   3.657961274764965*^9}, 3.6579616775648937`*^9, {3.657963748537416*^9, 
   3.657963748800256*^9}, {3.6579640548584023`*^9, 3.6579640550397377`*^9}, 
   3.6579643966343813`*^9, {3.657964787982163*^9, 3.657964788219819*^9}, {
   3.657979061944572*^9, 3.657979062094222*^9}, 3.657979162259286*^9, {
   3.658147338047896*^9, 3.6581473383659687`*^9}, {3.658147493417946*^9, 
   3.658147493560783*^9}, 3.658147638759336*^9, {3.6581478330411663`*^9, 
   3.6581478331988783`*^9}, {3.65821538082722*^9, 3.6582153931599827`*^9}, 
   3.6582192307680483`*^9, {3.658220365191001*^9, 3.658220365332737*^9}, {
   3.6582210079488087`*^9, 3.658221008348791*^9}, {3.658221655028468*^9, 
   3.658221655189927*^9}, {3.6582232741247177`*^9, 3.658223274442339*^9}, {
   3.65822964285907*^9, 3.658229643000409*^9}, {3.658230129188501*^9, 
   3.6582301293063307`*^9}, 3.658230303590469*^9, {3.658232817686871*^9, 
   3.658232817892416*^9}, 3.6584768211696243`*^9, {3.658478158331215*^9, 
   3.658478158443344*^9}, {3.658478301113508*^9, 3.658478301271511*^9}, {
   3.658478619567287*^9, 3.658478634334279*^9}, 3.658478678334684*^9, 
   3.658480635788706*^9, {3.6584833229658003`*^9, 3.658483323290544*^9}, 
   3.658487522364092*^9, {3.65848758445532*^9, 3.658487584598105*^9}, {
   3.6584884171436453`*^9, 3.65848841727075*^9}, {3.6584884778234158`*^9, 
   3.6584884779652967`*^9}, {3.658489370996216*^9, 3.65848937113943*^9}, {
   3.658489595695405*^9, 3.658489597764439*^9}, {3.658489696338751*^9, 
   3.658489696617964*^9}, {3.658492009634116*^9, 3.6584920096793003`*^9}, {
   3.6585846660710297`*^9, 3.658584666459688*^9}, {3.658585292452421*^9, 
   3.6585852925298557`*^9}, {3.658641070359269*^9, 3.658641076886517*^9}, {
   3.65864165133532*^9, 3.658641653470298*^9}, {3.658642007326476*^9, 
   3.658642007459906*^9}, {3.6586449508479767`*^9, 3.658644951699139*^9}, {
   3.658645465735037*^9, 3.658645465860588*^9}, {3.658645807779954*^9, 
   3.658645808242608*^9}, {3.6586461054593973`*^9, 3.658646105602231*^9}, {
   3.658646252248713*^9, 3.658646252398234*^9}, {3.6586464277626553`*^9, 
   3.658646438984563*^9}, {3.658646475842163*^9, 3.6586464760399303`*^9}, {
   3.658647174512472*^9, 3.6586471746871433`*^9}, {3.658648216620336*^9, 
   3.658648217242033*^9}, {3.6586482863783407`*^9, 3.658648286447935*^9}, 
   3.658648320671286*^9, {3.658648376543421*^9, 3.658648377325749*^9}, {
   3.65864855434483*^9, 3.658648554512006*^9}, 3.658653751876148*^9, {
   3.658653899701229*^9, 3.6586538998589697`*^9}, {3.6586540747667093`*^9, 
   3.65865407487011*^9}, {3.658658204802387*^9, 3.658658205272847*^9}, {
   3.658659165924616*^9, 3.658659166540614*^9}, {3.658660253437405*^9, 
   3.658660253675522*^9}, {3.658660368441811*^9, 3.6586603685352793`*^9}, {
   3.658660440119746*^9, 3.658660444189699*^9}, {3.6586605337874117`*^9, 
   3.6586605339068832`*^9}, {3.6586609079532824`*^9, 3.658660984781398*^9}, {
   3.658661222709853*^9, 3.658661223071912*^9}, {3.659076139006364*^9, 
   3.6590761408454857`*^9}, {3.660997322314293*^9, 3.660997333792224*^9}, {
   3.661000426499291*^9, 3.661000426583947*^9}, {3.661083041977661*^9, 
   3.6610830426181097`*^9}, {3.661148823202075*^9, 3.661148823328382*^9}, 
   3.6611561390514297`*^9, {3.661156350058941*^9, 3.6611563501925793`*^9}, {
   3.661156635184662*^9, 3.661156635334544*^9}, {3.66115690177173*^9, 
   3.661156902306993*^9}, {3.661157229700251*^9, 3.661157229762034*^9}, {
   3.661686252124406*^9, 3.6616862523611393`*^9}, {3.6616895007618303`*^9, 
   3.661689507670538*^9}, 3.6616899414082108`*^9, {3.661691585493167*^9, 
   3.661691585986661*^9}, {3.6616980800173807`*^9, 3.661698081343108*^9}, {
   3.661698611497982*^9, 3.6616986209107933`*^9}, {3.661698653631297*^9, 
   3.661698653956615*^9}, {3.661698783858286*^9, 3.661698786101461*^9}, {
   3.6743717081272707`*^9, 3.674371708182232*^9}, {3.674460314580468*^9, 
   3.674460320395936*^9}, {3.6761887911742573`*^9, 3.6761888043279533`*^9}, {
   3.7147553309681807`*^9, 3.7147554873603983`*^9}, {3.714755592486487*^9, 
   3.71475563782023*^9}, {3.714755667982114*^9, 3.714755777847192*^9}, 
   3.7147558356960573`*^9, {3.714755930660054*^9, 3.7147559665389977`*^9}, 
   3.714799816502062*^9},ExpressionUUID->"83bb530b-d075-4c57-b1b4-\
32f3f222d312"]
}, Open  ]],

Cell[CellGroupData[{

Cell["settings for import and export", "Section",
 CellChangeTimes->{{3.714798830927537*^9, 
  3.714798844282794*^9}},ExpressionUUID->"4fcd6037-54c1-4919-8035-\
2971b76c3ea7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"directory", " ", "prefix", " ", "for", " ", "import"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"prefix", " ", "=", " ", 
     RowBox[{"root", "<>", "\"\</results/\>\""}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Ca", " ", "signals", " ", "per", " ", "cell", " ", "from", " ", "HDF5", 
     " ", "file"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"in", " ", "=", 
     RowBox[{
     "prefix", "<>", "\"\<myl7-GCaMP5G-from-processed-labels/\>\"", "<>", 
      "fname", "<>", "\"\<-curated-signal.h5\>\""}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "labelled", " ", "volume", " ", "of", " ", "detected", " ", "cells"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"map", " ", "=", " ", 
     RowBox[{
     "prefix", "<>", "\"\<myl7-H2A-processed-labels/\>\"", "<>", "fname", 
      "<>", "\"\<-curated-labels.tif\>\""}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "coordinates", " ", "of", " ", "manually", " ", "extracted", " ", 
     "midline"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mline", " ", "=", " ", 
     RowBox[{
     "prefix", "<>", "\"\<extracted-midline/\>\"", "<>", "fname", "<>", 
      "\"\<-midline.m\>\""}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7147558009952583`*^9, 3.714755918798725*^9}, {
   3.714756001531382*^9, 3.7147560132343807`*^9}, 3.714798885787745*^9, {
   3.715094196677239*^9, 3.7150942422278*^9}, {3.715094349599399*^9, 
   3.715094420859765*^9}, {3.715094634608032*^9, 
   3.715094639553718*^9}},ExpressionUUID->"bc7ee520-5e41-4abf-9919-\
32494b9b9472"]
}, Open  ]],

Cell[CellGroupData[{

Cell["general parameters", "Section",
 CellChangeTimes->{{3.714798868879168*^9, 
  3.7147988770398684`*^9}},ExpressionUUID->"214ed1dd-1b46-4ebb-aa76-\
35a0100a0bfd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "frequency", " ", "cutoff", " ", "for", " ", "lowpass", " ", "filter"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"freqCut", "=", "0.06"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"arbitrary", " ", "'"}], 
     RowBox[{"zero", "'"}], " ", "point", " ", "for", " ", "all", " ", "time",
      " ", "series"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"startPoint", "=", "140"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"settings", " ", "for", " ", "exported", " ", "graphics"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"maxRes", "=", "600"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"imsize", "=", " ", "600"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"imres", " ", "=", " ", "300"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "color", " ", "range", " ", "clipping", " ", "for", " ", "plotting"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"minDelay", "=", "0.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"maxDelay", " ", "=", " ", "0.2"}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"maxMetricSpeed", "=", "4"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.655479021511404*^9, 3.655479133277341*^9}, 
   3.655479168135984*^9, {3.655487371971097*^9, 3.655487372234848*^9}, 
   3.655489483208609*^9, 3.655490299425108*^9, {3.655490644672233*^9, 
   3.655490644774046*^9}, {3.655533232865612*^9, 3.655533244600911*^9}, {
   3.655533519790916*^9, 3.6555335198944483`*^9}, {3.655533906040166*^9, 
   3.655533906133751*^9}, 3.655534024866321*^9, {3.655534159555071*^9, 
   3.6555341596589003`*^9}, {3.655535031717915*^9, 3.655535032235477*^9}, {
   3.655535862268572*^9, 3.655535862426869*^9}, {3.655535942509951*^9, 
   3.655535942644422*^9}, {3.655536065345306*^9, 3.6555360655276937`*^9}, {
   3.6555361482341633`*^9, 3.6555361483368587`*^9}, {3.655536269765544*^9, 
   3.655536270075507*^9}, {3.6555415495606613`*^9, 3.655541549640798*^9}, {
   3.655546248986149*^9, 3.655546249255982*^9}, {3.655546528727294*^9, 
   3.655546528990411*^9}, 3.655547057565041*^9, {3.655547266361803*^9, 
   3.655547266479578*^9}, {3.655547885678088*^9, 3.655547885805414*^9}, {
   3.6557198439299793`*^9, 3.655719844087031*^9}, 3.6564044086060553`*^9, {
   3.656686420679265*^9, 3.6566864207797823`*^9}, {3.657345184367741*^9, 
   3.6573451845996*^9}, {3.657348396415759*^9, 3.6573483965119677`*^9}, {
   3.657541782503058*^9, 3.6575417826103077`*^9}, {3.657542616905013*^9, 
   3.6575426170398703`*^9}, {3.6575429891181993`*^9, 3.657542989225912*^9}, {
   3.6578692973927727`*^9, 3.657869299550892*^9}, {3.657869901031538*^9, 
   3.657869901149851*^9}, {3.657870185950344*^9, 3.6578701870062017`*^9}, {
   3.657870596827506*^9, 3.6578705969307547`*^9}, 3.65787202419201*^9, {
   3.657880200309387*^9, 3.657880201402659*^9}, {3.657961274646967*^9, 
   3.657961274764965*^9}, 3.6579616775648937`*^9, {3.657963748537416*^9, 
   3.657963748800256*^9}, {3.6579640548584023`*^9, 3.6579640550397377`*^9}, 
   3.6579643966343813`*^9, {3.657964787982163*^9, 3.657964788219819*^9}, {
   3.657979061944572*^9, 3.657979062094222*^9}, 3.657979162259286*^9, {
   3.658147338047896*^9, 3.6581473383659687`*^9}, {3.658147493417946*^9, 
   3.658147493560783*^9}, 3.658147638759336*^9, {3.6581478330411663`*^9, 
   3.6581478331988783`*^9}, {3.65821538082722*^9, 3.6582153931599827`*^9}, 
   3.6582192307680483`*^9, {3.658220365191001*^9, 3.658220365332737*^9}, {
   3.6582210079488087`*^9, 3.658221008348791*^9}, {3.658221655028468*^9, 
   3.658221655189927*^9}, {3.6582232741247177`*^9, 3.658223274442339*^9}, {
   3.65822964285907*^9, 3.658229643000409*^9}, {3.658230129188501*^9, 
   3.6582301293063307`*^9}, 3.658230303590469*^9, {3.658232817686871*^9, 
   3.658232817892416*^9}, 3.6584768211696243`*^9, {3.658478158331215*^9, 
   3.658478158443344*^9}, {3.658478301113508*^9, 3.658478301271511*^9}, {
   3.658478619567287*^9, 3.658478634334279*^9}, 3.658478678334684*^9, 
   3.658480635788706*^9, {3.6584833229658003`*^9, 3.658483323290544*^9}, 
   3.658487522364092*^9, {3.65848758445532*^9, 3.658487584598105*^9}, {
   3.6584884171436453`*^9, 3.65848841727075*^9}, {3.6584884778234158`*^9, 
   3.6584884779652967`*^9}, {3.658489370996216*^9, 3.65848937113943*^9}, {
   3.658489595695405*^9, 3.658489597764439*^9}, {3.658489696338751*^9, 
   3.658489696617964*^9}, {3.658492009634116*^9, 3.6584920096793003`*^9}, {
   3.6585846660710297`*^9, 3.658584666459688*^9}, {3.658585292452421*^9, 
   3.6585852925298557`*^9}, {3.658641070359269*^9, 3.658641076886517*^9}, {
   3.65864165133532*^9, 3.658641653470298*^9}, {3.658642007326476*^9, 
   3.658642007459906*^9}, {3.6586449508479767`*^9, 3.658644951699139*^9}, {
   3.658645465735037*^9, 3.658645465860588*^9}, {3.658645807779954*^9, 
   3.658645808242608*^9}, {3.6586461054593973`*^9, 3.658646105602231*^9}, {
   3.658646252248713*^9, 3.658646252398234*^9}, {3.6586464277626553`*^9, 
   3.658646438984563*^9}, {3.658646475842163*^9, 3.6586464760399303`*^9}, {
   3.658647174512472*^9, 3.6586471746871433`*^9}, {3.658648216620336*^9, 
   3.658648217242033*^9}, {3.6586482863783407`*^9, 3.658648286447935*^9}, 
   3.658648320671286*^9, {3.658648376543421*^9, 3.658648377325749*^9}, {
   3.65864855434483*^9, 3.658648554512006*^9}, 3.658653751876148*^9, {
   3.658653899701229*^9, 3.6586538998589697`*^9}, {3.6586540747667093`*^9, 
   3.65865407487011*^9}, {3.658658204802387*^9, 3.658658205272847*^9}, {
   3.658659165924616*^9, 3.658659166540614*^9}, {3.658660253437405*^9, 
   3.658660253675522*^9}, {3.658660368441811*^9, 3.6586603685352793`*^9}, {
   3.658660440119746*^9, 3.658660444189699*^9}, {3.6586605337874117`*^9, 
   3.6586605339068832`*^9}, {3.6586609079532824`*^9, 3.658660984781398*^9}, {
   3.658661222709853*^9, 3.658661223071912*^9}, {3.659076139006364*^9, 
   3.6590761408454857`*^9}, {3.660997322314293*^9, 3.660997333792224*^9}, {
   3.661000426499291*^9, 3.661000426583947*^9}, {3.661083041977661*^9, 
   3.6610830426181097`*^9}, {3.661148823202075*^9, 3.661148823328382*^9}, 
   3.6611561390514297`*^9, {3.661156350058941*^9, 3.6611563501925793`*^9}, {
   3.661156635184662*^9, 3.661156635334544*^9}, {3.66115690177173*^9, 
   3.661156902306993*^9}, {3.661157229700251*^9, 3.661157229762034*^9}, {
   3.661686252124406*^9, 3.6616862523611393`*^9}, {3.6616895007618303`*^9, 
   3.661689507670538*^9}, 3.6616899414082108`*^9, {3.661691585493167*^9, 
   3.661691585986661*^9}, {3.6616980800173807`*^9, 3.661698081343108*^9}, {
   3.661698611497982*^9, 3.6616986209107933`*^9}, {3.661698653631297*^9, 
   3.661698653956615*^9}, {3.661698783858286*^9, 3.661698786101461*^9}, {
   3.6743717081272707`*^9, 3.674371708182232*^9}, {3.674460314580468*^9, 
   3.674460320395936*^9}, {3.6761887911742573`*^9, 3.6761888043279533`*^9}, {
   3.7147553309681807`*^9, 3.7147554873603983`*^9}, {3.714755592486487*^9, 
   3.71475563782023*^9}, {3.714755667982114*^9, 3.714755777847192*^9}, 
   3.7147558356960573`*^9, {3.714755930660054*^9, 3.714755996874426*^9}, {
   3.714756672414266*^9, 3.7147567661596603`*^9}, 3.714757078332003*^9, {
   3.714758081453981*^9, 3.714758097886653*^9}, {3.7147988798184967`*^9, 
   3.714798891764056*^9}},ExpressionUUID->"46c65317-771b-4e7a-891b-\
60a855dfae27"]
}, Open  ]],

Cell[CellGroupData[{

Cell["import position and Ca signals for each cell", "Section",
 CellChangeTimes->{{3.714798914835228*^9, 3.71479891797869*^9}, {
  3.714799901334991*^9, 
  3.714799925419663*^9}},ExpressionUUID->"f6cfb36e-53d1-4a82-a1c7-\
a7ed0518febd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"names", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"in", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<HDF5\>\"", ",", "\"\<Datasets\>\""}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ns", " ", "=", " ", 
   RowBox[{"Length", "[", "names", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"series", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{"in", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<HDF5\>\"", ",", "\"\<Datasets\>\"", ",", "n"}], "}"}]}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", " ", "1", ",", " ", "ns", ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"heart", "=", 
   RowBox[{"Import", "[", "map", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"img", "=", 
   RowBox[{"Image3D", "[", 
    RowBox[{"heart", ",", "\"\<Bit16\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lab", " ", "=", " ", 
   RowBox[{"ComponentMeasurements", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ImageData", "[", 
        RowBox[{"img", ",", "\"\<Bit16\>\""}], "]"}], ",", "img"}], "}"}], 
     ",", 
     RowBox[{"{", "\"\<Label\>\"", "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cnts", " ", "=", " ", 
   RowBox[{"ComponentMeasurements", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ImageData", "[", 
        RowBox[{"img", ",", "\"\<Bit16\>\""}], "]"}], ",", "img"}], "}"}], 
     ",", 
     RowBox[{"{", "\"\<Centroid\>\"", "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sizes", " ", "=", " ", 
   RowBox[{"ComponentMeasurements", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ImageData", "[", 
        RowBox[{"img", ",", "\"\<Bit16\>\""}], "]"}], ",", "img"}], "}"}], 
     ",", 
     RowBox[{"{", "\"\<Count\>\"", "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pts", "=", 
   RowBox[{"Join", "@@", 
    RowBox[{"(", 
     RowBox[{"Last", "/@", "cnts"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pts2", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "*", 
      RowBox[{"{", 
       RowBox[{"dx", ",", "dx", ",", "1"}], "}"}]}], "&"}], "/@", "pts"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"series", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"RotateLeft", "[", 
      RowBox[{"#", ",", "startPoint"}], "]"}], "&"}], "/@", "series"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ids", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ToExpression", "[", 
      RowBox[{"StringDrop", "[", 
       RowBox[{"#", ",", "3"}], "]"}], "]"}], "&"}], "/@", "names"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"series", "=", 
   RowBox[{"Last", "/@", 
    RowBox[{"SortBy", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"ids", ",", "series"}], "}"}], "]"}], ",", "First"}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stdTransform", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
    "prefix", "<>", "\"\<standard-view-transforms/\>\"", "<>", "fname", "<>", 
     "\"\<-standardTransform.m\>\""}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6554777135070953`*^9, 3.6554777232097397`*^9}, {
   3.655479245674204*^9, 3.6554792615614*^9}, 3.655487398780986*^9, {
   3.658478329966675*^9, 3.658478401381905*^9}, {3.6586609640409737`*^9, 
   3.658660968031726*^9}, {3.658661231493938*^9, 3.6586612318714027`*^9}, {
   3.661000523684219*^9, 3.661000523889441*^9}, 3.661000583676567*^9, 
   3.661000733243688*^9, {3.66115553423967*^9, 3.661155553104319*^9}, {
   3.6688373204136677`*^9, 3.6688373263768167`*^9}, {3.674458971630077*^9, 
   3.674458973429183*^9}, {3.674834667924857*^9, 3.674834672869282*^9}, {
   3.7147560215867863`*^9, 3.714756043690292*^9}, {3.714756075481628*^9, 
   3.714756104070279*^9}, {3.715094440206498*^9, 3.715094501536394*^9}, 
   3.715094658275865*^9},ExpressionUUID->"b0c544f0-8d9b-4118-81ca-\
70e13dd71cd6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["pre-process calcium signals", "Section",
 CellChangeTimes->{{3.7147989410943832`*^9, 
  3.714798951088229*^9}},ExpressionUUID->"c47182b8-3e1a-469f-9c1d-\
211b8076c644"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"res", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"smoothSeries", "[", "#", "]"}], "&"}], "/@", "series"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"shifted", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"shift2min", "[", 
      RowBox[{"smoothSeries", "[", "#", "]"}], "]"}], "&"}], "/@", 
    "series"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"onsetAP", ",", "slopes", ",", "SNR"}], "}"}], "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"extractFeatures", "/@", "series"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cutoffSNR", " ", "=", " ", 
   RowBox[{
    RowBox[{"1.5", " ", 
     RowBox[{"InterquartileRange", "[", "SNR", "]"}]}], "+", 
    RowBox[{"Quantile", "[", 
     RowBox[{"SNR", ",", " ", "0.75"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"del", "=", 
   RowBox[{"Position", "[", 
    RowBox[{"SNR", ",", " ", 
     RowBox[{"z_", "/;", 
      RowBox[{"z", ">", "cutoffSNR"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"series", "=", 
   RowBox[{"Delete", "[", 
    RowBox[{"series", ",", "del"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pts2", " ", "=", " ", 
   RowBox[{"Delete", "[", 
    RowBox[{"pts2", ",", "del"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.655477883181121*^9, 3.655477883358304*^9}, {
   3.6554805792274847`*^9, 3.65548058950598*^9}, {3.658478416699357*^9, 
   3.658478416931917*^9}, {3.65848353750935*^9, 3.658483569458721*^9}, 
   3.661000720898465*^9, {3.661155561804105*^9, 3.6611556339479637`*^9}, 
   3.6616982626787357`*^9, {3.661698564099627*^9, 3.661698566337749*^9}, 
   3.674834847214044*^9, 3.6748355717033377`*^9, 3.674900785196774*^9, {
   3.676188254246505*^9, 
   3.676188257389378*^9}},ExpressionUUID->"9793bd3f-7626-40a0-a7a8-\
c32fc3e84e83"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"onsetAP", ",", "slopes", ",", "SNR"}], "}"}], "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"extractFeatures", "/@", "series"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"res", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"smoothSeries", "[", "#", "]"}], "&"}], "/@", "series"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"shifted", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"shift2min", "[", 
      RowBox[{"smoothSeries", "[", "#", "]"}], "]"}], "&"}], "/@", 
    "series"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tAct", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"getActivationTime", "[", "#", "]"}], "&"}], "/@", "series"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"riseTime", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"getRiseTime", "[", "#", "]"}], "&"}], "/@", "series"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.6584772583005753`*^9, {3.658585303004656*^9, 3.658585303178588*^9}, {
   3.6611473197247267`*^9, 3.6611473372011623`*^9}, {3.661149469773375*^9, 
   3.661149480171771*^9}, {3.661152390038178*^9, 3.661152398993067*^9}, {
   3.661153381793466*^9, 3.661153388391382*^9}, {3.6611555564304857`*^9, 
   3.661155567142055*^9}, {3.714756153002902*^9, 
   3.7147561535343018`*^9}},ExpressionUUID->"150dc594-d635-46dd-948b-\
6b878f73baec"],

Cell["\<\
Please change rawCaDataDir to the path containing the synchronized images \
from the myl7-GCaMP5G channel (A sample dataset can be downloaded from \
https://dataverse.harvard.edu/dataverse/caom , doi:10.7910/DVN/AIDVRW)\
\>", "Text",
 CellChangeTimes->{{3.718008239223629*^9, 
  3.718008362275806*^9}},ExpressionUUID->"6e582590-a42e-4783-9c59-\
093583d534c1"],

Cell[BoxData[{
 RowBox[{"rawCaDataDir", "=", 
  RowBox[{
  "\"\</Users/scherf/Dropbox/work/MPI-CBG/cell-accurate-optical-mapping/data/\
\>\"", "<>", "fname", "<>", 
   "\"\</tp00000_ch1_VSilent/\>\""}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rawCaImageFiles", "=", 
   RowBox[{"FileNames", "[", 
    RowBox[{"\"\<*.tif\>\"", ",", "rawCaDataDir"}], "]"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.66999645416679*^9, 3.669996485871612*^9}, {
   3.669996546727735*^9, 3.6699965723753033`*^9}, {3.66999662324568*^9, 
   3.669996625499753*^9}, {3.669996659916112*^9, 3.669996673708066*^9}, 
   3.718008540175602*^9},ExpressionUUID->"798c20d6-19f9-432d-b6ee-\
c7e704e47914"],

Cell[BoxData[
 RowBox[{
  RowBox[{"timg", "=", 
   RowBox[{"Image3D", "[", 
    RowBox[{"Import", "[", 
     RowBox[{"rawCaImageFiles", "[", 
      RowBox[{"[", "20", "]"}], "]"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.669996764951151*^9, 
  3.669996793319707*^9}},ExpressionUUID->"631d4220-dc50-45c7-ab0b-\
ffff35b2d790"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mydat", "=", 
   RowBox[{"ImageData", "[", "timg", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"nz", ",", "ny", ",", "nx"}], "}"}], " ", "=", " ", 
   RowBox[{"Dimensions", "[", "mydat", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mymax", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{"mydat", "[", 
       RowBox[{"[", 
        RowBox[{";;", ",", "i", ",", "j"}], "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "ny"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "nx"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"viewMIP", "=", 
  RowBox[{"ImageAdjust", "[", 
   RowBox[{"ColorNegate", "[", 
    RowBox[{"ColorConvert", "[", 
     RowBox[{
      RowBox[{"Image", "[", "mymax", "]"}], ",", "\"\<Grayscale\>\""}], "]"}],
     "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.669996755905018*^9, 3.669996759567584*^9}, {
  3.718008712655559*^9, 
  3.718008716236845*^9}},ExpressionUUID->"2f3134a6-0b34-4ac6-9aad-\
fbe9aa55efdf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nmax", "=", 
   RowBox[{"Length", "[", "rawCaImageFiles", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6699982340947857`*^9, 3.669998243777323*^9}, 
   3.718008590076289*^9},ExpressionUUID->"a1a38e36-0ab2-49de-b2dc-\
561e7ecdb30c"],

Cell[CellGroupData[{

Cell["Video S2", "Subsection",
 CellChangeTimes->{{3.670126887185161*^9, 
  3.670126913887526*^9}},ExpressionUUID->"a7dcc7d2-4185-4863-a675-\
dcae708f5955"],

Cell[CellGroupData[{

Cell["part 0", "Subsubsection",
 CellChangeTimes->{{3.6702261707780447`*^9, 
  3.670226172460988*^9}},ExpressionUUID->"24625d88-b5a9-4580-b8a5-\
d017202c6abf"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showRawWaveFromSlices", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showRawWaveFromSlices", "[", "\[IndentingNewLine]", 
   RowBox[{
   "t_", ",", "\[IndentingNewLine]", "sliceRadius_", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"transferFunction_:", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Blend", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "0.05635", ",", " ", "0.081", ",", " ", "0.07687", ",", " ", 
               "0."}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0.284433", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "0.496561", ",", " ", "0.177689", ",", " ", "0.0361663", ",", 
               " ", "0."}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0.394387", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "1.", ",", " ", "0.6036", ",", " ", "0.", ",", " ", 
               "0.0116194"}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0.649016", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "1.", ",", " ", "0.9658", ",", " ", "0.4926", ",", " ", 
               "0.681842"}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"1.", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "1.", ",", " ", "0.6436", ",", " ", "0.03622", ",", " ", "1."}],
               "]"}]}], "}"}]}], "}"}], ",", " ", "#1"}], "]"}], " ", "&"}], 
      " ", ")"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"imgFileList_:", "rawCaImageFiles"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{"t0_:", "startPoint"}], ",", "\[IndentingNewLine]", 
    RowBox[{"nSlices_:", "152"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "img", ",", "inverseTransform", ",", "transformedImg", ",", " ", 
      "newDimensions", ",", " ", "xmin", ",", "ymin", ",", "zmin", ",", "n", 
      ",", "finalProjection", ",", "centreSlice"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "imgFileList", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"centreSlice", "=", 
      RowBox[{"Floor", "[", 
       RowBox[{"nSlices", "/", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"img", " ", "=", 
      RowBox[{"ImageAdjust", "[", 
       RowBox[{
        RowBox[{"Image3D", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Import", "[", 
            RowBox[{"imgFileList", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"t0", "+", "t"}], ",", "n"}], "]"}], "+", "1"}], 
              "]"}], "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"centreSlice", "-", "sliceRadius"}], ";;", 
             RowBox[{"centreSlice", "+", "sliceRadius"}]}], "]"}], "]"}], ",", 
          RowBox[{"ColorFunction", "\[Rule]", " ", "transferFunction"}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0.006"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"img", "=", 
      RowBox[{"ImageResize", "[", 
       RowBox[{"img", ",", 
        RowBox[{"Round", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.41", ",", "0.41", ",", "1"}], "}"}], "*", 
          RowBox[{"ImageDimensions", "[", "img", "]"}]}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", "img", "}"}], ",", 
           RowBox[{"Lighting", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"Ticks", "\[Rule]", "None"}], ",", 
           RowBox[{"AxesOrigin", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
             "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"12", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
             "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Automatic", ",", "Automatic", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"sliceRadius", "-", "centreSlice"}], ",", 
                RowBox[{"sliceRadius", "+", "centreSlice"}]}], "}"}]}], 
             "}"}]}], ",", " ", 
           RowBox[{"PlotRangePadding", "->", "None"}], ",", 
           RowBox[{"ImagePadding", "->", "None"}]}], "]"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "600"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"finalProjection", ",", 
         RowBox[{"Graphics", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Inset", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Graphics", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"ColorData", "[", 
                   RowBox[{"97", ",", "1"}], "]"}], ",", 
                  RowBox[{"Annulus", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.8", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"2", "Pi", " ", 
                    RowBox[{"t", "/", "207"}]}], ")"}], "+", "0.00001"}]}], 
                    "}"}]}], "]"}], ",", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"PaddedForm", "[", 
                    RowBox[{
                    RowBox[{"2.5", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "-", "1"}], ")"}], ",", "0"}], "]"}]}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"3", ",", "1"}], "}"}], ",", 
                    RowBox[{"NumberPadding", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\>\"", ",", "\"\<0\>\""}], "}"}]}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "0.1"}]}], "}"}]}], "]"}], ",", "12", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
                   "]"}]}], "}"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}]}], "}"}]}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "80"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"120", ",", "120"}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Inset", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Graphics", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"ColorData", "[", 
                   RowBox[{"97", ",", "1"}], "]"}], ",", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"\"\<n: \>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{
                    RowBox[{"sliceRadius", "*", "2"}], "+", "1"}], "]"}]}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "0.1"}]}], "}"}]}], "]"}], ",", "12", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
                   "]"}]}], "}"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}]}], "}"}]}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "80"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"40", ",", "120"}], "}"}]}], "]"}]}], "}"}], "]"}]}], 
        "}"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "20"}], ",", "853"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "500"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.670150794259326*^9, 3.670150839136697*^9}, {
   3.670150873302929*^9, 3.670150915182271*^9}, {3.670150946823495*^9, 
   3.670151111567506*^9}, {3.6701511690559597`*^9, 3.6701511691579943`*^9}, {
   3.670151201902421*^9, 3.670151202668602*^9}, {3.670151270026206*^9, 
   3.670151276794367*^9}, {3.670151341250643*^9, 3.6701513414565687`*^9}, {
   3.670151374626356*^9, 3.670151395670908*^9}, {3.6701514422555237`*^9, 
   3.670151450109721*^9}, {3.6701515531485863`*^9, 3.670151573552025*^9}, {
   3.6701516041941633`*^9, 3.6701516326163*^9}, 3.6701516815453987`*^9, {
   3.670154348177397*^9, 3.67015435623208*^9}, {3.670154728503667*^9, 
   3.6701547349483852`*^9}},ExpressionUUID->"91a59adb-d359-4245-b60c-\
8c4e744e0e27"],

Cell[BoxData[
 RowBox[{
  RowBox[{"img", " ", "=", 
   RowBox[{"ImageAdjust", "[", 
    RowBox[{
     RowBox[{"Image3D", "[", 
      RowBox[{
       RowBox[{"Import", "[", 
        RowBox[{"rawCaImageFiles", "[", 
         RowBox[{"[", "130", "]"}], "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"75", "-", "30"}], ";;", 
         RowBox[{"75", "+", "30"}]}], "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0.006"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.670218224644598*^9, 
  3.6702182576820717`*^9}},ExpressionUUID->"77f146b0-344c-4250-9340-\
b2990896251f"],

Cell[BoxData[
 RowBox[{"showRawWaveFromSlices", "[", 
  RowBox[{"130", ",", "75"}], "]"}]], "Input",
 CellChangeTimes->{{3.670151356596898*^9, 3.670151366069076*^9}, {
  3.670155277329777*^9, 
  3.6701552883034286`*^9}},ExpressionUUID->"98de4cc3-373b-4df4-a12e-\
5c0364e043fd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-0/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"t", ",", "10", ",", "3"}], "]"}], "<>", "\"\<.png\>\""}], 
      ",", 
      RowBox[{"showRawWaveFromSlices", "[", 
       RowBox[{"t", ",", "0"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "207", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6701517515536013`*^9, 3.670151751833097*^9}, {
   3.670151820163102*^9, 3.670151841093849*^9}, 
   3.670229488623662*^9},ExpressionUUID->"41a2886b-7bbf-4b8c-af81-\
d56d74db3622"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-0/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{
         RowBox[{"t", "+", "207"}], ",", "10", ",", "3"}], "]"}], "<>", 
       "\"\<.png\>\""}], ",", 
      RowBox[{"Import", "[", 
       RowBox[{
       "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-0/\>\"", "<>", 
        RowBox[{"IntegerString", "[", 
         RowBox[{"t", ",", "10", ",", "3"}], "]"}], "<>", "\"\<.png\>\""}], 
       "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "207", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670151964107444*^9, 3.670151966509115*^9}, {
  3.670229489307633*^9, 
  3.6702294897163467`*^9}},ExpressionUUID->"9e34e312-cc20-44af-b09c-\
f1ffe0e02b19"],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{
     "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-0/\>\"", "<>", 
      RowBox[{"IntegerString", "[", 
       RowBox[{
        RowBox[{"t", "+", "414"}], ",", "10", ",", "3"}], "]"}], "<>", 
      "\"\<.png\>\""}], ",", 
     RowBox[{"showRawWaveFromSlices", "[", 
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{"t", ",", "207"}], "]"}], ",", 
       RowBox[{"Quotient", "[", 
        RowBox[{"t", ",", "10"}], "]"}]}], "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "1", ",", "750", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.670152454175634*^9, 3.670152530312244*^9}, {
   3.670152581759602*^9, 3.670152587974036*^9}, 
   3.67022949079521*^9},ExpressionUUID->"878b47c5-bda1-40e4-894c-\
995db48a0801"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-0-1/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"t", ",", "10", ",", "4"}], "]"}], "<>", "\"\<.png\>\""}], 
      ",", 
      RowBox[{"Import", "[", 
       RowBox[{
       "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-0/\>\"", "<>", 
        RowBox[{"IntegerString", "[", 
         RowBox[{"t", ",", "10", ",", "3"}], "]"}], "<>", "\"\<.png\>\""}], 
       "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "998", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670153950875745*^9, 3.6701540213680477`*^9}, {
  3.670229491515339*^9, 
  3.6702294920036507`*^9}},ExpressionUUID->"c89d554d-04d8-4994-90db-\
7180d9244915"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-0-1/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{
         RowBox[{"t", "+", "414"}], ",", "10", ",", "4"}], "]"}], "<>", 
       "\"\<.png\>\""}], ",", 
      RowBox[{"showRawWaveFromSlices", "[", 
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"t", ",", "207"}], "]"}], ",", 
        RowBox[{"Quotient", "[", 
         RowBox[{"t", ",", "10"}], "]"}]}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "584", ",", "750", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670154185074945*^9, 3.670154195994451*^9}, 
   3.6701547734013968`*^9, 
   3.6702294927611732`*^9},ExpressionUUID->"b61b1f49-c345-4348-b95b-\
f9af96934f1f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{
     "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-0-1/\>\"", "<>", 
      RowBox[{"IntegerString", "[", 
       RowBox[{
        RowBox[{"#", "+", "414"}], ",", "10", ",", "4"}], "]"}], "<>", 
      "\"\<.png\>\""}], ",", 
     RowBox[{"showRawWaveFromSlices", "[", 
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{"#", ",", "207"}], "]"}], ",", 
       RowBox[{"Quotient", "[", 
        RowBox[{"#", ",", "10"}], "]"}]}], "]"}]}], "]"}], "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{"207", ",", "414", ",", "621"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.670154806120123*^9, 3.670154852541103*^9}, 
   3.670229493615349*^9},ExpressionUUID->"8c1b2c8f-f750-49cf-aa24-\
e0b8c3760c62"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showRawWaveFromSlicesMoveCameraSmooth", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showRawWaveFromSlicesMoveCameraSmooth", "[", "\[IndentingNewLine]", 
   RowBox[{
   "t_", ",", "\[IndentingNewLine]", "sliceRadius_", ",", 
    "\[IndentingNewLine]", "alpha_", ",", "\[IndentingNewLine]", 
    RowBox[{"transferFunction_:", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Blend", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "0.05635", ",", " ", "0.081", ",", " ", "0.07687", ",", " ", 
               "0."}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0.284433", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "0.496561", ",", " ", "0.177689", ",", " ", "0.0361663", ",", 
               " ", "0."}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0.394387", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "1.", ",", " ", "0.6036", ",", " ", "0.", ",", " ", 
               "0.0116194"}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0.649016", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "1.", ",", " ", "0.9658", ",", " ", "0.4926", ",", " ", 
               "0.681842"}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"1.", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "1.", ",", " ", "0.6436", ",", " ", "0.03622", ",", " ", "1."}],
               "]"}]}], "}"}]}], "}"}], ",", " ", "#1"}], "]"}], " ", "&"}], 
      " ", ")"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"imgFileList_:", "rawCaImageFiles"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{"t0_:", "startPoint"}], ",", "\[IndentingNewLine]", 
    RowBox[{"nSlices_:", "152"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "img", ",", "inverseTransform", ",", "transformedImg", ",", " ", 
      "newDimensions", ",", " ", "xmin", ",", "ymin", ",", "zmin", ",", "n", 
      ",", "finalProjection", ",", "centreSlice"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "imgFileList", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"centreSlice", "=", 
      RowBox[{"Floor", "[", 
       RowBox[{"nSlices", "/", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"img", " ", "=", 
      RowBox[{"ImageAdjust", "[", 
       RowBox[{
        RowBox[{"Image3D", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Import", "[", 
            RowBox[{"imgFileList", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"t0", "+", "t"}], ",", "n"}], "]"}], "+", "1"}], 
              "]"}], "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"centreSlice", "-", "sliceRadius"}], ";;", 
             RowBox[{"centreSlice", "+", "sliceRadius"}]}], "]"}], "]"}], ",", 
          RowBox[{"ColorFunction", "\[Rule]", " ", "transferFunction"}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0.006"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"img", "=", 
      RowBox[{"ImageResize", "[", 
       RowBox[{"img", ",", 
        RowBox[{"Round", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.41", ",", "0.41", ",", "1"}], "}"}], "*", 
          RowBox[{"ImageDimensions", "[", "img", "]"}]}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", "img", "}"}], ",", 
           RowBox[{"Lighting", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"ViewPoint", "->", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "alpha"}], ")"}], "1.3"}], ",", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  RowBox[{"alpha", "^", "5"}]}], ")"}]}], "2.4"}], ",", 
              RowBox[{"2", "+", 
               RowBox[{"alpha", " ", "2"}]}]}], "}"}]}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"Ticks", "\[Rule]", "None"}], ",", 
           RowBox[{"AxesOrigin", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
             "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"12", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
             "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Automatic", ",", "Automatic", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"sliceRadius", "-", "centreSlice"}], ",", 
                RowBox[{"sliceRadius", "+", "centreSlice"}]}], "}"}]}], 
             "}"}]}], ",", " ", 
           RowBox[{"PlotRangePadding", "->", "None"}], ",", 
           RowBox[{"ImagePadding", "->", "None"}]}], "]"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "600"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"finalProjection", ",", 
         RowBox[{"Graphics", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Inset", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Graphics", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"ColorData", "[", 
                   RowBox[{"97", ",", "1"}], "]"}], ",", 
                  RowBox[{"Annulus", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.8", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"2", "Pi", " ", 
                    RowBox[{"t", "/", "207"}]}], ")"}], "+", "0.00001"}]}], 
                    "}"}]}], "]"}], ",", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"PaddedForm", "[", 
                    RowBox[{
                    RowBox[{"2.5", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "-", "1"}], ")"}], ",", "0"}], "]"}]}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"3", ",", "1"}], "}"}], ",", 
                    RowBox[{"NumberPadding", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\>\"", ",", "\"\<0\>\""}], "}"}]}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "0.1"}]}], "}"}]}], "]"}], ",", "12", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
                   "]"}]}], "}"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}]}], "}"}]}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "80"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"120", ",", "120"}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Inset", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Graphics", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"ColorData", "[", 
                   RowBox[{"97", ",", "1"}], "]"}], ",", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"\"\<n: \>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{
                    RowBox[{"sliceRadius", "*", "2"}], "+", "1"}], "]"}]}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "0.1"}]}], "}"}]}], "]"}], ",", "12", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
                   "]"}]}], "}"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}]}], "}"}]}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "80"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"40", ",", "120"}], "}"}]}], "]"}]}], "}"}], "]"}]}], 
        "}"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "20"}], ",", "853"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "500"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.670216035395815*^9, 3.670216039113564*^9}, {
  3.6702163121312037`*^9, 
  3.670216332463067*^9}},ExpressionUUID->"5a87cfcc-f329-4569-9bec-\
eaadd5603244"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showRawWaveFromSlicesMoveCameraOnAxes", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showRawWaveFromSlicesMoveCameraOnAxes", "[", "\[IndentingNewLine]", 
   RowBox[{
   "t_", ",", "\[IndentingNewLine]", "sliceRadius_", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"camx_", ",", "camy_", ",", "camz_"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"transferFunction_:", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Blend", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "0.05635", ",", " ", "0.081", ",", " ", "0.07687", ",", " ", 
               "0."}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0.284433", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "0.496561", ",", " ", "0.177689", ",", " ", "0.0361663", ",", 
               " ", "0."}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0.394387", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "1.", ",", " ", "0.6036", ",", " ", "0.", ",", " ", 
               "0.0116194"}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0.649016", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "1.", ",", " ", "0.9658", ",", " ", "0.4926", ",", " ", 
               "0.681842"}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"1.", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "1.", ",", " ", "0.6436", ",", " ", "0.03622", ",", " ", "1."}],
               "]"}]}], "}"}]}], "}"}], ",", " ", "#1"}], "]"}], " ", "&"}], 
      " ", ")"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"imgFileList_:", "rawCaImageFiles"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{"t0_:", "startPoint"}], ",", "\[IndentingNewLine]", 
    RowBox[{"nSlices_:", "152"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "img", ",", "inverseTransform", ",", "transformedImg", ",", " ", 
      "newDimensions", ",", " ", "xmin", ",", "ymin", ",", "zmin", ",", "n", 
      ",", "finalProjection", ",", "centreSlice"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "imgFileList", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"centreSlice", "=", 
      RowBox[{"Floor", "[", 
       RowBox[{"nSlices", "/", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"img", " ", "=", 
      RowBox[{"ImageAdjust", "[", 
       RowBox[{
        RowBox[{"Image3D", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Import", "[", 
            RowBox[{"imgFileList", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"t0", "+", "t"}], ",", "n"}], "]"}], "+", "1"}], 
              "]"}], "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"centreSlice", "-", "sliceRadius"}], ";;", 
             RowBox[{"centreSlice", "+", "sliceRadius"}]}], "]"}], "]"}], ",", 
          RowBox[{"ColorFunction", "\[Rule]", " ", "transferFunction"}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0.006"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"img", "=", 
      RowBox[{"ImageResize", "[", 
       RowBox[{"img", ",", 
        RowBox[{"Round", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.41", ",", "0.41", ",", "1"}], "}"}], "*", 
          RowBox[{"ImageDimensions", "[", "img", "]"}]}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", "img", "}"}], ",", 
           RowBox[{"Lighting", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"ViewPoint", "->", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"camx", " ", "0.0123"}], ",", 
              RowBox[{
               RowBox[{"-", "0.112"}], " ", "camy"}], ",", 
              RowBox[{"camz", " ", "+", "3.981"}]}], "}"}]}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"Ticks", "\[Rule]", "None"}], ",", 
           RowBox[{"AxesOrigin", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
             "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"12", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
             "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Automatic", ",", "Automatic", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"sliceRadius", "-", "centreSlice"}], ",", 
                RowBox[{"sliceRadius", "+", "centreSlice"}]}], "}"}]}], 
             "}"}]}], ",", " ", 
           RowBox[{"PlotRangePadding", "->", "None"}], ",", 
           RowBox[{"ImagePadding", "->", "None"}]}], "]"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "600"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"finalProjection", ",", 
         RowBox[{"Graphics", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Inset", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Graphics", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"ColorData", "[", 
                   RowBox[{"97", ",", "1"}], "]"}], ",", 
                  RowBox[{"Annulus", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.8", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"2", "Pi", " ", 
                    RowBox[{"t", "/", "207"}]}], ")"}], "+", "0.00001"}]}], 
                    "}"}]}], "]"}], ",", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"PaddedForm", "[", 
                    RowBox[{
                    RowBox[{"2.5", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "-", "1"}], ")"}], ",", "0"}], "]"}]}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"3", ",", "1"}], "}"}], ",", 
                    RowBox[{"NumberPadding", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\>\"", ",", "\"\<0\>\""}], "}"}]}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "0.1"}]}], "}"}]}], "]"}], ",", "12", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
                   "]"}]}], "}"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}]}], "}"}]}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "80"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"120", ",", "120"}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Inset", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Graphics", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"ColorData", "[", 
                   RowBox[{"97", ",", "1"}], "]"}], ",", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"\"\<n: \>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{
                    RowBox[{"sliceRadius", "*", "2"}], "+", "1"}], "]"}]}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "0.1"}]}], "}"}]}], "]"}], ",", "12", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
                   "]"}]}], "}"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}]}], "}"}]}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "80"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"40", ",", "120"}], "}"}]}], "]"}]}], "}"}], "]"}]}], 
        "}"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "20"}], ",", "853"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "500"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.67015490832708*^9, 3.670154915612465*^9}, {
   3.670154950382378*^9, 3.670154951853094*^9}, 3.670154997562523*^9, {
   3.670155324451495*^9, 3.670155346256315*^9}, 3.6701554684955397`*^9, {
   3.670155502807678*^9, 3.6701555029391413`*^9}, 3.670156058620348*^9, {
   3.670156105188703*^9, 3.670156118415628*^9}, {3.6701563576902847`*^9, 
   3.670156393549827*^9}, {3.670157099866993*^9, 3.670157126535866*^9}, 
   3.670158151952784*^9, {3.6702163357882967`*^9, 3.670216340032666*^9}, {
   3.670216841379468*^9, 
   3.6702168645998077`*^9}},ExpressionUUID->"58f6ec18-d60c-45fd-99ba-\
db33cc7ef5be"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"camx", ",", "camy", ",", "camz"}], "}"}], "=", 
  RowBox[{"BSplineFunction", "/@", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1.3", ",", 
        RowBox[{"-", "2.4"}], ",", "2"}], "}"}], " ", ",", 
      RowBox[{"{", 
       RowBox[{"0.8", ",", 
        RowBox[{"-", "1.2"}], ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.4", ",", 
        RowBox[{"-", "0.6"}], ",", "20"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "100"}], "}"}]}], "}"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.670156171005878*^9, 3.670156326834383*^9}, {
  3.6701564418930387`*^9, 
  3.670156466642137*^9}},ExpressionUUID->"9b5f4ead-912c-4ad6-a8af-\
d55cf4cacfc8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"t", "=", "0.9905"}], ";", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "t"}], ")"}], "1.3"}], ",", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"t", "^", "5"}]}], ")"}]}], "2.4"}], ",", 
    RowBox[{"2", "+", 
     RowBox[{"t", " ", "2"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.670216719378067*^9, 3.6702167309694*^9}, {
  3.670216764504322*^9, 
  3.670216764775858*^9}},ExpressionUUID->"f4c59412-c0db-445a-a227-\
3620ea351428"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-0-1/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{
         RowBox[{"t", "+", "414"}], ",", "10", ",", "4"}], "]"}], "<>", 
       "\"\<.png\>\""}], ",", 
      RowBox[{"showRawWaveFromSlicesMoveCameraSmooth", "[", 
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"751", ",", "207"}], "]"}], ",", "75", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"t", "-", "751"}], ")"}], "/", "201"}], ")"}]}], "]"}]}], 
     "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "751", ",", "950", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670155076911737*^9, 3.670155099057929*^9}, 
   3.670155261725588*^9, {3.670155303272252*^9, 3.670155317263098*^9}, {
   3.670155351301917*^9, 3.670155367013006*^9}, {3.670157244806089*^9, 
   3.6701572795357313`*^9}, {3.6701573818061543`*^9, 3.670157381932803*^9}, {
   3.670216375140749*^9, 3.670216397620373*^9}, {3.670216434260254*^9, 
   3.670216445978609*^9}, {3.670216599816742*^9, 3.67021660018089*^9}, {
   3.670216644581575*^9, 3.67021664469247*^9}, 
   3.670229498197875*^9},ExpressionUUID->"bb74c45c-8524-49ee-9419-\
13ca4bb3e4fd"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{
       "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-0-1/\>\"", "<>", 
        RowBox[{"IntegerString", "[", 
         RowBox[{
          RowBox[{"t", "+", "414"}], ",", "10", ",", "4"}], "]"}], "<>", 
        "\"\<.png\>\""}], ",", 
       RowBox[{"showRawWaveFromSlicesMoveCamera", "[", 
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{"751", ",", "207"}], "]"}], ",", "75", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"1", "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"t", "-", "851"}], ")"}], "/", "100"}], ")"}]}], ",", 
           "1"}], "}"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "851", ",", "951", ",", "1"}], "}"}]}], "]"}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.67015730918128*^9, 3.670157332982009*^9}, {
   3.670157383781117*^9, 3.670157383909112*^9}, 3.6702164590180063`*^9, 
   3.670229499213188*^9},ExpressionUUID->"aec38008-ad8d-4dc5-9cf0-\
b190a41c75ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-0-1/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{
         RowBox[{"t", "+", "414"}], ",", "10", ",", "4"}], "]"}], "<>", 
       "\"\<.png\>\""}], ",", 
      RowBox[{"showRawWaveFromSlicesMoveCameraOnAxes", "[", 
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"751", ",", "207"}], "]"}], ",", "75", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"t", "-", "951"}], ")"}], "/", "29"}], ")"}]}], ",", 
          "1", ",", "1"}], "}"}]}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "951", ",", "980", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670157344727709*^9, 3.670157387772789*^9}, {
   3.670157982276367*^9, 3.67015798260185*^9}, {3.67021666282432*^9, 
   3.670216663787505*^9}, {3.670216893564416*^9, 3.670216925643031*^9}, {
   3.67021701346474*^9, 3.67021701353752*^9}, {3.6702210065875883`*^9, 
   3.670221007431633*^9}, 
   3.6702294997426243`*^9},ExpressionUUID->"14c0c3b5-e444-4c40-84f3-\
22a8712a38dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-0-1/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{
         RowBox[{"t", "+", "414"}], ",", "10", ",", "4"}], "]"}], "<>", 
       "\"\<.png\>\""}], ",", 
      RowBox[{"showRawWaveFromSlicesMoveCameraOnAxes", "[", 
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"751", ",", "207"}], "]"}], ",", "75", ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"t", "-", "981"}], ")"}], "/", "29"}], ")"}]}], ",", 
          "1"}], "}"}]}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "981", ",", "1010", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6702169456106586`*^9, 3.670216980888936*^9}, {
   3.6702170156807404`*^9, 3.6702170157447023`*^9}, {3.670221009739417*^9, 
   3.6702210103759623`*^9}, 
   3.670229500154573*^9},ExpressionUUID->"a13acd17-3f72-4252-a956-\
6fcad0b0d8f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-0-1/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{
         RowBox[{"t", "+", "414"}], ",", "10", ",", "4"}], "]"}], "<>", 
       "\"\<.png\>\""}], ",", 
      RowBox[{"showRawWaveFromSlicesMoveCameraOnAxes", "[", 
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"751", ",", "207"}], "]"}], ",", "75", ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"100", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"t", "-", "1011"}], ")"}], "/", "29"}], ")"}]}]}], 
         "}"}]}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1011", ",", "1040", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670217022928218*^9, 3.670217082966008*^9}, {
   3.670221012716235*^9, 3.670221013151753*^9}, 
   3.670229500601403*^9},ExpressionUUID->"a9e0ad2c-c7b2-4699-bc87-\
702260875858"]
}, Open  ]],

Cell[CellGroupData[{

Cell["part I", "Subsubsection",
 CellChangeTimes->{{3.670077920915923*^9, 
  3.670077921843992*^9}},ExpressionUUID->"5b3983be-403c-45a9-a266-\
ed97b9bafa5d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"myimg", " ", "=", 
   RowBox[{"ImageAdjust", "[", 
    RowBox[{"Image3D", "[", 
     RowBox[{"Import", "[", 
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/data/reference-nuclei/\>\"", "<>",
        "fname", "<>", "\"\<.tif\>\""}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myimg", "=", 
   RowBox[{"ImageResize", "[", 
    RowBox[{"myimg", ",", 
     RowBox[{"Round", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.41", ",", "0.41", ",", "1"}], "}"}], "*", 
       RowBox[{"ImageDimensions", "[", "myimg", "]"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",ExpressionUUID->"7dd7cd3c-89f1-405d-9138-b14c0739f412"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showNuclei", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showNuclei", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"centroids_:", "pts2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"transferFunction_:", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Blend", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "0.917794", ",", " ", "0.920966", ",", " ", "0.881936", ",", 
               " ", "0."}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0.0500579", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "0.876709", ",", " ", "0.880126", ",", " ", "0.845903", ",", 
               " ", "0."}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0.105035", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "0.831587", ",", " ", "0.835272", ",", " ", "0.806328", ",", 
               " ", "0.140508"}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0.327836", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "0.601702", ",", " ", "0.619402", ",", " ", "0.616518", ",", 
               " ", "0.63673"}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"1.", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "0.1", ",", " ", "0.1", ",", " ", "0.1", ",", " ", "0.86873"}], 
              "]"}]}], "}"}]}], "}"}], ",", " ", "#1"}], "]"}], " ", "&"}], 
      " ", ")"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "img", ",", "inverseTransform", ",", "transformedImg", ",", " ", 
      "newDimensions", ",", " ", "xmin", ",", "ymin", ",", "zmin", ",", "n", 
      ",", "finalProjection"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"img", " ", "=", 
      RowBox[{"ImageAdjust", "[", 
       RowBox[{"Image3D", "[", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{
          "\"\</Users/scherf/Documents/heart_new/data/reference-nuclei/\>\"", 
           "<>", "fname", "<>", "\"\<.tif\>\""}], "]"}], ",", 
         RowBox[{"ColorFunction", "\[Rule]", " ", "transferFunction"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", "img", "}"}], ",", 
           RowBox[{"ViewPoint", "\[Rule]", "Top"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}]}], "]"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "300"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"finalProjection", ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics", "[", 
          RowBox[{"{", 
           RowBox[{"Black", ",", 
            RowBox[{"Opacity", "[", "0.3", "]"}], ",", 
            RowBox[{"AbsolutePointSize", "[", "4", "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Point", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Most", "[", "#", "]"}], "*", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"1", "/", "dx"}], ",", 
                   RowBox[{"1", "/", "dx"}]}], "}"}]}], "+", 
                RowBox[{"{", 
                 RowBox[{"20", ",", "30"}], "}"}]}], "]"}], "&"}], "/@", 
             "centroids"}]}], "}"}], "]"}]}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "800"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "500"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"800", ",", "600"}], "}"}]}], ",", 
       RowBox[{"PlotRangePadding", "->", "None"}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.6700785946916027`*^9, 3.670078717748446*^9}, {
  3.670078768627328*^9, 3.6700787849696302`*^9}, {3.67007885136158*^9, 
  3.6700788536232977`*^9}},ExpressionUUID->"ed2d0aba-37bd-4bd1-adb5-\
130585980b9a"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showNuclei", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showNuclei", "[", "\[IndentingNewLine]", 
   RowBox[{
   "alpha_", ",", "\[IndentingNewLine]", "referenceCells_List", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"centroids_:", "pts2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"imgFileList_:", "rawCaImageFiles"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{"t0_:", "startPoint"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "img", ",", "inverseTransform", ",", "transformedImg", ",", " ", 
      "newDimensions", ",", " ", "xmin", ",", "ymin", ",", "zmin", ",", "n", 
      ",", "finalProjection", ",", "transferFunction"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "imgFileList", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SeedRandom", "[", "\"\<1234\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"transferFunction", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Blend", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0.", ",", " ", 
              RowBox[{"RGBColor", "[", 
               RowBox[{
               "0.917794", ",", " ", "0.920966", ",", " ", "0.881936", ",", 
                " ", "0."}], "]"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"0.0500579", ",", " ", 
              RowBox[{"RGBColor", "[", 
               RowBox[{
               "0.876709", ",", " ", "0.880126", ",", " ", "0.845903", ",", 
                " ", "0."}], "]"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"0.105035", ",", " ", 
              RowBox[{"RGBColor", "[", 
               RowBox[{
               "0.831587", ",", " ", "0.835272", ",", " ", "0.806328", ",", 
                " ", 
                RowBox[{"0.140508", "*", "alpha"}]}], "]"}]}], "}"}], ",", 
            " ", 
            RowBox[{"{", 
             RowBox[{"0.327836", ",", " ", 
              RowBox[{"RGBColor", "[", 
               RowBox[{
               "0.601702", ",", " ", "0.619402", ",", " ", "0.616518", ",", 
                " ", 
                RowBox[{"0.63673", "*", "alpha"}]}], "]"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"1.", ",", " ", 
              RowBox[{"RGBColor", "[", 
               RowBox[{"0.1", ",", " ", "0.1", ",", " ", "0.1", ",", " ", 
                RowBox[{"0.86873", "*", "alpha"}]}], "]"}]}], "}"}]}], "}"}], 
          ",", " ", "#1"}], "]"}], " ", "&"}], " ", ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"img", " ", "=", 
      RowBox[{"ImageAdjust", "[", 
       RowBox[{"Image3D", "[", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{
          "\"\</Users/scherf/Documents/heart_new/data/reference-nuclei/\>\"", 
           "<>", "fname", "<>", "\"\<.tif\>\""}], "]"}], ",", 
         RowBox[{"ColorFunction", "\[Rule]", " ", "transferFunction"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"img", "=", 
      RowBox[{"ImageResize", "[", 
       RowBox[{"img", ",", 
        RowBox[{"Round", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.41", ",", "0.41", ",", "1"}], "}"}], "*", 
          RowBox[{"ImageDimensions", "[", "img", "]"}]}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"img", ",", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"ColorData", "[", 
                   RowBox[{"96", ",", 
                    RowBox[{"RandomInteger", "[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "20"}], "}"}], "]"}]}], "]"}], ",", 
                  RowBox[{"Specularity", "[", "0.", "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{"#", ",", "1.4"}], "]"}]}], "}"}], "&"}], "/@", 
               "centroids"}], "]"}]}], "}"}], ",", 
           RowBox[{"Lighting", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"ViewPoint", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "Infinity"}], "}"}]}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRangePadding", "->", "None"}], ",", 
           RowBox[{"ImagePadding", "->", "None"}]}], "]"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "600"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", "finalProjection", "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "20"}], ",", "853"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "500"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.6700874767171097`*^9, 3.6700875003106403`*^9}, 
   3.670087532182136*^9, 3.6700875887398787`*^9, {3.67008764411082*^9, 
   3.6700877778812227`*^9}, {3.670087820697379*^9, 3.67008783076757*^9}, {
   3.670088250977563*^9, 
   3.6700882586578074`*^9}},ExpressionUUID->"6ebc5466-255b-4767-b5dc-\
74e855bc9ada"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showNucleiGray", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showNucleiGray", "[", "\[IndentingNewLine]", 
   RowBox[{
   "alpha_", ",", "\[IndentingNewLine]", "referenceCells_List", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"centroids_:", "pts2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"imgFileList_:", "rawCaImageFiles"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{"t0_:", "startPoint"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "img", ",", "inverseTransform", ",", "transformedImg", ",", " ", 
      "newDimensions", ",", " ", "xmin", ",", "ymin", ",", "zmin", ",", "n", 
      ",", "finalProjection", ",", "transferFunction"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "imgFileList", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SeedRandom", "[", "\"\<1234\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"transferFunction", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Blend", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0.", ",", " ", 
              RowBox[{"RGBColor", "[", 
               RowBox[{
               "0.917794", ",", " ", "0.920966", ",", " ", "0.881936", ",", 
                " ", "0."}], "]"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"0.0500579", ",", " ", 
              RowBox[{"RGBColor", "[", 
               RowBox[{
               "0.876709", ",", " ", "0.880126", ",", " ", "0.845903", ",", 
                " ", "0."}], "]"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"0.105035", ",", " ", 
              RowBox[{"RGBColor", "[", 
               RowBox[{
               "0.831587", ",", " ", "0.835272", ",", " ", "0.806328", ",", 
                " ", 
                RowBox[{"0.140508", "*", "alpha"}]}], "]"}]}], "}"}], ",", 
            " ", 
            RowBox[{"{", 
             RowBox[{"0.327836", ",", " ", 
              RowBox[{"RGBColor", "[", 
               RowBox[{
               "0.601702", ",", " ", "0.619402", ",", " ", "0.616518", ",", 
                " ", 
                RowBox[{"0.63673", "*", "alpha"}]}], "]"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"1.", ",", " ", 
              RowBox[{"RGBColor", "[", 
               RowBox[{"0.1", ",", " ", "0.1", ",", " ", "0.1", ",", " ", 
                RowBox[{"0.86873", "*", "alpha"}]}], "]"}]}], "}"}]}], "}"}], 
          ",", " ", "#1"}], "]"}], " ", "&"}], " ", ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"img", " ", "=", 
      RowBox[{"ImageAdjust", "[", 
       RowBox[{"Image3D", "[", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{
          "\"\</Users/scherf/Documents/heart_new/data/reference-nuclei/\>\"", 
           "<>", "fname", "<>", "\"\<.tif\>\""}], "]"}], ",", 
         RowBox[{"ColorFunction", "\[Rule]", " ", "transferFunction"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"img", "=", 
      RowBox[{"ImageResize", "[", 
       RowBox[{"img", ",", 
        RowBox[{"Round", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.41", ",", "0.41", ",", "1"}], "}"}], "*", 
          RowBox[{"ImageDimensions", "[", "img", "]"}]}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"img", ",", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Gray", ",", 
                  RowBox[{"Specularity", "[", "0.", "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{"#", ",", "1.4"}], "]"}]}], "}"}], "&"}], "/@", 
               "centroids"}], "]"}]}], "}"}], ",", 
           RowBox[{"Lighting", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"ViewPoint", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "Infinity"}], "}"}]}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRangePadding", "->", "None"}], ",", 
           RowBox[{"ImagePadding", "->", "None"}]}], "]"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "600"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", "finalProjection", "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "20"}], ",", "853"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "500"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.670088445820189*^9, 
  3.670088493859745*^9}},ExpressionUUID->"b3bf7ca3-2507-4e43-b7e8-\
0fa68b6ab8b0"],

Cell[BoxData[
 RowBox[{"frame1", "=", 
  RowBox[{"showNuclei", "[", 
   RowBox[{"0.001", ",", 
    RowBox[{"{", 
     RowBox[{"120", ",", "200"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.670078726351602*^9, 3.670078731375277*^9}, {
  3.6700875106000853`*^9, 3.670087513191864*^9}, {3.670087781567267*^9, 
  3.670087794935062*^9}, {3.670087851374748*^9, 3.670087852044722*^9}, {
  3.670087901382079*^9, 3.670087902443198*^9}, {3.670088475985675*^9, 
  3.670088479177782*^9}},ExpressionUUID->"2e96d335-790f-45d1-82a4-\
1d327207dff8"],

Cell[BoxData[
 RowBox[{"frame2", "=", 
  RowBox[{"showNucleiGray", "[", 
   RowBox[{"0.00", ",", 
    RowBox[{"{", 
     RowBox[{"120", ",", "200"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.67008850248237*^9, 
  3.670088514464284*^9}},ExpressionUUID->"f681d0f7-6c2a-4ff7-a20e-\
c88632aca452"],

Cell[BoxData[
 RowBox[{"Blend", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"frame1", ",", "frame2"}], "}"}], ",", "0.4"}], "]"}]], "Input",
 CellChangeTimes->{{3.670088522500749*^9, 3.6700885539855947`*^9}, {
  3.670088584024227*^9, 3.67008860051*^9}, {3.670088808241542*^9, 
  3.670088818648643*^9}},ExpressionUUID->"4f5e9c29-84fb-43cc-aad6-\
8dd184d1ff5c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-1/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{
         RowBox[{"t", "+", "20"}], ",", "10", ",", "3"}], "]"}], "<>", 
       "\"\<.png\>\""}], ",", 
      RowBox[{"Blend", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"frame1", ",", "frame2"}], "}"}], ",", 
        RowBox[{"0.1", " ", "t"}]}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "10"}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.6700880617189407`*^9, 3.670088118380741*^9}, {
   3.670088159181883*^9, 3.670088188395228*^9}, {3.670088286431903*^9, 
   3.6700882866233683`*^9}, {3.6700886297114887`*^9, 3.670088656508431*^9}, {
   3.670088720468835*^9, 3.670088759139432*^9}, {3.6700888248333817`*^9, 
   3.670088827038785*^9}, 
   3.670229501543788*^9},ExpressionUUID->"0498459a-0d3d-402c-b093-\
731f4e572d4d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-1/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"t", ",", "10", ",", "3"}], "]"}], "<>", "\"\<.png\>\""}], 
      ",", 
      RowBox[{"showNuclei", "[", 
       RowBox[{
        RowBox[{"1", "-", 
         RowBox[{"t", "/", "20"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"225", ",", "20"}], "}"}], ",", "pts2"}], "]"}]}], "]"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "20"}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{
  3.670229502192215*^9},ExpressionUUID->"4ec13f09-faee-4750-8ef0-\
eb8b3c331c74"],

Cell[BoxData[
 RowBox[{"test", "=", "\[IndentingNewLine]", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Image3D", "[", 
       RowBox[{"myimg", ",", 
        RowBox[{"ColorFunction", "->", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Blend", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0.", ",", " ", 
                 RowBox[{"RGBColor", "[", 
                  RowBox[{
                  "0.917794", ",", " ", "0.920966", ",", " ", "0.881936", ",",
                    " ", "0."}], "]"}]}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"0.0500579", ",", " ", 
                 RowBox[{"RGBColor", "[", 
                  RowBox[{
                  "0.876709", ",", " ", "0.880126", ",", " ", "0.845903", ",",
                    " ", "0."}], "]"}]}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"0.105035", ",", " ", 
                 RowBox[{"RGBColor", "[", 
                  RowBox[{
                  "0.831587", ",", " ", "0.835272", ",", " ", "0.806328", ",",
                    " ", "0.140508"}], "]"}]}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"0.327836", ",", " ", 
                 RowBox[{"RGBColor", "[", 
                  RowBox[{
                  "0.601702", ",", " ", "0.619402", ",", " ", "0.616518", ",",
                    " ", "0.63673"}], "]"}]}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"1.", ",", " ", 
                 RowBox[{"RGBColor", "[", 
                  RowBox[{
                  "0.1", ",", " ", "0.1", ",", " ", "0.1", ",", " ", 
                   "0.86873"}], "]"}]}], "}"}]}], "}"}], ",", " ", "#1"}], 
            "]"}], " ", "&"}], " ", ")"}]}]}], "]"}], ",", 
      RowBox[{"Graphics3D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ColorData", "[", 
            RowBox[{"96", ",", 
             RowBox[{"RandomInteger", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", "20"}], "}"}], "]"}]}], "]"}], ",", 
           RowBox[{"Specularity", "[", "0", "]"}], ",", 
           RowBox[{"Sphere", "[", 
            RowBox[{"#", ",", "1.5"}], "]"}]}], "}"}], "&"}], "/@", "pts2"}], 
       "]"}]}], "}"}], ",", 
    RowBox[{"ViewPoint", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "Infinity"}], "}"}]}], ",", 
    RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
    RowBox[{"Lighting", "->", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.670078889102418*^9, 3.6700789179417057`*^9}, {
  3.6700789826277323`*^9, 3.6700791159929457`*^9}, {3.670079739836691*^9, 
  3.6700797738967447`*^9}, {3.670087335710326*^9, 
  3.6700873377261953`*^9}},ExpressionUUID->"00fcfa32-b716-47c5-8865-\
dbc33f8a753c"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"nuclearChannel", "=", 
   RowBox[{"Image", "[", 
    RowBox[{"Rasterize", "[", 
     RowBox[{
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"Image3D", "[", 
         RowBox[{"myimg", ",", 
          RowBox[{"ColorFunction", "->", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Blend", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0.", ",", " ", 
                   RowBox[{"RGBColor", "[", 
                    RowBox[{
                    "0.917794", ",", " ", "0.920966", ",", " ", "0.881936", 
                    ",", " ", "0."}], "]"}]}], "}"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"0.0500579", ",", " ", 
                   RowBox[{"RGBColor", "[", 
                    RowBox[{
                    "0.876709", ",", " ", "0.880126", ",", " ", "0.845903", 
                    ",", " ", "0."}], "]"}]}], "}"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"0.105035", ",", " ", 
                   RowBox[{"RGBColor", "[", 
                    RowBox[{
                    "0.831587", ",", " ", "0.835272", ",", " ", "0.806328", 
                    ",", " ", "0.140508"}], "]"}]}], "}"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"0.327836", ",", " ", 
                   RowBox[{"RGBColor", "[", 
                    RowBox[{
                    "0.601702", ",", " ", "0.619402", ",", " ", "0.616518", 
                    ",", " ", "0.63673"}], "]"}]}], "}"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"1.", ",", " ", 
                   RowBox[{"RGBColor", "[", 
                    RowBox[{
                    "0.1", ",", " ", "0.1", ",", " ", "0.1", ",", " ", 
                    "0.86873"}], "]"}]}], "}"}]}], "}"}], ",", " ", "#1"}], 
              "]"}], " ", "&"}], " ", ")"}]}]}], "]"}], ",", 
        RowBox[{"ViewPoint", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "Infinity"}], "}"}]}], ",", 
        RowBox[{"Boxed", "\[Rule]", "False"}]}], "]"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
      RowBox[{"ImageResolution", "\[Rule]", "300"}]}], "]"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.670077927577117*^9, 3.670077930051448*^9}, {
   3.670078037481964*^9, 3.6700780682833652`*^9}, 3.6700782067038*^9, {
   3.6700782392845697`*^9, 3.6700782775529346`*^9}, {3.670078416255992*^9, 
   3.670078478475244*^9}, {3.670080450014278*^9, 
   3.6700804542446823`*^9}},ExpressionUUID->"a63ce417-35ea-46d7-be36-\
feabb48cc2d0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["part II", "Subsubsection",
 CellChangeTimes->{{3.670077911932323*^9, 
  3.6700779181000357`*^9}},ExpressionUUID->"74f25efc-d7ab-4263-8a42-\
41f28f985369"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"img", " ", "=", 
   RowBox[{"ImageAdjust", "[", 
    RowBox[{
     RowBox[{"Image3D", "[", 
      RowBox[{
       RowBox[{"Import", "[", 
        RowBox[{"rawCaImageFiles", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{"startPoint", "-", "10"}], ",", "207"}], "]"}], "+", 
           "1"}], "]"}], "]"}], "]"}], ",", 
       RowBox[{"ColorFunction", "\[Rule]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Blend", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0.", ",", " ", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{
                 "0.05635", ",", " ", "0.081", ",", " ", "0.07687", ",", " ", 
                  "0."}], "]"}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0.284433", ",", " ", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{
                 "0.496561", ",", " ", "0.177689", ",", " ", "0.0361663", ",",
                   " ", "0."}], "]"}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0.394387", ",", " ", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{
                 "1.", ",", " ", "0.6036", ",", " ", "0.", ",", " ", 
                  "0.0116194"}], "]"}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0.649016", ",", " ", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{
                 "1.", ",", " ", "0.9658", ",", " ", "0.4926", ",", " ", 
                  "0.01"}], "]"}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"1.", ",", " ", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{
                 "1.", ",", " ", "0.6436", ",", " ", "0.03622", ",", " ", 
                  "0.01"}], "]"}]}], "}"}]}], "}"}], ",", " ", "#1"}], "]"}], 
          " ", "&"}], " ", ")"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0.006"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"img", "=", 
   RowBox[{"ImageResize", "[", 
    RowBox[{"img", ",", 
     RowBox[{"Round", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.41", ",", "0.41", ",", "1"}], "}"}], "*", 
       RowBox[{"ImageDimensions", "[", "img", "]"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.670082914696488*^9, 3.6700829624081697`*^9}, {
  3.6700829987259407`*^9, 
  3.67008302506879*^9}},ExpressionUUID->"cd9f01b5-61e9-425a-8565-\
a4bbe4d8e1de"],

Cell[BoxData[
 RowBox[{"canvasCoords", "=", 
  RowBox[{"Sort", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Last", "/@", 
      RowBox[{"ComponentMeasurements", "[", 
       RowBox[{
        RowBox[{"MorphologicalComponents", "[", 
         RowBox[{"Binarize", "[", 
          RowBox[{
           RowBox[{"ColorNegate", "@", 
            RowBox[{"Image", "[", 
             RowBox[{"Rasterize", "[", 
              RowBox[{
               RowBox[{"Show", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"img", ",", 
                   RowBox[{"Graphics3D", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Black", ",", 
                    RowBox[{"Specularity", "[", "0.", "]"}], ",", 
                    RowBox[{"Sphere", "[", 
                    RowBox[{"#", ",", "0.5"}], "]"}]}], "}"}], "&"}], "/@", 
                    "pts2"}], "]"}]}], "}"}], ",", 
                 RowBox[{"Lighting", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], 
                   "}"}]}], ",", 
                 RowBox[{"ViewPoint", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "Infinity"}], "}"}]}], ",", 
                 RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                 RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
                 RowBox[{"PlotRangePadding", "->", "None"}], ",", 
                 RowBox[{"ImagePadding", "->", "None"}]}], "]"}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
               RowBox[{"ImageResolution", "\[Rule]", "300"}]}], "]"}], 
             "]"}]}], ",", "0.82"}], "]"}], "]"}], ",", 
        RowBox[{"{", "\"\<Centroid\>\"", "}"}]}], "]"}]}], ",", "1"}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6700829004741898`*^9, 3.670082901136447*^9}, {
  3.670082974014327*^9, 3.670082981912943*^9}, {3.670083034622427*^9, 
  3.67008318804735*^9}, {3.67008321992031*^9, 
  3.6700832251422663`*^9}},ExpressionUUID->"5dddb5bf-4bd5-466c-bbd9-\
2480ec9adede"],

Cell[BoxData[
 RowBox[{"floatingCoords", "=", 
  RowBox[{"Sort", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Most", "[", "#", "]"}], "&"}], "/@", "pts2"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.670083192441585*^9, 
  3.670083232823052*^9}},ExpressionUUID->"d8d06684-831d-40e9-b5d7-\
4a5d7226fd49"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"error", ",", "tfun"}], "}"}], "=", 
  RowBox[{"FindGeometricTransform", "[", 
   RowBox[{"canvasCoords", ",", 
    RowBox[{"Take", "[", 
     RowBox[{"floatingCoords", ",", 
      RowBox[{"Length", "[", "canvasCoords", "]"}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.670083236701099*^9, 3.670083279908334*^9}, {
  3.6700835359416924`*^9, 3.670083541914006*^9}, {3.6700836208096647`*^9, 
  3.67008362850517*^9}},ExpressionUUID->"94621707-08a9-4612-9407-\
46236fa4fe17"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showRawWave", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showRawWave", "[", "\[IndentingNewLine]", 
   RowBox[{"t_", ",", "\[IndentingNewLine]", 
    RowBox[{"centroids_:", "pts2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"transferFunction_:", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Blend", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "0.05635", ",", " ", "0.081", ",", " ", "0.07687", ",", " ", 
               "0."}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0.284433", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "0.496561", ",", " ", "0.177689", ",", " ", "0.0361663", ",", 
               " ", "0."}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0.394387", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "1.", ",", " ", "0.6036", ",", " ", "0.", ",", " ", 
               "0.0116194"}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0.649016", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "1.", ",", " ", "0.9658", ",", " ", "0.4926", ",", " ", 
               "0.681842"}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"1.", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "1.", ",", " ", "0.6436", ",", " ", "0.03622", ",", " ", "1."}],
               "]"}]}], "}"}]}], "}"}], ",", " ", "#1"}], "]"}], " ", "&"}], 
      " ", ")"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"imgFileList_:", "rawCaImageFiles"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{"t0_:", "startPoint"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "img", ",", "inverseTransform", ",", "transformedImg", ",", " ", 
      "newDimensions", ",", " ", "xmin", ",", "ymin", ",", "zmin", ",", "n", 
      ",", "finalProjection"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "imgFileList", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"img", " ", "=", 
      RowBox[{"ImageAdjust", "[", 
       RowBox[{
        RowBox[{"Image3D", "[", 
         RowBox[{
          RowBox[{"Import", "[", 
           RowBox[{"imgFileList", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"t0", "+", "t"}], ",", "n"}], "]"}], "+", "1"}], 
             "]"}], "]"}], "]"}], ",", 
          RowBox[{"ColorFunction", "\[Rule]", " ", "transferFunction"}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0.006"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"img", "=", 
      RowBox[{"ImageResize", "[", 
       RowBox[{"img", ",", 
        RowBox[{"Round", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.41", ",", "0.41", ",", "1"}], "}"}], "*", 
          RowBox[{"ImageDimensions", "[", "img", "]"}]}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"img", ",", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Gray", ",", 
                  RowBox[{"Specularity", "[", "0.", "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{"#", ",", "1."}], "]"}]}], "}"}], "&"}], "/@", 
               "centroids"}], "]"}]}], "}"}], ",", 
           RowBox[{"Lighting", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"ViewPoint", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "Infinity"}], "}"}]}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRangePadding", "->", "None"}], ",", 
           RowBox[{"ImagePadding", "->", "None"}]}], "]"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "600"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"finalProjection", ",", 
         RowBox[{"Graphics", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Graphics", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"ColorData", "[", 
                  RowBox[{"97", ",", "1"}], "]"}], ",", 
                 RowBox[{"Annulus", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0.8", ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"2", "Pi", " ", 
                    RowBox[{"t", "/", "207"}]}]}], "}"}]}], "]"}], ",", 
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"PaddedForm", "[", 
                    RowBox[{
                    RowBox[{"2.5", 
                    RowBox[{"(", 
                    RowBox[{"t", "-", "1"}], ")"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "1"}], "}"}], ",", 
                    RowBox[{"NumberPadding", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\>\"", ",", "\"\<0\>\""}], "}"}]}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "0.1"}]}], "}"}]}], "]"}], ",", "12", ",", 
                   RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
                  "]"}]}], "}"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}]}], "}"}]}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "80"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"120", ",", "120"}], "}"}]}], "]"}], "}"}], "]"}]}], 
        "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "20"}], ",", "853"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "500"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.6701168347735558`*^9, 3.670116863666915*^9}, {
  3.670116897354669*^9, 
  3.670116899537343*^9}},ExpressionUUID->"ab7d2486-0969-4ecf-8380-\
24bbc4c66b28"],

Cell[BoxData[
 RowBox[{"test", "=", 
  RowBox[{"showRawWave", "[", 
   RowBox[{"100", ",", "pts2", ",", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Blend", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.", ",", " ", 
            RowBox[{"RGBColor", "[", 
             RowBox[{
             "0.05635", ",", " ", "0.081", ",", " ", "0.07687", ",", " ", 
              "0."}], "]"}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0.278646", ",", " ", 
            RowBox[{"RGBColor", "[", 
             RowBox[{
             "0.496561", ",", " ", "0.177689", ",", " ", "0.0361663", ",", 
              " ", "0."}], "]"}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0.33941", ",", " ", 
            RowBox[{"RGBColor", "[", 
             RowBox[{
             "1.", ",", " ", "0.6036", ",", " ", "0.", ",", " ", 
              "0.0245082"}], "]"}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0.539062", ",", " ", 
            RowBox[{"RGBColor", "[", 
             RowBox[{
             "1.", ",", " ", "0.9658", ",", " ", "0.4926", ",", " ", 
              "0.314508"}], "]"}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"1.", ",", " ", 
            RowBox[{"RGBColor", "[", 
             RowBox[{
             "1.", ",", " ", "0.6436", ",", " ", "0.03622", ",", " ", "1."}], 
             "]"}]}], "}"}]}], "}"}], ",", " ", "#1"}], "]"}], " ", "&"}], 
     " ", ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.670116851818881*^9, 3.6701168590809917`*^9}, {
  3.6701169104009333`*^9, 
  3.6701169114872017`*^9}},ExpressionUUID->"f65fc970-530e-44bd-b70a-\
cdce5a2114a6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-2/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"t", ",", "10", ",", "3"}], "]"}], "<>", "\"\<.png\>\""}], 
      ",", 
      RowBox[{"showRawWave", "[", 
       RowBox[{"t", ",", "pts2", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Blend", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0.", ",", " ", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{
                 "0.05635", ",", " ", "0.081", ",", " ", "0.07687", ",", " ", 
                  "0."}], "]"}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0.278646", ",", " ", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{
                 "0.496561", ",", " ", "0.177689", ",", " ", "0.0361663", ",",
                   " ", "0."}], "]"}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0.33941", ",", " ", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{
                 "1.", ",", " ", "0.6036", ",", " ", "0.", ",", " ", 
                  "0.0245082"}], "]"}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0.539062", ",", " ", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{
                 "1.", ",", " ", "0.9658", ",", " ", "0.4926", ",", " ", 
                  "0.314508"}], "]"}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"1.", ",", " ", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{
                 "1.", ",", " ", "0.6436", ",", " ", "0.03622", ",", " ", 
                  "1."}], "]"}]}], "}"}]}], "}"}], ",", " ", "#1"}], "]"}], 
          " ", "&"}], " ", ")"}]}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "207", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670117037197627*^9, 3.6701170443152943`*^9}, 
   3.670229502905579*^9},ExpressionUUID->"7e5d518f-e400-45ba-a27b-\
100e7e721927"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-2/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{
         RowBox[{"t", "+", "207"}], ",", "10", ",", "3"}], "]"}], "<>", 
       "\"\<.png\>\""}], ",", 
      RowBox[{"Import", "[", 
       RowBox[{
       "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-2/\>\"", "<>", 
        RowBox[{"IntegerString", "[", 
         RowBox[{"t", ",", "10", ",", "3"}], "]"}], "<>", "\"\<.png\>\""}], 
       "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "207", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6701299793656597`*^9, 3.670130082249773*^9}, {
  3.670229503545743*^9, 
  3.67022950405376*^9}},ExpressionUUID->"897aad39-aa53-4ccf-97b1-\
8c31b54092c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-2/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{
         RowBox[{"t", "+", "414"}], ",", "10", ",", "3"}], "]"}], "<>", 
       "\"\<.png\>\""}], ",", 
      RowBox[{"Import", "[", 
       RowBox[{
       "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-2/\>\"", "<>", 
        RowBox[{"IntegerString", "[", 
         RowBox[{"t", ",", "10", ",", "3"}], "]"}], "<>", "\"\<.png\>\""}], 
       "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "414", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6701301343510513`*^9, 3.670130137350281*^9}, 
   3.670229474212179*^9, 
   3.670229505149098*^9},ExpressionUUID->"e75e27bd-89d0-4a9c-8f3e-\
e11095e487f1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["part III", "Subsubsection",
 CellChangeTimes->{{3.670116965629211*^9, 
  3.670116966997136*^9}},ExpressionUUID->"ac1085ad-e89a-43c3-98e1-\
2ec20e7b8df9"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showAnnotatedWave", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showAnnotatedWave", "[", "\[IndentingNewLine]", 
   RowBox[{
   "t_", ",", "\[IndentingNewLine]", "referenceCells_List", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"centroids_:", "pts2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"transferFunction_:", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Blend", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "0.05635", ",", " ", "0.081", ",", " ", "0.07687", ",", " ", 
               "0."}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0.284433", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "0.496561", ",", " ", "0.177689", ",", " ", "0.0361663", ",", 
               " ", "0."}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0.394387", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "1.", ",", " ", "0.6036", ",", " ", "0.", ",", " ", 
               "0.0116194"}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0.649016", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "1.", ",", " ", "0.9658", ",", " ", "0.4926", ",", " ", 
               "0.681842"}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"1.", ",", " ", 
             RowBox[{"RGBColor", "[", 
              RowBox[{
              "1.", ",", " ", "0.6436", ",", " ", "0.03622", ",", " ", "1."}],
               "]"}]}], "}"}]}], "}"}], ",", " ", "#1"}], "]"}], " ", "&"}], 
      " ", ")"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"imgFileList_:", "rawCaImageFiles"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{"t0_:", "startPoint"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "img", ",", "inverseTransform", ",", "transformedImg", ",", " ", 
      "newDimensions", ",", " ", "xmin", ",", "ymin", ",", "zmin", ",", "n", 
      ",", "finalProjection"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "imgFileList", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"img", " ", "=", 
      RowBox[{"ImageAdjust", "[", 
       RowBox[{
        RowBox[{"Image3D", "[", 
         RowBox[{
          RowBox[{"Import", "[", 
           RowBox[{"imgFileList", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"t0", "+", "t"}], ",", "n"}], "]"}], "+", "1"}], 
             "]"}], "]"}], "]"}], ",", 
          RowBox[{"ColorFunction", "\[Rule]", " ", "transferFunction"}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0.006"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"img", "=", 
      RowBox[{"ImageResize", "[", 
       RowBox[{"img", ",", 
        RowBox[{"Round", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.41", ",", "0.41", ",", "1"}], "}"}], "*", 
          RowBox[{"ImageDimensions", "[", "img", "]"}]}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"img", ",", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Gray", ",", 
                  RowBox[{"Specularity", "[", "0.", "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{"#", ",", "1."}], "]"}]}], "}"}], "&"}], "/@", 
               "centroids"}], "]"}]}], "}"}], ",", 
           RowBox[{"Lighting", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"ViewPoint", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "Infinity"}], "}"}]}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRangePadding", "->", "None"}], ",", 
           RowBox[{"ImagePadding", "->", "None"}]}], "]"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "600"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"finalProjection", ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
              RowBox[{"Darker", "@", "Gray"}], ",", 
              RowBox[{"Circle", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Most", "@", 
                    RowBox[{"centroids", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], ")"}], "*", "2.728"}], 
                 "+", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ",", "16"}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Darker", "@", "Gray"}], ",", 
              RowBox[{"AbsoluteThickness", "[", "1", "]"}], ",", 
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"Most", "@", 
                    RowBox[{"centroids", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], ")"}], "*", "2.728"}], 
                  "+", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"600", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"centroids", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "*", "2.728"}], "+", 
                    "1"}]}], "}"}]}], "}"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Inset", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"ListLinePlot", "[", 
                 RowBox[{
                  RowBox[{"Drop", "[", 
                   RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"series", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", 
                    RowBox[{"series", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", 
                    RowBox[{"series", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"t", "+", "207", "+", "103"}]}], "]"}], ",", 
                    RowBox[{"103", "+", "t"}]}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Epilog", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"AbsolutePointSize", "[", "7", "]"}], ",", 
                    RowBox[{"Darker", "@", 
                    RowBox[{"ColorData", "[", 
                    RowBox[{"97", ",", "1"}], "]"}]}], ",", 
                    RowBox[{"Point", "[", 
                    RowBox[{"{", 
                    RowBox[{"103", ",", 
                    RowBox[{
                    RowBox[{"series", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "[", 
                    RowBox[{"[", "t", "]"}], "]"}]}], "}"}], "]"}]}], "}"}]}],
                   ",", "\[IndentingNewLine]", 
                  RowBox[{"PlotRange", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"series", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Min", "[", 
                    RowBox[{"series", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Max", "[", 
                    RowBox[{"series", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "]"}]}], "}"}]}], "}"}]}],
                   ",", 
                  RowBox[{"Ticks", "\[Rule]", "None"}], ",", 
                  RowBox[{"AxesOrigin", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"103", ",", "Automatic"}], "}"}]}], ",", 
                  RowBox[{"AxesLabel", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<t\>\"", ",", 
                    "\"\<\!\(\*SuperscriptBox[\(Ca\), \
\(\(2\)\(+\)\)]\)\>\""}], "}"}]}], ",", 
                  RowBox[{"AxesStyle", "\[Rule]", 
                   RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"AbsoluteThickness", "[", "1", "]"}], ",", 
                    RowBox[{"Darker", "@", "Gray"}]}], "]"}]}], ",", 
                  RowBox[{"LabelStyle", "\[Rule]", 
                   RowBox[{"Directive", "[", 
                    RowBox[{"12", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
                    "]"}]}], ",", 
                  RowBox[{"ImageSize", "\[Rule]", "180"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"700", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"centroids", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/", "dx"}], "+", 
                   "30"}]}], "}"}]}], "]"}]}], "}"}], "&"}], "/@", 
           "referenceCells"}], "]"}], ",", 
         RowBox[{"Graphics", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Graphics", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"ColorData", "[", 
                  RowBox[{"97", ",", "1"}], "]"}], ",", 
                 RowBox[{"Annulus", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0.8", ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"2", "Pi", " ", 
                    RowBox[{"t", "/", "207"}]}]}], "}"}]}], "]"}], ",", 
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"PaddedForm", "[", 
                    RowBox[{
                    RowBox[{"2.5", 
                    RowBox[{"(", 
                    RowBox[{"t", "-", "1"}], ")"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "1"}], "}"}], ",", 
                    RowBox[{"NumberPadding", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\>\"", ",", "\"\<0\>\""}], "}"}]}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "0.1"}]}], "}"}]}], "]"}], ",", "12", ",", 
                   RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
                  "]"}]}], "}"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}]}], "}"}]}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "80"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"120", ",", "120"}], "}"}]}], "]"}], "}"}], "]"}]}], 
        "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "20"}], ",", "853"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "500"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.670057903071376*^9, 3.670057911071385*^9}, {
   3.670057963374995*^9, 3.6700579712773867`*^9}, {3.6700582536768827`*^9, 
   3.67005825702*^9}, {3.670058336883436*^9, 3.6700583449705772`*^9}, {
   3.670058380296713*^9, 3.670058409160487*^9}, {3.670058454135605*^9, 
   3.670058454494956*^9}, {3.670058500454132*^9, 3.670058534356063*^9}, {
   3.6700585773818398`*^9, 3.67005857875786*^9}, {3.670058622027166*^9, 
   3.670058642908824*^9}, {3.670058713208865*^9, 3.6700587377433357`*^9}, {
   3.670058814998385*^9, 3.670058906465366*^9}, {3.670058958359602*^9, 
   3.6700589928706512`*^9}, {3.6700590317987432`*^9, 3.670059032566143*^9}, {
   3.670059074158242*^9, 3.6700591058517637`*^9}, {3.670059152549259*^9, 
   3.670059152648828*^9}, {3.670059245745757*^9, 3.670059275806356*^9}, {
   3.6700593451468782`*^9, 3.670059371181117*^9}, {3.670059414979084*^9, 
   3.670059444067402*^9}, {3.670059516869369*^9, 3.6700595260288963`*^9}, {
   3.670059564624566*^9, 3.670059663330315*^9}, {3.670067637111182*^9, 
   3.6700676372360067`*^9}, {3.670075812796523*^9, 3.670075813250984*^9}, {
   3.670075853980027*^9, 3.6700758542003603`*^9}, {3.670076429649761*^9, 
   3.670076434398636*^9}, {3.670076610235682*^9, 3.670076610712755*^9}, {
   3.670079827347691*^9, 3.670079832473482*^9}, {3.670079896057816*^9, 
   3.670079912071719*^9}, {3.670079945994007*^9, 3.670079984415719*^9}, {
   3.6700800668626204`*^9, 3.670080149585837*^9}, {3.670080205795228*^9, 
   3.670080278573999*^9}, {3.670080316317648*^9, 3.670080344308157*^9}, {
   3.670080379633957*^9, 3.670080381986149*^9}, {3.670082082952228*^9, 
   3.67008211945892*^9}, {3.670082298699785*^9, 3.670082302327158*^9}, {
   3.670082334269651*^9, 3.670082411513792*^9}, {3.670082573751011*^9, 
   3.670082789264279*^9}, {3.670084228084301*^9, 3.6700844394593477`*^9}, {
   3.670084493331437*^9, 3.670084528552898*^9}, {3.670084688708909*^9, 
   3.670084799319314*^9}, {3.670084843512848*^9, 3.670085044623982*^9}, {
   3.67008510473496*^9, 3.670085159997501*^9}, {3.670085204324115*^9, 
   3.670085209283094*^9}, {3.670085270707155*^9, 3.670085317720256*^9}, {
   3.6700853522968903`*^9, 3.670085439171743*^9}, {3.670085722915914*^9, 
   3.67008576064083*^9}, {3.6700858007379103`*^9, 3.670085800856196*^9}, {
   3.670085859321311*^9, 3.670085872926487*^9}, {3.670085933526428*^9, 
   3.670085933764886*^9}, {3.670086057139759*^9, 3.670086246499321*^9}, {
   3.670086319234215*^9, 3.670086319800359*^9}, {3.6700869214052896`*^9, 
   3.670086922157887*^9}, {3.670086970540852*^9, 3.670087122241911*^9}, {
   3.670087164144413*^9, 3.670087196359371*^9}, {3.6700879510547953`*^9, 
   3.670087986987369*^9}, {3.670088915771068*^9, 3.670088948141985*^9}, {
   3.670089036772299*^9, 3.670089036883877*^9}, 3.670089080738925*^9, {
   3.670089299235347*^9, 
   3.670089300987401*^9}},ExpressionUUID->"085ba8fa-2690-4474-93ba-\
9a2c22477c38"],

Cell[BoxData[
 RowBox[{"test", "=", 
  RowBox[{"showAnnotatedWave", "[", 
   RowBox[{"1", ",", 
    RowBox[{"{", 
     RowBox[{"225", ",", "20"}], "}"}], ",", "pts2", ",", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Blend", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.", ",", " ", 
            RowBox[{"RGBColor", "[", 
             RowBox[{
             "0.05635", ",", " ", "0.081", ",", " ", "0.07687", ",", " ", 
              "0."}], "]"}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0.278646", ",", " ", 
            RowBox[{"RGBColor", "[", 
             RowBox[{
             "0.496561", ",", " ", "0.177689", ",", " ", "0.0361663", ",", 
              " ", "0."}], "]"}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0.33941", ",", " ", 
            RowBox[{"RGBColor", "[", 
             RowBox[{
             "1.", ",", " ", "0.6036", ",", " ", "0.", ",", " ", 
              "0.0245082"}], "]"}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0.539062", ",", " ", 
            RowBox[{"RGBColor", "[", 
             RowBox[{
             "1.", ",", " ", "0.9658", ",", " ", "0.4926", ",", " ", 
              "0.314508"}], "]"}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"1.", ",", " ", 
            RowBox[{"RGBColor", "[", 
             RowBox[{
             "1.", ",", " ", "0.6436", ",", " ", "0.03622", ",", " ", "1."}], 
             "]"}]}], "}"}]}], "}"}], ",", " ", "#1"}], "]"}], " ", "&"}], 
     " ", ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.670058606321575*^9, 3.670058606583727*^9}, {
   3.6700590047097282`*^9, 3.670059005091017*^9}, {3.670059186889099*^9, 
   3.6700591890615263`*^9}, {3.6700594520697412`*^9, 
   3.6700594527572327`*^9}, {3.670084546702035*^9, 3.67008463503399*^9}, {
   3.670085002654913*^9, 3.6700850034547997`*^9}, {3.670085472906477*^9, 
   3.670085555297866*^9}, {3.670085587901754*^9, 3.67008568432942*^9}, {
   3.670086936212569*^9, 3.670086952169417*^9}, 3.6700892668197737`*^9, {
   3.670089309858926*^9, 
   3.670089313151868*^9}},ExpressionUUID->"6d9ddc3c-d3aa-44e7-b640-\
528cdedf183c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-3/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"t", ",", "10", ",", "3"}], "]"}], "<>", "\"\<.png\>\""}], 
      ",", 
      RowBox[{"showAnnotatedWave", "[", 
       RowBox[{"t", ",", 
        RowBox[{"{", 
         RowBox[{"225", ",", "20"}], "}"}], ",", "pts2", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Blend", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0.", ",", " ", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{
                 "0.05635", ",", " ", "0.081", ",", " ", "0.07687", ",", " ", 
                  "0."}], "]"}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0.278646", ",", " ", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{
                 "0.496561", ",", " ", "0.177689", ",", " ", "0.0361663", ",",
                   " ", "0."}], "]"}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0.33941", ",", " ", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{
                 "1.", ",", " ", "0.6036", ",", " ", "0.", ",", " ", 
                  "0.0245082"}], "]"}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0.539062", ",", " ", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{
                 "1.", ",", " ", "0.9658", ",", " ", "0.4926", ",", " ", 
                  "0.314508"}], "]"}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"1.", ",", " ", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{
                 "1.", ",", " ", "0.6436", ",", " ", "0.03622", ",", " ", 
                  "1."}], "]"}]}], "}"}]}], "}"}], ",", " ", "#1"}], "]"}], 
          " ", "&"}], " ", ")"}]}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "207", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670050041515707*^9, 3.670050069595236*^9}, {
   3.670050199167712*^9, 3.67005025143883*^9}, {3.6700763378841877`*^9, 
   3.670076367549861*^9}, 3.670077854498332*^9, {3.670085998545019*^9, 
   3.6700859999359093`*^9}, {3.670089122367725*^9, 3.6700891247494297`*^9}, {
   3.670116953040066*^9, 3.670116953206319*^9}, 
   3.670229476601289*^9},ExpressionUUID->"604c4624-52f9-421a-8567-\
a993439a3d99"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-3/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{
         RowBox[{"t", "+", "207"}], ",", "10", ",", "3"}], "]"}], "<>", 
       "\"\<.png\>\""}], ",", 
      RowBox[{"Import", "[", 
       RowBox[{
       "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-3/\>\"", "<>", 
        RowBox[{"IntegerString", "[", 
         RowBox[{"t", ",", "10", ",", "3"}], "]"}], "<>", "\"\<.png\>\""}], 
       "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "207", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670132316226865*^9, 3.6701323176734343`*^9}, {
  3.670229477856039*^9, 
  3.6702294787492523`*^9}},ExpressionUUID->"1218ce1d-5bda-4021-8873-\
4a74c8b504a3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-3/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{
         RowBox[{"t", "+", "414"}], ",", "10", ",", "3"}], "]"}], "<>", 
       "\"\<.png\>\""}], ",", 
      RowBox[{"Import", "[", 
       RowBox[{
       "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-2/\
part-3/\>\"", "<>", 
        RowBox[{"IntegerString", "[", 
         RowBox[{"t", ",", "10", ",", "3"}], "]"}], "<>", "\"\<.png\>\""}], 
       "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "414", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670132320250915*^9, 3.670132322001602*^9}, {
  3.670229479534808*^9, 
  3.670229480972004*^9}},ExpressionUUID->"c11b3f1d-a52e-433f-8f51-\
545bb5d2a95f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"myimg", " ", "=", 
   RowBox[{"ImageAdjust", "[", 
    RowBox[{"Image3D", "[", 
     RowBox[{"Import", "[", 
      RowBox[{"rawCaImageFiles", "[", 
       RowBox[{"[", "60", "]"}], "]"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myimg", "=", 
   RowBox[{"ImageResize", "[", 
    RowBox[{"myimg", ",", 
     RowBox[{"Round", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.41", ",", "0.41", ",", "1"}], "}"}], "*", 
       RowBox[{"ImageDimensions", "[", "myimg", "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"invT", "=", 
   RowBox[{"InverseFunction", "[", "stdTransform", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.658662245985496*^9, 3.65866224723695*^9}, {
  3.6586623040222692`*^9, 3.658662350299596*^9}, {3.658663373879035*^9, 
  3.6586633982443733`*^9}, {3.6610883855703497`*^9, 3.661088385807625*^9}, {
  3.669996869701923*^9, 3.669996873092071*^9}, {3.669997643621047*^9, 
  3.669997644108048*^9}, {3.669997674444769*^9, 3.669997695731678*^9}, {
  3.669997741194888*^9, 3.669997781024274*^9}, {3.6699978741934137`*^9, 
  3.669997882620698*^9}, {3.6699979160281153`*^9, 3.669997999848838*^9}, {
  3.6699980521914253`*^9, 
  3.669998075398568*^9}},ExpressionUUID->"16cf0516-3d51-4f93-a29b-\
021080011ca8"],

Cell[BoxData[
 RowBox[{"cfun2", "=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Blend", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.", ",", " ", 
          RowBox[{"RGBColor", "[", 
           RowBox[{
           "0.05635", ",", " ", "0.081", ",", " ", "0.07687", ",", " ", 
            "0."}], "]"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0.284433", ",", " ", 
          RowBox[{"RGBColor", "[", 
           RowBox[{
           "0.496561", ",", " ", "0.177689", ",", " ", "0.0361663", ",", " ", 
            "0."}], "]"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0.434896", ",", " ", 
          RowBox[{"RGBColor", "[", 
           RowBox[{"1.", ",", " ", "0.6036", ",", " ", "0.", ",", " ", "0."}],
            "]"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0.649016", ",", " ", 
          RowBox[{"RGBColor", "[", 
           RowBox[{
           "1.", ",", " ", "0.9658", ",", " ", "0.4926", ",", " ", 
            "0.681842"}], "]"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"1.", ",", " ", 
          RowBox[{"RGBColor", "[", 
           RowBox[{
           "1.", ",", " ", "0.6436", ",", " ", "0.03622", ",", " ", "1."}], 
           "]"}]}], "}"}]}], "}"}], ",", " ", "#1"}], "]"}], " ", "&"}], " ", 
   ")"}]}]], "Input",
 CellChangeTimes->{{3.66999804651812*^9, 
  3.669998048274829*^9}},ExpressionUUID->"b1e8278f-27ff-4cd3-aedf-\
580365da8b33"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"timg", "=", 
   RowBox[{"Image3D", "[", 
    RowBox[{
     RowBox[{"ImageTransformation", "[", 
      RowBox[{"myimg", ",", "invT", ",", " ", 
       RowBox[{"DataRange", "\[Rule]", "Full"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
     RowBox[{"ColorFunction", "->", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Blend", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0.", ",", " ", 
              RowBox[{"RGBColor", "[", 
               RowBox[{
               "0.05635", ",", " ", "0.081", ",", " ", "0.07687", ",", " ", 
                "0."}], "]"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"0.0529514", ",", " ", 
              RowBox[{"RGBColor", "[", 
               RowBox[{
               "0.496561", ",", " ", "0.177689", ",", " ", "0.0361663", ",", 
                " ", "0."}], "]"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"0.3", ",", " ", 
              RowBox[{"RGBColor", "[", 
               RowBox[{
               "1.", ",", " ", "0.6036", ",", " ", "0.", ",", " ", 
                "0.301431"}], "]"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"0.66", ",", " ", 
              RowBox[{"RGBColor", "[", 
               RowBox[{
               "1.", ",", " ", "0.9658", ",", " ", "0.4926", ",", " ", 
                "0.660695"}], "]"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"1.", ",", " ", 
              RowBox[{"RGBColor", "[", 
               RowBox[{
               "1.", ",", " ", "0.6436", ",", " ", "0.03622", ",", " ", 
                "1."}], "]"}]}], "}"}]}], "}"}], ",", " ", "#1"}], "]"}], " ",
         "&"}], " ", ")"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"newdims", "=", 
   RowBox[{
    RowBox[{"Round", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", "#", "]"}], "-", 
        RowBox[{"Min", "[", "#", "]"}]}], "&"}], "/@", 
      RowBox[{"Transpose", "[", 
       RowBox[{"transformToStandardView", "/@", "pts2"}], "]"}]}], "]"}], "+",
     "10"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"xmin", ",", "ymin", ",", "zmin"}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Min", "[", "#", "]"}], "&"}], "/@", 
    RowBox[{"Transpose", "[", 
     RowBox[{"transformToStandardView", "/@", "pts2"}], "]"}]}]}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{"timg", "=", 
   RowBox[{"ImageCrop", "[", 
    RowBox[{
     RowBox[{"Image3D", "[", 
      RowBox[{"timg", ",", 
       RowBox[{"ColorFunction", "\[Rule]", "cfun2"}]}], "]"}], ",", 
     "newdims"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.669997074343728*^9, 3.6699970749010363`*^9}, 
   3.6699974673294563`*^9, {3.6699975285800457`*^9, 
   3.669997551199277*^9}},ExpressionUUID->"26157c09-3776-4db8-ad12-\
e1c78f297b65"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Video S3", "Subsection",
 CellChangeTimes->{{3.670126964565254*^9, 3.6701269670452757`*^9}, {
  3.670241808625021*^9, 
  3.670241811998432*^9}},ExpressionUUID->"e31cb52a-5450-4ff5-a463-\
cca16d536dfc"],

Cell[CellGroupData[{

Cell["part 1", "Subsubsection",
 CellChangeTimes->{{3.655479721777885*^9, 3.655479723344633*^9}, {
  3.66943602834438*^9, 3.66943602898307*^9}, {3.670241817007113*^9, 
  3.6702418216064568`*^9}},ExpressionUUID->"8e7a63ae-e181-42af-9b6d-\
0eb8b98bd5fd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nnfun", " ", "=", " ", 
   RowBox[{"Nearest", "[", "pts2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myEdges", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"localTopology", "[", 
       RowBox[{"#", ",", "pts2", ",", "nnfun"}], "]"}], "&"}], "/@", "pts2"}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vertexIDs", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"Length", "[", "pts2", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"edgeDelays", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"onsetAP", "[", 
         RowBox[{"[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "-", 
        RowBox[{"onsetAP", "[", 
         RowBox[{"[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "]"}], "&"}], "/@",
      "myEdges"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"edgeOutlierThresh", "=", 
     RowBox[{
      RowBox[{"1.5", 
       RowBox[{"InterquartileRange", "[", "edgeDelays", "]"}]}], "+", 
      RowBox[{"Quantile", "[", 
       RowBox[{"edgeDelays", ",", "0.75"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"edgeOutliers", "=", 
     RowBox[{"Position", "[", 
      RowBox[{"edgeDelays", ",", 
       RowBox[{"x_", "/;", 
        RowBox[{"x", "\[GreaterEqual]", "edgeOutlierThresh"}]}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"myEdges", "=", 
     RowBox[{"Delete", "[", 
      RowBox[{"myEdges", ",", "edgeOutliers"}], "]"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myGraph", "=", 
   RowBox[{"Graph", "[", 
    RowBox[{"vertexIDs", ",", " ", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"Sort", "/@", "myEdges"}], "]"}], ",", " ", 
     RowBox[{"VertexCoordinates", "\[Rule]", 
      RowBox[{"MapIndexed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#2", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", "#1"}], "&"}], ",", 
        "pts2"}], "]"}]}], ",", 
     RowBox[{"EdgeStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{
        RowBox[{"AbsoluteThickness", "[", "1", "]"}], ",", "LightGray"}], 
       "]"}]}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.655478038313387*^9, 3.655478052570207*^9}, {
   3.658640810280506*^9, 3.658640810537683*^9}, 
   3.6586462072401876`*^9},ExpressionUUID->"d336e2a8-0e5c-4ffc-bbad-\
cffb5b3c16fe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"maxZ", ",", " ", "minZ"}], "}"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", "pts2"}], "]"}], ",", 
     RowBox[{"Min", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", "pts2"}], "]"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"edges", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"GrayLevel", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", "#", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"maxZ", "-", "minZ"}], ")"}]}], "]"}], ",", 
       RowBox[{"AbsoluteThickness", "[", "1", "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]}], "}"}], "&"}], "/@", 
    RowBox[{"(", 
     RowBox[{"myEdges", "/.", 
      RowBox[{"MapIndexed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#2", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", "#1"}], "&"}], ",", 
        "pts2"}], "]"}]}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.655482883642618*^9, 3.655483086125012*^9}, {
  3.655483123033209*^9, 3.655483142891944*^9}, {3.65548319577076*^9, 
  3.655483239928317*^9}},ExpressionUUID->"8dfef96c-2205-4940-8b1c-\
919b1e015fd9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cells", " ", "=", " ", "pts2"}], ";"}]], "Input",
 CellChangeTimes->{{3.655488142715345*^9, 
  3.655488145226264*^9}},ExpressionUUID->"2a809d9a-3b98-4053-ac56-\
24dd4188be14"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"spfun", "=", 
   RowBox[{"FindShortestPath", "[", 
    RowBox[{"myGraph", ",", "All", ",", "All"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gdistMat", " ", "=", " ", 
   RowBox[{"GraphDistanceMatrix", "[", "myGraph", "]"}]}], ";"}]}], "Input",Ex\
pressionUUID->"ef910e75-4dc4-472f-8b20-04aca25b8ba1"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showNodes", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showNodes", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"centroids_:", "pts2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "maxZ", ",", "minZ", ",", "stdCentroids", ",", "n", ",", 
      "finalProjection", ",", "transferFunction"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "\"\<1234\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"stdCentroids", " ", "=", " ", 
      RowBox[{"dataTransform", "/@", "centroids"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"maxZ", ",", " ", "minZ"}], "}"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"Graphics3D", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Gray", ",", 
                 RowBox[{"Specularity", "[", "0.", "]"}], ",", 
                 RowBox[{"GrayLevel", "[", 
                  RowBox[{"0.5", "+", 
                   RowBox[{"0.2", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"maxZ", "-", "minZ"}], ")"}]}], ")"}]}], 
                    ")"}]}]}], "]"}], ",", 
                 RowBox[{"Sphere", "[", 
                  RowBox[{"#", ",", "2"}], "]"}]}], "}"}], "&"}], "/@", 
              RowBox[{"(", "stdCentroids", ")"}]}], "]"}], "}"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"Lighting", "->", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"ViewPoint", "\[Rule]", "Top"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "None"}]}], "]"}], ",", 
         RowBox[{"RasterSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", "finalProjection", "}"}], ",", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "200"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "50"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.67022634267782*^9, 3.670226474047686*^9}, {
  3.6702265048019333`*^9, 3.670226541181279*^9}, {3.670226615121361*^9, 
  3.670226702632674*^9}, {3.670226792139421*^9, 3.670227037149662*^9}, {
  3.670227084163362*^9, 3.670227344531225*^9}, {3.670227383838891*^9, 
  3.670227393626245*^9}, {3.670227437686014*^9, 3.670227450136833*^9}, {
  3.67022751014697*^9, 3.670227558792839*^9}, {3.670227697093686*^9, 
  3.670227697538872*^9}, {3.670227734244042*^9, 3.67022788134704*^9}, {
  3.670227925700842*^9, 3.670228035814036*^9}, {3.670228261972925*^9, 
  3.670228329724214*^9}, {3.670228735315816*^9, 
  3.6702287354394712`*^9}},ExpressionUUID->"a16a0890-59ef-4591-8b6b-\
0951c46d58cc"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showNodes", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showNodes", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"centroids_:", "pts2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "maxZ", ",", "minZ", ",", "stdCentroids", ",", "n", ",", 
      "finalProjection", ",", "transferFunction"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "\"\<1234\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"stdCentroids", " ", "=", " ", 
      RowBox[{"dataTransform", "/@", "centroids"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"maxZ", ",", " ", "minZ"}], "}"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"Graphics3D", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"GrayLevel", "[", 
                  RowBox[{"0.5", "+", 
                   RowBox[{"0.2", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"maxZ", "-", "minZ"}], ")"}]}], ")"}]}], 
                    ")"}]}]}], "]"}], ",", 
                 RowBox[{"Sphere", "[", 
                  RowBox[{"#", ",", "1"}], "]"}]}], "}"}], "&"}], "/@", 
              RowBox[{"(", "stdCentroids", ")"}]}], "]"}], 
            "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", 
           RowBox[{"Lighting", "->", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"ViewPoint", "\[Rule]", "Top"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "85"}], ",", "134"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "38"}], ",", "118"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"101", ",", "228"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "None"}]}], "]"}], ",", 
         RowBox[{"RasterSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", "finalProjection", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "200"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "50"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.670577037602235*^9, 3.6705770820718327`*^9}, {
  3.670577172772563*^9, 
  3.670577173292027*^9}},ExpressionUUID->"df379c5d-ba9a-4c2b-bdb1-\
9e750d4f9020"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showNodesActivation", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showNodesActivation", "[", "\[IndentingNewLine]", 
   RowBox[{"t_", ",", "\[IndentingNewLine]", 
    RowBox[{"dt_:", "20"}], ",", "\[IndentingNewLine]", 
    RowBox[{"centroids_:", "pts2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "maxZ", ",", "minZ", ",", "stdCentroids", ",", "n", ",", 
      "finalProjection", ",", "transferFunction"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "\"\<1234\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"stdCentroids", " ", "=", " ", 
      RowBox[{"dataTransform", "/@", "centroids"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"maxZ", ",", " ", "minZ"}], "}"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Graphics3D", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"GrayLevel", "[", 
                   RowBox[{"0.5", "+", 
                    RowBox[{"0.2", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"maxZ", "-", "minZ"}], ")"}]}], ")"}]}], 
                    ")"}]}]}], "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{"#", ",", "1"}], "]"}]}], "}"}], "&"}], "/@", 
               RowBox[{"(", "stdCentroids", ")"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"ColorData", "[", 
                   RowBox[{"\"\<SolarColors\>\"", ",", "0.94"}], "]"}], ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"onsetAP", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "-", "t"}], "]"}], 
                    "\[LessEqual]", "dt"}], ",", 
                    RowBox[{"Opacity", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"Clip", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"res", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "[", 
                    RowBox[{"[", "t", "]"}], "]"}], "-", "0.1"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0.1"}], "}"}]}], "]"}], "/", "0.1"}]}],
                     "]"}], ",", 
                    RowBox[{"Opacity", "[", "0", "]"}]}], "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{
                    RowBox[{"stdCentroids", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", "3"}], "]"}]}], 
                 "}"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "stdCentroids", "]"}], "]"}], ")"}]}],
               "]"}]}], "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", 
           ",", 
           RowBox[{"Lighting", "->", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"ViewPoint", "\[Rule]", "Top"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "85"}], ",", "134"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "38"}], ",", "118"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"101", ",", "228"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "None"}]}], "]"}], ",", 
         RowBox[{"RasterSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"finalProjection", ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Graphics", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"ColorData", "[", 
                  RowBox[{"97", ",", "1"}], "]"}], ",", 
                 RowBox[{"Annulus", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0.8", ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"2", "Pi", " ", 
                    RowBox[{"t", "/", "207"}]}]}], "}"}]}], "]"}], ",", 
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"PaddedForm", "[", 
                    RowBox[{
                    RowBox[{"2.5", 
                    RowBox[{"(", 
                    RowBox[{"t", "-", "1"}], ")"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "1"}], "}"}], ",", 
                    RowBox[{"NumberPadding", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\>\"", ",", "\"\<0\>\""}], "}"}]}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "0.1"}]}], "}"}]}], "]"}], ",", "12", ",", 
                   RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
                  "]"}]}], "}"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}]}], "}"}]}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "80"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"120", ",", "120"}], "}"}]}], "]"}], "}"}], "]"}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "200"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "50"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.670228950569273*^9, 3.67022898640732*^9}, {
   3.670229056833683*^9, 3.670229094772396*^9}, {3.670229149136731*^9, 
   3.670229156497582*^9}, {3.670229187267654*^9, 3.67022918791304*^9}, {
   3.670229308770278*^9, 3.6702293109263906`*^9}, {3.67022934228942*^9, 
   3.670229362764471*^9}, {3.6702294011189833`*^9, 3.670229401162406*^9}, {
   3.670230165455474*^9, 3.670230316080367*^9}, {3.670230346157982*^9, 
   3.6702303619248257`*^9}, {3.670230399857809*^9, 3.670230423922172*^9}, {
   3.67023047052139*^9, 3.670230493406858*^9}, {3.670230542221409*^9, 
   3.670230579797349*^9}, {3.670230628515089*^9, 3.6702306319164457`*^9}, {
   3.6702306799897833`*^9, 3.6702306845619593`*^9}, 3.670230851301062*^9, {
   3.670230882073017*^9, 3.670230935537386*^9}, {3.670231403952125*^9, 
   3.670231469921949*^9}, {3.670231534178928*^9, 3.6702315496459227`*^9}, {
   3.6702318121695633`*^9, 3.670231814206272*^9}, {3.67023184742906*^9, 
   3.670231879609311*^9}, {3.670231918662765*^9, 3.670231924296708*^9}, 
   3.670232054366424*^9, 3.670232096314803*^9, 3.670232140585349*^9, {
   3.670307492857266*^9, 3.67030750892975*^9}, {3.67030753901551*^9, 
   3.67030754573792*^9}, {3.670307628463193*^9, 3.6703077139495068`*^9}, {
   3.6703077684097767`*^9, 3.670307814369773*^9}, {3.670308242737397*^9, 
   3.670308243099165*^9}},ExpressionUUID->"00b0ed39-bb71-426f-af66-\
7f95aed12883"],

Cell[BoxData[
 RowBox[{"showNodesActivation", "[", "40", "]"}]], "Input",
 CellChangeTimes->{{3.67022915894302*^9, 3.670229166640956*^9}, {
  3.670229197865447*^9, 3.670229216407112*^9}, {3.670229279487547*^9, 
  3.670229279837199*^9}, {3.6702293166218367`*^9, 3.670229329451868*^9}, {
  3.6702293722349453`*^9, 3.6702293822823153`*^9}, {3.670230587461276*^9, 
  3.670230591777742*^9}, {3.670230911970964*^9, 3.6702309647512283`*^9}, {
  3.6702315073981457`*^9, 3.670231569987254*^9}, {3.670231937657378*^9, 
  3.670231949310602*^9}, {3.6702321562006683`*^9, 
  3.670232161551962*^9}},ExpressionUUID->"49b47cdd-bad1-4c01-a300-\
ab215d08dfa2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-3/\
part-1/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"t", ",", "10", ",", "4"}], "]"}], "<>", "\"\<.png\>\""}], 
      ",", 
      RowBox[{"showNodesActivation", "[", "t", "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "207", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6702295980277367`*^9, 3.670229652304862*^9}, {
  3.67024154997503*^9, 3.6702415754301643`*^9}, {3.670258079584731*^9, 
  3.670258087845747*^9}},ExpressionUUID->"6a9c76b1-518c-4321-aae2-\
a2237d0ad4af"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-3/\
part-1/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{
         RowBox[{"t", "+", "207"}], ",", "10", ",", "4"}], "]"}], "<>", 
       "\"\<.png\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{"Import", "[", 
       RowBox[{
       "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-3/\
part-1/\>\"", "<>", 
        RowBox[{"IntegerString", "[", 
         RowBox[{"t", ",", "10", ",", "4"}], "]"}], "<>", "\"\<.png\>\""}], 
       "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "207", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6706869582976303`*^9, 
  3.6706869881035767`*^9}},ExpressionUUID->"d4fe94e7-bd00-4ea0-be23-\
ffbe10ee23cd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-3/\
part-1/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{
         RowBox[{"t", "+", "207", "+", "207"}], ",", "10", ",", "4"}], "]"}], 
       "<>", "\"\<.png\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{"Import", "[", 
       RowBox[{
       "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-3/\
part-1/\>\"", "<>", 
        RowBox[{"IntegerString", "[", 
         RowBox[{"t", ",", "10", ",", "4"}], "]"}], "<>", "\"\<.png\>\""}], 
       "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", 
      RowBox[{"207", "+", "207"}], ",", "1"}], "}"}]}], "]"}], ";"}]], "Input",\

 CellChangeTimes->{{3.67068707407672*^9, 
  3.6706870799079227`*^9}},ExpressionUUID->"4b60bf37-95e1-4ecd-9f37-\
fa9e5b553320"]
}, Open  ]],

Cell[CellGroupData[{

Cell["part 2", "Subsubsection",
 CellChangeTimes->{{3.670241828333707*^9, 
  3.670241830414549*^9}},ExpressionUUID->"19a76ecb-5163-4d9b-8ddb-\
d10e4108e4f6"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showNodesAndNEdges", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showNodesAndNEdges", "[", "\[IndentingNewLine]", 
   RowBox[{"n_", ",", "\[IndentingNewLine]", 
    RowBox[{"centroids_:", "pts2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}], ",", "\[IndentingNewLine]", 
    RowBox[{"edges_:", "myEdges"}]}], "\[IndentingNewLine]", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "maxZ", ",", "minZ", ",", "stdCentroids", ",", "finalProjection", ",", 
      "transferFunction"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "\"\<1234\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"stdCentroids", " ", "=", " ", 
      RowBox[{"dataTransform", "/@", "centroids"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"maxZ", ",", " ", "minZ"}], "}"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Graphics3D", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Gray", ",", 
                  RowBox[{"Specularity", "[", "0.", "]"}], ",", 
                  RowBox[{"GrayLevel", "[", 
                   RowBox[{"0.5", "+", 
                    RowBox[{"0.2", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"maxZ", "-", "minZ"}], ")"}]}], ")"}]}], 
                    ")"}]}]}], "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{"#", ",", "1"}], "]"}]}], "}"}], "&"}], "/@", 
               RowBox[{"(", "stdCentroids", ")"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"GrayLevel", "[", 
                   RowBox[{"0.5", "+", 
                    RowBox[{"0.2", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"stdCentroids", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"maxZ", "-", "minZ"}], ")"}]}], ")"}]}], 
                    ")"}]}]}], "]"}], ",", 
                  RowBox[{"Tube", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"stdCentroids", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"stdCentroids", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}], 
                    ",", "0.25"}], "]"}]}], "}"}], "&"}], "/@", 
               RowBox[{"Take", "[", 
                RowBox[{"edges", ",", "n"}], "]"}]}], "]"}]}], "}"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"Lighting", "->", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"ViewPoint", "\[Rule]", "Top"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "85"}], ",", "134"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "38"}], ",", "118"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"101", ",", "228"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "None"}]}], "]"}], ",", 
         RowBox[{"RasterSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", "finalProjection", "}"}], ",", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "200"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "50"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.670228077388611*^9, 3.670228132954935*^9}, {
   3.670228375745685*^9, 3.670228411915131*^9}, {3.670228445537074*^9, 
   3.670228483459071*^9}, {3.670228590697063*^9, 3.670228600085656*^9}, {
   3.6702286406310663`*^9, 3.670228652145726*^9}, {3.67022868351131*^9, 
   3.6702287234480247`*^9}, {3.670229367072443*^9, 3.670229369988366*^9}, 
   3.670307425722949*^9, {3.670307843246273*^9, 
   3.670307844311747*^9}},ExpressionUUID->"13592335-27cd-4b42-bccf-\
c9750eb87770"],

Cell[BoxData[
 RowBox[{"showNodesAndNEdges", "[", "1200", "]"}]], "Input",
 CellChangeTimes->{{3.670228473622711*^9, 3.670228477710795*^9}, {
  3.670228606386951*^9, 
  3.670228628945737*^9}},ExpressionUUID->"2d819712-5067-4843-9cb9-\
dd13219e71d6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-3/\
part-2/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{
         RowBox[{"t", "+", "207"}], ",", "10", ",", "4"}], "]"}], "<>", 
       "\"\<.png\>\""}], ",", 
      RowBox[{"showNodesAndNEdges", "[", 
       RowBox[{"t", "*", "10"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "134", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670241594678389*^9, 3.6702416081611977`*^9}, {
  3.670241645957604*^9, 3.670241647004771*^9}, {3.670241762474422*^9, 
  3.670241766968235*^9}, {3.670258105542266*^9, 
  3.6702581077546167`*^9}},ExpressionUUID->"628984ae-313c-44a5-b452-\
cbc1afb13d74"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showGraphActivation", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showGraphActivation", "[", "\[IndentingNewLine]", 
   RowBox[{"t_", ",", "\[IndentingNewLine]", 
    RowBox[{"dt_:", "20"}], ",", "\[IndentingNewLine]", 
    RowBox[{"centroids_:", "pts2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}], ",", "\[IndentingNewLine]", 
    RowBox[{"edges_:", "myEdges"}]}], "\[IndentingNewLine]", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "maxZ", ",", "minZ", ",", "stdCentroids", ",", "finalProjection", ",", 
      "transferFunction"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "\"\<1234\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"stdCentroids", " ", "=", " ", 
      RowBox[{"dataTransform", "/@", "centroids"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"maxZ", ",", " ", "minZ"}], "}"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Graphics3D", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"GrayLevel", "[", 
                   RowBox[{"0.5", "+", 
                    RowBox[{"0.2", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"maxZ", "-", "minZ"}], ")"}]}], ")"}]}], 
                    ")"}]}]}], "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{"#", ",", "1"}], "]"}]}], "}"}], "&"}], "/@", 
               RowBox[{"(", "stdCentroids", ")"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"ColorData", "[", 
                   RowBox[{"\"\<SolarColors\>\"", ",", "0.94"}], "]"}], ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"onsetAP", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "-", "t"}], "]"}], 
                    "\[LessEqual]", "dt"}], ",", 
                    RowBox[{"Opacity", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"Clip", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"res", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "[", 
                    RowBox[{"[", "t", "]"}], "]"}], "-", "0.1"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0.1"}], "}"}]}], "]"}], "/", "0.1"}]}],
                     "]"}], ",", 
                    RowBox[{"Opacity", "[", "0", "]"}]}], "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{
                    RowBox[{"stdCentroids", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", "3"}], "]"}]}], 
                 "}"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "stdCentroids", "]"}], "]"}], ")"}]}],
               "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"GrayLevel", "[", 
                   RowBox[{"0.5", "+", 
                    RowBox[{"0.2", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"stdCentroids", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"maxZ", "-", "minZ"}], ")"}]}], ")"}]}], 
                    ")"}]}]}], "]"}], ",", 
                  RowBox[{"Tube", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"stdCentroids", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"stdCentroids", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}], 
                    ",", "0.25"}], "]"}]}], "}"}], "&"}], "/@", "edges"}], 
              "]"}]}], "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", 
           ",", 
           RowBox[{"Lighting", "->", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"ViewPoint", "\[Rule]", "Top"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "85"}], ",", "134"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "38"}], ",", "118"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"101", ",", "228"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "None"}]}], "]"}], ",", 
         RowBox[{"RasterSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"finalProjection", ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Graphics", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"ColorData", "[", 
                  RowBox[{"97", ",", "1"}], "]"}], ",", 
                 RowBox[{"Annulus", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0.8", ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"2", "Pi", " ", 
                    RowBox[{"t", "/", "207"}]}]}], "}"}]}], "]"}], ",", 
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"PaddedForm", "[", 
                    RowBox[{
                    RowBox[{"2.5", 
                    RowBox[{"(", 
                    RowBox[{"t", "-", "1"}], ")"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "1"}], "}"}], ",", 
                    RowBox[{"NumberPadding", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\>\"", ",", "\"\<0\>\""}], "}"}]}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "0.1"}]}], "}"}]}], "]"}], ",", "12", ",", 
                   RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
                  "]"}]}], "}"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}]}], "}"}]}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "80"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"120", ",", "120"}], "}"}]}], "]"}], "}"}], "]"}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "200"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "50"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.6702419004470673`*^9, 3.670241911940661*^9}, {
   3.6702419462806873`*^9, 3.670242011962625*^9}, {3.670242050382998*^9, 
   3.670242057585606*^9}, 3.670242093430608*^9, 3.6703073218719673`*^9, 
   3.670307446600737*^9, {3.670307861072434*^9, 3.670307879270604*^9}, {
   3.670307914469616*^9, 3.67030793448628*^9}, {3.6703082203936253`*^9, 
   3.670308230347044*^9}},ExpressionUUID->"f636fa92-34f4-4f79-81b1-\
6b8e42a97a02"],

Cell[BoxData[
 RowBox[{"showGraphActivation", "[", "102", "]"}]], "Input",
 CellChangeTimes->{{3.670242017712137*^9, 3.670242025407577*^9}, {
  3.670307902710285*^9, 
  3.670307904580365*^9}},ExpressionUUID->"ee9d5a45-2b20-445f-ba1c-\
8edc02ebb402"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-3/\
part-2/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{
         RowBox[{"t", "+", "207", "+", "134"}], ",", "10", ",", "4"}], "]"}], 
       "<>", "\"\<.png\>\""}], ",", 
      RowBox[{"showGraphActivation", "[", "t", "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "207", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670242131886764*^9, 3.670242158427297*^9}, {
  3.670258146222557*^9, 
  3.670258148477076*^9}},ExpressionUUID->"d15122a6-35f2-404c-a741-\
f350923a0ee6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dspeeds", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"estimateDiscreteWaveSpeedAtCell", "[", 
      RowBox[{"i", ",", "2", ",", "0"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "cells", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"ef60c2ac-b428-4f55-bcba-b150dd6d4c68"],

Cell[BoxData[{
 RowBox[{"maxSpeed", "=", 
  RowBox[{"Quantile", "[", 
   RowBox[{"dspeeds", ",", "0.95"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"minSpeed", "=", 
  RowBox[{"Quantile", "[", 
   RowBox[{"dspeeds", ",", "0.05"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6702423293660097`*^9, 
  3.67024238109302*^9}},ExpressionUUID->"5bcceb1e-b32c-4077-9770-\
2d8123ea5f91"],

Cell[BoxData[
 RowBox[{"colorscale", "=", 
  RowBox[{"Image", "[", 
   RowBox[{"MatrixPlot", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ConstantArray", "[", 
         RowBox[{"i", ",", "4"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "1", ",", "0.01"}], "}"}]}], "]"}], 
      "]"}], ",", 
     RowBox[{"ColorFunction", "\[Rule]", "brewerDiv"}], ",", 
     RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
     RowBox[{"Axes", "\[Rule]", "False"}], ",", 
     RowBox[{"Frame", "\[Rule]", "False"}], ",", 
     RowBox[{"PlotRangePadding", "\[Rule]", "None"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.670773826177229*^9, 3.670774005951931*^9}, {
  3.670774180931897*^9, 
  3.670774209537972*^9}},ExpressionUUID->"fc314d11-777e-4d4f-ab31-\
930f8caa7118"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showGraphActivationSpeedMap", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showGraphActivationSpeedMap", "[", "\[IndentingNewLine]", 
   RowBox[{"t_", ",", "\[IndentingNewLine]", 
    RowBox[{"dt_:", "20"}], ",", "\[IndentingNewLine]", 
    RowBox[{"centroids_:", "pts2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}], ",", "\[IndentingNewLine]", 
    RowBox[{"edges_:", "myEdges"}]}], "\[IndentingNewLine]", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "maxZ", ",", "minZ", ",", "stdCentroids", ",", "finalProjection", ",", 
      "transferFunction"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "\"\<1234\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"stdCentroids", " ", "=", " ", 
      RowBox[{"dataTransform", "/@", "centroids"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"maxZ", ",", " ", "minZ"}], "}"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Graphics3D", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"onsetAP", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"t", "-", "5"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"brewerDiv", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"dspeeds", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "-", "minDelay"}], ")"}], 
                    "/", 
                    RowBox[{"(", 
                    RowBox[{"maxDelay", "-", "minDelay"}], ")"}]}], "]"}], 
                    ",", 
                    RowBox[{"Sphere", "[", 
                    RowBox[{
                    RowBox[{"stdCentroids", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", "2.9"}], "]"}]}], 
                    "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"GrayLevel", "[", 
                    RowBox[{"0.5", "+", 
                    RowBox[{"0.2", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"stdCentroids", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"maxZ", "-", "minZ"}], ")"}]}], ")"}]}], 
                    ")"}]}]}], "]"}], ",", 
                    RowBox[{"Sphere", "[", 
                    RowBox[{
                    RowBox[{"stdCentroids", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", "1"}], "]"}]}], 
                    "}"}]}], "]"}], "}"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "stdCentroids", "]"}], "]"}], ")"}]}],
               "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"ColorData", "[", 
                   RowBox[{"\"\<SolarColors\>\"", ",", "0.94"}], "]"}], ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"onsetAP", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "-", "t"}], "]"}], 
                    "\[LessEqual]", "dt"}], ",", 
                    RowBox[{"Opacity", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"Clip", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"res", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "[", 
                    RowBox[{"[", "t", "]"}], "]"}], "-", "0.1"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0.1"}], "}"}]}], "]"}], "/", "0.1"}]}],
                     "]"}], ",", 
                    RowBox[{"Opacity", "[", "0", "]"}]}], "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{
                    RowBox[{"stdCentroids", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", "3"}], "]"}]}], 
                 "}"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "stdCentroids", "]"}], "]"}], ")"}]}],
               "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"GrayLevel", "[", 
                   RowBox[{"0.5", "+", 
                    RowBox[{"0.2", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"stdCentroids", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"maxZ", "-", "minZ"}], ")"}]}], ")"}]}], 
                    ")"}]}]}], "]"}], ",", 
                  RowBox[{"Tube", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"stdCentroids", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"stdCentroids", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}], 
                    ",", "0.25"}], "]"}]}], "}"}], "&"}], "/@", "edges"}], 
              "]"}]}], "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", 
           ",", 
           RowBox[{"Lighting", "->", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"ViewPoint", "\[Rule]", "Top"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "85"}], ",", "134"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "38"}], ",", "118"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"101", ",", "228"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "None"}]}], "]"}], ",", 
         RowBox[{"RasterSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"finalProjection", ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Graphics", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"ColorData", "[", 
                  RowBox[{"97", ",", "1"}], "]"}], ",", 
                 RowBox[{"Annulus", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0.8", ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"2", "Pi", " ", 
                    RowBox[{"t", "/", "207"}]}]}], "}"}]}], "]"}], ",", 
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"PaddedForm", "[", 
                    RowBox[{
                    RowBox[{"2.5", 
                    RowBox[{"(", 
                    RowBox[{"t", "-", "1"}], ")"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "1"}], "}"}], ",", 
                    RowBox[{"NumberPadding", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\>\"", ",", "\"\<0\>\""}], "}"}]}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "0.1"}]}], "}"}]}], "]"}], ",", "12", ",", 
                   RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
                  "]"}]}], "}"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}]}], "}"}]}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "80"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"120", ",", "120"}], "}"}]}], "]"}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Graphics", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Inset", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Show", "[", 
               RowBox[{
                RowBox[{"{", "colorscale", "}"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "80"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"120", ",", "50"}], "}"}]}], "]"}], ",", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<min\>\"", ",", "10", ",", 
                RowBox[{"GrayLevel", "[", "0.3", "]"}], ",", 
                RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
               "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"80", ",", "30"}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<max\>\"", ",", "10", ",", 
                RowBox[{"GrayLevel", "[", "0.3", "]"}], ",", 
                RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
               "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"160", ",", "30"}], "}"}]}], "]"}]}], "}"}], "]"}]}], 
        "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "200"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "50"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.670242135412122*^9, 3.670242147491954*^9}, {
  3.6702421885183897`*^9, 3.670242320201766*^9}, {3.670242387030748*^9, 
  3.670242405020561*^9}, {3.67030574623412*^9, 3.6703057549281807`*^9}, {
  3.670305797520784*^9, 3.670305797617805*^9}, {3.670307987868079*^9, 
  3.670308025890815*^9}, {3.670308067442627*^9, 3.670308128311228*^9}, {
  3.6703081636519403`*^9, 3.67030820282119*^9}, {3.670308257881425*^9, 
  3.670308258090385*^9}, {3.6703083090873213`*^9, 3.6703083299449663`*^9}, {
  3.6703083623103943`*^9, 3.670308362520217*^9}, {3.67077471785614*^9, 
  3.670774721420907*^9}, {3.67077475357498*^9, 3.6707747712693233`*^9}, {
  3.670774802156836*^9, 
  3.670774812177799*^9}},ExpressionUUID->"cda299b1-ecda-4f8b-b4e5-\
103ab647a5a0"],

Cell[BoxData[
 RowBox[{"showGraphActivationSpeedMap", "[", "84", "]"}]], "Input",
 CellChangeTimes->{{3.6702424075074873`*^9, 3.67024244698629*^9}, {
  3.670305770657569*^9, 3.670305811454967*^9}, {3.6703083317107353`*^9, 
  3.6703083690770273`*^9}},ExpressionUUID->"3a705a95-a893-4e99-bb40-\
9cded3a5d7f6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-3/\
part-2/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{
         RowBox[{"t", "+", "207", "+", "134", "+", "207"}], ",", "10", ",", 
         "4"}], "]"}], "<>", "\"\<.png\>\""}], ",", 
      RowBox[{"showGraphActivationSpeedMap", "[", "t", "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "207", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670305841912134*^9, 
  3.670305847726589*^9}},ExpressionUUID->"41fee0c2-73ed-40ec-94d1-\
2bf42cc1aa33"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.67030983083351*^9, 3.670309835389791*^9}, 
   3.670310005225306*^9},ExpressionUUID->"87daf923-a7a9-4cdb-895f-\
6ff0627d2289"]
}, Open  ]],

Cell[CellGroupData[{

Cell["part 3", "Subsubsection",
 CellChangeTimes->{{3.670241853214517*^9, 
  3.670241854868787*^9}},ExpressionUUID->"85f5befe-f91d-47a0-bc62-\
59d962285877"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xmin", ",", "xmax"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ymin", ",", "ymax"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"zmin", ",", "zmax"}], "}"}]}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Min", "[", "#", "]"}], ",", 
       RowBox[{"Max", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
    RowBox[{"Transpose", "[", "pts2", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ctrlPts", "=", 
   RowBox[{"Import", "[", "mline", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"xi", ",", "yi", ",", "zi"}], "}"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"BSplineFunction", "[", 
       RowBox[{"#", ",", 
        RowBox[{"SplineDegree", "\[Rule]", "4"}]}], "]"}], "&"}], "/@", 
     RowBox[{"Transpose", "[", "ctrlPts", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "s", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s", "[", "x_", "]"}], ":=", 
  RowBox[{"NIntegrate", "[", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xi", "'"}], "[", "t0", "]"}], ")"}], "^", "2"}], " ", "+", 
      " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"yi", "'"}], "[", "t0", "]"}], ")"}], "^", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"zi", "'"}], "[", "t0", "]"}], ")"}], "^", "2"}]}], "]"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"t0", ",", "0", ",", "x"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.657264228489072*^9, 3.657264262224662*^9}, 
   3.6584837573919783`*^9, {3.670306966055604*^9, 
   3.6703069825459642`*^9}},ExpressionUUID->"c5c6bdc4-c83e-4122-bff2-\
fc1ee491f832"],

Cell[BoxData[
 RowBox[{"smin", "=", 
  RowBox[{"s", "[", "0", "]"}]}]], "Input",
 CellChangeTimes->{{3.657532910691523*^9, 
  3.657532913820859*^9}},ExpressionUUID->"58f1706a-6ceb-4729-b14a-\
9db58cf19579"],

Cell[BoxData[
 RowBox[{"smax", " ", "=", " ", 
  RowBox[{
   RowBox[{"s", "[", "1.", "]"}], "-", "0.001"}]}]], "Input",
 CellChangeTimes->{{3.657532915647379*^9, 3.6575329184857597`*^9}, 
   3.6581423917168913`*^9, {3.658142551112506*^9, 
   3.6581425537602367`*^9}},ExpressionUUID->"0deca09a-99e2-4a63-8d13-\
43895aaf453b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ipol", "=", 
   RowBox[{"ListInterpolation", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "t", "}"}], ",", 
        RowBox[{"s", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "0", ",", "1", ",", "0.05"}], "}"}]}], "]"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.657345818128326*^9, 3.657345841485382*^9}, {
   3.6573459420897284`*^9, 3.657345965124411*^9}, {3.657346041760828*^9, 
   3.657346060879562*^9}, 
   3.657532791982586*^9},ExpressionUUID->"fd755b52-223b-4894-a05a-\
cb3e1aaec91d"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "t", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", "[", "s_", "]"}], ":=", 
  RowBox[{
   RowBox[{"InverseFunction", "[", "ipol", "]"}], "[", "s", "]"}]}]}], "Input",\

 CellChangeTimes->{{3.6573460636659203`*^9, 3.657346093806614*^9}, {
  3.6581419849927588`*^9, 
  3.65814198774489*^9}},ExpressionUUID->"020a9bff-a0c9-471a-83b1-\
87aba92c472b"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "xint", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xint", "[", "s_", "]"}], ":=", 
  RowBox[{"Chop", "[", 
   RowBox[{"xi", "[", 
    RowBox[{"t", "[", 
     RowBox[{"s", "*", "smax"}], "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "yint", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yint", "[", "s_", "]"}], ":=", 
  RowBox[{"Chop", "[", 
   RowBox[{"yi", "[", 
    RowBox[{"t", "[", 
     RowBox[{"s", "*", "smax"}], "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "zint", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zint", "[", "s_", "]"}], ":=", 
  RowBox[{"Chop", "[", 
   RowBox[{"zi", "[", 
    RowBox[{"t", "[", 
     RowBox[{"s", "*", "smax"}], "]"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.657532795491921*^9, 3.657532846916621*^9}, {
  3.657532985285966*^9, 3.657532987001934*^9}, {3.657533020441791*^9, 
  3.65753303592013*^9}, {3.6575330948184137`*^9, 
  3.657533124107502*^9}},ExpressionUUID->"ea7ded96-cc1d-4558-a5b6-\
cf69a9270307"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"xint2", "=", 
   RowBox[{"BSplineFunction", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"xint", "[", "s", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"s", ",", "0", ",", "1", ",", "0.01"}], "}"}]}], "]"}], ",", 
     RowBox[{"SplineDegree", "\[Rule]", "4"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yint2", "=", 
   RowBox[{"BSplineFunction", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"yint", "[", "s", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"s", ",", "0", ",", "1", ",", "0.01"}], "}"}]}], "]"}], ",", 
     RowBox[{"SplineDegree", "\[Rule]", "4"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zint2", "=", 
   RowBox[{"BSplineFunction", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"zint", "[", "s", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"s", ",", "0", ",", "1", ",", "0.01"}], "}"}]}], "]"}], ",", 
     RowBox[{"SplineDegree", "\[Rule]", "4"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.657532739823515*^9, 3.657532743770092*^9}, {
  3.657533352078638*^9, 3.657533424513402*^9}, {3.657533528780498*^9, 
  3.657533595790003*^9}, {3.657534103983925*^9, 
  3.657534105958561*^9}},ExpressionUUID->"6845f454-2b62-491a-89fa-\
4fbfd6af619d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"midline", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xint2", "[", "t", "]"}], ",", 
       RowBox[{"yint2", "[", "t", "]"}], ",", 
       RowBox[{"zint2", "[", "t", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "1", ",", "0.01"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670310021881441*^9, 
  3.6703100585097523`*^9}},ExpressionUUID->"96df3877-2ac7-4616-8858-\
a2e01abd4d1d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"straightenedLine", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"First", "[", "midline", "]"}], "+", 
      RowBox[{"t", 
       RowBox[{"(", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Last", "[", "midline", "]"}], "-", 
          RowBox[{"First", "[", "midline", "]"}]}], ")"}], ")"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "1", ",", "0.01"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6703101602580357`*^9, 3.6703102488901377`*^9}, {
  3.670310300588932*^9, 3.6703103771708117`*^9}, {3.670310424888227*^9, 
  3.670310439769334*^9}},ExpressionUUID->"a5fea3d0-3f6c-4168-b126-\
031ce20ef860"],

Cell[BoxData[{
 RowBox[{"meanY", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"Mean", " ", "@", 
     RowBox[{"(", 
      RowBox[{"transformToStandardView", "/@", "pts2"}], ")"}]}], ")"}], "[", 
   
   RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"meanZ", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"Mean", " ", "@", 
     RowBox[{"(", 
      RowBox[{"transformToStandardView", "/@", "pts2"}], ")"}]}], ")"}], "[", 
   
   RowBox[{"[", "3", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"minX", ",", "maxX"}], "}"}], "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Min", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"transformToStandardView", "/@", "pts2"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
    RowBox[{"Max", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"transformToStandardView", "/@", "pts2"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.670568864384687*^9, 3.6705689791244173`*^9}, {
  3.670569018469366*^9, 
  3.67056904520255*^9}},ExpressionUUID->"0a7935d8-2064-4232-8134-\
b36f9da73476"],

Cell[BoxData[
 RowBox[{"invT", "=", 
  RowBox[{"Inverse", "[", 
   RowBox[{"Most", "/@", 
    RowBox[{"Most", "[", 
     RowBox[{"TransformationMatrix", "[", "stdTransform", "]"}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.670576286326392*^9, 3.6705763038802757`*^9}, {
  3.670576520865547*^9, 
  3.670576525440954*^9}},ExpressionUUID->"68af9121-d3e0-49f5-94b5-\
94ab84992b01"],

Cell[BoxData[
 RowBox[{"direction", "=", 
  RowBox[{"invT", ".", 
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"maxX", ",", "meanY", ",", "meanZ"}], "}"}], "-", 
      RowBox[{"{", 
       RowBox[{"minX", ",", "meanY", ",", "meanZ"}], "}"}]}], 
     ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6705764367076197`*^9, 3.670576491707786*^9}, {
  3.670576530647499*^9, 3.67057653903916*^9}, {3.6705768498616037`*^9, 
  3.6705768936220903`*^9}},ExpressionUUID->"2c47dde6-810b-4911-90a0-\
371e7f67210d"],

Cell[BoxData[
 RowBox[{"start", "=", 
  RowBox[{"invT", ".", 
   RowBox[{"{", 
    RowBox[{"maxX", ",", "meanY", ",", "meanZ"}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.6705765411502438`*^9, 3.670576550729751*^9}, {
  3.670576904156537*^9, 
  3.670576905227605*^9}},ExpressionUUID->"e80d3d7a-8523-46db-be46-\
68e64bf59800"],

Cell[BoxData[
 RowBox[{
  RowBox[{"straightenedLine", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"First", "[", "midline", "]"}], "+", 
      RowBox[{"t", 
       RowBox[{"(", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Last", "[", "midline", "]"}], "-", 
          RowBox[{"First", "[", "midline", "]"}]}], ")"}], ")"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "1", ",", "0.01"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670683267037756*^9, 
  3.6706832872651987`*^9}},ExpressionUUID->"af838bd4-85e5-4539-8bbb-\
a1a4776528b8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"intermediateMidlines", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", "lambda", ")"}], "straightenedLine"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "lambda"}], ")"}], "midline"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"lambda", ",", "0", ",", "1", ",", "0.05"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.67031047083746*^9, 3.6703105168229733`*^9}, {
  3.670310662130438*^9, 3.6703107081448708`*^9}, {3.670310764021202*^9, 
  3.6703107839986362`*^9}, {3.6705777971510687`*^9, 
  3.670577797838842*^9}},ExpressionUUID->"38e52fe1-6e2c-4255-9860-\
876be5544cf9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"interpolatedMidlines", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"BSplineFunction", "[", 
      RowBox[{"#", ",", 
       RowBox[{"SplineDegree", "\[Rule]", "4"}]}], "]"}], "&"}], "/@", 
    "intermediateMidlines"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6703107865238247`*^9, 3.6703108076800528`*^9}, 
   3.670311149124642*^9},ExpressionUUID->"40ba4360-14b4-4430-af0a-\
d1e178d42b93"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "getMovingFrame", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getMovingFrame", "[", "interpolatedLine_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "xint", ",", "yint", ",", "zint", ",", "kappa", ",", "tau", ",", "Ni", 
      ",", "Bi", ",", "Ti"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"xint", "=", 
      RowBox[{"BSplineFunction", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"interpolatedLine", "[", "s", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"s", ",", "0", ",", "1", ",", "0.01"}], "}"}]}], "]"}], 
        ",", 
        RowBox[{"SplineDegree", "\[Rule]", "4"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"yint", "=", 
      RowBox[{"BSplineFunction", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"interpolatedLine", "[", "s", "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"s", ",", "0", ",", "1", ",", "0.01"}], "}"}]}], "]"}], 
        ",", 
        RowBox[{"SplineDegree", "\[Rule]", "4"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"zint", "=", 
      RowBox[{"BSplineFunction", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"interpolatedLine", "[", "s", "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"s", ",", "0", ",", "1", ",", "0.01"}], "}"}]}], "]"}], 
        ",", 
        RowBox[{"SplineDegree", "\[Rule]", "4"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"kappa", ",", "tau"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Ti", ",", "Ni", ",", "Bi"}], "}"}]}], "}"}], " ", "=", 
      RowBox[{"FrenetSerretSystem", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"xint", "[", "t", "]"}], ",", 
          RowBox[{"yint", "[", "t", "]"}], ",", 
          RowBox[{"zint", "[", "t", "]"}]}], "}"}], ",", "t"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Ti", ",", "Ni", ",", "Bi"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"xint", ",", "yint", ",", "zint"}], "}"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.670311161869294*^9, 3.670311308574066*^9}, {
  3.6703114980775347`*^9, 3.670311502497424*^9}, {3.670567763862814*^9, 
  3.670567771235819*^9}, {3.670578349504897*^9, 
  3.6705783541663027`*^9}},ExpressionUUID->"52b5c6b6-36bf-451b-987b-\
cdf56a928444"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Kappa]", ",", "\[Tau]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Ti", ",", "Ni", ",", "Bi"}], "}"}]}], "}"}], " ", "=", 
   RowBox[{"FrenetSerretSystem", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xint2", "[", "t", "]"}], ",", 
       RowBox[{"yint2", "[", "t", "]"}], ",", 
       RowBox[{"zint2", "[", "t", "]"}]}], "}"}], ",", "t"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.657533627637414*^9, 
  3.657533631436824*^9}},ExpressionUUID->"43f19126-f7c0-4cf9-b5b4-\
7bc4f2feaedd"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "projectPointToMidline", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"projectPointToMidline", "[", 
   RowBox[{"pt_", ",", 
    RowBox[{"xint_:", "xint2"}], ",", 
    RowBox[{"yint_:", "yint2"}], ",", 
    RowBox[{"zint_:", "zint2"}], ",", " ", 
    RowBox[{"frenetFrame_:", 
     RowBox[{"FrenetSerretSystem", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"xint2", "[", "t", "]"}], ",", 
         RowBox[{"yint2", "[", "t", "]"}], ",", 
         RowBox[{"zint2", "[", "t", "]"}]}], "}"}], ",", "t"}], "]"}]}]}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "pieces", ",", " ", "minDist", ",", " ", "minPar", ",", "minVec", ",", 
      "Ti", ",", "Ni", ",", "Bi", ",", "dv", ",", "\[Kappa]", ",", "\[Tau]", 
      ",", "vec", ",", "z", ",", "\[Rho]", ",", "\[Phi]"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"minDist", ",", " ", "minPar"}], "}"}], "=", 
      RowBox[{"NMinimize", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"EuclideanDistance", "[", 
           RowBox[{"pt", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xint", "[", "t", "]"}], ",", 
              RowBox[{"yint", "[", "t", "]"}], ",", 
              RowBox[{"zint", "[", "t", "]"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"0", "<", "t", "<", "1"}]}], "}"}], ",", "t"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"minDist", ",", "minPar"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{"minDist", ",", " ", 
        RowBox[{"t", "/.", "minPar"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"minVec", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"xint", "[", "minPar", "]"}], ",", 
        RowBox[{"yint", "[", "minPar", "]"}], ",", 
        RowBox[{"zint", "[", "minPar", "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Kappa]", ",", "\[Tau]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Ti", ",", "Ni", ",", "Bi"}], "}"}]}], "}"}], " ", "=", " ", 
      
      RowBox[{"frenetFrame", "/.", 
       RowBox[{"t", "\[Rule]", "minPar"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"vec", "=", 
      RowBox[{"pt", "-", "minVec"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Rho]", ",", "\[Phi]", ",", "z"}], "}"}], "=", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"ToPolarCoordinates", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"vec", ".", "Bi"}], ",", 
           RowBox[{"vec", ".", "Ni"}]}], "}"}], "]"}], ",", "minPar"}], 
       "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.6575325654682417`*^9, 3.657532607428583*^9}, {
  3.657532646290414*^9, 3.657532656411809*^9}, {3.657533635384447*^9, 
  3.657533648547943*^9}, {3.7179231010122747`*^9, 
  3.717923105146702*^9}},ExpressionUUID->"a4733b18-ca2d-4eab-a56d-\
e1aad70575ac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ptsCylinder", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"projectPointToMidline", "[", 
      RowBox[{"#", ",", "xint2", ",", "yint2", ",", "zint2", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Kappa]", ",", "\[Tau]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Ti", ",", "Ni", ",", "Bi"}], "}"}]}], "}"}]}], "]"}], 
     "&"}], "/@", "pts2"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.657291360484021*^9, 3.6572913868855143`*^9}, {
  3.657291942495368*^9, 3.65729195739799*^9}, {3.6575419469868097`*^9, 
  3.6575419496444798`*^9}, {3.6610871437402153`*^9, 
  3.6610871449158382`*^9}},ExpressionUUID->"4b1dec69-bfc2-4fb4-85f7-\
f9dd677e2af3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"minParameter", "=", 
   RowBox[{"Min", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Last", "[", "#", "]"}], "&"}], "/@", "ptsCylinder"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"maxParameter", "=", 
   RowBox[{"Max", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Last", "[", "#", "]"}], "&"}], "/@", "ptsCylinder"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.65848387882095*^9, 3.658483940543996*^9}, {
  3.658484394123461*^9, 3.65848443784943*^9}, {3.661087182193818*^9, 
  3.661087209472797*^9}},ExpressionUUID->"90053c19-4aa8-4901-baaf-\
9fe08a7ff8e4"],

Cell[BoxData[
 RowBox[{"smax", "=", 
  RowBox[{
   RowBox[{"s", "[", "1.0", "]"}], " ", "*", " ", 
   RowBox[{"(", 
    RowBox[{"maxParameter", "-", "minParameter"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.661087261351487*^9, 3.661087275094413*^9}, {
  3.661087347253866*^9, 
  3.661087349771925*^9}},ExpressionUUID->"77fc923d-04bc-4d23-9d88-\
cf4c21d36dc8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ptsCylinder", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "-", "minParameter"}], ")"}], "/", 
        
        RowBox[{"(", 
         RowBox[{"maxParameter", "-", "minParameter"}], ")"}]}]}], "}"}], 
     "&"}], "/@", "ptsCylinder"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.661087386022403*^9, 3.661087425813204*^9}, {
  3.6610874746178637`*^9, 3.661087476840064*^9}, {3.661087555102058*^9, 
  3.66108755659865*^9}},ExpressionUUID->"8ee36a93-4d73-4d06-b4d3-\
9316f34d2cb5"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "projectBackFromMidline", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"projectBackFromMidline", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Rho]_", ",", "\[Phi]_", ",", "z_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"Ti_", ",", "Ni_", ",", "Bi_"}], "}"}], ",", 
    RowBox[{"xint_:", "xint2"}], ",", 
    RowBox[{"yint_:", "yint2"}], ",", 
    RowBox[{"zint_:", "zint2"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x0", ",", "n", ",", "b"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"x0", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"xint", "[", "z", "]"}], ",", 
        RowBox[{"yint", "[", "z", "]"}], ",", 
        RowBox[{"zint", "[", "z", "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"b", ",", "n"}], "}"}], "=", 
      RowBox[{"FromPolarCoordinates", "[", 
       RowBox[{"{", 
        RowBox[{"\[Rho]", ",", "\[Phi]"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"x0", "+", 
      RowBox[{"b", " ", 
       RowBox[{"(", 
        RowBox[{"Bi", "/.", 
         RowBox[{"t", "->", "z"}]}], ")"}]}], "+", 
      RowBox[{"n", " ", 
       RowBox[{"(", 
        RowBox[{"Ni", "/.", 
         RowBox[{"t", "->", "z"}]}], ")"}]}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.6705670417093153`*^9, 3.670567317283452*^9}, {
  3.670567426150058*^9, 3.670567437854035*^9}, {3.670567492690938*^9, 
  3.6705675030364437`*^9}, {3.670567538234458*^9, 
  3.670567565641444*^9}},ExpressionUUID->"39bfdca4-438b-4049-86cf-\
ab1e2ac8e461"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "computeIntermediateHeartGeometry", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"computeIntermediateHeartGeometry", "[", 
   RowBox[{"midline_", ",", 
    RowBox[{"coords_:", "ptsCylinder"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "tangent", ",", "normal", ",", "binormal", ",", "xInter", ",", "yInter", 
      ",", "zInter", ",", "newPts"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"tangent", ",", "normal", ",", "binormal"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"xInter", ",", "yInter", ",", "zInter"}], "}"}]}], "}"}], 
      "=", 
      RowBox[{"getMovingFrame", "[", "midline", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"newPts", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"projectBackFromMidline", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{"tangent", ",", "normal", ",", "binormal"}], "}"}], ",", 
          "xInter", ",", "yInter", ",", "zInter"}], "]"}], "&"}], "/@", 
       "coords"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.670567930629661*^9, 
  3.670568033883307*^9}},ExpressionUUID->"5bf389f1-c74b-4241-8ee5-\
595fd7a37d0b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"intermediatePts", "=", 
   RowBox[{
   "computeIntermediateHeartGeometry", "/@", "interpolatedMidlines"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6705681304323683`*^9, 
  3.6705681475521297`*^9}},ExpressionUUID->"8fba21cd-d28a-4b9c-b197-\
9e6d02aebc5f"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "cyl2cart", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cyl2cart", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Rho]_", ",", "\[Phi]_", ",", "z_"}], "}"}], ",", 
    RowBox[{"scale_:", "smax"}]}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "z"}], " ", "scale"}], ",", " ", 
    RowBox[{"\[Rho]", " ", 
     RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
    RowBox[{"\[Rho]", " ", 
     RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.657292352892045*^9, 3.657292413173862*^9}, {
  3.657292451179304*^9, 3.6572924842990522`*^9}, {3.6572925737699137`*^9, 
  3.657292578111039*^9}, {3.657292861435207*^9, 3.657292868167025*^9}, {
  3.6572935256862993`*^9, 3.657293550769112*^9}, {3.670584173751635*^9, 
  3.670584174336763*^9}},ExpressionUUID->"c96f8059-6a7f-4468-be19-\
d658dda3f626"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showNodesAndMidline", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showNodesAndMidline", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tmax_:", "0"}], ",", 
    RowBox[{"centroids_:", "pts2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "maxZ", ",", "minZ", ",", "stdCentroids", ",", "n", ",", 
      "finalProjection", ",", "transferFunction", ",", "trails"}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "\"\<1234\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"stdCentroids", " ", "=", " ", 
      RowBox[{"dataTransform", "/@", "centroids"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"maxZ", ",", " ", "minZ"}], "}"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Graphics3D", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"AbsoluteThickness", "[", "5", "]"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"GrayLevel", "[", "0.3", "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"transformToStandardView", "/@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xint2", "[", "t", "]"}], ",", 
                    RowBox[{"yint2", "[", "t", "]"}], ",", 
                    RowBox[{"zint2", "[", "t", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xint2", "[", 
                    RowBox[{"t", "+", "0.01"}], "]"}], ",", 
                    RowBox[{"yint2", "[", 
                    RowBox[{"t", "+", "0.01"}], "]"}], ",", 
                    RowBox[{"zint2", "[", 
                    RowBox[{"t", "+", "0.01"}], "]"}]}], "}"}]}], "}"}]}], 
                    "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"t", ",", "minParameter", ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{"tmax", ",", 
                    RowBox[{"maxParameter", "-", "0.01"}]}], "]"}], ",", 
                    "0.01"}], "}"}]}], "]"}]}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Opacity", "[", "0.2", "]"}], ",", 
                  RowBox[{"GrayLevel", "[", 
                   RowBox[{"0.5", "+", 
                    RowBox[{"0.2", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"maxZ", "-", "minZ"}], ")"}]}], ")"}]}], 
                    ")"}]}]}], "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{"#", ",", "2.5"}], "]"}], ",", 
                  RowBox[{"Opacity", "[", "1", "]"}], ",", 
                  RowBox[{"GrayLevel", "[", "0.3", "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{"#", ",", "1"}], "]"}]}], "}"}], "&"}], "/@", 
               RowBox[{"(", "stdCentroids", ")"}]}], "]"}]}], 
            "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", 
           RowBox[{"Lighting", "->", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"ViewPoint", "\[Rule]", "Top"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "85"}], ",", "134"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "38"}], ",", "118"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"101", ",", "228"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "None"}]}], "]"}], ",", 
         RowBox[{"RasterSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", "finalProjection", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "200"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "50"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.670680102804528*^9, 3.67068012930226*^9}, 
   3.6706830191492243`*^9, {3.670683933500822*^9, 3.670683991334156*^9}, {
   3.670684027354344*^9, 3.670684044831604*^9}, {3.670685157207794*^9, 
   3.670685162685554*^9}},ExpressionUUID->"ba80e92a-bdc6-4718-b3af-\
a40f9dca5287"],

Cell[BoxData[
 RowBox[{"showNodesAndMidline", "[", "1", "]"}]], "Input",
 CellChangeTimes->{{3.670683866619974*^9, 3.670683874739737*^9}, {
   3.6706839272354717`*^9, 3.670683929048983*^9}, {3.670683999329176*^9, 
   3.670684013838654*^9}, 
   3.670685166243457*^9},ExpressionUUID->"62faa492-9e06-4265-859f-\
33677d53f048"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-4/\
part-1/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"t", ",", "10", ",", "4"}], "]"}], "<>", "\"\<.png\>\""}], 
      ",", 
      RowBox[{"showNodesAndMidline", "[", 
       RowBox[{"t", "/", "100"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "100", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.67068513682563*^9, 3.670685184377162*^9}, {
  3.6706852160853043`*^9, 
  3.670685259159155*^9}},ExpressionUUID->"400a93eb-21df-4787-92b8-\
32c9f8a18014"],

Cell[BoxData[
 RowBox[{"myblue", "=", 
  InterpretationBox[
   ButtonBox[
    TooltipBox[
     GraphicsBox[{
       {GrayLevel[0], RectangleBox[{0, 0}]}, 
       {GrayLevel[0], RectangleBox[{1, -1}]}, 
       {RGBColor[
        0.33725490196078434`, 0.7058823529411764, 0.9137254901960784], 
        RectangleBox[{0, -1}, {2, 1}]}},
      AspectRatio->1,
      Frame->True,
      FrameStyle->RGBColor[
       0.22483660130718958`, 0.47058823529411764`, 0.6091503267973857],
      FrameTicks->None,
      ImageSize->
       Dynamic[{
        Automatic, 
         1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
          Magnification])}],
      PlotRangePadding->None],
     "RGBColor[0.33725490196078434, 0.7058823529411764, 0.9137254901960784]"],
    
    Appearance->None,
    BaseStyle->{},
    BaselinePosition->Baseline,
    ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
      If[
       Not[
        AbsoluteCurrentValue["Deployed"]], 
       SelectionMove[Typeset`box$, All, Expression]; 
       FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
       FrontEnd`Private`$ColorSelectorInitialColor = 
        RGBColor[
         0.33725490196078434`, 0.7058823529411764, 0.9137254901960784]; 
       FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
       MathLink`CallFrontEnd[
         FrontEnd`AttachCell[Typeset`box$, 
          FrontEndResource["RGBColorValueSelector"], {0, {Left, Bottom}}, {
          Left, Top}, 
          "ClosingActions" -> {
           "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
    DefaultBaseStyle->{},
    Evaluator->Automatic,
    Method->"Preemptive"],
   RGBColor[0.33725490196078434`, 0.7058823529411764, 0.9137254901960784],
   Editable->False,
   Selectable->False]}]], "Input",
 CellChangeTimes->{{3.6706846763450727`*^9, 
  3.6706846782775927`*^9}},ExpressionUUID->"87707031-c713-41ac-a2c4-\
695fdd275536"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showNodesAndReference", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showNodesAndReference", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ti_:", "0"}], ",", "\[IndentingNewLine]", 
    RowBox[{"centroids_:", "pts2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "maxZ", ",", "minZ", ",", "stdCentroids", ",", "n", ",", 
      "finalProjection", ",", "transferFunction", ",", "trails"}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "\"\<1234\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"stdCentroids", " ", "=", " ", 
      RowBox[{"dataTransform", "/@", "centroids"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"maxZ", ",", " ", "minZ"}], "}"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Graphics3D", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"GrayLevel", "[", "0.3", "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"transformToStandardView", "/@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xint2", "[", "t", "]"}], ",", 
                    RowBox[{"yint2", "[", "t", "]"}], ",", 
                    RowBox[{"zint2", "[", "t", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xint2", "[", 
                    RowBox[{"t", "+", "0.01"}], "]"}], ",", 
                    RowBox[{"yint2", "[", 
                    RowBox[{"t", "+", "0.01"}], "]"}], ",", 
                    RowBox[{"zint2", "[", 
                    RowBox[{"t", "+", "0.01"}], "]"}]}], "}"}]}], "}"}]}], 
                    "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"t", ",", "minParameter", ",", 
                    RowBox[{"maxParameter", "-", "0.01"}], ",", "0.01"}], 
                   "}"}]}], "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"AbsoluteThickness", "[", "5", "]"}], ",", "Black", 
                ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"transformToStandardView", "/@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xint2", "[", "ti", "]"}], ",", 
                    RowBox[{"yint2", "[", "ti", "]"}], ",", 
                    RowBox[{"zint2", "[", "ti", "]"}]}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xint2", "[", "ti", "]"}], ",", 
                    RowBox[{"yint2", "[", "ti", "]"}], ",", 
                    RowBox[{"zint2", "[", "ti", "]"}]}], "}"}], "+", 
                    RowBox[{"15", 
                    RowBox[{"(", 
                    RowBox[{"Ti", "/.", 
                    RowBox[{"t", "\[Rule]", "ti"}]}], ")"}]}]}]}], "}"}]}], 
                 "]"}], ",", "\[IndentingNewLine]", "Gray", ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"transformToStandardView", "/@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xint2", "[", "ti", "]"}], ",", 
                    RowBox[{"yint2", "[", "ti", "]"}], ",", 
                    RowBox[{"zint2", "[", "ti", "]"}]}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xint2", "[", "ti", "]"}], ",", 
                    RowBox[{"yint2", "[", "ti", "]"}], ",", 
                    RowBox[{"zint2", "[", "ti", "]"}]}], "}"}], "+", 
                    RowBox[{"15", 
                    RowBox[{"(", 
                    RowBox[{"Ni", "/.", 
                    RowBox[{"t", "\[Rule]", "ti"}]}], ")"}]}]}]}], "}"}]}], 
                 "]"}], ",", "\[IndentingNewLine]", "myblue", ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"transformToStandardView", "/@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xint2", "[", "ti", "]"}], ",", 
                    RowBox[{"yint2", "[", "ti", "]"}], ",", 
                    RowBox[{"zint2", "[", "ti", "]"}]}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xint2", "[", "ti", "]"}], ",", 
                    RowBox[{"yint2", "[", "ti", "]"}], ",", 
                    RowBox[{"zint2", "[", "ti", "]"}]}], "}"}], "+", 
                    RowBox[{"15", 
                    RowBox[{"(", 
                    RowBox[{"Bi", "/.", 
                    RowBox[{"t", "\[Rule]", "ti"}]}], ")"}]}]}]}], "}"}]}], 
                 "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"myblue", ",", 
                    RowBox[{"Opacity", "[", "0.2", "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"transformToStandardView", "/@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xint2", "[", "t", "]"}], ",", 
                    RowBox[{"yint2", "[", "t", "]"}], ",", 
                    RowBox[{"zint2", "[", "t", "]"}]}], "}"}], "-", 
                    RowBox[{"5", 
                    RowBox[{"(", 
                    RowBox[{"Bi", "/.", 
                    RowBox[{"t", "\[Rule]", "t"}]}], ")"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xint2", "[", "t", "]"}], ",", 
                    RowBox[{"yint2", "[", "t", "]"}], ",", 
                    RowBox[{"zint2", "[", "t", "]"}]}], "}"}], "+", 
                    RowBox[{"5", 
                    RowBox[{"(", 
                    RowBox[{"Bi", "/.", 
                    RowBox[{"t", "\[Rule]", "t"}]}], ")"}]}]}]}], "}"}]}], 
                    "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"t", ",", "minParameter", ",", 
                    RowBox[{"ti", "-", "0.01"}], ",", "0.001"}], "}"}]}], 
                 "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Opacity", "[", "0.2", "]"}], ",", 
                  RowBox[{"GrayLevel", "[", 
                   RowBox[{"0.5", "+", 
                    RowBox[{"0.2", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"maxZ", "-", "minZ"}], ")"}]}], ")"}]}], 
                    ")"}]}]}], "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{"#", ",", "2.5"}], "]"}], ",", 
                  RowBox[{"Opacity", "[", "1", "]"}], ",", 
                  RowBox[{"GrayLevel", "[", "0.3", "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{"#", ",", "1"}], "]"}]}], "}"}], "&"}], "/@", 
               RowBox[{"(", "stdCentroids", ")"}]}], "]"}]}], 
            "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", 
           RowBox[{"Lighting", "->", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"ViewPoint", "\[Rule]", "Top"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "85"}], ",", "134"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "38"}], ",", "118"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"101", ",", "228"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "None"}]}], "]"}], ",", 
         RowBox[{"RasterSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", "finalProjection", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "200"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "50"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.670684072951549*^9, 3.670684120428967*^9}, {
  3.6706841745084333`*^9, 3.670684199795245*^9}, {3.670684238674363*^9, 
  3.670684248050229*^9}, {3.67068443391028*^9, 3.670684628117836*^9}, {
  3.670684685869546*^9, 3.670684726778635*^9}, {3.6706849070291853`*^9, 
  3.670684940379243*^9}, {3.6706849709017277`*^9, 3.670685118200675*^9}, {
  3.670685322896262*^9, 
  3.670685326478973*^9}},ExpressionUUID->"56d2589c-2841-41f5-abd3-\
0fcb0e3d871c"],

Cell[BoxData[
 RowBox[{"showNodesAndReference", "[", "0.01", "]"}]], "Input",
 CellChangeTimes->{{3.670684211628325*^9, 3.670684257878666*^9}, {
  3.670684736767717*^9, 3.670684749790978*^9}, {3.7180094098952847`*^9, 
  3.718009410737802*^9}},ExpressionUUID->"056d3197-bf2d-4de8-8ae8-\
8d33dd149dd9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-4/\
part-1/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{
         RowBox[{"x", "+", "100"}], ",", "10", ",", "4"}], "]"}], "<>", 
       "\"\<.png\>\""}], ",", 
      RowBox[{"showNodesAndReference", "[", 
       RowBox[{"x", "/", "100"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "1", ",", "100", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.67068513682563*^9, 3.670685184377162*^9}, {
  3.6706852160853043`*^9, 3.670685259159155*^9}, {3.6706853123755083`*^9, 
  3.6706853340601254`*^9}, {3.670686309088122*^9, 
  3.670686313516638*^9}},ExpressionUUID->"6b7e9f5b-54aa-4197-bba0-\
13220c1d5274"],

Cell[BoxData[
 RowBox[{"midline3D1", "=", 
  RowBox[{"Graphics3D", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Opacity", "[", "0.2", "]"}], ",", "Black", ",", 
      RowBox[{"AbsoluteThickness", "[", ".1", "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"pts2", "[", 
            RowBox[{"[", 
             RowBox[{"First", "@", "#"}], "]"}], "]"}], ",", 
           RowBox[{"pts2", "[", 
            RowBox[{"[", 
             RowBox[{"Last", "@", "#"}], "]"}], "]"}]}], "}"}], "]"}], "&"}], 
       "/@", "myEdges"}], ",", 
      RowBox[{"Opacity", "[", "1", "]"}], ",", "Gray", ",", 
      RowBox[{"AbsolutePointSize", "[", "4", "]"}], ",", 
      RowBox[{"Point", "/@", "pts2"}], ",", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Line", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"xint", "[", "t", "]"}], ",", 
             RowBox[{"yint", "[", "t", "]"}], ",", 
             RowBox[{"zint", "[", "t", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "25"}]}], "}"}]}], "]"}], "]"}], ","}], "*)"}],
       ",", 
      RowBox[{"AbsoluteThickness", "[", "10", "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"brewerDiv", "[", "t", "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"transformToStandardView", "/@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xint2", "[", "t", "]"}], ",", 
                RowBox[{"yint2", "[", "t", "]"}], ",", 
                RowBox[{"zint2", "[", "t", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xint2", "[", 
                 RowBox[{"t", "+", "0.01"}], "]"}], ",", 
                RowBox[{"yint2", "[", 
                 RowBox[{"t", "+", "0.01"}], "]"}], ",", 
                RowBox[{"zint2", "[", 
                 RowBox[{"t", "+", "0.01"}], "]"}]}], "}"}]}], "}"}]}], 
           "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "minParameter", ",", 
          RowBox[{"maxParameter", "-", "0.01"}], ",", "0.01"}], "}"}]}], 
       "]"}]}], "}"}], ",", 
    RowBox[{"ViewPoint", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "Infinity"}], "}"}]}], ",", " ", 
    RowBox[{"Boxed", "\[Rule]", "False"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.657984783975045*^9, 3.657984836355968*^9}, {
   3.6579848938347187`*^9, 3.657984901243081*^9}, {3.6579849325088167`*^9, 
   3.657985104263637*^9}, {3.6579851848621883`*^9, 3.657985240083713*^9}, {
   3.657985270363158*^9, 3.657985270575674*^9}, {3.657985374071765*^9, 
   3.657985379878828*^9}, {3.6579855816872683`*^9, 3.657985643790964*^9}, {
   3.657985674222041*^9, 3.65798581777089*^9}, {3.6580351580489902`*^9, 
   3.6580352123148003`*^9}, {3.658035283593392*^9, 3.658035327406106*^9}, {
   3.65803543250918*^9, 3.6580354821549683`*^9}, {3.6582341639082623`*^9, 
   3.658234166209003*^9}, {3.658234303230865*^9, 3.658234306447753*^9}, {
   3.658235047185814*^9, 3.658235070014612*^9}, {3.658235233051486*^9, 
   3.658235235897299*^9}, 3.658589020224845*^9, 3.658658668562426*^9, {
   3.662104192035379*^9, 3.662104236090082*^9}, {3.662112949769024*^9, 
   3.66211302024553*^9}, {3.662217712312717*^9, 3.662217721644907*^9}, {
   3.662280464149666*^9, 3.662280469381529*^9}, {3.662280502308629*^9, 
   3.662280502980617*^9}, {3.670307155853096*^9, 
   3.6703071754923058`*^9}},ExpressionUUID->"d21dd3cb-d627-44b3-9794-\
b6ad5e36a8ce"],

Cell[BoxData[
 RowBox[{"midline3D", "=", 
  RowBox[{"Graphics3D", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Opacity", "[", "0.2", "]"}], ",", "Black", ",", 
      RowBox[{"AbsoluteThickness", "[", ".5", "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"pts2", "[", 
            RowBox[{"[", 
             RowBox[{"First", "@", "#"}], "]"}], "]"}], ",", 
           RowBox[{"pts2", "[", 
            RowBox[{"[", 
             RowBox[{"Last", "@", "#"}], "]"}], "]"}]}], "}"}], "]"}], "&"}], 
       "/@", "myEdges"}], ",", 
      RowBox[{"Opacity", "[", "1", "]"}], ",", "Gray", ",", 
      RowBox[{"AbsolutePointSize", "[", "3", "]"}], ",", 
      RowBox[{"MapIndexed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"minAngle", "<=", 
              RowBox[{
               RowBox[{"ptsCylinder", "[", 
                RowBox[{"[", 
                 RowBox[{"#2", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", "maxAngle"}], 
             ",", 
             RowBox[{"Directive", "[", 
              RowBox[{
               RowBox[{"AbsolutePointSize", "[", "7", "]"}], ",", "Gray"}], 
              "]"}], ",", 
             RowBox[{"Directive", "[", 
              RowBox[{
               RowBox[{"Opacity", "[", "0.2", "]"}], ",", "Black"}], "]"}]}], 
            "]"}], ",", 
           RowBox[{"Point", "[", "#1", "]"}]}], "}"}], "&"}], ",", "pts2"}], 
       "]"}], ",", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Line", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"xint", "[", "t", "]"}], ",", 
             RowBox[{"yint", "[", "t", "]"}], ",", 
             RowBox[{"zint", "[", "t", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "25"}]}], "}"}]}], "]"}], "]"}], ","}], "*)"}],
       ",", 
      RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", "Black", ",", 
      RowBox[{"Line", "[", 
       RowBox[{"transformToStandardView", "/@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"xint2", "[", "t", "]"}], ",", 
            RowBox[{"yint2", "[", "t", "]"}], ",", 
            RowBox[{"zint2", "[", "t", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "t", ",", "minParameter", ",", "maxParameter", ",", "0.01"}], 
           "}"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"(*", 
          RowBox[{"Black", ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xint2", "[", "t", "]"}], ",", 
                RowBox[{"yint2", "[", "t", "]"}], ",", 
                RowBox[{"zint2", "[", "t", "]"}]}], "}"}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xint2", "[", "t", "]"}], ",", 
                 RowBox[{"yint2", "[", "t", "]"}], ",", 
                 RowBox[{"zint2", "[", "t", "]"}]}], "}"}], "+", 
               RowBox[{"10", 
                RowBox[{"(", 
                 RowBox[{"Ti", "/.", 
                  RowBox[{"t", "\[Rule]", "t"}]}], ")"}]}]}]}], "}"}], "]"}], 
           ","}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AbsoluteThickness", "[", "3", "]"}], ",", "Gray", ",", 
          RowBox[{"Line", "[", 
           RowBox[{"transformToStandardView", "/@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xint2", "[", "t", "]"}], ",", 
                RowBox[{"yint2", "[", "t", "]"}], ",", 
                RowBox[{"zint2", "[", "t", "]"}]}], "}"}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xint2", "[", "t", "]"}], ",", 
                 RowBox[{"yint2", "[", "t", "]"}], ",", 
                 RowBox[{"zint2", "[", "t", "]"}]}], "}"}], "+", 
               RowBox[{"10", 
                RowBox[{"(", 
                 RowBox[{"Ni", "/.", 
                  RowBox[{"t", "\[Rule]", "t"}]}], ")"}]}]}]}], "}"}]}], 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"cols", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "3", "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"transformToStandardView", "/@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xint2", "[", "t", "]"}], ",", 
                RowBox[{"yint2", "[", "t", "]"}], ",", 
                RowBox[{"zint2", "[", "t", "]"}]}], "}"}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xint2", "[", "t", "]"}], ",", 
                 RowBox[{"yint2", "[", "t", "]"}], ",", 
                 RowBox[{"zint2", "[", "t", "]"}]}], "}"}], "+", 
               RowBox[{"10", 
                RowBox[{"(", 
                 RowBox[{"Bi", "/.", 
                  RowBox[{"t", "\[Rule]", "t"}]}], ")"}]}]}]}], "}"}]}], 
           "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "minParameter", ",", "maxParameter", ",", "0.03"}],
          "}"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"ViewPoint", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "Infinity"}], "}"}]}], ",", 
    RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.65798595040504*^9, 3.657985992340199*^9}, {
   3.657986033164126*^9, 3.65798608729807*^9}, {3.65798613029888*^9, 
   3.657986218374427*^9}, {3.657986260805554*^9, 3.657986283684362*^9}, {
   3.657986351163575*^9, 3.657986464216404*^9}, {3.6579865240388527`*^9, 
   3.657986542469304*^9}, {3.6579865964142227`*^9, 3.65798671596922*^9}, {
   3.657988305564435*^9, 3.657988308886791*^9}, {3.658234356295573*^9, 
   3.658234383718233*^9}, {3.658234518082582*^9, 3.658234518779248*^9}, {
   3.658235077305356*^9, 3.658235092863056*^9}, 3.658589025232708*^9, 
   3.6586586792992773`*^9, {3.662104260082375*^9, 3.662104301431559*^9}, {
   3.662104398252344*^9, 3.6621044031869097`*^9}, {3.6622805448921967`*^9, 
   3.66228058487367*^9}},ExpressionUUID->"f8a80b4c-15d0-4d0b-b283-\
eb350156bd7c"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "findLocalRotation", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"findLocalRotation", "[", 
   RowBox[{"t0_", ",", "dt_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"T0", ",", "N0", ",", "B0", ",", "T1", ",", "B1", ",", "N1"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"T0", ",", "N0", ",", "B0"}], "}"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Ti", ",", "Ni", ",", "Bi"}], "}"}], "/.", 
       RowBox[{"t", "\[Rule]", "t0"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"T1", ",", "N1", ",", "B1"}], "}"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Ti", ",", "Ni", ",", "Bi"}], "}"}], "/.", 
       RowBox[{"t", "\[Rule]", 
        RowBox[{"t0", "+", "dt"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Theta]", "/.", 
      RowBox[{"Last", "[", 
       RowBox[{"NMinimize", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"EuclideanDistance", "[", 
           RowBox[{"N1", ",", 
            RowBox[{
             RowBox[{"RotationMatrix", "[", 
              RowBox[{"\[Theta]", ",", "T0"}], "]"}], ".", "N0"}]}], "]"}], 
          "+", 
          RowBox[{"EuclideanDistance", "[", 
           RowBox[{"B1", ",", 
            RowBox[{
             RowBox[{"RotationMatrix", "[", 
              RowBox[{"\[Theta]", ",", "T0"}], "]"}], ".", "B0"}]}], "]"}]}], 
         ",", "\[Theta]"}], "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.670652667738594*^9, 3.670652842552628*^9}, {
  3.6706528883533087`*^9, 3.670652963603217*^9}, {3.670653037952166*^9, 
  3.6706530495219927`*^9}, {3.67065308325386*^9, 3.670653096359571*^9}, {
  3.670653327126549*^9, 3.670653337471537*^9}, {3.670653371692881*^9, 
  3.670653376774559*^9}},ExpressionUUID->"1883d84c-1579-45d7-bc24-\
87352a867883"],

Cell[BoxData[
 RowBox[{
  RowBox[{"localRotations", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"findLocalRotation", "[", 
      RowBox[{"x", ",", "0.01"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", 
       RowBox[{"1", "-", "0.01"}], ",", "0.01"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670652966335971*^9, 3.670652997688999*^9}, {
  3.670653062143635*^9, 3.670653062863909*^9}, {3.6706531015513277`*^9, 
  3.6706531198221684`*^9}, {3.6706531627579203`*^9, 
  3.6706532278186693`*^9}},ExpressionUUID->"9e1cb4c8-780a-47fc-9042-\
3b4c0266c07e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"accumulatedRotations", "=", 
   RowBox[{"Accumulate", "[", "localRotations", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.670653390502137*^9, 
  3.670653445836005*^9}},ExpressionUUID->"f178f4da-0b00-4f5b-b405-\
a05646da41a6"],

Cell[BoxData[
 RowBox[{"intRotations", "=", 
  RowBox[{"ListInterpolation", "[", 
   RowBox[{"accumulatedRotations", ",", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.670653447305667*^9, 
  3.670653486498242*^9}},ExpressionUUID->"609d7c40-17e1-4b0a-bdb8-\
193528a1bc5a"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "untwistCurve", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"untwistCurve", "[", 
   RowBox[{"alpha_", ",", 
    RowBox[{"{", 
     RowBox[{"\[Rho]_", ",", "\[Phi]_", ",", "z_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"Ti_", ",", "Ni_", ",", "Bi_"}], "}"}], ",", 
    RowBox[{"xint_:", "xint2"}], ",", 
    RowBox[{"yint_:", "yint2"}], ",", 
    RowBox[{"zint_:", "zint2"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x0", ",", "n", ",", "b", ",", "rot"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"x0", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"xint", "[", "z", "]"}], ",", 
        RowBox[{"yint", "[", "z", "]"}], ",", 
        RowBox[{"zint", "[", "z", "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"b", ",", "n"}], "}"}], "=", 
      RowBox[{"FromPolarCoordinates", "[", 
       RowBox[{"{", 
        RowBox[{"\[Rho]", ",", "\[Phi]"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"x0", "+", 
       RowBox[{"b", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"RotationMatrix", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"intRotations", "[", "z", "]"}]}], "alpha"}], ",", 
            "Ti"}], "]"}], ".", 
          RowBox[{"(", 
           RowBox[{"Bi", "/.", 
            RowBox[{"t", "->", "z"}]}], ")"}]}], ")"}]}], "+", 
       RowBox[{"n", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"RotationMatrix", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"intRotations", "[", "z", "]"}]}], "alpha"}], ",", 
            "Ti"}], "]"}], 
          RowBox[{"(", 
           RowBox[{"Ni", "/.", 
            RowBox[{"t", "->", "z"}]}], ")"}]}], ")"}]}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"rot", "=", 
      RowBox[{"RotationMatrix", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "alpha"}], " ", 
         RowBox[{"intRotations", "[", "z", "]"}]}], ",", 
        RowBox[{"(", 
         RowBox[{"Ti", "/.", 
          RowBox[{"t", "\[Rule]", "z"}]}], ")"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"x0", "+", 
      RowBox[{"b", 
       RowBox[{"(", 
        RowBox[{"rot", ".", 
         RowBox[{"(", 
          RowBox[{"Bi", "/.", 
           RowBox[{"t", "\[Rule]", "z"}]}], ")"}]}], ")"}]}], "+", 
      RowBox[{"n", 
       RowBox[{"(", 
        RowBox[{"rot", ".", 
         RowBox[{"(", 
          RowBox[{"Ni", "/.", 
           RowBox[{"t", "\[Rule]", "z"}]}], ")"}]}], ")"}]}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.670653668406418*^9, 3.670653676844726*^9}, {
  3.670653708780542*^9, 3.670653806088893*^9}, {3.670653910548849*^9, 
  3.670654118383088*^9}},ExpressionUUID->"388bc73c-4c9b-41b0-9efc-\
937a9b8f6c44"],

Cell[BoxData[
 RowBox[{"Graphics3D", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Line", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"untwistCurve", "[", 
        RowBox[{"alpha", ",", "#", ",", 
         RowBox[{"{", 
          RowBox[{"Ti", ",", "Ni", ",", "Bi"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"alpha", ",", "0", ",", "1", ",", "0.1"}], "}"}]}], "]"}], 
     "]"}], "&"}], "/@", "ptsCylinder"}], "]"}]], "Input",
 CellChangeTimes->{{3.670654167445711*^9, 3.6706541798922567`*^9}, {
  3.670654248315516*^9, 
  3.670654269122683*^9}},ExpressionUUID->"928be9bb-a0c5-4fe9-8b51-\
381922746e09"],

Cell[BoxData[
 RowBox[{
  RowBox[{"untwistingSequence", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"untwistCurve", "[", 
        RowBox[{"alpha", ",", "#", ",", 
         RowBox[{"{", 
          RowBox[{"Ti", ",", "Ni", ",", "Bi"}], "}"}]}], "]"}], "&"}], "/@", 
      "ptsCylinder"}], ",", 
     RowBox[{"{", 
      RowBox[{"alpha", ",", "0", ",", "1", ",", "0.01"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6706596377165403`*^9, 
  3.6706596885558453`*^9}},ExpressionUUID->"c9883da1-127d-4616-a3bf-\
1573eba46f49"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showNodesTrail", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showNodesTrail", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"centroidLst_:", "pts2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "maxZ", ",", "minZ", ",", "stdCentroids", ",", "n", ",", 
      "finalProjection", ",", "transferFunction", ",", "centroids", ",", 
      "trails"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "\"\<1234\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"centroids", "=", 
      RowBox[{"Last", "[", "centroidLst", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"trails", "=", 
      RowBox[{"dataTransform", "/@", 
       RowBox[{"Transpose", "[", "centroidLst", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"stdCentroids", " ", "=", " ", 
      RowBox[{"dataTransform", "/@", "centroids"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"maxZ", ",", " ", "minZ"}], "}"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Graphics3D", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Opacity", "[", "0.2", "]"}], ",", 
                  RowBox[{"GrayLevel", "[", 
                   RowBox[{"0.5", "+", 
                    RowBox[{"0.2", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"maxZ", "-", "minZ"}], ")"}]}], ")"}]}], 
                    ")"}]}]}], "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{"#", ",", "2.5"}], "]"}], ",", 
                  RowBox[{"Opacity", "[", "1", "]"}], ",", 
                  RowBox[{"GrayLevel", "[", "0.3", "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{"#", ",", "1"}], "]"}]}], "}"}], "&"}], "/@", 
               RowBox[{"(", "stdCentroids", ")"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"AbsoluteThickness", "[", "1.5", "]"}], ",", 
                RowBox[{"GrayLevel", "[", "0.3", "]"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Line", "[", "#", "]"}], "&"}], "/@", "trails"}]}], 
               "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"Lighting", "->", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"ViewPoint", "\[Rule]", "Top"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "85"}], ",", "134"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "38"}], ",", "118"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"101", ",", "228"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "None"}]}], "]"}], ",", 
         RowBox[{"RasterSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", "finalProjection", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "200"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "50"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.670679566295768*^9, 3.670679576485353*^9}, {
  3.670679616213417*^9, 3.6706796922585497`*^9}, {3.670679735498166*^9, 
  3.670679754888548*^9}, {3.6706798129051723`*^9, 3.670679937651681*^9}, {
  3.670679973979554*^9, 3.670680000704935*^9}, {3.670680038544817*^9, 
  3.670680047831208*^9}},ExpressionUUID->"bba3edd9-47f6-4123-ab7b-\
6a5d719d71f7"],

Cell[BoxData[
 RowBox[{"showNodesTrail", "[", 
  RowBox[{"Take", "[", 
   RowBox[{"untwistingSequence", ",", "90"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.670679699288466*^9, 3.670679722896117*^9}, {
  3.6706797616249123`*^9, 3.6706797897101173`*^9}, {3.6706799493070297`*^9, 
  3.670679949704588*^9}, {3.67068000748109*^9, 
  3.670680008375182*^9}},ExpressionUUID->"ec92fd72-319c-44a0-884d-\
bed007de2286"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-4/\
part-2-a/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"t", ",", "10", ",", "4"}], "]"}], "<>", "\"\<.png\>\""}], 
      ",", 
      RowBox[{"showNodesTrail", "[", 
       RowBox[{"Take", "[", 
        RowBox[{"untwistingSequence", ",", "t"}], "]"}], "]"}]}], "]"}], ",", 
    
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "100", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670680253096822*^9, 
  3.6706802766632147`*^9}},ExpressionUUID->"599b4470-20cb-4631-b9cb-\
ac809989e8e3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"startPositions", "=", 
   RowBox[{"Last", "[", "untwistingSequence", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"finalPositions", "=", 
   RowBox[{"computeIntermediateHeartGeometry", "[", 
    RowBox[{"Last", "[", "interpolatedMidlines", "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.670577531030735*^9, 3.670577557246562*^9}, {
  3.6705957900603323`*^9, 3.67059579071119*^9}, {3.670659717636059*^9, 
  3.6706597662787867`*^9}},ExpressionUUID->"3b2cd9c4-4fbc-4a7d-9587-\
bfc4f28f1dde"],

Cell[BoxData[
 RowBox[{
  RowBox[{"displacements", "=", 
   RowBox[{"finalPositions", "-", "startPositions"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.670577561960559*^9, 3.670577613413162*^9}, {
  3.6705777160227118`*^9, 
  3.670577717050075*^9}},ExpressionUUID->"25214a3b-32f2-4d90-bb48-\
134735ef19d2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"straighteningSequence", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"startPositions", "+", 
      RowBox[{"alpha", " ", "displacements"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"alpha", ",", "0", ",", "1", ",", "0.01"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670659768981691*^9, 
  3.6706597985843*^9}},ExpressionUUID->"65f6f823-9b42-4592-aae5-73586172f198"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showNodes", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showNodes", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"centroids_:", "pts2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "maxZ", ",", "minZ", ",", "stdCentroids", ",", "n", ",", 
      "finalProjection", ",", "transferFunction", ",", "trails"}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "\"\<1234\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"stdCentroids", " ", "=", " ", 
      RowBox[{"dataTransform", "/@", "centroids"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"maxZ", ",", " ", "minZ"}], "}"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"Graphics3D", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Opacity", "[", "0.2", "]"}], ",", 
                 RowBox[{"GrayLevel", "[", 
                  RowBox[{"0.5", "+", 
                   RowBox[{"0.2", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"maxZ", "-", "minZ"}], ")"}]}], ")"}]}], 
                    ")"}]}]}], "]"}], ",", 
                 RowBox[{"Sphere", "[", 
                  RowBox[{"#", ",", "2.5"}], "]"}], ",", 
                 RowBox[{"Opacity", "[", "1", "]"}], ",", 
                 RowBox[{"GrayLevel", "[", "0.3", "]"}], ",", 
                 RowBox[{"Sphere", "[", 
                  RowBox[{"#", ",", "1"}], "]"}]}], "}"}], "&"}], "/@", 
              RowBox[{"(", "stdCentroids", ")"}]}], "]"}], 
            "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", 
           RowBox[{"Lighting", "->", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"ViewPoint", "\[Rule]", "Top"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "85"}], ",", "134"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "38"}], ",", "118"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"101", ",", "228"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "None"}]}], "]"}], ",", 
         RowBox[{"RasterSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", "finalProjection", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "200"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "50"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.670680102804528*^9, 3.67068012930226*^9}, 
   3.6706830191492243`*^9},ExpressionUUID->"6cb74f3a-8550-43f6-8ba8-\
61bd86223e49"],

Cell[BoxData[
 RowBox[{"showNodes", "[", 
  RowBox[{"straighteningSequence", "[", 
   RowBox[{"[", "90", "]"}], "]"}], "]"}]], "Input",ExpressionUUID->"8db3e222-\
9413-46ac-ba74-93fcb2ecdd6f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-4/\
part-2-b/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"t", ",", "10", ",", "4"}], "]"}], "<>", "\"\<.png\>\""}], 
      ",", 
      RowBox[{"showNodes", "[", 
       RowBox[{"straighteningSequence", "[", 
        RowBox[{"[", "t", "]"}], "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "100", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670680312147273*^9, 
  3.670680326012377*^9}},ExpressionUUID->"ed5aa493-40e7-49c9-946f-\
c23f289356f0"],

Cell[BoxData[
 RowBox[{"Mean", "[", 
  RowBox[{"First", "/@", "ptsCylinder"}], "]"}]], "Input",
 CellChangeTimes->{{3.6706606579266453`*^9, 
  3.670660663980104*^9}},ExpressionUUID->"c246976a-f815-4083-be9b-\
4fbc956c0900"],

Cell[BoxData[
 RowBox[{
  RowBox[{"finalCylinder", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"35", ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}], "/@", 
    "ptsCylinder"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6706606206017933`*^9, 
  3.6706606713085403`*^9}},ExpressionUUID->"8b5dc112-0143-4710-83be-\
d8e29f34e0ab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"finalPositionsBlowUp", "=", 
   RowBox[{"computeIntermediateHeartGeometry", "[", 
    RowBox[{
     RowBox[{"Last", "[", "interpolatedMidlines", "]"}], ",", 
     "finalCylinder"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.670660612543305*^9, 3.670660614550268*^9}, {
  3.6706606750523043`*^9, 
  3.670660677533257*^9}},ExpressionUUID->"e1ccd0f5-74ca-4bd1-b127-\
72d8c5ea42e5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"startPositions2", "=", 
   RowBox[{"Last", "[", "straighteningSequence", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"finalPositions2", "=", "finalPositionsBlowUp"}], ";"}]}], "Input",
 CellChangeTimes->{{3.670577531030735*^9, 3.670577557246562*^9}, {
  3.6705957900603323`*^9, 3.67059579071119*^9}, {3.670659717636059*^9, 
  3.6706597662787867`*^9}, {3.670660706284568*^9, 
  3.670660719434865*^9}},ExpressionUUID->"dc5fe613-1c31-4567-ac26-\
f753efb090e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"displacements2", "=", 
   RowBox[{"finalPositions2", "-", "startPositions2"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.670577561960559*^9, 3.670577613413162*^9}, {
  3.6705777160227118`*^9, 3.670577717050075*^9}, {3.670660720963282*^9, 
  3.6706607236667624`*^9}},ExpressionUUID->"2498c671-c9c6-4b56-b1f6-\
0bd90459e18c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"blowUpSequence", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"startPositions2", "+", 
      RowBox[{"alpha", " ", "displacements2"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"alpha", ",", "0", ",", "1", ",", "0.01"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670659768981691*^9, 3.6706597985843*^9}, {
  3.670660726802848*^9, 
  3.670660733938422*^9}},ExpressionUUID->"6cf37673-f007-4f3e-ab22-\
f41bf899c75d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-4/\
part-2-b/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{
         RowBox[{"t", "+", "100"}], ",", "10", ",", "4"}], "]"}], "<>", 
       "\"\<.png\>\""}], ",", 
      RowBox[{"showNodes", "[", 
       RowBox[{"blowUpSequence", "[", 
        RowBox[{"[", "t", "]"}], "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "100", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670680312147273*^9, 3.670680326012377*^9}, {
  3.670680356214452*^9, 
  3.67068036761917*^9}},ExpressionUUID->"6b3e880b-4a08-4f26-a3d0-\
1293ce742c7a"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Graphics3D", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Point", "[", 
        RowBox[{"transformToStandardView", "[", "#", "]"}], "]"}], "&"}], "/@", 
      RowBox[{"blowUpSequence", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{"ViewPoint", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "Infinity"}], "}"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "blowUpSequence", "]"}], ",", "1"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.670577820161676*^9, 3.6705778447014427`*^9}, {
  3.670578474860207*^9, 3.670578495722582*^9}, {3.6705793419659367`*^9, 
  3.6705793798681927`*^9}, {3.6705894806336317`*^9, 3.670589480841942*^9}, {
  3.6706598533449907`*^9, 3.670659854744608*^9}, {3.670660750091552*^9, 
  3.6706607532563047`*^9}},ExpressionUUID->"d0dff843-b422-465c-8e63-\
3d1eadc222d3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Min", "[", "#", "]"}], ",", 
     RowBox[{"Max", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
  RowBox[{"Transpose", "[", "finalPositionsBlowUp", "]"}]}]], "Input",
 CellChangeTimes->{{3.670677304761421*^9, 
  3.670677326878892*^9}},ExpressionUUID->"01a167f2-79f0-4169-af00-\
82ecf24ff464"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-3/\
part-4-alt/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"t", ",", "10", ",", "4"}], "]"}], "<>", "\"\<.png\>\""}], 
      ",", 
      RowBox[{"showNodes", "[", "t", "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "207", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670659604799827*^9, 
  3.670659627598448*^9}},ExpressionUUID->"95fc3974-1319-4ac3-b362-\
9fb74a8ee576"],

Cell[BoxData[
 RowBox[{
  RowBox[{"testCylPts", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "+", "\[Pi]"}], ",", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "*", 
        RowBox[{"-", "5"}]}]}], "}"}], "&"}], "/@", "ptsCylinder"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670676385379427*^9, 3.6706764379144487`*^9}, {
   3.6706767279147587`*^9, 3.670676728024674*^9}, 3.670676804782564*^9, 
   3.670676890219676*^9, 3.6706769218027277`*^9, {3.670677388808144*^9, 
   3.6706773892353077`*^9}, {3.670677435498369*^9, 3.670677435665737*^9}, {
   3.6706774667291603`*^9, 
   3.670677472577305*^9}},ExpressionUUID->"b3cf07d0-8e7b-4525-8976-\
3a3eefac2969"],

Cell[BoxData[
 RowBox[{
  RowBox[{"unroll", "[", 
   RowBox[{"\[Phi]_", ",", 
    RowBox[{"{", 
     RowBox[{"r_", ",", "\[Theta]_", ",", "z_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Piecewise", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"z", ",", 
         RowBox[{
          RowBox[{"2", " ", "\[Pi]"}], "-", "\[Phi]", "-", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]", "-", "\[Phi]"}], "]"}]}], ",", 
         RowBox[{"-", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]", "-", "\[Phi]"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"\[Phi]", "\[LessEqual]", "\[Theta]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"z", ",", 
         RowBox[{
          RowBox[{"2", " ", "\[Pi]"}], "-", "\[Theta]"}], ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"\[Phi]", ">", "\[Theta]"}]}], "}"}]}], "}"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6706761560762463`*^9, 
  3.670676230656538*^9}},ExpressionUUID->"33d87854-522e-46e3-97d9-\
a6b13ae5c757"],

Cell[BoxData[
 RowBox[{
  RowBox[{"unrollingSequence", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"unroll", "[", 
        RowBox[{
         RowBox[{"2", "\[Pi]", " ", "t"}], ",", "#"}], "]"}], "&"}], "/@", 
      "testCylPts"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "1", ",", "0.01"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670677602364678*^9, 
  3.670677660034585*^9}},ExpressionUUID->"3ea1311e-0e63-466f-8e03-\
2d18d0a45d12"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showNodesUnrolling", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showNodesUnrolling", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"centroids_:", "pts2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "maxZ", ",", "minZ", ",", "stdCentroids", ",", "n", ",", 
      "finalProjection", ",", "transferFunction"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "\"\<1234\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"stdCentroids", " ", "=", " ", "centroids"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"maxZ", ",", " ", "minZ"}], "}"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Graphics3D", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Opacity", "[", "0.2", "]"}], ",", 
                  RowBox[{"GrayLevel", "[", 
                   RowBox[{"0.5", "+", 
                    RowBox[{"0.2", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"maxZ", "-", "minZ"}], ")"}]}], ")"}]}], 
                    ")"}]}]}], "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{"#", ",", "0.07"}], "]"}], ",", 
                  RowBox[{"Opacity", "[", "1", "]"}], ",", 
                  RowBox[{"GrayLevel", "[", "0.3", "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{"#", ",", "0.03"}], "]"}]}], "}"}], "&"}], "/@", 
               RowBox[{"(", "stdCentroids", ")"}]}], "]"}], ",", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "\[Pi]", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "5.2"}], ",", "\[Pi]", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], "]"}], ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"2", "\[Pi]"}], ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], "]"}]}], "}"}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<\[Phi]\>\"", ",", "Bold", ",", "32", ",", 
                  RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
                 "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0.2", ",", 
                  RowBox[{"2", "\[Pi]"}], ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}], ",", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<\[Tau]\>\"", ",", "Bold", ",", "32", ",", 
                  RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
                 "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "5.4"}], ",", "\[Pi]", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], 
            "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", 
           RowBox[{"Lighting", "->", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "5.2"}], ",", "0.2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "0.2"}], ",", "8.2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1.2"}], ",", "1.2"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "None"}]}], "]"}], ",", 
         RowBox[{"RasterSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", "finalProjection", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "200"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "50"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.67067773300272*^9, 3.670677861756619*^9}, {
  3.670677906998221*^9, 3.670677910059761*^9}, {3.670677943172559*^9, 
  3.6706779659699574`*^9}, {3.6706780201531067`*^9, 3.670678046577499*^9}, {
  3.6706781288523693`*^9, 3.6706781800424337`*^9}, {3.670678210756214*^9, 
  3.67067824833885*^9}, {3.670679017337426*^9, 3.6706790175625563`*^9}, {
  3.6707760340509357`*^9, 3.6707761811541567`*^9}, {3.670776254330929*^9, 
  3.670776256551668*^9}, {3.6707763236332397`*^9, 
  3.6707763247896852`*^9}},ExpressionUUID->"48aa82d4-15c9-47dd-8f3d-\
0351e5405cc6"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showNodesUnrollingFinal", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showNodesUnrollingFinal", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"centroids_:", "pts2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "maxZ", ",", "minZ", ",", "stdCentroids", ",", "n", ",", 
      "finalProjection", ",", "transferFunction"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "\"\<1234\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"stdCentroids", " ", "=", " ", "centroids"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"maxZ", ",", " ", "minZ"}], "}"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Graphics3D", "[", 
              RowBox[{"MapIndexed", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"brewerDiv", "[", 
                    RowBox[{
                    RowBox[{"dspeeds", "[", 
                    RowBox[{"[", 
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "/", 
                    "maxDelay"}], "]"}], ",", 
                   RowBox[{"Sphere", "[", 
                    RowBox[{"#1", ",", ".07"}], "]"}]}], "}"}], "&"}], ",", 
                RowBox[{"(", "stdCentroids", ")"}]}], "]"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "\[Pi]", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "5.2"}], ",", "\[Pi]", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], "]"}], ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"2", "\[Pi]"}], ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], "]"}]}], "}"}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<\[Phi]\>\"", ",", "Bold", ",", "32", ",", 
                  RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
                 "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0.2", ",", 
                  RowBox[{"2", "\[Pi]"}], ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}], ",", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<\[Tau]\>\"", ",", "Bold", ",", "32", ",", 
                  RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
                 "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "5.4"}], ",", "\[Pi]", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], 
            "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", 
           RowBox[{"Lighting", "->", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "5.2"}], ",", "0.2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "0.2"}], ",", "8.2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1.2"}], ",", "1.2"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "None"}]}], "]"}], ",", 
         RowBox[{"RasterSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"finalProjection", ",", 
         RowBox[{"Graphics", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Inset", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Show", "[", 
               RowBox[{
                RowBox[{"{", "colorscale", "}"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "80"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"120", ",", "50"}], "}"}]}], "]"}], ",", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<min\>\"", ",", "10", ",", 
                RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
               "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"70", ",", "30"}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<max\>\"", ",", "10", ",", 
                RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
               "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"170", ",", "30"}], "}"}]}], "]"}]}], "}"}], "]"}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "200"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "50"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.6706782773372107`*^9, 3.6706783370585003`*^9}, {
  3.670678391117787*^9, 3.670678431795196*^9}, {3.670678462622322*^9, 
  3.670678469995364*^9}, {3.67067853760069*^9, 3.670678563808647*^9}, {
  3.6706786050634527`*^9, 3.670678612189555*^9}, {3.670678654443651*^9, 
  3.670678675763212*^9}, {3.670678718818304*^9, 3.67067878783911*^9}, {
  3.670678825048061*^9, 3.670678960050521*^9}, {3.6707735900955343`*^9, 
  3.670773593757457*^9}, {3.670773648720449*^9, 3.670773703154313*^9}, {
  3.670773737844263*^9, 3.670773748849936*^9}, {3.670774018628251*^9, 
  3.670774103502471*^9}, {3.6707741984784184`*^9, 3.6707742232508287`*^9}, {
  3.6707742671306963`*^9, 3.6707744147495127`*^9}, {3.670776269914693*^9, 
  3.67077627189544*^9}, {3.670776312641651*^9, 
  3.6707763139024982`*^9}},ExpressionUUID->"3fe7df1f-6689-464b-9e25-\
e2dd1e71ab5e"],

Cell[BoxData[
 RowBox[{"colorscale", "=", 
  RowBox[{"Image", "[", 
   RowBox[{"MatrixPlot", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ConstantArray", "[", 
         RowBox[{"i", ",", "4"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "1", ",", "0.01"}], "}"}]}], "]"}], 
      "]"}], ",", 
     RowBox[{"ColorFunction", "\[Rule]", "brewerDiv"}], ",", 
     RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
     RowBox[{"Axes", "\[Rule]", "False"}], ",", 
     RowBox[{"Frame", "\[Rule]", "False"}], ",", 
     RowBox[{"PlotRangePadding", "\[Rule]", "None"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.670773826177229*^9, 3.670774005951931*^9}, {
  3.670774180931897*^9, 
  3.670774209537972*^9}},ExpressionUUID->"04a72d52-59c0-49e6-b9db-\
9d14a9c6d3c5"],

Cell[BoxData[
 RowBox[{"showNodesUnrolling", "[", 
  RowBox[{"unrollingSequence", "[", 
   RowBox[{"[", "20", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.670775971902285*^9, 
  3.670775972366226*^9}},ExpressionUUID->"83c6704b-007f-499e-b64b-\
f40b53f6deea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-4/\
part-3/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"t", ",", "10", ",", "4"}], "]"}], "<>", "\"\<.png\>\""}], 
      ",", 
      RowBox[{"showNodesUnrolling", "[", 
       RowBox[{"unrollingSequence", "[", 
        RowBox[{"[", "t", "]"}], "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "100", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670679085334559*^9, 
  3.67067913394716*^9}},ExpressionUUID->"deffc191-43ec-4e94-8526-\
c62a3f47e48f"],

Cell[BoxData[
 RowBox[{"showNodesUnrollingFinal", "[", 
  RowBox[{"unrollingSequence", "[", 
   RowBox[{"[", "100", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6706783490444813`*^9, 3.670678360709469*^9}, {
   3.670678582711277*^9, 3.670678595244526*^9}, 3.670678627253779*^9, 
   3.670678692378819*^9, {3.670678971995027*^9, 3.670678972136321*^9}, {
   3.670679027199538*^9, 
   3.670679028038682*^9}},ExpressionUUID->"34ac6c6d-f307-4a34-8ca3-\
27ccd15884eb"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{
   "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-4/part-\
3-color/\>\"", "<>", 
    RowBox[{"IntegerString", "[", 
     RowBox[{"100", ",", "10", ",", "4"}], "]"}], "<>", "\"\<.png\>\""}], ",", 
   RowBox[{"showNodesUnrollingFinal", "[", 
    RowBox[{"unrollingSequence", "[", 
     RowBox[{"[", "100", "]"}], "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.67077444919633*^9, 
  3.670774451907034*^9}},ExpressionUUID->"55ffdee6-311e-433f-ace7-\
649dde0a7766"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-4/\
part-3-color/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"t", ",", "10", ",", "4"}], "]"}], "<>", "\"\<.png\>\""}], 
      ",", 
      RowBox[{"showNodesUnrollingFinal", "[", 
       RowBox[{"unrollingSequence", "[", 
        RowBox[{"[", "t", "]"}], "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "100", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670679168490752*^9, 
  3.670679176793675*^9}},ExpressionUUID->"4fc172b3-9679-4586-8004-\
7d38470071b7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["solving the Frenet-Serret equations", "Subsubsection",
 CellChangeTimes->{{3.670725684202384*^9, 
  3.6707257013338003`*^9}},ExpressionUUID->"7b035c10-7391-4d4a-af26-\
1e0358717fd2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xmin", ",", "xmax"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ymin", ",", "ymax"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"zmin", ",", "zmax"}], "}"}]}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Min", "[", "#", "]"}], ",", 
       RowBox[{"Max", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
    RowBox[{"Transpose", "[", "pts2", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ctrlPts", "=", 
   RowBox[{"Import", "[", "mline", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"xi", ",", "yi", ",", "zi"}], "}"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"BSplineFunction", "[", 
       RowBox[{"#", ",", 
        RowBox[{"SplineDegree", "\[Rule]", "4"}]}], "]"}], "&"}], "/@", 
     RowBox[{"Transpose", "[", "ctrlPts", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "s", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s", "[", "x_", "]"}], ":=", 
  RowBox[{"NIntegrate", "[", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xi", "'"}], "[", "t0", "]"}], ")"}], "^", "2"}], " ", "+", 
      " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"yi", "'"}], "[", "t0", "]"}], ")"}], "^", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"zi", "'"}], "[", "t0", "]"}], ")"}], "^", "2"}]}], "]"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"t0", ",", "0", ",", "x"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.657264228489072*^9, 3.657264262224662*^9}, 
   3.6584837573919783`*^9, {3.670306966055604*^9, 
   3.6703069825459642`*^9}},ExpressionUUID->"96aa97b7-8e13-4250-a421-\
efb3cc49f900"],

Cell[BoxData[
 RowBox[{"smin", "=", 
  RowBox[{"s", "[", "0", "]"}]}]], "Input",
 CellChangeTimes->{{3.657532910691523*^9, 
  3.657532913820859*^9}},ExpressionUUID->"9c051a19-b748-4919-8e8d-\
155f6b5425c6"],

Cell[BoxData[
 RowBox[{"smax", " ", "=", " ", 
  RowBox[{
   RowBox[{"s", "[", "1.", "]"}], "-", "0.001"}]}]], "Input",
 CellChangeTimes->{{3.657532915647379*^9, 3.6575329184857597`*^9}, 
   3.6581423917168913`*^9, {3.658142551112506*^9, 
   3.6581425537602367`*^9}},ExpressionUUID->"beed03dd-ad1c-4e3a-aff8-\
f9183e29a212"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ipol", "=", 
   RowBox[{"ListInterpolation", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "t", "}"}], ",", 
        RowBox[{"s", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "0", ",", "1", ",", "0.05"}], "}"}]}], "]"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.657345818128326*^9, 3.657345841485382*^9}, {
   3.6573459420897284`*^9, 3.657345965124411*^9}, {3.657346041760828*^9, 
   3.657346060879562*^9}, 
   3.657532791982586*^9},ExpressionUUID->"526c782b-570b-4ce6-811a-\
113c945cec23"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "tp", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tp", "[", "s_", "]"}], ":=", 
  RowBox[{
   RowBox[{"InverseFunction", "[", "ipol", "]"}], "[", "s", "]"}]}]}], "Input",\

 CellChangeTimes->{{3.6573460636659203`*^9, 3.657346093806614*^9}, {
  3.6581419849927588`*^9, 3.65814198774489*^9}, {3.670726349379245*^9, 
  3.670726353081375*^9}},ExpressionUUID->"83a4e186-7a32-411b-9eec-\
63be3b9642df"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "xint", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xint", "[", "s_", "]"}], ":=", 
  RowBox[{"Chop", "[", 
   RowBox[{"xi", "[", 
    RowBox[{"tp", "[", "s", "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "yint", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yint", "[", "s_", "]"}], ":=", 
  RowBox[{"Chop", "[", 
   RowBox[{"yi", "[", 
    RowBox[{"tp", "[", "s", "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "zint", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zint", "[", "s_", "]"}], ":=", 
  RowBox[{"Chop", "[", 
   RowBox[{"zi", "[", 
    RowBox[{"tp", "[", "s", "]"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.657532795491921*^9, 3.657532846916621*^9}, {
  3.657532985285966*^9, 3.657532987001934*^9}, {3.657533020441791*^9, 
  3.65753303592013*^9}, {3.6575330948184137`*^9, 3.657533124107502*^9}, {
  3.670726356474152*^9, 3.670726362112317*^9}, {3.6707268910411987`*^9, 
  3.670726895119443*^9}},ExpressionUUID->"dd71bf3c-39af-4240-9185-\
a5203e3e863e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Kappa]0", ",", "\[Tau]0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Ti0", ",", "Ni0", ",", "Bi0"}], "}"}]}], "}"}], " ", "=", 
   RowBox[{"FrenetSerretSystem", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xint", "[", "t", "]"}], ",", 
       RowBox[{"yint", "[", "t", "]"}], ",", 
       RowBox[{"zint", "[", "t", "]"}]}], "}"}], ",", "t"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670726141489395*^9, 
  3.670726160359025*^9}},ExpressionUUID->"1f4b2a13-9d82-4221-a015-\
0ae23e1f4c07"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "r", ",", "s", ",", "t", ",", "n", ",", "b", ",", "\[Kappa]", ",", 
    "\[Tau]", ",", "r0", ",", "t0", ",", "n0", ",", "b0"}], "]"}], 
  ";"}]], "Input",ExpressionUUID->"65368441-d6e5-4430-8925-45e20d1ef59f"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"\[Kappa]", ",", "\[Tau]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Kappa]", "[", "s_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{"\[Kappa]0", "/.", 
     RowBox[{"(", 
      RowBox[{"t", "\[Rule]", "s"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Tau]", "[", "s_", "]"}], ":=", 
   RowBox[{"\[Tau]0", "/.", 
    RowBox[{"(", 
     RowBox[{"t", "\[Rule]", "s"}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.67072617197198*^9, 3.670726185999049*^9}, {
   3.670726216545053*^9, 3.670726232911861*^9}, {3.6707262942611856`*^9, 
   3.670726320090952*^9}, {3.670726421080755*^9, 3.670726432177107*^9}, {
   3.6707298115822763`*^9, 3.6707298141711483`*^9}, {3.6707330684128723`*^9, 
   3.670733076669704*^9}, 
   3.6707331415704203`*^9},ExpressionUUID->"49ab81d9-89c3-40cd-868d-\
f3463a3311cb"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"t0", ",", "n0", ",", "b0"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"t0", ",", "n0", ",", "b0"}], "}"}], "=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Ti", ",", "Ni", ",", "Bi"}], "}"}], "/.", 
   RowBox[{"t", "\[Rule]", "0"}]}]}]}], "Input",
 CellChangeTimes->{{3.6707269723627787`*^9, 3.670727002685224*^9}, {
  3.670731739811378*^9, 3.670731742027259*^9}, {3.670733078523773*^9, 
  3.670733085075445*^9}},ExpressionUUID->"e94c1b53-a8fe-46ed-8cf1-\
3e225d9b60f1"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "r0", "]"}], "\[IndentingNewLine]", 
 RowBox[{"r0", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"xint", "[", "0", "]"}], ",", 
    RowBox[{"yint", "[", "0", "]"}], ",", 
    RowBox[{"zint", "[", "0", "]"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.6707270137803392`*^9, 3.670727029851408*^9}, {
  3.670733097475074*^9, 
  3.670733097988418*^9}},ExpressionUUID->"cb11675a-08a5-4489-9cfb-\
f49a4062f72b"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "t", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"eqns", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"t", "'"}], "[", "s", "]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"\[Kappa]", "[", "s", "]"}], " ", 
        RowBox[{"n", "[", "s", "]"}]}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"n", "'"}], "[", "s", "]"}], "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"\[Kappa]", "[", "s", "]"}]}], " ", 
         RowBox[{"t", "[", "s", "]"}]}], "+", 
        RowBox[{
         RowBox[{"\[Tau]", "[", "s", "]"}], " ", 
         RowBox[{"b", "[", "s", "]"}]}]}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"b", "'"}], "[", "s", "]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[Tau]", "[", "s", "]"}]}], " ", 
        RowBox[{"n", "[", "s", "]"}]}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"r", "'"}], "[", "s", "]"}], "\[Equal]", 
       RowBox[{"t", "[", "s", "]"}]}], ",", 
      RowBox[{
       RowBox[{"t", "[", "0", "]"}], "\[Equal]", "t0"}], ",", 
      RowBox[{
       RowBox[{"n", "[", "0", "]"}], "\[Equal]", "n0"}], ",", 
      RowBox[{
       RowBox[{"b", "[", "0", "]"}], "\[Equal]", "b0"}], ",", 
      RowBox[{
       RowBox[{"r", "[", "0", "]"}], "\[Equal]", "r0"}]}], "}"}]}], ";"}], 
  "\n", "\n"}], "\n", 
 RowBox[{
  RowBox[{"sol", "=", 
   RowBox[{"First", "@", 
    RowBox[{"NDSolve", "[", 
     RowBox[{"eqns", ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", "t", ",", "n", ",", "b"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"s", ",", "0", ",", "249"}], "}"}]}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.670725702532131*^9, 3.6707257025725718`*^9}, {
   3.6707264097493258`*^9, 3.670726439622849*^9}, 3.6707265167903023`*^9, {
   3.670726936352687*^9, 3.670726937486918*^9}, 3.6707270112060013`*^9, {
   3.670727098413224*^9, 3.6707271003222857`*^9}, {3.6707271691866503`*^9, 
   3.67072718333039*^9}, {3.670733120925274*^9, 
   3.670733124931184*^9}},ExpressionUUID->"d9d1ac22-89e6-4c76-a981-\
b4b7834511a3"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "removeTorsion", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"removeTorsion", "[", "alpha_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Kappa]", ",", "\[Tau]", ",", "t0", ",", "n0", ",", "b0", ",", "r0", 
      ",", "eqns", ",", "sol"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Kappa]", "[", "s_", "]"}], ":=", 
      RowBox[{"(", 
       RowBox[{"\[Kappa]0", "/.", 
        RowBox[{"(", 
         RowBox[{"t", "\[Rule]", "s"}], ")"}]}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Tau]", "[", "s_", "]"}], ":=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "alpha"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"\[Tau]0", "/.", 
         RowBox[{"(", 
          RowBox[{"t", "\[Rule]", "s"}], ")"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t0", ",", "n0", ",", "b0"}], "}"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Ti", ",", "Ni", ",", "Bi"}], "}"}], "/.", 
       RowBox[{"t", "\[Rule]", "0"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r0", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"xint", "[", "0", "]"}], ",", 
        RowBox[{"yint", "[", "0", "]"}], ",", 
        RowBox[{"zint", "[", "0", "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"eqns", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"t", "'"}], "[", "s", "]"}], "\[Equal]", 
         RowBox[{
          RowBox[{"\[Kappa]", "[", "s", "]"}], " ", 
          RowBox[{"n", "[", "s", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"n", "'"}], "[", "s", "]"}], "\[Equal]", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"\[Kappa]", "[", "s", "]"}]}], " ", 
           RowBox[{"t", "[", "s", "]"}]}], "+", 
          RowBox[{
           RowBox[{"\[Tau]", "[", "s", "]"}], " ", 
           RowBox[{"b", "[", "s", "]"}]}]}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"b", "'"}], "[", "s", "]"}], "\[Equal]", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"\[Tau]", "[", "s", "]"}]}], " ", 
          RowBox[{"n", "[", "s", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"r", "'"}], "[", "s", "]"}], "\[Equal]", 
         RowBox[{"t", "[", "s", "]"}]}], ",", 
        RowBox[{
         RowBox[{"t", "[", "0", "]"}], "\[Equal]", "t0"}], ",", 
        RowBox[{
         RowBox[{"n", "[", "0", "]"}], "\[Equal]", "n0"}], ",", 
        RowBox[{
         RowBox[{"b", "[", "0", "]"}], "\[Equal]", "b0"}], ",", 
        RowBox[{
         RowBox[{"r", "[", "0", "]"}], "\[Equal]", "r0"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sol", "=", 
      RowBox[{"First", "@", 
       RowBox[{"NDSolve", "[", 
        RowBox[{"eqns", ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "t", ",", "n", ",", "b"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "0", ",", "249"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"r", "/.", "sol"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6707332254716473`*^9, 3.670733372732245*^9}, {
  3.670733615134295*^9, 
  3.67073362012488*^9}},ExpressionUUID->"c9024fba-84dc-48ac-b0b6-\
0eb4d24a7e3b"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "removeCurvature", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"removeCurvature", "[", "alpha_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Kappa]", ",", "\[Tau]", ",", "t0", ",", "n0", ",", "b0", ",", "r0", 
      ",", "eqns", ",", "sol"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Kappa]", "[", "s_", "]"}], ":=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "alpha"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"\[Kappa]0", "/.", 
         RowBox[{"(", 
          RowBox[{"t", "\[Rule]", "s"}], ")"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Tau]", "[", "s_", "]"}], ":=", 
      RowBox[{
       RowBox[{"(", "0.05", ")"}], 
       RowBox[{"(", 
        RowBox[{"\[Tau]0", "/.", 
         RowBox[{"(", 
          RowBox[{"t", "\[Rule]", "s"}], ")"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t0", ",", "n0", ",", "b0"}], "}"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Ti", ",", "Ni", ",", "Bi"}], "}"}], "/.", 
       RowBox[{"t", "\[Rule]", "0"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r0", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"xint", "[", "0", "]"}], ",", 
        RowBox[{"yint", "[", "0", "]"}], ",", 
        RowBox[{"zint", "[", "0", "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"eqns", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"t", "'"}], "[", "s", "]"}], "\[Equal]", 
         RowBox[{
          RowBox[{"\[Kappa]", "[", "s", "]"}], " ", 
          RowBox[{"n", "[", "s", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"n", "'"}], "[", "s", "]"}], "\[Equal]", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"\[Kappa]", "[", "s", "]"}]}], " ", 
           RowBox[{"t", "[", "s", "]"}]}], "+", 
          RowBox[{
           RowBox[{"\[Tau]", "[", "s", "]"}], " ", 
           RowBox[{"b", "[", "s", "]"}]}]}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"b", "'"}], "[", "s", "]"}], "\[Equal]", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"\[Tau]", "[", "s", "]"}]}], " ", 
          RowBox[{"n", "[", "s", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"r", "'"}], "[", "s", "]"}], "\[Equal]", 
         RowBox[{"t", "[", "s", "]"}]}], ",", 
        RowBox[{
         RowBox[{"t", "[", "0", "]"}], "\[Equal]", "t0"}], ",", 
        RowBox[{
         RowBox[{"n", "[", "0", "]"}], "\[Equal]", "n0"}], ",", 
        RowBox[{
         RowBox[{"b", "[", "0", "]"}], "\[Equal]", "b0"}], ",", 
        RowBox[{
         RowBox[{"r", "[", "0", "]"}], "\[Equal]", "r0"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sol", "=", 
      RowBox[{"First", "@", 
       RowBox[{"NDSolve", "[", 
        RowBox[{"eqns", ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "t", ",", "n", ",", "b"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "0", ",", "249"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"r", "/.", "sol"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",\

 CellChangeTimes->{{3.670734050006229*^9, 
  3.670734077605364*^9}},ExpressionUUID->"0a5bdabb-9b08-478e-bd33-\
c9ea20e2bac5"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "removeCurvatureTurn", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"removeCurvatureTurn", "[", 
   RowBox[{"alpha_", ",", 
    RowBox[{"angle_:", "angle"}], ",", 
    RowBox[{"axis_:", "rotVector"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Kappa]", ",", "\[Tau]", ",", "t0", ",", "n0", ",", "b0", ",", "r0", 
      ",", "eqns", ",", "sol"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Kappa]", "[", "s_", "]"}], ":=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "alpha"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"\[Kappa]0", "/.", 
         RowBox[{"(", 
          RowBox[{"t", "\[Rule]", "s"}], ")"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Tau]", "[", "s_", "]"}], ":=", 
      RowBox[{
       RowBox[{"(", "0.05", ")"}], 
       RowBox[{"(", 
        RowBox[{"\[Tau]0", "/.", 
         RowBox[{"(", 
          RowBox[{"t", "\[Rule]", "s"}], ")"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t0", ",", "n0", ",", "b0"}], "}"}], "=", 
      RowBox[{
       RowBox[{"RotationMatrix", "[", 
        RowBox[{
         RowBox[{"alpha", " ", "angle"}], ",", "axis"}], "]"}], ".", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Ti", ",", "Ni", ",", "Bi"}], "}"}], "/.", 
         RowBox[{"t", "\[Rule]", "0"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"r0", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"xint", "[", "0", "]"}], ",", 
        RowBox[{"yint", "[", "0", "]"}], ",", 
        RowBox[{"zint", "[", "0", "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"eqns", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"t", "'"}], "[", "s", "]"}], "\[Equal]", 
         RowBox[{
          RowBox[{"\[Kappa]", "[", "s", "]"}], " ", 
          RowBox[{"n", "[", "s", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"n", "'"}], "[", "s", "]"}], "\[Equal]", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"\[Kappa]", "[", "s", "]"}]}], " ", 
           RowBox[{"t", "[", "s", "]"}]}], "+", 
          RowBox[{
           RowBox[{"\[Tau]", "[", "s", "]"}], " ", 
           RowBox[{"b", "[", "s", "]"}]}]}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"b", "'"}], "[", "s", "]"}], "\[Equal]", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"\[Tau]", "[", "s", "]"}]}], " ", 
          RowBox[{"n", "[", "s", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"r", "'"}], "[", "s", "]"}], "\[Equal]", 
         RowBox[{"t", "[", "s", "]"}]}], ",", 
        RowBox[{
         RowBox[{"t", "[", "0", "]"}], "\[Equal]", "t0"}], ",", 
        RowBox[{
         RowBox[{"n", "[", "0", "]"}], "\[Equal]", "n0"}], ",", 
        RowBox[{
         RowBox[{"b", "[", "0", "]"}], "\[Equal]", "b0"}], ",", 
        RowBox[{
         RowBox[{"r", "[", "0", "]"}], "\[Equal]", "r0"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sol", "=", 
      RowBox[{"First", "@", 
       RowBox[{"NDSolve", "[", 
        RowBox[{"eqns", ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "t", ",", "n", ",", "b"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "0", ",", "249"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"r", "/.", "sol"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",\

 CellChangeTimes->{{3.670752976425336*^9, 3.670752979223507*^9}, {
  3.670753364244713*^9, 3.670753378012005*^9}, {3.6707534172671633`*^9, 
  3.670753432164103*^9}, {3.670770390026923*^9, 3.6707704053851757`*^9}, {
  3.670770619868084*^9, 
  3.67077062065923*^9}},ExpressionUUID->"a79385b2-e4fb-40a2-ba53-\
e71cebf30531"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rotationAxis", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rotationAngle", "=", 
   RowBox[{"8", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Pi]", "/", "2"}], ")"}], "/", "9"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.670753305890916*^9, 3.6707533602615347`*^9}, {
   3.670753400420825*^9, 3.6707534026263533`*^9}, 3.6707534482192707`*^9, {
   3.670754008128722*^9, 3.6707540103204412`*^9}, {3.670754079271901*^9, 
   3.670754080750554*^9}},ExpressionUUID->"a917adb6-98df-4c57-87e6-\
9a84a8e13384"],

Cell[BoxData[
 RowBox[{"rotVector", "=", 
  RowBox[{"Cross", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"transformToStandardView", "@", "t0"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.670770071993154*^9, 3.670770090225*^9}, {
   3.6707701259200773`*^9, 3.670770154727002*^9}, 
   3.67077029014132*^9},ExpressionUUID->"80496866-1143-4a20-8975-\
4d2960a5b45f"],

Cell[BoxData[
 RowBox[{"angle", "=", 
  RowBox[{"VectorAngle", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"transformToStandardView", "@", "t0"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.670770156311062*^9, 3.670770169538775*^9}, 
   3.6707702949555693`*^9},ExpressionUUID->"10fcbd94-2946-4e77-95d8-\
d6c356b590d3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"test", "=", 
   RowBox[{"removeCurvatureTurn", "[", 
    RowBox[{"0.5", ",", "angle", ",", "rotVector"}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.670753459655388*^9, 3.670753491175664*^9}, {
  3.670753965186593*^9, 3.670753969745701*^9}, {3.670754034442194*^9, 
  3.670754039991611*^9}, {3.670754102328373*^9, 3.670754104269245*^9}, {
  3.670770440183793*^9, 3.670770447353423*^9}, {3.670770529462317*^9, 
  3.67077055174988*^9}, {3.670770590642864*^9, 3.670770590922184*^9}, {
  3.670770639881605*^9, 
  3.670770663176379*^9}},ExpressionUUID->"894c0b1c-ec2a-43f3-ba81-\
01668a03301d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"inerTest", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"BSplineFunction", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"#", "[", "s", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "0", ",", "smax", ",", "0.5"}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"SplineDegree", "\[Rule]", "4"}]}], "]"}], "&"}], "@", 
    "test"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.670753559719433*^9, 
  3.6707535682931843`*^9}},ExpressionUUID->"ac6ff5a1-67f3-4962-8569-\
3c5b937983bd"],

Cell[BoxData[
 RowBox[{"Graphics3D", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Point", "[", 
       RowBox[{"transformToStandardView", "[", "#", "]"}], "]"}], "&"}], "/@", 
     RowBox[{"computeIntermediateHeartGeometry", "[", "inerTest", "]"}]}], 
    "}"}], ",", 
   RowBox[{"ViewPoint", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "2"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.67075348585575*^9, 
  3.670753589820826*^9}},ExpressionUUID->"9d2bc847-edb4-4ff4-924c-\
4c0d0ac3a281"],

Cell[BoxData[
 RowBox[{"rot1", "=", 
  RowBox[{"RotationMatrix", "[", 
   RowBox[{
    RowBox[{"-", "angle"}], ",", "rotVector"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.670768844882782*^9, 3.670768881089777*^9}, {
   3.6707689195045567`*^9, 3.670768919760661*^9}, {3.670768955968214*^9, 
   3.6707689923427887`*^9}, {3.670769352124323*^9, 3.670769360627851*^9}, {
   3.6707694556027813`*^9, 3.670769455904893*^9}, {3.6707701808888683`*^9, 
   3.67077018941813*^9}, 
   3.670770310291593*^9},ExpressionUUID->"1124c974-58e1-4c09-98a9-\
d5e766b4f32e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"t1", ",", "n1", ",", "b1"}], "}"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"rot1", ".", 
     RowBox[{"(", 
      RowBox[{"transformToStandardView", "[", "#", "]"}], ")"}]}], "&"}], "/@", 
   RowBox[{"{", 
    RowBox[{"t0", ",", "n0", ",", "b0"}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.67077023599582*^9, 
  3.670770266899867*^9}},ExpressionUUID->"9e1e64a0-9953-4c48-bfaa-\
9539e5f809ae"],

Cell[BoxData[
 RowBox[{
  RowBox[{"intermediateLines", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"removeTorsion", "[", "alpha", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"alpha", ",", "0", ",", "0.99", ",", "0.01"}], "}"}]}], "]"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.670733379305916*^9, 3.6707334212250967`*^9}, {
  3.67073362477914*^9, 3.670733634490131*^9}, {3.670734516612916*^9, 
  3.6707345222141523`*^9}},ExpressionUUID->"4e4ab014-0bff-41f3-b260-\
80b36bc64551"],

Cell[BoxData[
 RowBox[{
  RowBox[{"intermediateLines2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"removeCurvature", "[", "alpha", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"alpha", ",", "0", ",", "0.99", ",", "0.01"}], "}"}]}], "]"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.670734093540894*^9, 3.670734099393105*^9}, {
  3.670734519765397*^9, 
  3.6707345254959593`*^9}},ExpressionUUID->"f6920d74-e0c2-4a08-8b1a-\
720e9c9f8c43"],

Cell[BoxData[
 RowBox[{
  RowBox[{"intermediateLines2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"removeCurvatureTurn", "[", 
      RowBox[{"alpha", ",", "angle", ",", "rotVector"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"alpha", ",", "0", ",", "0.99", ",", "0.01"}], "}"}]}], "]"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.6707704858213263`*^9, 
  3.670770495925254*^9}},ExpressionUUID->"936b9a4d-4aa8-439b-80c5-\
853c6b554428"],

Cell[BoxData[
 RowBox[{
  RowBox[{"interpolatedMidlines", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"BSplineFunction", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"#", "[", "s", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "0", ",", "smax", ",", "0.5"}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"SplineDegree", "\[Rule]", "4"}]}], "]"}], "&"}], "/@", 
    "intermediateLines"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6707335187986794`*^9, 
  3.670733547692766*^9}},ExpressionUUID->"d0c2396e-5483-4884-903b-\
91339770d3ee"],

Cell[BoxData[
 RowBox[{
  RowBox[{"interpolatedMidlines2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"BSplineFunction", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"#", "[", "s", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "0", ",", "smax", ",", "0.5"}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"SplineDegree", "\[Rule]", "4"}]}], "]"}], "&"}], "/@", 
    "intermediateLines2"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6707341090848093`*^9, 
  3.670734111277372*^9}},ExpressionUUID->"54b568bf-4fb2-49c4-b3ee-\
e0939dc23197"],

Cell[BoxData[
 RowBox[{"Graphics3D", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Line", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"#", "[", "s", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"s", ",", "0", ",", "smax", ",", "0.5"}], "}"}]}], "]"}], 
     "]"}], "&"}], "/@", 
   RowBox[{"Join", "[", 
    RowBox[{"intermediateLines", ",", "intermediateLines2"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6707335570095*^9, 3.670733573365151*^9}, {
  3.670734133387774*^9, 
  3.670734145423471*^9}},ExpressionUUID->"3fa51d50-c819-4be1-aadf-\
00174bae51c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"intermediatePoints", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"computeIntermediateHeartGeometry", "[", "#", "]"}], "&"}], "/@",
     "interpolatedMidlines"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.670733782912477*^9, {3.670733849037225*^9, 
   3.6707338689876947`*^9}},ExpressionUUID->"877ca50e-6cb4-4217-8466-\
9ee78170b6ac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"intermediatePoints2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"computeIntermediateHeartGeometry", "[", "#", "]"}], "&"}], "/@",
     "interpolatedMidlines2"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.670734155746179*^9, 
  3.670734157513968*^9}},ExpressionUUID->"6d455349-0473-486b-8325-\
4f388c7770e9"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Graphics3D", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"AbsolutePointSize", "[", "3", "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"transformToStandardView", "[", "#", "]"}], "]"}], "&"}], "/@", 
        RowBox[{"intermediatePoints", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"ViewPoint", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "2"}], "}"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "intermediatePoints", "]"}], ",", "1"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.670733898503622*^9, 
  3.6707339690484247`*^9}},ExpressionUUID->"1287a9b5-a2cb-4776-bba3-\
7399ef2a1ed8"],

Cell[BoxData[
 RowBox[{"axis", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Mean", "[", 
     RowBox[{"transformToStandardView", "/@", 
      RowBox[{"intermediatePoints2", "[", 
       RowBox[{"[", "100", "]"}], "]"}]}], "]"}], ",", 
    RowBox[{
     RowBox[{"Mean", "[", 
      RowBox[{"transformToStandardView", "/@", 
       RowBox[{"intermediatePoints2", "[", 
        RowBox[{"[", "100", "]"}], "]"}]}], "]"}], "+", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "10"}], "}"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6707379258867893`*^9, 3.6707379597289133`*^9}, {
  3.670737993543726*^9, 3.670738020894418*^9}, {3.670738055829603*^9, 
  3.6707380571332417`*^9}, {3.670738093196187*^9, 3.670738157385211*^9}, {
  3.6707382857172947`*^9, 3.670738287412794*^9}, {3.670738345795347*^9, 
  3.67073834843433*^9}, {3.6707384061769342`*^9, 
  3.6707384776315403`*^9}},ExpressionUUID->"a73dc3b4-70cb-4d80-a5b0-\
6826daf66e26"],

Cell[BoxData[
 RowBox[{"rot", "=", 
  RowBox[{"RotationMatrix", "[", 
   RowBox[{
    RowBox[{"\[Pi]", "/", "2"}], ",", "axis"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.670738008808865*^9, 
  3.670738034301962*^9}},ExpressionUUID->"34bb81af-1d16-4982-b41c-\
ea42e39968d2"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Graphics3D", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"AbsolutePointSize", "[", "3", "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"rot", ".", 
           RowBox[{"transformToStandardView", "[", "#", "]"}]}], "]"}], "&"}],
         "/@", 
        RowBox[{"intermediatePoints2", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"ViewPoint", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "2"}], "}"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "intermediatePoints2", "]"}], ",", "1"}], "}"}]}],
   "]"}]], "Input",
 CellChangeTimes->{{3.67073416665357*^9, 3.670734168516985*^9}, {
  3.670738041424192*^9, 3.670738042157937*^9}, {3.670738081870812*^9, 
  3.670738085316327*^9}},ExpressionUUID->"324e2e94-fca2-4d60-828f-\
2dd8a8f92787"],

Cell[BoxData[
 RowBox[{"showNodesTrail", "[", 
  RowBox[{"Take", "[", 
   RowBox[{"intermediatePoints", ",", "100"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.670679699288466*^9, 3.670679722896117*^9}, {
  3.6706797616249123`*^9, 3.6706797897101173`*^9}, {3.6706799493070297`*^9, 
  3.670679949704588*^9}, {3.67068000748109*^9, 3.670680008375182*^9}, {
  3.670734610535202*^9, 3.670734612420465*^9}, {3.670737779785531*^9, 
  3.670737780911381*^9}},ExpressionUUID->"107dd728-80b0-47b5-b8ff-\
4a9be9e847ff"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showNodesTrailAdaptive", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showNodesTrailAdaptive", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"centroidLst_:", "pts2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "maxZ", ",", "minZ", ",", "stdCentroids", ",", "n", ",", 
      "finalProjection", ",", "transferFunction", ",", "centroids", ",", 
      "trails"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "\"\<1234\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"centroids", "=", 
      RowBox[{"Last", "[", "centroidLst", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"trails", "=", 
      RowBox[{"dataTransform", "/@", 
       RowBox[{"Transpose", "[", "centroidLst", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"stdCentroids", " ", "=", " ", 
      RowBox[{"dataTransform", "/@", "centroids"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"maxZ", ",", " ", "minZ"}], "}"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Graphics3D", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Opacity", "[", "0.2", "]"}], ",", 
                  RowBox[{"GrayLevel", "[", 
                   RowBox[{"0.5", "+", 
                    RowBox[{"0.2", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"maxZ", "-", "minZ"}], ")"}]}], ")"}]}], 
                    ")"}]}]}], "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{"#", ",", "2.5"}], "]"}], ",", 
                  RowBox[{"Opacity", "[", "1", "]"}], ",", 
                  RowBox[{"GrayLevel", "[", "0.3", "]"}], ",", 
                  RowBox[{"Sphere", "[", 
                   RowBox[{"#", ",", "1"}], "]"}]}], "}"}], "&"}], "/@", 
               RowBox[{"(", "stdCentroids", ")"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"AbsoluteThickness", "[", "1.5", "]"}], ",", 
                RowBox[{"GrayLevel", "[", "0.3", "]"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Line", "[", "#", "]"}], "&"}], "/@", "trails"}]}], 
               "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"Lighting", "->", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"ViewPoint", "\[Rule]", "Top"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
           RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "None"}]}], "]"}], ",", 
         RowBox[{"RasterSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", "finalProjection", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "200"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "50"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.670738550641561*^9, 
  3.6707385633788157`*^9}},ExpressionUUID->"ad5cda6b-b744-49d5-a2fe-\
59329f77d059"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showNodesAdaptive", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showNodesAdaptive", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"centroids_:", "pts2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "maxZ", ",", "minZ", ",", "stdCentroids", ",", "n", ",", 
      "finalProjection", ",", "transferFunction", ",", "trails"}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "\"\<1234\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"stdCentroids", " ", "=", " ", 
      RowBox[{"dataTransform", "/@", "centroids"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"maxZ", ",", " ", "minZ"}], "}"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"Graphics3D", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Opacity", "[", "0.2", "]"}], ",", 
                 RowBox[{"GrayLevel", "[", 
                  RowBox[{"0.5", "+", 
                   RowBox[{"0.2", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"maxZ", "-", "minZ"}], ")"}]}], ")"}]}], 
                    ")"}]}]}], "]"}], ",", 
                 RowBox[{"Sphere", "[", 
                  RowBox[{"#", ",", "2.5"}], "]"}], ",", 
                 RowBox[{"Opacity", "[", "1", "]"}], ",", 
                 RowBox[{"GrayLevel", "[", "0.3", "]"}], ",", 
                 RowBox[{"Sphere", "[", 
                  RowBox[{"#", ",", "1"}], "]"}]}], "}"}], "&"}], "/@", 
              RowBox[{"(", "stdCentroids", ")"}]}], "]"}], 
            "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", 
           RowBox[{"Lighting", "->", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"ViewPoint", "\[Rule]", "Top"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
           RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "None"}]}], "]"}], ",", 
         RowBox[{"RasterSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", "finalProjection", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "200"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "50"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.6707389609353533`*^9, 
  3.6707389804795227`*^9}},ExpressionUUID->"e9a3022e-823b-43a4-bbd2-\
0b8ab4ac6613"],

Cell[BoxData[
 RowBox[{"showNodesTrailAdaptive", "[", 
  RowBox[{"Take", "[", 
   RowBox[{"intermediatePoints2", ",", "100"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{
  3.67073782780551*^9, {3.6707385721694593`*^9, 
   3.67073858586764*^9}},ExpressionUUID->"e76feedc-a3a9-454b-871a-\
f2f405020878"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-4/\
part-2-a/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"t", ",", "10", ",", "4"}], "]"}], "<>", "\"\<.png\>\""}], 
      ",", 
      RowBox[{"showNodesTrail", "[", 
       RowBox[{"Take", "[", 
        RowBox[{"intermediatePoints", ",", "t"}], "]"}], "]"}]}], "]"}], ",", 
    
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "100", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670680253096822*^9, 3.6706802766632147`*^9}, {
  3.6707378170065117`*^9, 
  3.670737819655587*^9}},ExpressionUUID->"9958585e-67ac-4ffb-9401-\
64739569e170"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-4/\
part-2-b/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"t", ",", "10", ",", "4"}], "]"}], "<>", "\"\<.png\>\""}], 
      ",", 
      RowBox[{"showNodesTrailAdaptive", "[", 
       RowBox[{"Take", "[", 
        RowBox[{"intermediatePoints2", ",", "t"}], "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "100", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6707386114659443`*^9, 
  3.6707386243219337`*^9}},ExpressionUUID->"1fd7ce3d-0a41-4044-9ed8-\
1f2e4ff9b4e1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-4/\
part-2-b-trailless/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"t", ",", "10", ",", "4"}], "]"}], "<>", "\"\<.png\>\""}], 
      ",", 
      RowBox[{"showNodesAdaptive", "[", 
       RowBox[{"intermediatePoints2", "[", 
        RowBox[{"[", "t", "]"}], "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "100", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6707389983100653`*^9, 
  3.670739021493019*^9}},ExpressionUUID->"6112782f-af9a-4b0c-adf0-\
2fe103ba7717"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ptsCylinderFlat", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"35", ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}], "/@", 
    "ptsCylinder"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.670739259145679*^9, 
  3.670739288974854*^9}},ExpressionUUID->"f9e86e33-1263-44af-ab5c-\
858f3254ca64"],

Cell[BoxData[
 RowBox[{
  RowBox[{"start", "=", 
   RowBox[{"Last", "[", "intermediatePoints2", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6707392422374687`*^9, 
  3.670739256054229*^9}},ExpressionUUID->"4148bd5b-f00f-490c-9929-\
feb2a9f5cb2f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"end", "=", 
   RowBox[{"computeIntermediateHeartGeometry", "[", 
    RowBox[{
     RowBox[{"Last", "[", "interpolatedMidlines2", "]"}], ",", 
     "ptsCylinderFlat"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6707392914609947`*^9, 
  3.670739331814378*^9}},ExpressionUUID->"f922d2cd-59af-4c0d-9347-\
b81bbded3394"],

Cell[BoxData[
 RowBox[{
  RowBox[{"displacement", "=", 
   RowBox[{"end", "-", "start"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.670739338362875*^9, 
  3.670739349365456*^9}},ExpressionUUID->"16ce0cd9-4615-46e7-b622-\
090b880df7cd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"blowUpPoints", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"start", "+", 
      RowBox[{"a", " ", "displacement"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "0", ",", "1", ",", "0.01"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670739355110736*^9, 
  3.670739381597134*^9}},ExpressionUUID->"1d3a26bc-5806-4d10-bfba-\
6bf7e1c489f2"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "showNodesBlowUp", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showNodesBlowUp", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"centroids_:", "pts2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"dataTransform_:", "stdTransform"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "maxZ", ",", "minZ", ",", "stdCentroids", ",", "n", ",", 
      "finalProjection", ",", "transferFunction", ",", "trails"}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "\"\<1234\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"stdCentroids", " ", "=", " ", 
      RowBox[{"dataTransform", "/@", "centroids"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"maxZ", ",", " ", "minZ"}], "}"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "stdCentroids"}], 
         "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"finalProjection", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"Graphics3D", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Opacity", "[", "0.2", "]"}], ",", 
                 RowBox[{"GrayLevel", "[", 
                  RowBox[{"0.5", "+", 
                   RowBox[{"0.2", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "minZ"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"maxZ", "-", "minZ"}], ")"}]}], ")"}]}], 
                    ")"}]}]}], "]"}], ",", 
                 RowBox[{"Sphere", "[", 
                  RowBox[{"#", ",", "2.5"}], "]"}], ",", 
                 RowBox[{"Opacity", "[", "1", "]"}], ",", 
                 RowBox[{"GrayLevel", "[", "0.3", "]"}], ",", 
                 RowBox[{"Sphere", "[", 
                  RowBox[{"#", ",", "1"}], "]"}]}], "}"}], "&"}], "/@", 
              RowBox[{"(", "stdCentroids", ")"}]}], "]"}], 
            "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", 
           RowBox[{"Lighting", "->", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"ViewPoint", "\[Rule]", "Top"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "160"}], ",", "95"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "80"}], ",", "30"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"165", ",", "255"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "None"}]}], "]"}], ",", 
         RowBox[{"RasterSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", "finalProjection", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "200"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "50"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"853", ",", "480"}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", "None"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.670772238477687*^9, 3.6707722441959476`*^9}, {
  3.67077228144306*^9, 3.670772371699368*^9}, {3.670772483717043*^9, 
  3.6707724878852043`*^9}},ExpressionUUID->"56dee6f4-3e5f-44e1-8642-\
a0390054649b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Min", "[", "#", "]"}], ",", 
     RowBox[{"Max", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
  RowBox[{"Transpose", "[", 
   RowBox[{"transformToStandardView", "/@", 
    RowBox[{"blowUpPoints", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.670772249966744*^9, 3.670772275410228*^9}, 
   3.670772474382751*^9},ExpressionUUID->"744a8074-72f2-4ec7-a526-\
a2e95e888ccf"],

Cell[BoxData[
 RowBox[{"showNodesBlowUp", "[", 
  RowBox[{"blowUpPoints", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.670739383886479*^9, 3.6707393945808983`*^9}, {
   3.67077184333689*^9, 3.670771848201825*^9}, {3.6707723206571198`*^9, 
   3.670772323690284*^9}, 
   3.670772380305187*^9},ExpressionUUID->"178efb93-c689-47da-9a71-\
7c2430796fa9"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.670752899678864*^9, 3.670752902970375*^9}, {
  3.6707529370397243`*^9, 
  3.670752938879821*^9}},ExpressionUUID->"d6607fb8-2b01-437c-a60b-\
81657242d1b5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/scherf/Documents/heart_new/results/supplementary-video-4/\
part-2-c/\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"t", ",", "10", ",", "4"}], "]"}], "<>", "\"\<.png\>\""}], 
      ",", 
      RowBox[{"showNodesBlowUp", "[", 
       RowBox[{"blowUpPoints", "[", 
        RowBox[{"[", "t", "]"}], "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "100", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670739430516576*^9, 3.670739441885194*^9}, {
  3.670772435064447*^9, 
  3.6707724398249187`*^9}},ExpressionUUID->"6fbb9397-9729-46c8-8a75-\
90cd4e1bd110"],

Cell[BoxData[
 RowBox[{
  RowBox[{"testCylPts", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"2", "\[Pi]"}]}], "}"}], "]"}], ",", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], "]"}]}], "}"}], ",", 
     
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "400"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6706758875131474`*^9, 
  3.6706759594734163`*^9}},ExpressionUUID->"e60541e1-5435-4a9c-b9a9-\
b768bd8d108e"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.670675962800527*^9, 3.670675972136806*^9}, 
   3.670676029758923*^9},ExpressionUUID->"78a6f97c-8607-449b-8024-\
928f158cfc23"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Insert", "[", 
   RowBox[{
    RowBox[{"unroll", "[", 
     RowBox[{"\[Phi]", ",", "\[Theta]", ",", 
      RowBox[{"-", "1"}]}], "]"}], ",", "v", ",", "1"}], "]"}], "+", 
  RowBox[{"{", 
   RowBox[{"\[Pi]", ",", 
    RowBox[{"-", "\[Pi]"}], ",", "0"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.670661799643724*^9, 3.670661804794361*^9}, {
  3.6706618489524193`*^9, 
  3.670661873527978*^9}},ExpressionUUID->"2e10de7c-2936-48f7-93bf-\
06418c44d096"],

Cell[BoxData[
 RowBox[{"unrolledCylinder", "=", 
  RowBox[{"Graphics3D", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Dashed", ",", 
      RowBox[{"Line", "[", 
       RowBox[{"cyl2cart", "/@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"AbsolutePointSize", "[", "4", "]"}], ",", 
      RowBox[{"MapIndexed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"\[Pi]", "<=", 
              RowBox[{
               RowBox[{"ptsCylinder", "[", 
                RowBox[{"[", 
                 RowBox[{"#2", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
             RowBox[{"Directive", "[", 
              RowBox[{
               RowBox[{"AbsolutePointSize", "[", "7", "]"}], ",", "Gray"}], 
              "]"}], ",", 
             RowBox[{"Directive", "[", 
              RowBox[{
               RowBox[{"Opacity", "[", "0.4", "]"}], ",", "Black"}], "]"}]}], 
            "]"}], ",", 
           RowBox[{"Point", "[", 
            RowBox[{"cyl2cart", "[", "#1", "]"}], "]"}]}], "}"}], "&"}], ",", 
        "ptsCylinder"}], "]"}]}], "}"}], ",", 
    RowBox[{"ViewPoint", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "Infinity"}], "}"}]}], ",", 
    RowBox[{"Boxed", "\[Rule]", "False"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.657986769896801*^9, 3.657986937082038*^9}, {
  3.657986993449499*^9, 3.657987070061286*^9}, {3.6582345301370983`*^9, 
  3.658234533174749*^9}, {3.6585890298176603`*^9, 3.6585890351668167`*^9}, {
  3.662104431923518*^9, 3.662104437734913*^9}, {3.670577332175994*^9, 
  3.670577348095648*^9}},ExpressionUUID->"43e2a1a6-90fc-4f2e-98e7-\
d16ee68cdee3"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{720, 852},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"11.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (April 27, \
2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 312, 6, 148, "Title", "ExpressionUUID" -> \
"ae4d838c-45d8-404a-ac1d-2bc52147ce9b"],
Cell[CellGroupData[{
Cell[917, 32, 285, 4, 109, "Chapter", "ExpressionUUID" -> \
"f70b2d53-7e59-4ecf-8842-aeb38c2a6260"],
Cell[1205, 38, 196, 4, 32, "Input", "ExpressionUUID" -> \
"17f02651-4138-48b0-aa0c-3718904e1c90"],
Cell[1404, 44, 264, 6, 32, "Input", "ExpressionUUID" -> \
"f59c4b78-d69d-46aa-bec5-a10cc0677254"],
Cell[CellGroupData[{
Cell[1693, 54, 175, 3, 63, "Subchapter", "ExpressionUUID" -> \
"8a6f721f-d86f-4581-ba2c-8b0e769d9d57"],
Cell[1871, 59, 420, 8, 49, "Text", "ExpressionUUID" -> \
"9299b925-35d3-4158-a027-f1bb546a467e"],
Cell[2294, 69, 673, 13, 54, "Input", "ExpressionUUID" -> \
"45b84a11-4300-4e70-b063-5187097877f1"],
Cell[2970, 84, 248, 6, 30, "Text", "ExpressionUUID" -> \
"6e6c5fac-96a6-4056-93f1-68fbdc2996da"],
Cell[3221, 92, 3049, 46, 54, "Input", "ExpressionUUID" -> \
"f0b055b9-0547-49f1-8769-d6711d11e0ef"],
Cell[CellGroupData[{
Cell[6295, 142, 172, 3, 64, "Section", "ExpressionUUID" -> \
"46031d6a-d29b-4847-b7d2-ddcf9aa8ee07"],
Cell[6470, 147, 6807, 108, 117, "Input", "ExpressionUUID" -> \
"83bb530b-d075-4c57-b1b4-32f3f222d312"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13314, 260, 175, 3, 64, "Section", "ExpressionUUID" -> \
"4fcd6037-54c1-4919-8035-2971b76c3ea7"],
Cell[13492, 265, 1717, 43, 222, "Input", "ExpressionUUID" -> \
"bc7ee520-5e41-4abf-9919-32494b9b9472"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15246, 313, 165, 3, 64, "Section", "ExpressionUUID" -> \
"214ed1dd-1b46-4ebb-aa76-35a0100a0bfd"],
Cell[15414, 318, 7399, 118, 264, "Input", "ExpressionUUID" -> \
"46c65317-771b-4e7a-891b-60a855dfae27"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22850, 441, 237, 4, 64, "Section", "ExpressionUUID" -> \
"f6cfb36e-53d1-4a82-a1c7-a7ed0518febd"],
Cell[23090, 447, 4167, 119, 348, "Input", "ExpressionUUID" -> \
"b0c544f0-8d9b-4118-81ca-70e13dd71cd6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27294, 571, 174, 3, 64, "Section", "ExpressionUUID" -> \
"c47182b8-3e1a-469f-9c1d-211b8076c644"],
Cell[27471, 576, 1911, 52, 159, "Input", "ExpressionUUID" -> \
"9793bd3f-7626-40a0-a7a8-c32fc3e84e83"],
Cell[29385, 630, 1411, 40, 117, "Input", "ExpressionUUID" -> \
"150dc594-d635-46dd-948b-6b878f73baec"],
Cell[30799, 672, 369, 7, 68, "Text", "ExpressionUUID" -> \
"6e582590-a42e-4783-9c59-093583d534c1"],
Cell[31171, 681, 679, 15, 96, "Input", "ExpressionUUID" -> \
"798c20d6-19f9-432d-b6ee-c7e704e47914"],
Cell[31853, 698, 339, 9, 32, "Input", "ExpressionUUID" -> \
"631d4220-dc50-45c7-ab0b-ffff35b2d790"],
Cell[32195, 709, 1142, 33, 117, "Input", "ExpressionUUID" -> \
"2f3134a6-0b34-4ac6-9aad-fbe9aa55efdf"],
Cell[33340, 744, 269, 6, 32, "Input", "ExpressionUUID" -> \
"a1a38e36-0ab2-49de-b2dc-561e7ecdb30c"],
Cell[CellGroupData[{
Cell[33634, 754, 156, 3, 44, "Subsection", "ExpressionUUID" -> \
"5ac71cb4-26f7-47e8-8529-1e9db0d4d2a5"],
Cell[CellGroupData[{
Cell[33815, 761, 159, 3, 35, "Subsubsection", "ExpressionUUID" -> \
"24625d88-b5a9-4580-b8a5-d017202c6abf"],
Cell[33977, 766, 11267, 266, 1125, "Input", "ExpressionUUID" -> \
"91a59adb-d359-4245-b60c-8c4e744e0e27"],
Cell[45247, 1034, 768, 22, 96, "Input", "ExpressionUUID" -> \
"77f146b0-344c-4250-9340-b2990896251f"],
Cell[46018, 1058, 277, 6, 32, "Input", "ExpressionUUID" -> \
"98de4cc3-373b-4df4-a12e-5c0364e043fd"],
Cell[46298, 1066, 747, 20, 117, "Input", "ExpressionUUID" -> \
"0985482b-1528-416e-96ae-dfdae651bf96"],
Cell[47048, 1088, 947, 26, 180, "Input", "ExpressionUUID" -> \
"eda01d0d-6f6d-42e7-9f01-64e2cb69984a"],
Cell[47998, 1116, 879, 23, 117, "Input", "ExpressionUUID" -> \
"4936eca8-73aa-47f5-81a5-fac629ee1170"],
Cell[48880, 1141, 918, 25, 180, "Input", "ExpressionUUID" -> \
"f642d3b2-d0b2-4a98-996f-c660cfbc2417"],
Cell[49801, 1168, 902, 25, 117, "Input", "ExpressionUUID" -> \
"2c6280a9-a694-472b-a803-67a27cf3d9c6"],
Cell[50706, 1195, 811, 22, 117, "Input", "ExpressionUUID" -> \
"f2795dd0-64c5-4a86-b6c5-d8bc1cbf8169"],
Cell[51520, 1219, 11261, 272, 1167, "Input", "ExpressionUUID" -> \
"5a87cfcc-f329-4569-9bec-eaadd5603244"],
Cell[62784, 1493, 11575, 275, 1167, "Input", "ExpressionUUID" -> \
"58f6ec18-d60c-45fd-99ba-db33cc7ef5be"],
Cell[74362, 1770, 796, 23, 96, "Input", "ExpressionUUID" -> \
"9b5f4ead-912c-4ad6-a8af-d55cf4cacfc8"],
Cell[75161, 1795, 560, 18, 32, "Input", "ExpressionUUID" -> \
"f4c59412-c0db-445a-a227-3620ea351428"],
Cell[75724, 1815, 1377, 33, 138, "Input", "ExpressionUUID" -> \
"bb74c45c-8524-49ee-9419-13ca4bb3e4fd"],
Cell[77104, 1850, 1194, 32, 138, "Input", "ExpressionUUID" -> \
"479b4d6d-8f87-4b64-8037-437d0f80d869"],
Cell[78301, 1884, 1323, 34, 138, "Input", "ExpressionUUID" -> \
"539889b0-82e6-4d31-94bd-cf800365f074"],
Cell[79627, 1920, 1186, 32, 138, "Input", "ExpressionUUID" -> \
"276b83a7-c9f0-4110-864f-6ea97acd8aae"],
Cell[80816, 1954, 1126, 31, 138, "Input", "ExpressionUUID" -> \
"9a808e30-cec7-49a5-aa8a-66b18c90862e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81979, 1990, 157, 3, 35, "Subsubsection", "ExpressionUUID" -> \
"4cecf108-92f2-4f6d-a70f-83b3cc749467"],
Cell[82139, 1995, 708, 19, 138, "Input", "ExpressionUUID" -> \
"7dd7cd3c-89f1-405d-9138-b14c0739f412"],
Cell[82850, 2016, 4878, 116, 621, "Input", "ExpressionUUID" -> \
"ed2d0aba-37bd-4bd1-adb5-130585980b9a"],
Cell[87731, 2134, 6166, 146, 873, "Input", "ExpressionUUID" -> \
"6ebc5466-255b-4767-b5dc-74e855bc9ada"],
Cell[93900, 2282, 5740, 138, 852, "Input", "ExpressionUUID" -> \
"b3bf7ca3-2507-4e43-b7e8-0fa68b6ab8b0"],
Cell[99643, 2422, 541, 11, 32, "Input", "ExpressionUUID" -> \
"2e96d335-790f-45d1-82a4-1d327207dff8"],
Cell[100187, 2435, 302, 8, 32, "Input", "ExpressionUUID" -> \
"f681d0f7-6c2a-4ff7-a20e-c88632aca452"],
Cell[100492, 2445, 361, 8, 32, "Input", "ExpressionUUID" -> \
"4f5e9c29-84fb-43cc-aad6-8dd184d1ff5c"],
Cell[100856, 2455, 1051, 26, 117, "Input", "ExpressionUUID" -> \
"289cc953-90ab-4df3-962a-85229895778f"],
Cell[101910, 2483, 763, 23, 117, "Input", "ExpressionUUID" -> \
"7c3821e6-e14a-4407-b3b4-827e51fb49c6"],
Cell[102676, 2508, 3002, 73, 285, "Input", "ExpressionUUID" -> \
"00fcfa32-b716-47c5-8865-dbc33f8a753c"],
Cell[105681, 2583, 2695, 60, 306, "Input", "ExpressionUUID" -> \
"a63ce417-35ea-46d7-be36-feabb48cc2d0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[108413, 2648, 160, 3, 35, "Subsubsection", "ExpressionUUID" -> \
"26f7874c-37d2-4d98-9272-0da1107ce394"],
Cell[108576, 2653, 2778, 72, 243, "Input", "ExpressionUUID" -> \
"cd9f01b5-61e9-425a-8565-a4bbe4d8e1de"],
Cell[111357, 2727, 2201, 49, 285, "Input", "ExpressionUUID" -> \
"5dddb5bf-4bd5-466c-bbd9-2480ec9adede"],
Cell[113561, 2778, 303, 9, 32, "Input", "ExpressionUUID" -> \
"d8d06684-831d-40e9-b5d7-4a5d7226fd49"],
Cell[113867, 2789, 535, 13, 54, "Input", "ExpressionUUID" -> \
"94621707-08a9-4612-9407-46236fa4fe17"],
Cell[114405, 2804, 8067, 197, 873, "Input", "ExpressionUUID" -> \
"ab7d2486-0969-4ecf-8380-24bbc4c66b28"],
Cell[122475, 3003, 1713, 44, 138, "Input", "ExpressionUUID" -> \
"f65fc970-530e-44bd-b70a-cdce5a2114a6"],
Cell[124191, 3049, 2253, 56, 243, "Input", "ExpressionUUID" -> \
"5720bb2c-3c28-4b17-87fa-14270d2576a2"],
Cell[126447, 3107, 946, 26, 180, "Input", "ExpressionUUID" -> \
"ca185c4f-66ed-4770-be2a-1ecc72c4fc52"],
Cell[127396, 3135, 947, 26, 180, "Input", "ExpressionUUID" -> \
"f9043f42-6712-462d-89a6-b0fb9cb4f61b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[128380, 3166, 159, 3, 35, "Subsubsection", "ExpressionUUID" -> \
"23d45b89-670d-459f-adca-cc0fb963764a"],
Cell[128542, 3171, 16574, 364, 1336, "Input", "ExpressionUUID" -> \
"085ba8fa-2690-4474-93ba-9a2c22477c38"],
Cell[145119, 3537, 2201, 52, 138, "Input", "ExpressionUUID" -> \
"6d9ddc3c-d3aa-44e7-b640-528cdedf183c"],
Cell[147323, 3591, 2602, 62, 243, "Input", "ExpressionUUID" -> \
"8e30b6a0-5247-4149-a667-37a27a43a852"],
Cell[149928, 3655, 949, 26, 180, "Input", "ExpressionUUID" -> \
"6bf32639-bb8e-4979-b026-550c37089bc5"],
Cell[150880, 3683, 945, 26, 180, "Input", "ExpressionUUID" -> \
"e470424c-31e6-4537-a3a8-3164b1f0cf1e"],
Cell[151828, 3711, 1339, 31, 96, "Input", "ExpressionUUID" -> \
"16cf0516-3d51-4f93-a29b-021080011ca8"],
Cell[153170, 3744, 1488, 40, 138, "Input", "ExpressionUUID" -> \
"b1e8278f-27ff-4cd3-aedf-580365da8b33"],
Cell[154661, 3786, 2945, 80, 306, "Input", "ExpressionUUID" -> \
"26157c09-3776-4db8-ad12-e1c78f297b65"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[157655, 3872, 207, 4, 44, "Subsection", "ExpressionUUID" -> \
"8f5c5ab8-f226-41f1-b48c-4b1ecc071bc1"],
Cell[CellGroupData[{
Cell[157887, 3880, 252, 4, 35, "Subsubsection", "ExpressionUUID" -> \
"7895b915-79a9-4b5b-bbab-73192ed72279"],
Cell[158142, 3886, 2590, 74, 243, "Input", "ExpressionUUID" -> \
"d336e2a8-0e5c-4ffc-bbad-cffb5b3c16fe"],
Cell[160735, 3962, 1757, 53, 117, "Input", "ExpressionUUID" -> \
"8dfef96c-2205-4940-8b1c-919b1e015fd9"],
Cell[162495, 4017, 210, 5, 32, "Input", "ExpressionUUID" -> \
"2a809d9a-3b98-4053-ac56-24dd4188be14"],
Cell[162708, 4024, 360, 9, 54, "Input", "ExpressionUUID" -> \
"ef910e75-4dc4-472f-8b20-04aca25b8ba1"],
Cell[163071, 4035, 4659, 109, 495, "Input", "ExpressionUUID" -> \
"a16a0890-59ef-4591-8b6b-0951c46d58cc"],
Cell[167733, 4146, 4523, 112, 516, "Input", "ExpressionUUID" -> \
"df379c5d-ba9a-4c2b-bdb1-9e750d4f9020"],
Cell[172259, 4260, 9952, 225, 873, "Input", "ExpressionUUID" -> \
"00b0ed39-bb71-426f-af66-7f95aed12883"],
Cell[182214, 4487, 642, 10, 32, "Input", "ExpressionUUID" -> \
"49b47cdd-bad1-4c01-a300-ab215d08dfa2"],
Cell[182859, 4499, 740, 19, 117, "Input", "ExpressionUUID" -> \
"07a52bae-13c8-42c9-ac7e-ad44363aeed1"],
Cell[183602, 4520, 946, 25, 180, "Input", "ExpressionUUID" -> \
"f30ad689-234d-4662-9374-0397a6d29602"],
Cell[184551, 4547, 983, 26, 180, "Input", "ExpressionUUID" -> \
"fa8bd396-ba5b-472e-bf6b-4366373d1c04"]
}, Open  ]],
Cell[CellGroupData[{
Cell[185571, 4578, 157, 3, 35, "Subsubsection", "ExpressionUUID" -> \
"14941b6e-bc80-4fd8-9e22-7b7ae2be5b06"],
Cell[185731, 4583, 6653, 157, 684, "Input", "ExpressionUUID" -> \
"13592335-27cd-4b42-bccf-c9750eb87770"],
Cell[192387, 4742, 249, 5, 32, "Input", "ExpressionUUID" -> \
"2d819712-5067-4843-9cb9-dd13219e71d6"],
Cell[192639, 4749, 851, 22, 117, "Input", "ExpressionUUID" -> \
"21036ca9-c9b3-46a4-8b3d-0375ca24ea16"],
Cell[193493, 4773, 10615, 249, 1020, "Input", "ExpressionUUID" -> \
"f636fa92-34f4-4f79-81b1-6b8e42a97a02"],
Cell[204111, 5024, 249, 5, 32, "Input", "ExpressionUUID" -> \
"ee9d5a45-2b20-445f-ba1c-8edc02ebb402"],
Cell[204363, 5031, 736, 20, 117, "Input", "ExpressionUUID" -> \
"5e862beb-d37d-4097-96c6-037d545f1c8d"],
Cell[205102, 5053, 392, 10, 54, "Input", "ExpressionUUID" -> \
"ef60c2ac-b428-4f55-bcba-b150dd6d4c68"],
Cell[205497, 5065, 378, 9, 54, "Input", "ExpressionUUID" -> \
"5bcceb1e-b32c-4077-9770-2d8123ea5f91"],
Cell[205878, 5076, 876, 22, 96, "Input", "ExpressionUUID" -> \
"fc314d11-777e-4d4f-ab31-930f8caa7118"],
Cell[206757, 5100, 13678, 317, 1314, "Input", "ExpressionUUID" -> \
"cda299b1-ecda-4f8b-b4e5-103ab647a5a0"],
Cell[220438, 5419, 307, 5, 32, "Input", "ExpressionUUID" -> \
"3a705a95-a893-4e99-bb40-9cded3a5d7f6"],
Cell[220748, 5426, 709, 19, 117, "Input", "ExpressionUUID" -> \
"7e202c29-b05d-4e64-ac6d-12788b0a17b7"],
Cell[221460, 5447, 174, 3, 32, "Input", "ExpressionUUID" -> \
"0478642e-f27a-4d3c-a953-e912c13cf7a7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[221671, 5455, 157, 3, 35, "Subsubsection", "ExpressionUUID" -> \
"6123bb36-5149-43dc-a714-6bbde8c16b49"],
Cell[221831, 5460, 1914, 59, 201, "Input", "ExpressionUUID" -> \
"c5c6bdc4-c83e-4122-bff2-fc1ee491f832"],
Cell[223748, 5521, 206, 5, 32, "Input", "ExpressionUUID" -> \
"58f1706a-6ceb-4729-b14a-9db58cf19579"],
Cell[223957, 5528, 324, 7, 32, "Input", "ExpressionUUID" -> \
"0deca09a-99e2-4a63-8d13-43895aaf453b"],
Cell[224284, 5537, 627, 17, 32, "Input", "ExpressionUUID" -> \
"fd755b52-223b-4894-a05a-cb3e1aaec91d"],
Cell[224914, 5556, 394, 10, 54, "Input", "ExpressionUUID" -> \
"020a9bff-a0c9-471a-83b1-87aba92c472b"],
Cell[225311, 5568, 1067, 26, 138, "Input", "ExpressionUUID" -> \
"ea7ded96-cc1d-4558-a5b6-cf69a9270307"],
Cell[226381, 5596, 1360, 37, 75, "Input", "ExpressionUUID" -> \
"6845f454-2b62-491a-89fa-4fbfd6af619d"],
Cell[227744, 5635, 512, 15, 32, "Input", "ExpressionUUID" -> \
"96df3877-2ac7-4616-8858-a2e01abd4d1d"],
Cell[228259, 5652, 714, 19, 75, "Input", "ExpressionUUID" -> \
"a5fea3d0-3f6c-4168-b126-031ce20ef860"],
Cell[228976, 5673, 1187, 35, 96, "Input", "ExpressionUUID" -> \
"0a7935d8-2064-4232-8134-b36f9da73476"],
Cell[230166, 5710, 389, 10, 32, "Input", "ExpressionUUID" -> \
"68af9121-d3e0-49f5-94b5-94ab84992b01"],
Cell[230558, 5722, 537, 14, 32, "Input", "ExpressionUUID" -> \
"2c47dde6-810b-4911-90a0-371e7f67210d"],
Cell[231098, 5738, 326, 8, 32, "Input", "ExpressionUUID" -> \
"e80d3d7a-8523-46db-be46-68e64bf59800"],
Cell[231427, 5748, 615, 18, 75, "Input", "ExpressionUUID" -> \
"af838bd4-85e5-4539-8bbb-a1a4776528b8"],
Cell[232045, 5768, 691, 18, 75, "Input", "ExpressionUUID" -> \
"38e52fe1-6e2c-4255-9860-876be5544cf9"],
Cell[232739, 5788, 425, 11, 54, "Input", "ExpressionUUID" -> \
"40ba4360-14b4-4430-af0a-d1e178d42b93"],
Cell[233167, 5801, 2905, 77, 306, "Input", "ExpressionUUID" -> \
"52b5c6b6-36bf-451b-987b-cdf56a928444"],
Cell[236075, 5880, 626, 19, 54, "Input", "ExpressionUUID" -> \
"43f19126-f7c0-4cf9-b5b4-7bc4f2feaedd"],
Cell[236704, 5901, 3287, 85, 390, "Input", "ExpressionUUID" -> \
"a4733b18-ca2d-4eab-a56d-e1aad70575ac"],
Cell[239994, 5988, 734, 18, 75, "Input", "ExpressionUUID" -> \
"4b1dec69-bfc2-4fb4-85f7-f9dd677e2af3"],
Cell[240731, 6008, 630, 18, 54, "Input", "ExpressionUUID" -> \
"90053c19-4aa8-4901-baaf-9fe08a7ff8e4"],
Cell[241364, 6028, 362, 9, 32, "Input", "ExpressionUUID" -> \
"77fc923d-04bc-4d23-9d88-cf4c21d36dc8"],
Cell[241729, 6039, 803, 23, 75, "Input", "ExpressionUUID" -> \
"8ee36a93-4d73-4d06-b4d3-9316f34d2cb5"],
Cell[242535, 6064, 1695, 45, 180, "Input", "ExpressionUUID" -> \
"39bfdca4-438b-4049-86cf-ab1e2ac8e461"],
Cell[244233, 6111, 1367, 35, 222, "Input", "ExpressionUUID" -> \
"5bf389f1-c74b-4241-8ee5-595fd7a37d0b"],
Cell[245603, 6148, 293, 8, 32, "Input", "ExpressionUUID" -> \
"8fba21cd-d28a-4b9c-b197-9e6d02aebc5f"],
Cell[245899, 6158, 899, 21, 54, "Input", "ExpressionUUID" -> \
"c96f8059-6a7f-4468-be19-d658dda3f626"],
Cell[246801, 6181, 6612, 154, 747, "Input", "ExpressionUUID" -> \
"ba80e92a-bdc6-4718-b3af-a40f9dca5287"],
Cell[253416, 6337, 323, 6, 32, "Input", "ExpressionUUID" -> \
"62faa492-9e06-4265-859f-33677d53f048"],
Cell[253742, 6345, 722, 20, 117, "Input", "ExpressionUUID" -> \
"45dbe7a8-dc87-4a90-a26e-3023113da21c"],
Cell[254467, 6367, 1894, 51, 32, "Input", "ExpressionUUID" -> \
"87707031-c713-41ac-a2c4-695fdd275536"],
Cell[256364, 6420, 11484, 258, 1104, "Input", "ExpressionUUID" -> \
"56d2589c-2841-41f5-abd3-0fcb0e3d871c"],
Cell[267851, 6680, 300, 5, 32, "Input", "ExpressionUUID" -> \
"056d3197-bf2d-4de8-8ae8-8d33dd149dd9"],
Cell[268154, 6687, 856, 22, 117, "Input", "ExpressionUUID" -> \
"0a1bc03b-9d30-4ce0-b331-ec6dd65dfb13"],
Cell[269013, 6711, 3769, 85, 264, "Input", "ExpressionUUID" -> \
"d21dd3cb-d627-44b3-9794-b6ad5e36a8ce"],
Cell[272785, 6798, 6754, 163, 558, "Input", "ExpressionUUID" -> \
"f8a80b4c-15d0-4d0b-b283-eb350156bd7c"],
Cell[279542, 6963, 1990, 49, 201, "Input", "ExpressionUUID" -> \
"1883d84c-1579-45d7-bc24-87352a867883"],
Cell[281535, 7014, 603, 15, 32, "Input", "ExpressionUUID" -> \
"9e1cb4c8-780a-47fc-9042-3b4c0266c07e"],
Cell[282141, 7031, 263, 6, 32, "Input", "ExpressionUUID" -> \
"f178f4da-0b00-4f5b-b405-a05646da41a6"],
Cell[282407, 7039, 351, 9, 32, "Input", "ExpressionUUID" -> \
"609d7c40-17e1-4b0a-bdb8-193528a1bc5a"],
Cell[282761, 7050, 3030, 86, 264, "Input", "ExpressionUUID" -> \
"388bc73c-4c9b-41b0-9efc-937a9b8f6c44"],
Cell[285794, 7138, 638, 17, 75, "Input", "ExpressionUUID" -> \
"928be9bb-a0c5-4fe9-8b51-381922746e09"],
Cell[286435, 7157, 582, 17, 75, "Input", "ExpressionUUID" -> \
"c9883da1-127d-4616-a3bf-1573eba46f49"],
Cell[287020, 7176, 5782, 136, 684, "Input", "ExpressionUUID" -> \
"bba3edd9-47f6-4123-ab7b-6a5d719d71f7"],
Cell[292805, 7314, 415, 8, 32, "Input", "ExpressionUUID" -> \
"ec92fd72-319c-44a0-884d-bed007de2286"],
Cell[293223, 7324, 728, 21, 117, "Input", "ExpressionUUID" -> \
"53fbbb7b-3407-4c7e-a10a-279f9a8365c0"],
Cell[293954, 7347, 554, 13, 75, "Input", "ExpressionUUID" -> \
"3b2cd9c4-4fbc-4a7d-9587-bfc4f28f1dde"],
Cell[294511, 7362, 306, 7, 32, "Input", "ExpressionUUID" -> \
"25214a3b-32f2-4d90-bb48-134735ef19d2"],
Cell[294820, 7371, 432, 11, 54, "Input", "ExpressionUUID" -> \
"65f6f823-9b42-4592-aae5-73586172f198"],
Cell[295255, 7384, 4816, 116, 621, "Input", "ExpressionUUID" -> \
"6cb74f3a-8550-43f6-8ba8-61bd86223e49"],
Cell[300074, 7502, 192, 4, 32, "Input", "ExpressionUUID" -> \
"8db3e222-9413-46ac-ba74-93fcb2ecdd6f"],
Cell[300269, 7508, 716, 20, 117, "Input", "ExpressionUUID" -> \
"215530fa-8dff-46df-9a7b-6a162ce7ae9e"],
Cell[300988, 7530, 223, 5, 32, "Input", "ExpressionUUID" -> \
"c246976a-f815-4083-be9b-4fbc956c0900"],
Cell[301214, 7537, 457, 14, 32, "Input", "ExpressionUUID" -> \
"8b5dc112-0143-4710-83be-d8e29f34e0ab"],
Cell[301674, 7553, 419, 10, 54, "Input", "ExpressionUUID" -> \
"e1ccd0f5-74ca-4bd1-b127-72d8c5ea42e5"],
Cell[302096, 7565, 512, 11, 54, "Input", "ExpressionUUID" -> \
"dc5fe613-1c31-4567-ac26-f753efb090e5"],
Cell[302611, 7578, 357, 7, 32, "Input", "ExpressionUUID" -> \
"2498c671-c9c6-4b56-b1f6-0bd90459e18c"],
Cell[302971, 7587, 478, 13, 54, "Input", "ExpressionUUID" -> \
"6cf37673-f007-4f3e-ab22-f41bf899c75d"],
Cell[303452, 7602, 790, 22, 117, "Input", "ExpressionUUID" -> \
"de0b8a9e-1c66-4687-bb12-9a50dbda6876"],
Cell[304245, 7626, 974, 23, 75, "Input", "ExpressionUUID" -> \
"e5e68852-a80b-44dd-87d3-b6157dab28d5"],
Cell[305222, 7651, 364, 10, 32, "Input", "ExpressionUUID" -> \
"6c913f4f-b094-4feb-af01-76fe933262dc"],
Cell[305589, 7663, 636, 18, 117, "Input", "ExpressionUUID" -> \
"60e6060e-2cb9-4a5a-a07d-5b56dbcdd22d"],
Cell[306228, 7683, 838, 22, 32, "Input", "ExpressionUUID" -> \
"b3cf07d0-8e7b-4525-8976-3a3eefac2969"],
Cell[307069, 7707, 1098, 32, 75, "Input", "ExpressionUUID" -> \
"33d87854-522e-46e3-97d9-a6b13ae5c757"],
Cell[308170, 7741, 517, 16, 32, "Input", "ExpressionUUID" -> \
"3ea1311e-0e63-466f-8e03-2d18d0a45d12"],
Cell[308690, 7759, 7305, 169, 705, "Input", "ExpressionUUID" -> \
"48aa82d4-15c9-47dd-8f3d-0351e5405cc6"],
Cell[315998, 7930, 8364, 194, 747, "Input", "ExpressionUUID" -> \
"3fe7df1f-6689-464b-9e25-e2dd1e71ab5e"],
Cell[324365, 8126, 876, 22, 96, "Input", "ExpressionUUID" -> \
"04a72d52-59c0-49e6-b9db-9d14a9c6d3c5"],
Cell[325244, 8150, 266, 6, 32, "Input", "ExpressionUUID" -> \
"83c6704b-007f-499e-b64b-f40b53f6deea"],
Cell[325513, 8158, 718, 20, 117, "Input", "ExpressionUUID" -> \
"f305f4e6-68a7-413a-8975-52ed91385918"],
Cell[326234, 8180, 469, 9, 32, "Input", "ExpressionUUID" -> \
"34ac6c6d-f307-4a34-8ca3-27ccd15884eb"],
Cell[326706, 8191, 550, 13, 96, "Input", "ExpressionUUID" -> \
"7a6d96ca-2660-4668-92e6-928ff3910e75"],
Cell[327259, 8206, 730, 20, 117, "Input", "ExpressionUUID" -> \
"7c0bf163-e593-4074-8290-0abe7145b179"]
}, Open  ]],
Cell[CellGroupData[{
Cell[328026, 8231, 188, 3, 35, "Subsubsection", "ExpressionUUID" -> \
"3ad8d8b4-3df3-407d-8f9c-be9e15303b74"],
Cell[328217, 8236, 1914, 59, 201, "Input", "ExpressionUUID" -> \
"96aa97b7-8e13-4250-a421-efb3cc49f900"],
Cell[330134, 8297, 206, 5, 32, "Input", "ExpressionUUID" -> \
"9c051a19-b748-4919-8e8d-155f6b5425c6"],
Cell[330343, 8304, 324, 7, 32, "Input", "ExpressionUUID" -> \
"beed03dd-ad1c-4e3a-aff8-f9183e29a212"],
Cell[330670, 8313, 627, 17, 32, "Input", "ExpressionUUID" -> \
"526c782b-570b-4ce6-811a-113c945cec23"],
Cell[331300, 8332, 442, 10, 54, "Input", "ExpressionUUID" -> \
"83a4e186-7a32-411b-9eec-63be3b9642df"],
Cell[331745, 8344, 1080, 24, 138, "Input", "ExpressionUUID" -> \
"dd71bf3c-39af-4240-9185-a5203e3e863e"],
Cell[332828, 8370, 628, 19, 54, "Input", "ExpressionUUID" -> \
"1f4b2a13-9d82-4221-a015-0ae23e1f4c07"],
Cell[333459, 8391, 273, 6, 32, "Input", "ExpressionUUID" -> \
"65368441-d6e5-4430-8925-45e20d1ef59f"],
Cell[333735, 8399, 917, 23, 75, "Input", "ExpressionUUID" -> \
"49ab81d9-89c3-40cd-868d-f3463a3311cb"],
Cell[334655, 8424, 545, 13, 54, "Input", "ExpressionUUID" -> \
"e94c1b53-a8fe-46ed-8cf1-3e225d9b60f1"],
Cell[335203, 8439, 445, 11, 54, "Input", "ExpressionUUID" -> \
"cb11675a-08a5-4489-9cfb-f49a4062f72b"],
Cell[335651, 8452, 2162, 60, 159, "Input", "ExpressionUUID" -> \
"d9d1ac22-89e6-4c76-a981-b4b7834511a3"],
Cell[337816, 8514, 3490, 96, 306, "Input", "ExpressionUUID" -> \
"c9024fba-84dc-48ac-b0b6-0eb4d24a7e3b"],
Cell[341309, 8612, 3476, 97, 285, "Input", "ExpressionUUID" -> \
"0a5bdabb-9b08-478e-bd33-c9ea20e2bac5"],
Cell[344788, 8711, 3962, 109, 306, "Input", "ExpressionUUID" -> \
"a79385b2-e4fb-40a2-ba53-e71cebf30531"],
Cell[348753, 8822, 626, 16, 54, "Input", "ExpressionUUID" -> \
"a917adb6-98df-4c57-87e6-9a84a8e13384"],
Cell[349382, 8840, 441, 11, 32, "Input", "ExpressionUUID" -> \
"80496866-1143-4a20-8975-4d2960a5b45f"],
Cell[349826, 8853, 397, 10, 32, "Input", "ExpressionUUID" -> \
"10fcbd94-2946-4e77-95d8-d6c356b590d3"],
Cell[350226, 8865, 630, 13, 32, "Input", "ExpressionUUID" -> \
"894c0b1c-ec2a-43f3-ba81-01668a03301d"],
Cell[350859, 8880, 566, 17, 75, "Input", "ExpressionUUID" -> \
"ac6ff5a1-67f3-4962-8569-3c5b937983bd"],
Cell[351428, 8899, 546, 15, 75, "Input", "ExpressionUUID" -> \
"9d2bc847-edb4-4ff4-924c-4c0d0ac3a281"],
Cell[351977, 8916, 551, 11, 32, "Input", "ExpressionUUID" -> \
"1124c974-58e1-4c09-98a9-d5e766b4f32e"],
Cell[352531, 8929, 447, 13, 32, "Input", "ExpressionUUID" -> \
"9e1e64a0-9953-4c48-bfaa-9539e5f809ae"],
Cell[352981, 8944, 498, 12, 32, "Input", "ExpressionUUID" -> \
"4e4ab014-0bff-41f3-b260-80b36bc64551"],
Cell[353482, 8958, 454, 12, 32, "Input", "ExpressionUUID" -> \
"f6920d74-e0c2-4a08-8b1a-720e9c9f8c43"],
Cell[353939, 8972, 458, 12, 54, "Input", "ExpressionUUID" -> \
"936b9a4d-4aa8-439b-80c5-853c6b554428"],
Cell[354400, 8986, 592, 17, 75, "Input", "ExpressionUUID" -> \
"d0c2396e-5483-4884-903b-91339770d3ee"],
Cell[354995, 9005, 594, 17, 75, "Input", "ExpressionUUID" -> \
"54b568bf-4fb2-49c4-b3ee-e0939dc23197"],
Cell[355592, 9024, 588, 17, 54, "Input", "ExpressionUUID" -> \
"3fa51d50-c819-4be1-aadf-00174bae51c6"],
Cell[356183, 9043, 369, 10, 54, "Input", "ExpressionUUID" -> \
"877ca50e-6cb4-4217-8466-9ee78170b6ac"],
Cell[356555, 9055, 343, 9, 54, "Input", "ExpressionUUID" -> \
"6d455349-0473-486b-8325-4f388c7770e9"],
Cell[356901, 9066, 840, 23, 96, "Input", "ExpressionUUID" -> \
"1287a9b5-a2cb-4776-bba3-7399ef2a1ed8"],
Cell[357744, 9091, 941, 21, 54, "Input", "ExpressionUUID" -> \
"a73dc3b4-70cb-4d80-a5b0-6826daf66e26"],
Cell[358688, 9114, 274, 7, 32, "Input", "ExpressionUUID" -> \
"34bb81af-1d16-4982-b41c-ea42e39968d2"],
Cell[358965, 9123, 977, 26, 96, "Input", "ExpressionUUID" -> \
"324e2e94-fca2-4d60-828f-2dd8a8f92787"],
Cell[359945, 9151, 511, 9, 32, "Input", "ExpressionUUID" -> \
"cb87d7c9-9832-44cb-b0c1-50be493e862b"],
Cell[360459, 9162, 5195, 123, 663, "Input", "ExpressionUUID" -> \
"64267db5-55f8-4b36-aac3-db4b74114acf"],
Cell[365657, 9287, 4450, 106, 600, "Input", "ExpressionUUID" -> \
"70f65310-cbef-4d57-9e69-70e0d232ce66"],
Cell[370110, 9395, 302, 7, 32, "Input", "ExpressionUUID" -> \
"5331adba-31f5-4be2-ac35-89ce5501c470"],
Cell[370415, 9404, 779, 22, 117, "Input", "ExpressionUUID" -> \
"a7fd4352-76a3-4e30-8b38-0caaa02cc953"],
Cell[371197, 9428, 734, 20, 117, "Input", "ExpressionUUID" -> \
"9efe5a10-ead4-4fba-b23c-7192d9274e95"],
Cell[371934, 9450, 734, 20, 117, "Input", "ExpressionUUID" -> \
"3940c8af-e02c-4e24-a2ad-707fa2a4eb2e"],
Cell[372671, 9472, 455, 14, 32, "Input", "ExpressionUUID" -> \
"f9e86e33-1263-44af-ab5c-858f3254ca64"],
Cell[373129, 9488, 249, 6, 32, "Input", "ExpressionUUID" -> \
"4148bd5b-f00f-490c-9929-feb2a9f5cb2f"],
Cell[373381, 9496, 356, 9, 54, "Input", "ExpressionUUID" -> \
"f922d2cd-59af-4c0d-9347-b81bbded3394"],
Cell[373740, 9507, 234, 6, 32, "Input", "ExpressionUUID" -> \
"61cead47-2a0e-47b1-892e-0590ded4bded"],
Cell[373977, 9515, 409, 12, 32, "Input", "ExpressionUUID" -> \
"9f872d1b-f360-4d6b-804e-eecbf333f89b"],
Cell[374389, 9529, 4901, 117, 600, "Input", "ExpressionUUID" -> \
"56dee6f4-3e5f-44e1-8642-a0390054649b"],
Cell[379293, 9648, 482, 13, 54, "Input", "ExpressionUUID" -> \
"52a99331-d752-4eec-8256-52e98c8aa0c1"],
Cell[379778, 9663, 383, 8, 32, "Input", "ExpressionUUID" -> \
"97b4b5fe-b19c-4cc6-8972-2855f3a59ed9"],
Cell[380164, 9673, 203, 4, 32, "Input", "ExpressionUUID" -> \
"b7f0efbc-abb5-4d13-b3c6-9e224b2d6dab"],
Cell[380370, 9679, 764, 21, 117, "Input", "ExpressionUUID" -> \
"72728c1f-80b6-456f-8d8e-0e4ac2bc29e8"],
Cell[381137, 9702, 664, 20, 54, "Input", "ExpressionUUID" -> \
"26323f08-0100-45c9-9074-e68145c3e601"],
Cell[381804, 9724, 175, 3, 32, "Input", "ExpressionUUID" -> \
"7e0ee65d-1284-4417-bc35-0fc3e46a8f7e"],
Cell[381982, 9729, 483, 13, 32, "Input", "ExpressionUUID" -> \
"1cac39c7-875c-4a57-9745-43cab52af265"],
Cell[382468, 9744, 2011, 49, 180, "Input", "ExpressionUUID" -> \
"43e2a1a6-90fc-4f2e-98e7-d16ee68cdee3"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

